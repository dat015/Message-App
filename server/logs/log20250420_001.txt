2025-04-20 22:51:10.159 +07:00 [INF] Executed DbCommand (36ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [u].[id], [u].[username], [u].[avatar_url]
FROM [Users] AS [u]
2025-04-20 22:51:10.383 +07:00 [INF] User profile is available. Using 'C:\Users\Thao\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-04-20 22:51:10.489 +07:00 [WRN] Overriding address(es) 'https://localhost:7189, http://localhost:5053'. Binding to endpoints defined via IConfiguration and/or UseKestrel() instead.
2025-04-20 22:51:10.509 +07:00 [ERR] Hosting failed to start
System.IO.IOException: Failed to bind to address http://[::]:5053: address already in use.
 ---> Microsoft.AspNetCore.Connections.AddressInUseException: Only one usage of each socket address (protocol/network address/port) is normally permitted.
 ---> System.Net.Sockets.SocketException (10048): Only one usage of each socket address (protocol/network address/port) is normally permitted.
   at System.Net.Sockets.Socket.UpdateStatusAfterSocketErrorAndThrowException(SocketError error, Boolean disconnectOnFailure, String callerName)
   at System.Net.Sockets.Socket.DoBind(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Bind(EndPoint localEP)
   at Microsoft.AspNetCore.Server.Kestrel.Transport.Sockets.SocketTransportOptions.CreateDefaultBoundListenSocket(EndPoint endpoint)
   at Microsoft.AspNetCore.Server.Kestrel.Transport.Sockets.SocketConnectionListener.Bind()
   --- End of inner exception stack trace ---
   at Microsoft.AspNetCore.Server.Kestrel.Transport.Sockets.SocketConnectionListener.Bind()
   at Microsoft.AspNetCore.Server.Kestrel.Transport.Sockets.SocketTransportFactory.BindAsync(EndPoint endpoint, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.Infrastructure.TransportManager.BindAsync(EndPoint endPoint, ConnectionDelegate connectionDelegate, EndpointConfig endpointConfig, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Core.KestrelServerImpl.<>c__DisplayClass28_0`1.<<StartAsync>g__OnBind|0>d.MoveNext()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.AddressBinder.BindEndpointAsync(ListenOptions endpoint, AddressBindContext context, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.AddressBinder.BindEndpointAsync(ListenOptions endpoint, AddressBindContext context, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Core.ListenOptions.BindAsync(AddressBindContext context, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Core.AnyIPListenOptions.BindAsync(AddressBindContext context, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.AddressBinder.EndpointsStrategy.BindAsync(AddressBindContext context, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.AddressBinder.BindAsync(ListenOptions[] listenOptions, AddressBindContext context, Func`2 useHttps, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Core.KestrelServerImpl.BindAsync(CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Core.KestrelServerImpl.StartAsync[TContext](IHttpApplication`1 application, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Hosting.GenericWebHostService.StartAsync(CancellationToken cancellationToken)
   at Microsoft.Extensions.Hosting.Internal.Host.<StartAsync>b__15_1(IHostedService service, CancellationToken token)
   at Microsoft.Extensions.Hosting.Internal.Host.ForeachService[T](IEnumerable`1 services, CancellationToken token, Boolean concurrent, Boolean abortOnFirstException, List`1 exceptions, Func`3 operation)
2025-04-20 22:52:36.451 +07:00 [INF] Executed DbCommand (28ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [u].[id], [u].[username], [u].[avatar_url]
FROM [Users] AS [u]
2025-04-20 22:52:36.658 +07:00 [INF] User profile is available. Using 'C:\Users\Thao\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-04-20 22:52:36.749 +07:00 [WRN] Overriding address(es) 'https://localhost:7189, http://localhost:5053'. Binding to endpoints defined via IConfiguration and/or UseKestrel() instead.
2025-04-20 22:52:36.762 +07:00 [INF] Now listening on: http://[::]:5053
2025-04-20 22:52:36.762 +07:00 [INF] Now listening on: http://0.0.0.0:5053
2025-04-20 22:52:36.762 +07:00 [INF] Application started. Press Ctrl+C to shut down.
2025-04-20 22:52:36.763 +07:00 [INF] Hosting environment: Development
2025-04-20 22:52:36.763 +07:00 [INF] Content root path: C:\Users\Thao\source\Flutter\Message_app\server
2025-04-20 22:53:03.943 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/api/Message/getMessages/1/5 - null null
2025-04-20 22:53:04.042 +07:00 [WRN] Failed to determine the https port for redirect.
2025-04-20 22:53:04.291 +07:00 [INF] Executing endpoint 'server.Controllers.MessageController.GetMessages (Message_app)'
2025-04-20 22:53:04.330 +07:00 [INF] Route matched with {action = "GetMessages", controller = "Message"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetMessages(Int32, Int32) on controller server.Controllers.MessageController (Message_app).
2025-04-20 22:56:26.122 +07:00 [INF] Request starting HTTP/1.1 GET http://192.168.1.3:5053/ws/chat - null null
2025-04-20 22:56:26.122 +07:00 [INF] Request starting HTTP/1.1 GET http://192.168.1.3:5053/ws/chat - null null
2025-04-20 22:56:26.122 +07:00 [INF] Request starting HTTP/1.1 GET http://192.168.1.3:5053/ws/chat - null null
2025-04-20 22:56:26.147 +07:00 [INF] Executing endpoint '/ws/chat'
2025-04-20 22:56:26.147 +07:00 [INF] Executing endpoint '/ws/chat'
2025-04-20 22:56:26.147 +07:00 [INF] Executing endpoint '/ws/chat'
2025-04-20 22:56:26.218 +07:00 [INF] Executing ObjectResult, writing value of type 'System.String'.
2025-04-20 22:56:26.222 +07:00 [INF] Executed action server.Controllers.MessageController.GetMessages (Message_app) in 201889.5606ms
2025-04-20 22:56:26.224 +07:00 [INF] Executed endpoint 'server.Controllers.MessageController.GetMessages (Message_app)'
2025-04-20 22:56:26.229 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5053/api/Message/getMessages/1/5 - 500 null text/plain; charset=utf-8 202288.8121ms
2025-04-20 22:56:26.402 +07:00 [INF] Executed DbCommand (22ms) [Parameters=[@__client_UserId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[conversation_id]
FROM [Participants] AS [p]
WHERE [p].[user_id] = @__client_UserId_0 AND [p].[is_deleted] = CAST(0 AS bit)
2025-04-20 22:56:26.402 +07:00 [INF] Executed DbCommand (27ms) [Parameters=[@__client_UserId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[conversation_id]
FROM [Participants] AS [p]
WHERE [p].[user_id] = @__client_UserId_0 AND [p].[is_deleted] = CAST(0 AS bit)
2025-04-20 22:56:26.402 +07:00 [INF] Executed DbCommand (31ms) [Parameters=[@__client_UserId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[conversation_id]
FROM [Participants] AS [p]
WHERE [p].[user_id] = @__client_UserId_0 AND [p].[is_deleted] = CAST(0 AS bit)
2025-04-20 23:00:57.262 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/api/Message/getMessages/1/5 - null null
2025-04-20 23:00:57.285 +07:00 [INF] Executing endpoint 'server.Controllers.MessageController.GetMessages (Message_app)'
2025-04-20 23:00:57.286 +07:00 [INF] Route matched with {action = "GetMessages", controller = "Message"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetMessages(Int32, Int32) on controller server.Controllers.MessageController (Message_app).
2025-04-20 23:05:10.653 +07:00 [INF] Executing ObjectResult, writing value of type 'System.String'.
2025-04-20 23:05:10.656 +07:00 [INF] Executed action server.Controllers.MessageController.GetMessages (Message_app) in 253369.2041ms
2025-04-20 23:05:10.656 +07:00 [INF] Executed endpoint 'server.Controllers.MessageController.GetMessages (Message_app)'
2025-04-20 23:05:10.656 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5053/api/Message/getMessages/1/5 - 500 null text/plain; charset=utf-8 253393.7502ms
2025-04-20 23:05:14.750 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/api/Message/getMessages/1/5 - null null
2025-04-20 23:05:14.751 +07:00 [INF] Executing endpoint 'server.Controllers.MessageController.GetMessages (Message_app)'
2025-04-20 23:05:14.751 +07:00 [INF] Route matched with {action = "GetMessages", controller = "Message"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetMessages(Int32, Int32) on controller server.Controllers.MessageController (Message_app).
2025-04-20 23:05:14.762 +07:00 [INF] Retrieved 0 messages from Redis for conversation 1
2025-04-20 23:05:14.844 +07:00 [INF] Executed DbCommand (17ms) [Parameters=[@__user_id_0='?' (DbType = Int32), @__conversationId_1='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[cleared_at]
FROM [messageDeletions] AS [m]
WHERE [m].[user_id] = @__user_id_0 AND CAST([m].[conversation_id] AS bigint) = @__conversationId_1
2025-04-20 23:05:14.976 +07:00 [INF] Executed DbCommand (36ms) [Parameters=[@__p_1='?' (DbType = Int32), @__conversationId_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[id], [t].[content], [t].[conversation_id], [t].[created_at], [t].[isFile], [t].[isRecalled], [t].[is_read], [t].[sender_id], [t].[type], [a].[id], [a].[FileSize], [a].[file_type], [a].[file_url], [a].[is_temporary], [a].[message_id], [a].[uploaded_at]
FROM (
    SELECT TOP(@__p_1) [m].[id], [m].[content], [m].[conversation_id], [m].[created_at], [m].[isFile], [m].[isRecalled], [m].[is_read], [m].[sender_id], [m].[type]
    FROM [Messages] AS [m]
    WHERE CAST([m].[conversation_id] AS bigint) = @__conversationId_0
    ORDER BY [m].[created_at] DESC
) AS [t]
LEFT JOIN [Attachments] AS [a] ON [t].[id] = [a].[message_id]
ORDER BY [t].[created_at] DESC, [t].[id]
2025-04-20 23:05:24.452 +07:00 [INF] Saved message 81 to Redis
2025-04-20 23:05:24.458 +07:00 [INF] Added message 81 to conversation 1
2025-04-20 23:05:24.460 +07:00 [INF] Saved message 80 to Redis
2025-04-20 23:05:24.462 +07:00 [INF] Added message 80 to conversation 1
2025-04-20 23:05:24.464 +07:00 [INF] Saved message 79 to Redis
2025-04-20 23:05:24.465 +07:00 [INF] Added message 79 to conversation 1
2025-04-20 23:05:24.466 +07:00 [INF] Saved message 78 to Redis
2025-04-20 23:05:24.467 +07:00 [INF] Added message 78 to conversation 1
2025-04-20 23:05:24.468 +07:00 [INF] Saved message 77 to Redis
2025-04-20 23:05:24.469 +07:00 [INF] Added message 77 to conversation 1
2025-04-20 23:05:24.474 +07:00 [INF] Saved message 76 to Redis
2025-04-20 23:05:24.474 +07:00 [INF] Added message 76 to conversation 1
2025-04-20 23:05:24.479 +07:00 [INF] Saved message 75 to Redis
2025-04-20 23:05:24.480 +07:00 [INF] Added message 75 to conversation 1
2025-04-20 23:05:24.481 +07:00 [INF] Saved message 74 to Redis
2025-04-20 23:05:24.482 +07:00 [INF] Added message 74 to conversation 1
2025-04-20 23:05:24.484 +07:00 [INF] Saved message 73 to Redis
2025-04-20 23:05:24.485 +07:00 [INF] Added message 73 to conversation 1
2025-04-20 23:05:24.488 +07:00 [INF] Saved message 72 to Redis
2025-04-20 23:05:24.488 +07:00 [INF] Added message 72 to conversation 1
2025-04-20 23:05:24.491 +07:00 [INF] Saved message 71 to Redis
2025-04-20 23:05:24.491 +07:00 [INF] Added message 71 to conversation 1
2025-04-20 23:05:24.493 +07:00 [INF] Saved message 68 to Redis
2025-04-20 23:05:24.494 +07:00 [INF] Added message 68 to conversation 1
2025-04-20 23:05:24.495 +07:00 [INF] Saved message 64 to Redis
2025-04-20 23:05:24.496 +07:00 [INF] Added message 64 to conversation 1
2025-04-20 23:05:24.498 +07:00 [INF] Saved message 62 to Redis
2025-04-20 23:05:24.499 +07:00 [INF] Added message 62 to conversation 1
2025-04-20 23:05:24.500 +07:00 [INF] Saved message 61 to Redis
2025-04-20 23:05:24.501 +07:00 [INF] Added message 61 to conversation 1
2025-04-20 23:05:24.503 +07:00 [INF] Saved message 60 to Redis
2025-04-20 23:05:24.504 +07:00 [INF] Added message 60 to conversation 1
2025-04-20 23:05:24.506 +07:00 [INF] Saved message 59 to Redis
2025-04-20 23:05:24.507 +07:00 [INF] Added message 59 to conversation 1
2025-04-20 23:05:24.508 +07:00 [INF] Saved message 57 to Redis
2025-04-20 23:05:24.509 +07:00 [INF] Added message 57 to conversation 1
2025-04-20 23:05:24.510 +07:00 [INF] Saved message 55 to Redis
2025-04-20 23:05:24.510 +07:00 [INF] Added message 55 to conversation 1
2025-04-20 23:05:24.511 +07:00 [INF] Saved message 54 to Redis
2025-04-20 23:05:24.512 +07:00 [INF] Added message 54 to conversation 1
2025-04-20 23:05:24.514 +07:00 [INF] Saved message 51 to Redis
2025-04-20 23:05:24.515 +07:00 [INF] Added message 51 to conversation 1
2025-04-20 23:05:24.516 +07:00 [INF] Saved message 49 to Redis
2025-04-20 23:05:24.517 +07:00 [INF] Added message 49 to conversation 1
2025-04-20 23:05:24.519 +07:00 [INF] Saved message 11 to Redis
2025-04-20 23:05:24.520 +07:00 [INF] Added message 11 to conversation 1
2025-04-20 23:05:24.521 +07:00 [INF] Saved message 8 to Redis
2025-04-20 23:05:24.522 +07:00 [INF] Added message 8 to conversation 1
2025-04-20 23:05:24.527 +07:00 [INF] Saved message 3 to Redis
2025-04-20 23:05:24.527 +07:00 [INF] Added message 3 to conversation 1
2025-04-20 23:05:24.529 +07:00 [INF] Saved message 2 to Redis
2025-04-20 23:05:24.529 +07:00 [INF] Added message 2 to conversation 1
2025-04-20 23:05:24.531 +07:00 [INF] Saved message 1 to Redis
2025-04-20 23:05:24.532 +07:00 [INF] Added message 1 to conversation 1
2025-04-20 23:05:24.532 +07:00 [INF] Cached 27 messages to Redis for conversation 1
2025-04-20 23:05:24.533 +07:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[server.DTO.MessageWithAttachment, Message_app, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-04-20 23:05:24.718 +07:00 [INF] Executed action server.Controllers.MessageController.GetMessages (Message_app) in 9966.7481ms
2025-04-20 23:05:24.718 +07:00 [INF] Executed endpoint 'server.Controllers.MessageController.GetMessages (Message_app)'
2025-04-20 23:05:24.722 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5053/api/Message/getMessages/1/5 - 200 null application/json; charset=utf-8 9972.0925ms
2025-04-20 23:05:27.317 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/api/Message/getMessages/1/5 - null null
2025-04-20 23:05:27.318 +07:00 [INF] Executing endpoint 'server.Controllers.MessageController.GetMessages (Message_app)'
2025-04-20 23:05:27.319 +07:00 [INF] Route matched with {action = "GetMessages", controller = "Message"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetMessages(Int32, Int32) on controller server.Controllers.MessageController (Message_app).
2025-04-20 23:05:27.351 +07:00 [INF] Executing ObjectResult, writing value of type 'System.String'.
2025-04-20 23:05:27.351 +07:00 [INF] Executed action server.Controllers.MessageController.GetMessages (Message_app) in 32.2237ms
2025-04-20 23:05:27.352 +07:00 [INF] Executed endpoint 'server.Controllers.MessageController.GetMessages (Message_app)'
2025-04-20 23:05:27.352 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5053/api/Message/getMessages/1/5 - 500 null text/plain; charset=utf-8 34.7938ms
2025-04-20 23:06:45.497 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/api/Message/getMessages/1/5 - null null
2025-04-20 23:06:45.499 +07:00 [INF] Executing endpoint 'server.Controllers.MessageController.GetMessages (Message_app)'
2025-04-20 23:06:45.499 +07:00 [INF] Route matched with {action = "GetMessages", controller = "Message"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetMessages(Int32, Int32) on controller server.Controllers.MessageController (Message_app).
2025-04-20 23:06:45.542 +07:00 [INF] Executing ObjectResult, writing value of type 'System.String'.
2025-04-20 23:06:45.542 +07:00 [INF] Executed action server.Controllers.MessageController.GetMessages (Message_app) in 43.357ms
2025-04-20 23:06:45.542 +07:00 [INF] Executed endpoint 'server.Controllers.MessageController.GetMessages (Message_app)'
2025-04-20 23:06:45.543 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5053/api/Message/getMessages/1/5 - 500 null text/plain; charset=utf-8 45.5661ms
2025-04-20 23:06:58.470 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/api/Message/getMessages/1/5 - null null
2025-04-20 23:06:58.471 +07:00 [INF] Executing endpoint 'server.Controllers.MessageController.GetMessages (Message_app)'
2025-04-20 23:06:58.471 +07:00 [INF] Route matched with {action = "GetMessages", controller = "Message"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetMessages(Int32, Int32) on controller server.Controllers.MessageController (Message_app).
2025-04-20 23:06:58.501 +07:00 [INF] Executing ObjectResult, writing value of type 'System.String'.
2025-04-20 23:06:58.501 +07:00 [INF] Executed action server.Controllers.MessageController.GetMessages (Message_app) in 30.4011ms
2025-04-20 23:06:58.501 +07:00 [INF] Executed endpoint 'server.Controllers.MessageController.GetMessages (Message_app)'
2025-04-20 23:06:58.501 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5053/api/Message/getMessages/1/5 - 500 null text/plain; charset=utf-8 31.214ms
2025-04-20 23:06:59.560 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/api/Message/getMessages/1/5 - null null
2025-04-20 23:06:59.561 +07:00 [INF] Executing endpoint 'server.Controllers.MessageController.GetMessages (Message_app)'
2025-04-20 23:06:59.561 +07:00 [INF] Route matched with {action = "GetMessages", controller = "Message"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetMessages(Int32, Int32) on controller server.Controllers.MessageController (Message_app).
2025-04-20 23:06:59.590 +07:00 [INF] Executing ObjectResult, writing value of type 'System.String'.
2025-04-20 23:06:59.590 +07:00 [INF] Executed action server.Controllers.MessageController.GetMessages (Message_app) in 29.6175ms
2025-04-20 23:06:59.591 +07:00 [INF] Executed endpoint 'server.Controllers.MessageController.GetMessages (Message_app)'
2025-04-20 23:06:59.591 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5053/api/Message/getMessages/1/5 - 500 null text/plain; charset=utf-8 30.1412ms
2025-04-20 23:07:23.110 +07:00 [INF] Executed DbCommand (35ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [u].[id], [u].[username], [u].[avatar_url]
FROM [Users] AS [u]
2025-04-20 23:07:23.363 +07:00 [INF] User profile is available. Using 'C:\Users\Thao\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-04-20 23:07:23.483 +07:00 [WRN] Overriding address(es) 'https://localhost:7189, http://localhost:5053'. Binding to endpoints defined via IConfiguration and/or UseKestrel() instead.
2025-04-20 23:07:23.495 +07:00 [INF] Now listening on: http://[::]:5053
2025-04-20 23:07:23.495 +07:00 [INF] Now listening on: http://0.0.0.0:5053
2025-04-20 23:07:23.495 +07:00 [INF] Application started. Press Ctrl+C to shut down.
2025-04-20 23:07:23.495 +07:00 [INF] Hosting environment: Development
2025-04-20 23:07:23.496 +07:00 [INF] Content root path: C:\Users\Thao\source\Flutter\Message_app\server
2025-04-20 23:07:29.531 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/api/Message/getMessages/1/5 - null null
2025-04-20 23:07:29.576 +07:00 [WRN] Failed to determine the https port for redirect.
2025-04-20 23:07:29.647 +07:00 [INF] Executing endpoint 'server.Controllers.MessageController.GetMessages (Message_app)'
2025-04-20 23:07:29.672 +07:00 [INF] Route matched with {action = "GetMessages", controller = "Message"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetMessages(Int32, Int32) on controller server.Controllers.MessageController (Message_app).
2025-04-20 23:07:29.777 +07:00 [INF] Executing ObjectResult, writing value of type 'System.String'.
2025-04-20 23:07:29.782 +07:00 [INF] Executed action server.Controllers.MessageController.GetMessages (Message_app) in 107.1882ms
2025-04-20 23:07:29.783 +07:00 [INF] Executed endpoint 'server.Controllers.MessageController.GetMessages (Message_app)'
2025-04-20 23:07:29.786 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5053/api/Message/getMessages/1/5 - 500 null text/plain; charset=utf-8 256.6746ms
2025-04-20 23:08:20.840 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/api/Message/getMessages/1/5 - null null
2025-04-20 23:08:20.853 +07:00 [INF] Executing endpoint 'server.Controllers.MessageController.GetMessages (Message_app)'
2025-04-20 23:08:20.854 +07:00 [INF] Route matched with {action = "GetMessages", controller = "Message"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetMessages(Int32, Int32) on controller server.Controllers.MessageController (Message_app).
2025-04-20 23:08:20.892 +07:00 [INF] Executing ObjectResult, writing value of type 'System.String'.
2025-04-20 23:08:20.892 +07:00 [INF] Executed action server.Controllers.MessageController.GetMessages (Message_app) in 38.3443ms
2025-04-20 23:08:20.893 +07:00 [INF] Executed endpoint 'server.Controllers.MessageController.GetMessages (Message_app)'
2025-04-20 23:08:20.893 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5053/api/Message/getMessages/1/5 - 500 null text/plain; charset=utf-8 52.7375ms
2025-04-20 23:08:21.545 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/api/Message/getMessages/1/5 - null null
2025-04-20 23:08:21.548 +07:00 [INF] Executing endpoint 'server.Controllers.MessageController.GetMessages (Message_app)'
2025-04-20 23:08:21.548 +07:00 [INF] Route matched with {action = "GetMessages", controller = "Message"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetMessages(Int32, Int32) on controller server.Controllers.MessageController (Message_app).
2025-04-20 23:08:21.590 +07:00 [INF] Executing ObjectResult, writing value of type 'System.String'.
2025-04-20 23:08:21.590 +07:00 [INF] Executed action server.Controllers.MessageController.GetMessages (Message_app) in 41.86ms
2025-04-20 23:08:21.591 +07:00 [INF] Executed endpoint 'server.Controllers.MessageController.GetMessages (Message_app)'
2025-04-20 23:08:21.591 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5053/api/Message/getMessages/1/5 - 500 null text/plain; charset=utf-8 46.288ms
2025-04-20 23:09:31.038 +07:00 [INF] Request starting HTTP/1.1 GET http://192.168.1.3:5053/ws/chat - null null
2025-04-20 23:09:31.039 +07:00 [INF] Executing endpoint '/ws/chat'
2025-04-20 23:09:31.042 +07:00 [INF] Request starting HTTP/1.1 GET http://192.168.1.3:5053/ws/chat - null null
2025-04-20 23:09:31.052 +07:00 [INF] Executing endpoint '/ws/chat'
2025-04-20 23:09:31.055 +07:00 [INF] Request starting HTTP/1.1 GET http://192.168.1.3:5053/ws/chat - null null
2025-04-20 23:09:31.055 +07:00 [INF] Executing endpoint '/ws/chat'
2025-04-20 23:09:31.537 +07:00 [INF] Executed DbCommand (52ms) [Parameters=[@__client_UserId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[conversation_id]
FROM [Participants] AS [p]
WHERE [p].[user_id] = @__client_UserId_0 AND [p].[is_deleted] = CAST(0 AS bit)
2025-04-20 23:09:31.537 +07:00 [INF] Executed DbCommand (41ms) [Parameters=[@__client_UserId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[conversation_id]
FROM [Participants] AS [p]
WHERE [p].[user_id] = @__client_UserId_0 AND [p].[is_deleted] = CAST(0 AS bit)
2025-04-20 23:09:31.537 +07:00 [INF] Executed DbCommand (23ms) [Parameters=[@__client_UserId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[conversation_id]
FROM [Participants] AS [p]
WHERE [p].[user_id] = @__client_UserId_0 AND [p].[is_deleted] = CAST(0 AS bit)
2025-04-20 23:09:31.675 +07:00 [INF] Executed DbCommand (7ms) [Parameters=[@__p_1='?' (DbType = Int32), @__conversationId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(@__p_1) [m].[id], [m].[conversation_id], [m].[sender_id], [m].[content], [m].[created_at], [m].[isFile], [m].[type], [m].[isRecalled]
FROM [Messages] AS [m]
WHERE [m].[conversation_id] = @__conversationId_0
ORDER BY [m].[created_at] DESC
2025-04-20 23:09:31.677 +07:00 [INF] Executed DbCommand (9ms) [Parameters=[@__p_1='?' (DbType = Int32), @__conversationId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(@__p_1) [m].[id], [m].[conversation_id], [m].[sender_id], [m].[content], [m].[created_at], [m].[isFile], [m].[type], [m].[isRecalled]
FROM [Messages] AS [m]
WHERE [m].[conversation_id] = @__conversationId_0
ORDER BY [m].[created_at] DESC
2025-04-20 23:09:31.677 +07:00 [INF] Executed DbCommand (7ms) [Parameters=[@__p_1='?' (DbType = Int32), @__conversationId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(@__p_1) [m].[id], [m].[conversation_id], [m].[sender_id], [m].[content], [m].[created_at], [m].[isFile], [m].[type], [m].[isRecalled]
FROM [Messages] AS [m]
WHERE [m].[conversation_id] = @__conversationId_0
ORDER BY [m].[created_at] DESC
2025-04-20 23:09:31.718 +07:00 [INF] Saved message 69 to Redis
2025-04-20 23:09:31.718 +07:00 [INF] Saved message 69 to Redis
2025-04-20 23:09:31.718 +07:00 [INF] Saved message 69 to Redis
2025-04-20 23:09:31.721 +07:00 [INF] Added message 69 to conversation 4
2025-04-20 23:09:31.721 +07:00 [INF] Added message 69 to conversation 4
2025-04-20 23:09:31.721 +07:00 [INF] Added message 69 to conversation 4
2025-04-20 23:09:31.725 +07:00 [INF] Saved message 67 to Redis
2025-04-20 23:09:31.725 +07:00 [INF] Saved message 67 to Redis
2025-04-20 23:09:31.726 +07:00 [INF] Saved message 67 to Redis
2025-04-20 23:09:31.727 +07:00 [INF] Added message 67 to conversation 4
2025-04-20 23:09:31.732 +07:00 [INF] Added message 67 to conversation 4
2025-04-20 23:09:31.733 +07:00 [INF] Added message 67 to conversation 4
2025-04-20 23:09:31.739 +07:00 [INF] Message 66 already exists in Redis
2025-04-20 23:09:31.748 +07:00 [INF] Saved message 66 to Redis
2025-04-20 23:09:31.748 +07:00 [INF] Saved message 66 to Redis
2025-04-20 23:09:31.752 +07:00 [INF] Added message 66 to conversation 4
2025-04-20 23:09:31.758 +07:00 [INF] Added message 66 to conversation 4
2025-04-20 23:09:31.759 +07:00 [INF] Message 63 already exists in Redis
2025-04-20 23:09:31.762 +07:00 [INF] Message 63 already exists in Redis
2025-04-20 23:09:31.771 +07:00 [INF] Saved message 58 to Redis
2025-04-20 23:09:31.771 +07:00 [INF] Saved message 63 to Redis
2025-04-20 23:09:31.775 +07:00 [INF] Added message 58 to conversation 4
2025-04-20 23:09:31.772 +07:00 [INF] Saved message 58 to Redis
2025-04-20 23:09:31.782 +07:00 [INF] Added message 58 to conversation 4
2025-04-20 23:09:31.798 +07:00 [INF] Message 56 already exists in Redis
2025-04-20 23:09:31.798 +07:00 [INF] Saved message 56 to Redis
2025-04-20 23:09:31.798 +07:00 [INF] Added message 63 to conversation 4
2025-04-20 23:09:31.816 +07:00 [INF] Message 58 already exists in Redis
2025-04-20 23:09:31.816 +07:00 [INF] Added message 56 to conversation 4
2025-04-20 23:09:31.826 +07:00 [INF] Message 56 already exists in Redis
2025-04-20 23:09:31.826 +07:00 [INF] Message 53 already exists in Redis
2025-04-20 23:09:31.828 +07:00 [INF] Saved message 53 to Redis
2025-04-20 23:09:31.829 +07:00 [INF] Message 53 already exists in Redis
2025-04-20 23:09:31.832 +07:00 [INF] Added message 53 to conversation 4
2025-04-20 23:09:31.835 +07:00 [INF] Message 52 already exists in Redis
2025-04-20 23:09:31.838 +07:00 [INF] Message 52 already exists in Redis
2025-04-20 23:09:31.838 +07:00 [INF] Saved message 52 to Redis
2025-04-20 23:09:31.840 +07:00 [INF] Message 50 already exists in Redis
2025-04-20 23:09:31.841 +07:00 [INF] Added message 52 to conversation 4
2025-04-20 23:09:31.844 +07:00 [INF] Saved message 50 to Redis
2025-04-20 23:09:31.844 +07:00 [INF] Message 50 already exists in Redis
2025-04-20 23:09:31.845 +07:00 [INF] Added message 50 to conversation 4
2025-04-20 23:09:31.850 +07:00 [INF] Message 47 already exists in Redis
2025-04-20 23:09:31.862 +07:00 [INF] Saved message 47 to Redis
2025-04-20 23:09:31.862 +07:00 [INF] Message 47 already exists in Redis
2025-04-20 23:09:31.868 +07:00 [INF] Added message 47 to conversation 4
2025-04-20 23:09:31.873 +07:00 [INF] Saved message 46 to Redis
2025-04-20 23:09:31.875 +07:00 [INF] Message 46 already exists in Redis
2025-04-20 23:09:31.877 +07:00 [INF] Saved message 46 to Redis
2025-04-20 23:09:31.877 +07:00 [INF] Added message 46 to conversation 4
2025-04-20 23:09:31.882 +07:00 [INF] Added message 46 to conversation 4
2025-04-20 23:09:31.887 +07:00 [INF] Message 45 already exists in Redis
2025-04-20 23:09:31.890 +07:00 [INF] Saved message 45 to Redis
2025-04-20 23:09:31.892 +07:00 [INF] Saved message 45 to Redis
2025-04-20 23:09:31.892 +07:00 [INF] Added message 45 to conversation 4
2025-04-20 23:09:31.892 +07:00 [INF] Saved message 44 to Redis
2025-04-20 23:09:31.894 +07:00 [INF] Added message 45 to conversation 4
2025-04-20 23:09:31.896 +07:00 [INF] Message 44 already exists in Redis
2025-04-20 23:09:31.901 +07:00 [INF] Added message 44 to conversation 4
2025-04-20 23:09:31.902 +07:00 [INF] Message 44 already exists in Redis
2025-04-20 23:09:31.903 +07:00 [INF] Message 43 already exists in Redis
2025-04-20 23:09:31.904 +07:00 [INF] Saved message 43 to Redis
2025-04-20 23:09:31.906 +07:00 [INF] Added message 43 to conversation 4
2025-04-20 23:09:31.906 +07:00 [INF] Saved message 43 to Redis
2025-04-20 23:09:31.907 +07:00 [INF] Message 42 already exists in Redis
2025-04-20 23:09:31.910 +07:00 [INF] Added message 43 to conversation 4
2025-04-20 23:09:31.910 +07:00 [INF] Saved message 42 to Redis
2025-04-20 23:09:31.912 +07:00 [INF] Message 42 already exists in Redis
2025-04-20 23:09:31.914 +07:00 [INF] Added message 42 to conversation 4
2025-04-20 23:09:31.919 +07:00 [INF] Saved message 41 to Redis
2025-04-20 23:09:31.919 +07:00 [INF] Message 41 already exists in Redis
2025-04-20 23:09:31.919 +07:00 [INF] Message 41 already exists in Redis
2025-04-20 23:09:31.921 +07:00 [INF] Added message 41 to conversation 4
2025-04-20 23:09:31.924 +07:00 [INF] Message 40 already exists in Redis
2025-04-20 23:09:31.925 +07:00 [INF] Saved message 40 to Redis
2025-04-20 23:09:31.926 +07:00 [INF] Saved message 40 to Redis
2025-04-20 23:09:31.927 +07:00 [INF] Added message 40 to conversation 4
2025-04-20 23:09:31.929 +07:00 [INF] Saved message 39 to Redis
2025-04-20 23:09:31.929 +07:00 [INF] Message 39 already exists in Redis
2025-04-20 23:09:31.929 +07:00 [INF] Added message 40 to conversation 4
2025-04-20 23:09:31.932 +07:00 [INF] Added message 39 to conversation 4
2025-04-20 23:09:31.933 +07:00 [INF] Message 39 already exists in Redis
2025-04-20 23:09:31.935 +07:00 [INF] Message 38 already exists in Redis
2025-04-20 23:09:31.935 +07:00 [INF] Saved message 38 to Redis
2025-04-20 23:09:31.937 +07:00 [INF] Message 38 already exists in Redis
2025-04-20 23:09:31.939 +07:00 [INF] Added message 38 to conversation 4
2025-04-20 23:09:31.941 +07:00 [INF] Message 37 already exists in Redis
2025-04-20 23:09:31.943 +07:00 [INF] Saved message 37 to Redis
2025-04-20 23:09:31.945 +07:00 [INF] Saved message 37 to Redis
2025-04-20 23:09:31.946 +07:00 [INF] Added message 37 to conversation 4
2025-04-20 23:09:31.946 +07:00 [INF] Added message 37 to conversation 4
2025-04-20 23:09:31.949 +07:00 [INF] Saved message 36 to Redis
2025-04-20 23:09:31.949 +07:00 [INF] Message 36 already exists in Redis
2025-04-20 23:09:31.949 +07:00 [INF] Message 36 already exists in Redis
2025-04-20 23:09:31.955 +07:00 [INF] Added message 36 to conversation 4
2025-04-20 23:09:31.961 +07:00 [INF] Message 35 already exists in Redis
2025-04-20 23:09:31.961 +07:00 [INF] Saved message 35 to Redis
2025-04-20 23:09:31.962 +07:00 [INF] Saved message 35 to Redis
2025-04-20 23:09:31.968 +07:00 [INF] Saved message 34 to Redis
2025-04-20 23:09:31.968 +07:00 [INF] Added message 35 to conversation 4
2025-04-20 23:09:31.970 +07:00 [INF] Added message 35 to conversation 4
2025-04-20 23:09:31.970 +07:00 [INF] Added message 34 to conversation 4
2025-04-20 23:09:31.973 +07:00 [INF] Message 34 already exists in Redis
2025-04-20 23:09:31.973 +07:00 [INF] Message 34 already exists in Redis
2025-04-20 23:09:31.976 +07:00 [INF] Message 33 already exists in Redis
2025-04-20 23:09:31.976 +07:00 [INF] Message 33 already exists in Redis
2025-04-20 23:09:31.977 +07:00 [INF] Saved message 33 to Redis
2025-04-20 23:09:31.979 +07:00 [INF] Added message 33 to conversation 4
2025-04-20 23:09:31.979 +07:00 [INF] Saved message 32 to Redis
2025-04-20 23:09:31.979 +07:00 [INF] Saved message 32 to Redis
2025-04-20 23:09:31.982 +07:00 [INF] Added message 32 to conversation 4
2025-04-20 23:09:31.982 +07:00 [INF] Message 32 already exists in Redis
2025-04-20 23:09:31.984 +07:00 [INF] Added message 32 to conversation 4
2025-04-20 23:09:31.986 +07:00 [INF] Message 31 already exists in Redis
2025-04-20 23:09:31.989 +07:00 [INF] Saved message 31 to Redis
2025-04-20 23:09:31.989 +07:00 [INF] Saved message 31 to Redis
2025-04-20 23:09:31.990 +07:00 [INF] Added message 31 to conversation 4
2025-04-20 23:09:31.990 +07:00 [INF] Added message 31 to conversation 4
2025-04-20 23:09:31.992 +07:00 [INF] Saved message 30 to Redis
2025-04-20 23:09:31.992 +07:00 [INF] Message 30 already exists in Redis
2025-04-20 23:09:31.992 +07:00 [INF] Message 30 already exists in Redis
2025-04-20 23:09:31.993 +07:00 [INF] Added message 30 to conversation 4
2025-04-20 23:09:31.994 +07:00 [INF] Saved message 29 to Redis
2025-04-20 23:09:31.994 +07:00 [INF] Message 29 already exists in Redis
2025-04-20 23:09:31.995 +07:00 [INF] Added message 29 to conversation 4
2025-04-20 23:09:31.995 +07:00 [INF] Saved message 29 to Redis
2025-04-20 23:09:31.996 +07:00 [INF] Added message 29 to conversation 4
2025-04-20 23:09:31.999 +07:00 [INF] Saved message 28 to Redis
2025-04-20 23:09:31.999 +07:00 [INF] Message 28 already exists in Redis
2025-04-20 23:09:32.001 +07:00 [INF] Saved message 28 to Redis
2025-04-20 23:09:32.002 +07:00 [INF] Added message 28 to conversation 4
2025-04-20 23:09:32.005 +07:00 [INF] Added message 28 to conversation 4
2025-04-20 23:09:32.007 +07:00 [INF] Message 27 already exists in Redis
2025-04-20 23:09:32.009 +07:00 [INF] Message 27 already exists in Redis
2025-04-20 23:09:32.008 +07:00 [INF] Saved message 27 to Redis
2025-04-20 23:09:32.017 +07:00 [INF] Added message 27 to conversation 4
2025-04-20 23:09:32.017 +07:00 [INF] Saved message 26 to Redis
2025-04-20 23:09:32.021 +07:00 [INF] Saved message 26 to Redis
2025-04-20 23:09:32.022 +07:00 [INF] Message 26 already exists in Redis
2025-04-20 23:09:32.022 +07:00 [INF] Added message 26 to conversation 4
2025-04-20 23:09:32.024 +07:00 [INF] Added message 26 to conversation 4
2025-04-20 23:09:32.026 +07:00 [INF] Message 25 already exists in Redis
2025-04-20 23:09:32.032 +07:00 [INF] Saved message 25 to Redis
2025-04-20 23:09:32.033 +07:00 [INF] Saved message 25 to Redis
2025-04-20 23:09:32.034 +07:00 [INF] Added message 25 to conversation 4
2025-04-20 23:09:32.038 +07:00 [INF] Message 24 already exists in Redis
2025-04-20 23:09:32.038 +07:00 [INF] Added message 25 to conversation 4
2025-04-20 23:09:32.038 +07:00 [INF] Saved message 24 to Redis
2025-04-20 23:09:32.043 +07:00 [INF] Added message 24 to conversation 4
2025-04-20 23:09:32.043 +07:00 [INF] Saved message 23 to Redis
2025-04-20 23:09:32.043 +07:00 [INF] Message 24 already exists in Redis
2025-04-20 23:09:32.045 +07:00 [INF] Message 23 already exists in Redis
2025-04-20 23:09:32.045 +07:00 [INF] Message 23 already exists in Redis
2025-04-20 23:09:32.051 +07:00 [INF] Added message 23 to conversation 4
2025-04-20 23:09:32.052 +07:00 [INF] Message 22 already exists in Redis
2025-04-20 23:09:32.052 +07:00 [INF] Saved message 22 to Redis
2025-04-20 23:09:32.052 +07:00 [INF] Saved message 22 to Redis
2025-04-20 23:09:32.053 +07:00 [INF] Added message 22 to conversation 4
2025-04-20 23:09:32.053 +07:00 [INF] Added message 22 to conversation 4
2025-04-20 23:09:32.056 +07:00 [INF] Message 21 already exists in Redis
2025-04-20 23:09:32.057 +07:00 [INF] Saved message 21 to Redis
2025-04-20 23:09:32.056 +07:00 [INF] Message 21 already exists in Redis
2025-04-20 23:09:32.060 +07:00 [INF] Added message 21 to conversation 4
2025-04-20 23:09:32.060 +07:00 [INF] Message 20 already exists in Redis
2025-04-20 23:09:32.061 +07:00 [INF] Saved message 20 to Redis
2025-04-20 23:09:32.061 +07:00 [INF] Message 20 already exists in Redis
2025-04-20 23:09:32.066 +07:00 [INF] Added message 20 to conversation 4
2025-04-20 23:09:32.086 +07:00 [INF] Message 19 already exists in Redis
2025-04-20 23:09:32.087 +07:00 [INF] Saved message 19 to Redis
2025-04-20 23:09:32.110 +07:00 [INF] Saved message 19 to Redis
2025-04-20 23:09:32.122 +07:00 [INF] Saved message 18 to Redis
2025-04-20 23:09:32.122 +07:00 [INF] Added message 19 to conversation 4
2025-04-20 23:09:32.123 +07:00 [INF] Added message 19 to conversation 4
2025-04-20 23:09:32.140 +07:00 [INF] Message 18 already exists in Redis
2025-04-20 23:09:32.171 +07:00 [INF] Message 18 already exists in Redis
2025-04-20 23:09:32.192 +07:00 [INF] Added message 18 to conversation 4
2025-04-20 23:09:32.192 +07:00 [INF] Message 17 already exists in Redis
2025-04-20 23:09:32.203 +07:00 [INF] Message 17 already exists in Redis
2025-04-20 23:09:32.204 +07:00 [INF] Saved message 17 to Redis
2025-04-20 23:09:32.232 +07:00 [INF] Added message 17 to conversation 4
2025-04-20 23:09:32.234 +07:00 [INF] Message 16 already exists in Redis
2025-04-20 23:09:32.235 +07:00 [INF] Saved message 16 to Redis
2025-04-20 23:09:32.236 +07:00 [INF] Saved message 16 to Redis
2025-04-20 23:09:32.236 +07:00 [INF] Added message 16 to conversation 4
2025-04-20 23:09:32.242 +07:00 [INF] Added message 16 to conversation 4
2025-04-20 23:09:32.242 +07:00 [INF] Message 15 already exists in Redis
2025-04-20 23:09:32.256 +07:00 [INF] Saved message 15 to Redis
2025-04-20 23:09:32.259 +07:00 [INF] Message 15 already exists in Redis
2025-04-20 23:09:32.293 +07:00 [INF] Added message 15 to conversation 4
2025-04-20 23:09:32.311 +07:00 [INF] Saved message 14 to Redis
2025-04-20 23:09:32.311 +07:00 [INF] Saved message 14 to Redis
2025-04-20 23:09:32.311 +07:00 [INF] Saved message 14 to Redis
2025-04-20 23:09:32.312 +07:00 [INF] Added message 14 to conversation 4
2025-04-20 23:09:32.312 +07:00 [INF] Added message 14 to conversation 4
2025-04-20 23:09:32.314 +07:00 [INF] Added message 14 to conversation 4
2025-04-20 23:09:32.318 +07:00 [INF] Saved message 13 to Redis
2025-04-20 23:09:32.318 +07:00 [INF] Saved message 13 to Redis
2025-04-20 23:09:32.318 +07:00 [INF] Saved message 13 to Redis
2025-04-20 23:09:32.319 +07:00 [INF] Added message 13 to conversation 4
2025-04-20 23:09:32.324 +07:00 [INF] Added message 13 to conversation 4
2025-04-20 23:09:32.320 +07:00 [INF] Added message 13 to conversation 4
2025-04-20 23:09:32.328 +07:00 [INF] Message 12 already exists in Redis
2025-04-20 23:09:32.329 +07:00 [INF] Saved message 12 to Redis
2025-04-20 23:09:32.332 +07:00 [INF] Added message 12 to conversation 4
2025-04-20 23:09:32.329 +07:00 [INF] Saved message 12 to Redis
2025-04-20 23:09:32.335 +07:00 [INF] Message 10 already exists in Redis
2025-04-20 23:09:32.338 +07:00 [INF] Added message 12 to conversation 4
2025-04-20 23:09:32.338 +07:00 [INF] Saved message 10 to Redis
2025-04-20 23:09:32.340 +07:00 [INF] Message 10 already exists in Redis
2025-04-20 23:09:32.340 +07:00 [INF] Added message 10 to conversation 4
2025-04-20 23:09:32.343 +07:00 [INF] Message 7 already exists in Redis
2025-04-20 23:09:32.343 +07:00 [INF] Saved message 7 to Redis
2025-04-20 23:09:32.351 +07:00 [INF] Added message 7 to conversation 4
2025-04-20 23:09:32.387 +07:00 [INF] Saved message 7 to Redis
2025-04-20 23:09:32.387 +07:00 [INF] Saved message 6 to Redis
2025-04-20 23:09:32.388 +07:00 [INF] Saved message 6 to Redis
2025-04-20 23:09:32.390 +07:00 [INF] Added message 7 to conversation 4
2025-04-20 23:09:32.391 +07:00 [INF] Added message 6 to conversation 4
2025-04-20 23:09:32.392 +07:00 [INF] Added message 6 to conversation 4
2025-04-20 23:09:32.392 +07:00 [INF] Message 6 already exists in Redis
2025-04-20 23:09:32.396 +07:00 [INF] Message 5 already exists in Redis
2025-04-20 23:09:32.397 +07:00 [INF] Saved message 5 to Redis
2025-04-20 23:09:32.398 +07:00 [INF] Saved message 5 to Redis
2025-04-20 23:09:32.400 +07:00 [INF] Added message 5 to conversation 4
2025-04-20 23:09:32.402 +07:00 [INF] Added message 5 to conversation 4
2025-04-20 23:11:13.260 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/api/Message/getMessages/1/5 - null null
2025-04-20 23:11:13.261 +07:00 [INF] Executing endpoint 'server.Controllers.MessageController.GetMessages (Message_app)'
2025-04-20 23:11:13.261 +07:00 [INF] Route matched with {action = "GetMessages", controller = "Message"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetMessages(Int32, Int32) on controller server.Controllers.MessageController (Message_app).
2025-04-20 23:11:13.355 +07:00 [INF] Executing ObjectResult, writing value of type 'System.String'.
2025-04-20 23:11:13.355 +07:00 [INF] Executed action server.Controllers.MessageController.GetMessages (Message_app) in 94.0477ms
2025-04-20 23:11:13.356 +07:00 [INF] Executed endpoint 'server.Controllers.MessageController.GetMessages (Message_app)'
2025-04-20 23:11:13.356 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5053/api/Message/getMessages/1/5 - 500 null text/plain; charset=utf-8 95.8729ms
2025-04-20 23:11:14.138 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/api/Message/getMessages/1/5 - null null
2025-04-20 23:11:14.138 +07:00 [INF] Executing endpoint 'server.Controllers.MessageController.GetMessages (Message_app)'
2025-04-20 23:11:14.138 +07:00 [INF] Route matched with {action = "GetMessages", controller = "Message"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetMessages(Int32, Int32) on controller server.Controllers.MessageController (Message_app).
2025-04-20 23:11:14.205 +07:00 [INF] Executing ObjectResult, writing value of type 'System.String'.
2025-04-20 23:11:14.206 +07:00 [INF] Executed action server.Controllers.MessageController.GetMessages (Message_app) in 67.2487ms
2025-04-20 23:11:14.206 +07:00 [INF] Executed endpoint 'server.Controllers.MessageController.GetMessages (Message_app)'
2025-04-20 23:11:14.206 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5053/api/Message/getMessages/1/5 - 500 null text/plain; charset=utf-8 68.217ms
2025-04-20 23:11:50.287 +07:00 [INF] Executed DbCommand (22ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [u].[id], [u].[username], [u].[avatar_url]
FROM [Users] AS [u]
2025-04-20 23:11:50.407 +07:00 [INF] User profile is available. Using 'C:\Users\Thao\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-04-20 23:11:50.485 +07:00 [WRN] Overriding address(es) 'http://localhost:5053'. Binding to endpoints defined via IConfiguration and/or UseKestrel() instead.
2025-04-20 23:11:50.495 +07:00 [INF] Now listening on: http://[::]:5053
2025-04-20 23:11:50.496 +07:00 [INF] Now listening on: http://0.0.0.0:5053
2025-04-20 23:11:50.496 +07:00 [INF] Application started. Press Ctrl+C to shut down.
2025-04-20 23:11:50.496 +07:00 [INF] Hosting environment: Development
2025-04-20 23:11:50.496 +07:00 [INF] Content root path: C:\Users\Thao\source\Flutter\Message_app\server
2025-04-20 23:11:53.979 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/api/Message/getMessages/1/5 - null null
2025-04-20 23:11:54.007 +07:00 [WRN] Failed to determine the https port for redirect.
2025-04-20 23:11:54.021 +07:00 [INF] Executing endpoint 'server.Controllers.MessageController.GetMessages (Message_app)'
2025-04-20 23:11:54.036 +07:00 [INF] Route matched with {action = "GetMessages", controller = "Message"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetMessages(Int32, Int32) on controller server.Controllers.MessageController (Message_app).
2025-04-20 23:11:54.072 +07:00 [INF] Executing ObjectResult, writing value of type 'System.String'.
2025-04-20 23:11:54.079 +07:00 [INF] Executed action server.Controllers.MessageController.GetMessages (Message_app) in 40.8032ms
2025-04-20 23:11:54.079 +07:00 [INF] Executed endpoint 'server.Controllers.MessageController.GetMessages (Message_app)'
2025-04-20 23:11:54.082 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5053/api/Message/getMessages/1/5 - 500 null text/plain; charset=utf-8 103.7611ms
2025-04-20 23:12:00.775 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/api/Message/getMessages/1/5 - null null
2025-04-20 23:12:00.784 +07:00 [INF] Executing endpoint 'server.Controllers.MessageController.GetMessages (Message_app)'
2025-04-20 23:12:00.785 +07:00 [INF] Route matched with {action = "GetMessages", controller = "Message"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetMessages(Int32, Int32) on controller server.Controllers.MessageController (Message_app).
2025-04-20 23:12:00.791 +07:00 [INF] Retrieved 0 messages from Redis for conversation 1
2025-04-20 23:12:00.929 +07:00 [INF] Executed DbCommand (34ms) [Parameters=[@__user_id_0='?' (DbType = Int32), @__conversationId_1='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[cleared_at]
FROM [messageDeletions] AS [m]
WHERE [m].[user_id] = @__user_id_0 AND CAST([m].[conversation_id] AS bigint) = @__conversationId_1
2025-04-20 23:12:01.155 +07:00 [INF] Executed DbCommand (10ms) [Parameters=[@__p_1='?' (DbType = Int32), @__conversationId_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[id], [t].[content], [t].[conversation_id], [t].[created_at], [t].[isFile], [t].[isRecalled], [t].[is_read], [t].[sender_id], [t].[type], [a].[id], [a].[FileSize], [a].[file_type], [a].[file_url], [a].[is_temporary], [a].[message_id], [a].[uploaded_at]
FROM (
    SELECT TOP(@__p_1) [m].[id], [m].[content], [m].[conversation_id], [m].[created_at], [m].[isFile], [m].[isRecalled], [m].[is_read], [m].[sender_id], [m].[type]
    FROM [Messages] AS [m]
    WHERE CAST([m].[conversation_id] AS bigint) = @__conversationId_0
    ORDER BY [m].[created_at] DESC
) AS [t]
LEFT JOIN [Attachments] AS [a] ON [t].[id] = [a].[message_id]
ORDER BY [t].[created_at] DESC, [t].[id]
2025-04-20 23:12:01.309 +07:00 [INF] Saved message 81 to Redis
2025-04-20 23:12:01.313 +07:00 [INF] Added message 81 to conversation 1
2025-04-20 23:12:01.316 +07:00 [INF] Saved message 80 to Redis
2025-04-20 23:12:01.318 +07:00 [INF] Added message 80 to conversation 1
2025-04-20 23:12:01.327 +07:00 [INF] Saved message 79 to Redis
2025-04-20 23:12:01.329 +07:00 [INF] Added message 79 to conversation 1
2025-04-20 23:12:01.333 +07:00 [INF] Saved message 78 to Redis
2025-04-20 23:12:01.335 +07:00 [INF] Added message 78 to conversation 1
2025-04-20 23:12:01.342 +07:00 [INF] Saved message 77 to Redis
2025-04-20 23:12:01.343 +07:00 [INF] Added message 77 to conversation 1
2025-04-20 23:12:01.346 +07:00 [INF] Saved message 76 to Redis
2025-04-20 23:12:01.347 +07:00 [INF] Added message 76 to conversation 1
2025-04-20 23:12:01.351 +07:00 [INF] Saved message 75 to Redis
2025-04-20 23:12:01.353 +07:00 [INF] Added message 75 to conversation 1
2025-04-20 23:12:01.357 +07:00 [INF] Saved message 74 to Redis
2025-04-20 23:12:01.359 +07:00 [INF] Added message 74 to conversation 1
2025-04-20 23:12:01.362 +07:00 [INF] Saved message 73 to Redis
2025-04-20 23:12:01.364 +07:00 [INF] Added message 73 to conversation 1
2025-04-20 23:12:01.366 +07:00 [INF] Saved message 72 to Redis
2025-04-20 23:12:01.367 +07:00 [INF] Added message 72 to conversation 1
2025-04-20 23:12:01.370 +07:00 [INF] Saved message 71 to Redis
2025-04-20 23:12:01.372 +07:00 [INF] Added message 71 to conversation 1
2025-04-20 23:12:01.374 +07:00 [INF] Saved message 68 to Redis
2025-04-20 23:12:01.374 +07:00 [INF] Added message 68 to conversation 1
2025-04-20 23:12:01.376 +07:00 [INF] Saved message 64 to Redis
2025-04-20 23:12:01.377 +07:00 [INF] Added message 64 to conversation 1
2025-04-20 23:12:01.379 +07:00 [INF] Saved message 62 to Redis
2025-04-20 23:12:01.380 +07:00 [INF] Added message 62 to conversation 1
2025-04-20 23:12:01.382 +07:00 [INF] Saved message 61 to Redis
2025-04-20 23:12:01.383 +07:00 [INF] Added message 61 to conversation 1
2025-04-20 23:12:01.386 +07:00 [INF] Saved message 60 to Redis
2025-04-20 23:12:01.387 +07:00 [INF] Added message 60 to conversation 1
2025-04-20 23:12:01.390 +07:00 [INF] Saved message 59 to Redis
2025-04-20 23:12:01.392 +07:00 [INF] Added message 59 to conversation 1
2025-04-20 23:12:01.395 +07:00 [INF] Saved message 57 to Redis
2025-04-20 23:12:01.396 +07:00 [INF] Added message 57 to conversation 1
2025-04-20 23:12:01.398 +07:00 [INF] Saved message 55 to Redis
2025-04-20 23:12:01.399 +07:00 [INF] Added message 55 to conversation 1
2025-04-20 23:12:01.401 +07:00 [INF] Saved message 54 to Redis
2025-04-20 23:12:01.402 +07:00 [INF] Added message 54 to conversation 1
2025-04-20 23:12:01.405 +07:00 [INF] Saved message 51 to Redis
2025-04-20 23:12:01.406 +07:00 [INF] Added message 51 to conversation 1
2025-04-20 23:12:01.407 +07:00 [INF] Saved message 49 to Redis
2025-04-20 23:12:01.408 +07:00 [INF] Added message 49 to conversation 1
2025-04-20 23:12:01.409 +07:00 [INF] Saved message 11 to Redis
2025-04-20 23:12:01.410 +07:00 [INF] Added message 11 to conversation 1
2025-04-20 23:12:01.412 +07:00 [INF] Saved message 8 to Redis
2025-04-20 23:12:01.412 +07:00 [INF] Added message 8 to conversation 1
2025-04-20 23:12:01.414 +07:00 [INF] Saved message 3 to Redis
2025-04-20 23:12:01.415 +07:00 [INF] Added message 3 to conversation 1
2025-04-20 23:12:01.416 +07:00 [INF] Saved message 2 to Redis
2025-04-20 23:12:01.417 +07:00 [INF] Added message 2 to conversation 1
2025-04-20 23:12:01.418 +07:00 [INF] Saved message 1 to Redis
2025-04-20 23:12:01.419 +07:00 [INF] Added message 1 to conversation 1
2025-04-20 23:12:01.420 +07:00 [INF] Cached 27 messages to Redis for conversation 1
2025-04-20 23:12:01.422 +07:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[server.DTO.MessageWithAttachment, Message_app, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-04-20 23:12:01.558 +07:00 [INF] Executed action server.Controllers.MessageController.GetMessages (Message_app) in 772.9013ms
2025-04-20 23:12:01.558 +07:00 [INF] Executed endpoint 'server.Controllers.MessageController.GetMessages (Message_app)'
2025-04-20 23:12:01.563 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5053/api/Message/getMessages/1/5 - 200 null application/json; charset=utf-8 787.7715ms
2025-04-20 23:12:07.473 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/api/Message/getMessages/1/5 - null null
2025-04-20 23:12:07.476 +07:00 [INF] Executing endpoint 'server.Controllers.MessageController.GetMessages (Message_app)'
2025-04-20 23:12:07.476 +07:00 [INF] Route matched with {action = "GetMessages", controller = "Message"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetMessages(Int32, Int32) on controller server.Controllers.MessageController (Message_app).
2025-04-20 23:12:07.482 +07:00 [INF] Executing ObjectResult, writing value of type 'System.String'.
2025-04-20 23:12:07.483 +07:00 [INF] Executed action server.Controllers.MessageController.GetMessages (Message_app) in 6.6636ms
2025-04-20 23:12:07.483 +07:00 [INF] Executed endpoint 'server.Controllers.MessageController.GetMessages (Message_app)'
2025-04-20 23:12:07.483 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5053/api/Message/getMessages/1/5 - 500 null text/plain; charset=utf-8 9.9796ms
2025-04-20 23:13:47.035 +07:00 [INF] Request starting HTTP/1.1 GET http://192.168.1.3:5053/ws/chat - null null
2025-04-20 23:13:47.036 +07:00 [INF] Executing endpoint '/ws/chat'
2025-04-20 23:13:47.056 +07:00 [INF] Request starting HTTP/1.1 GET http://192.168.1.3:5053/ws/chat - null null
2025-04-20 23:13:47.057 +07:00 [INF] Executing endpoint '/ws/chat'
2025-04-20 23:13:47.068 +07:00 [INF] Request starting HTTP/1.1 GET http://192.168.1.3:5053/ws/chat - null null
2025-04-20 23:13:47.068 +07:00 [INF] Executing endpoint '/ws/chat'
2025-04-20 23:13:47.176 +07:00 [INF] Executed DbCommand (5ms) [Parameters=[@__client_UserId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[conversation_id]
FROM [Participants] AS [p]
WHERE [p].[user_id] = @__client_UserId_0 AND [p].[is_deleted] = CAST(0 AS bit)
2025-04-20 23:13:47.179 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__client_UserId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[conversation_id]
FROM [Participants] AS [p]
WHERE [p].[user_id] = @__client_UserId_0 AND [p].[is_deleted] = CAST(0 AS bit)
2025-04-20 23:13:47.183 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__client_UserId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[conversation_id]
FROM [Participants] AS [p]
WHERE [p].[user_id] = @__client_UserId_0 AND [p].[is_deleted] = CAST(0 AS bit)
2025-04-20 23:13:47.195 +07:00 [INF] Executed DbCommand (4ms) [Parameters=[@__p_1='?' (DbType = Int32), @__conversationId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(@__p_1) [m].[id], [m].[conversation_id], [m].[sender_id], [m].[content], [m].[created_at], [m].[isFile], [m].[type], [m].[isRecalled]
FROM [Messages] AS [m]
WHERE [m].[conversation_id] = @__conversationId_0
ORDER BY [m].[created_at] DESC
2025-04-20 23:13:47.195 +07:00 [INF] Executed DbCommand (4ms) [Parameters=[@__p_1='?' (DbType = Int32), @__conversationId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(@__p_1) [m].[id], [m].[conversation_id], [m].[sender_id], [m].[content], [m].[created_at], [m].[isFile], [m].[type], [m].[isRecalled]
FROM [Messages] AS [m]
WHERE [m].[conversation_id] = @__conversationId_0
ORDER BY [m].[created_at] DESC
2025-04-20 23:13:47.196 +07:00 [INF] Executed DbCommand (5ms) [Parameters=[@__p_1='?' (DbType = Int32), @__conversationId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(@__p_1) [m].[id], [m].[conversation_id], [m].[sender_id], [m].[content], [m].[created_at], [m].[isFile], [m].[type], [m].[isRecalled]
FROM [Messages] AS [m]
WHERE [m].[conversation_id] = @__conversationId_0
ORDER BY [m].[created_at] DESC
2025-04-20 23:13:47.198 +07:00 [INF] Saved message 69 to Redis
2025-04-20 23:13:47.198 +07:00 [INF] Saved message 69 to Redis
2025-04-20 23:13:47.198 +07:00 [INF] Saved message 69 to Redis
2025-04-20 23:13:47.198 +07:00 [INF] Added message 69 to conversation 4
2025-04-20 23:13:47.198 +07:00 [INF] Added message 69 to conversation 4
2025-04-20 23:13:47.198 +07:00 [INF] Added message 69 to conversation 4
2025-04-20 23:13:47.199 +07:00 [INF] Saved message 67 to Redis
2025-04-20 23:13:47.200 +07:00 [INF] Saved message 67 to Redis
2025-04-20 23:13:47.200 +07:00 [INF] Saved message 67 to Redis
2025-04-20 23:13:47.200 +07:00 [INF] Added message 67 to conversation 4
2025-04-20 23:13:47.200 +07:00 [INF] Added message 67 to conversation 4
2025-04-20 23:13:47.200 +07:00 [INF] Added message 67 to conversation 4
2025-04-20 23:13:47.200 +07:00 [INF] Message 66 already exists in Redis
2025-04-20 23:13:47.200 +07:00 [INF] Message 66 already exists in Redis
2025-04-20 23:13:47.201 +07:00 [INF] Saved message 66 to Redis
2025-04-20 23:13:47.201 +07:00 [INF] Added message 66 to conversation 4
2025-04-20 23:13:47.201 +07:00 [INF] Message 63 already exists in Redis
2025-04-20 23:13:47.201 +07:00 [INF] Saved message 63 to Redis
2025-04-20 23:13:47.201 +07:00 [INF] Message 63 already exists in Redis
2025-04-20 23:13:47.201 +07:00 [INF] Added message 63 to conversation 4
2025-04-20 23:13:47.202 +07:00 [INF] Message 58 already exists in Redis
2025-04-20 23:13:47.202 +07:00 [INF] Message 58 already exists in Redis
2025-04-20 23:13:47.202 +07:00 [INF] Saved message 58 to Redis
2025-04-20 23:13:47.202 +07:00 [INF] Message 56 already exists in Redis
2025-04-20 23:13:47.202 +07:00 [INF] Added message 58 to conversation 4
2025-04-20 23:13:47.202 +07:00 [INF] Saved message 56 to Redis
2025-04-20 23:13:47.202 +07:00 [INF] Message 56 already exists in Redis
2025-04-20 23:13:47.203 +07:00 [INF] Added message 56 to conversation 4
2025-04-20 23:13:47.203 +07:00 [INF] Message 53 already exists in Redis
2025-04-20 23:13:47.203 +07:00 [INF] Message 53 already exists in Redis
2025-04-20 23:13:47.203 +07:00 [INF] Saved message 53 to Redis
2025-04-20 23:13:47.204 +07:00 [INF] Added message 53 to conversation 4
2025-04-20 23:13:47.204 +07:00 [INF] Message 52 already exists in Redis
2025-04-20 23:13:47.205 +07:00 [INF] Saved message 52 to Redis
2025-04-20 23:13:47.205 +07:00 [INF] Saved message 52 to Redis
2025-04-20 23:13:47.205 +07:00 [INF] Added message 52 to conversation 4
2025-04-20 23:13:47.205 +07:00 [INF] Added message 52 to conversation 4
2025-04-20 23:13:47.205 +07:00 [INF] Saved message 50 to Redis
2025-04-20 23:13:47.206 +07:00 [INF] Message 50 already exists in Redis
2025-04-20 23:13:47.206 +07:00 [INF] Message 50 already exists in Redis
2025-04-20 23:13:47.206 +07:00 [INF] Added message 50 to conversation 4
2025-04-20 23:13:47.207 +07:00 [INF] Saved message 47 to Redis
2025-04-20 23:13:47.207 +07:00 [INF] Saved message 47 to Redis
2025-04-20 23:13:47.207 +07:00 [INF] Saved message 47 to Redis
2025-04-20 23:13:47.208 +07:00 [INF] Added message 47 to conversation 4
2025-04-20 23:13:47.208 +07:00 [INF] Added message 47 to conversation 4
2025-04-20 23:13:47.208 +07:00 [INF] Added message 47 to conversation 4
2025-04-20 23:13:47.209 +07:00 [INF] Saved message 46 to Redis
2025-04-20 23:13:47.209 +07:00 [INF] Saved message 46 to Redis
2025-04-20 23:13:47.209 +07:00 [INF] Saved message 46 to Redis
2025-04-20 23:13:47.210 +07:00 [INF] Added message 46 to conversation 4
2025-04-20 23:13:47.210 +07:00 [INF] Added message 46 to conversation 4
2025-04-20 23:13:47.210 +07:00 [INF] Added message 46 to conversation 4
2025-04-20 23:13:47.211 +07:00 [INF] Saved message 45 to Redis
2025-04-20 23:13:47.211 +07:00 [INF] Saved message 45 to Redis
2025-04-20 23:13:47.211 +07:00 [INF] Saved message 45 to Redis
2025-04-20 23:13:47.211 +07:00 [INF] Added message 45 to conversation 4
2025-04-20 23:13:47.211 +07:00 [INF] Added message 45 to conversation 4
2025-04-20 23:13:47.211 +07:00 [INF] Added message 45 to conversation 4
2025-04-20 23:13:47.212 +07:00 [INF] Saved message 44 to Redis
2025-04-20 23:13:47.212 +07:00 [INF] Saved message 44 to Redis
2025-04-20 23:13:47.212 +07:00 [INF] Saved message 44 to Redis
2025-04-20 23:13:47.213 +07:00 [INF] Added message 44 to conversation 4
2025-04-20 23:13:47.213 +07:00 [INF] Added message 44 to conversation 4
2025-04-20 23:13:47.213 +07:00 [INF] Added message 44 to conversation 4
2025-04-20 23:13:47.214 +07:00 [INF] Saved message 43 to Redis
2025-04-20 23:13:47.214 +07:00 [INF] Saved message 43 to Redis
2025-04-20 23:13:47.214 +07:00 [INF] Saved message 43 to Redis
2025-04-20 23:13:47.214 +07:00 [INF] Added message 43 to conversation 4
2025-04-20 23:13:47.214 +07:00 [INF] Added message 43 to conversation 4
2025-04-20 23:13:47.214 +07:00 [INF] Added message 43 to conversation 4
2025-04-20 23:13:47.215 +07:00 [INF] Saved message 42 to Redis
2025-04-20 23:13:47.215 +07:00 [INF] Saved message 42 to Redis
2025-04-20 23:13:47.215 +07:00 [INF] Saved message 42 to Redis
2025-04-20 23:13:47.216 +07:00 [INF] Added message 42 to conversation 4
2025-04-20 23:13:47.216 +07:00 [INF] Added message 42 to conversation 4
2025-04-20 23:13:47.216 +07:00 [INF] Added message 42 to conversation 4
2025-04-20 23:13:47.216 +07:00 [INF] Saved message 41 to Redis
2025-04-20 23:13:47.216 +07:00 [INF] Saved message 41 to Redis
2025-04-20 23:13:47.216 +07:00 [INF] Saved message 41 to Redis
2025-04-20 23:13:47.217 +07:00 [INF] Added message 41 to conversation 4
2025-04-20 23:13:47.217 +07:00 [INF] Added message 41 to conversation 4
2025-04-20 23:13:47.217 +07:00 [INF] Added message 41 to conversation 4
2025-04-20 23:13:47.218 +07:00 [INF] Saved message 40 to Redis
2025-04-20 23:13:47.218 +07:00 [INF] Saved message 40 to Redis
2025-04-20 23:13:47.218 +07:00 [INF] Saved message 40 to Redis
2025-04-20 23:13:47.218 +07:00 [INF] Added message 40 to conversation 4
2025-04-20 23:13:47.218 +07:00 [INF] Added message 40 to conversation 4
2025-04-20 23:13:47.218 +07:00 [INF] Added message 40 to conversation 4
2025-04-20 23:13:47.219 +07:00 [INF] Saved message 39 to Redis
2025-04-20 23:13:47.219 +07:00 [INF] Saved message 39 to Redis
2025-04-20 23:13:47.219 +07:00 [INF] Saved message 39 to Redis
2025-04-20 23:13:47.219 +07:00 [INF] Added message 39 to conversation 4
2025-04-20 23:13:47.219 +07:00 [INF] Added message 39 to conversation 4
2025-04-20 23:13:47.219 +07:00 [INF] Added message 39 to conversation 4
2025-04-20 23:13:47.220 +07:00 [INF] Saved message 38 to Redis
2025-04-20 23:13:47.220 +07:00 [INF] Saved message 38 to Redis
2025-04-20 23:13:47.220 +07:00 [INF] Saved message 38 to Redis
2025-04-20 23:13:47.220 +07:00 [INF] Added message 38 to conversation 4
2025-04-20 23:13:47.221 +07:00 [INF] Added message 38 to conversation 4
2025-04-20 23:13:47.220 +07:00 [INF] Added message 38 to conversation 4
2025-04-20 23:13:47.221 +07:00 [INF] Saved message 37 to Redis
2025-04-20 23:13:47.221 +07:00 [INF] Saved message 37 to Redis
2025-04-20 23:13:47.221 +07:00 [INF] Saved message 37 to Redis
2025-04-20 23:13:47.222 +07:00 [INF] Added message 37 to conversation 4
2025-04-20 23:13:47.222 +07:00 [INF] Added message 37 to conversation 4
2025-04-20 23:13:47.222 +07:00 [INF] Added message 37 to conversation 4
2025-04-20 23:13:47.223 +07:00 [INF] Saved message 36 to Redis
2025-04-20 23:13:47.223 +07:00 [INF] Saved message 36 to Redis
2025-04-20 23:13:47.223 +07:00 [INF] Saved message 36 to Redis
2025-04-20 23:13:47.223 +07:00 [INF] Added message 36 to conversation 4
2025-04-20 23:13:47.223 +07:00 [INF] Added message 36 to conversation 4
2025-04-20 23:13:47.223 +07:00 [INF] Added message 36 to conversation 4
2025-04-20 23:13:47.224 +07:00 [INF] Saved message 35 to Redis
2025-04-20 23:13:47.224 +07:00 [INF] Saved message 35 to Redis
2025-04-20 23:13:47.224 +07:00 [INF] Saved message 35 to Redis
2025-04-20 23:13:47.225 +07:00 [INF] Added message 35 to conversation 4
2025-04-20 23:13:47.224 +07:00 [INF] Added message 35 to conversation 4
2025-04-20 23:13:47.225 +07:00 [INF] Added message 35 to conversation 4
2025-04-20 23:13:47.225 +07:00 [INF] Saved message 34 to Redis
2025-04-20 23:13:47.225 +07:00 [INF] Saved message 34 to Redis
2025-04-20 23:13:47.225 +07:00 [INF] Saved message 34 to Redis
2025-04-20 23:13:47.226 +07:00 [INF] Added message 34 to conversation 4
2025-04-20 23:13:47.226 +07:00 [INF] Added message 34 to conversation 4
2025-04-20 23:13:47.226 +07:00 [INF] Added message 34 to conversation 4
2025-04-20 23:13:47.227 +07:00 [INF] Saved message 33 to Redis
2025-04-20 23:13:47.227 +07:00 [INF] Saved message 33 to Redis
2025-04-20 23:13:47.226 +07:00 [INF] Saved message 33 to Redis
2025-04-20 23:13:47.227 +07:00 [INF] Added message 33 to conversation 4
2025-04-20 23:13:47.227 +07:00 [INF] Added message 33 to conversation 4
2025-04-20 23:13:47.227 +07:00 [INF] Added message 33 to conversation 4
2025-04-20 23:13:47.228 +07:00 [INF] Saved message 32 to Redis
2025-04-20 23:13:47.228 +07:00 [INF] Saved message 32 to Redis
2025-04-20 23:13:47.228 +07:00 [INF] Saved message 32 to Redis
2025-04-20 23:13:47.228 +07:00 [INF] Added message 32 to conversation 4
2025-04-20 23:13:47.228 +07:00 [INF] Added message 32 to conversation 4
2025-04-20 23:13:47.228 +07:00 [INF] Added message 32 to conversation 4
2025-04-20 23:13:47.229 +07:00 [INF] Saved message 31 to Redis
2025-04-20 23:13:47.229 +07:00 [INF] Saved message 31 to Redis
2025-04-20 23:13:47.229 +07:00 [INF] Saved message 31 to Redis
2025-04-20 23:13:47.230 +07:00 [INF] Added message 31 to conversation 4
2025-04-20 23:13:47.230 +07:00 [INF] Added message 31 to conversation 4
2025-04-20 23:13:47.230 +07:00 [INF] Added message 31 to conversation 4
2025-04-20 23:13:47.231 +07:00 [INF] Saved message 30 to Redis
2025-04-20 23:13:47.231 +07:00 [INF] Saved message 30 to Redis
2025-04-20 23:13:47.231 +07:00 [INF] Saved message 30 to Redis
2025-04-20 23:13:47.231 +07:00 [INF] Added message 30 to conversation 4
2025-04-20 23:13:47.231 +07:00 [INF] Added message 30 to conversation 4
2025-04-20 23:13:47.231 +07:00 [INF] Added message 30 to conversation 4
2025-04-20 23:13:47.232 +07:00 [INF] Saved message 29 to Redis
2025-04-20 23:13:47.232 +07:00 [INF] Saved message 29 to Redis
2025-04-20 23:13:47.232 +07:00 [INF] Saved message 29 to Redis
2025-04-20 23:13:47.232 +07:00 [INF] Added message 29 to conversation 4
2025-04-20 23:13:47.232 +07:00 [INF] Added message 29 to conversation 4
2025-04-20 23:13:47.232 +07:00 [INF] Added message 29 to conversation 4
2025-04-20 23:13:47.233 +07:00 [INF] Saved message 28 to Redis
2025-04-20 23:13:47.233 +07:00 [INF] Saved message 28 to Redis
2025-04-20 23:13:47.233 +07:00 [INF] Saved message 28 to Redis
2025-04-20 23:13:47.233 +07:00 [INF] Added message 28 to conversation 4
2025-04-20 23:13:47.233 +07:00 [INF] Added message 28 to conversation 4
2025-04-20 23:13:47.233 +07:00 [INF] Added message 28 to conversation 4
2025-04-20 23:13:47.234 +07:00 [INF] Saved message 27 to Redis
2025-04-20 23:13:47.234 +07:00 [INF] Saved message 27 to Redis
2025-04-20 23:13:47.234 +07:00 [INF] Saved message 27 to Redis
2025-04-20 23:13:47.234 +07:00 [INF] Added message 27 to conversation 4
2025-04-20 23:13:47.234 +07:00 [INF] Added message 27 to conversation 4
2025-04-20 23:13:47.234 +07:00 [INF] Added message 27 to conversation 4
2025-04-20 23:13:47.235 +07:00 [INF] Saved message 26 to Redis
2025-04-20 23:13:47.235 +07:00 [INF] Saved message 26 to Redis
2025-04-20 23:13:47.235 +07:00 [INF] Saved message 26 to Redis
2025-04-20 23:13:47.235 +07:00 [INF] Added message 26 to conversation 4
2025-04-20 23:13:47.235 +07:00 [INF] Added message 26 to conversation 4
2025-04-20 23:13:47.235 +07:00 [INF] Added message 26 to conversation 4
2025-04-20 23:13:47.236 +07:00 [INF] Saved message 25 to Redis
2025-04-20 23:13:47.236 +07:00 [INF] Saved message 25 to Redis
2025-04-20 23:13:47.236 +07:00 [INF] Saved message 25 to Redis
2025-04-20 23:13:47.237 +07:00 [INF] Added message 25 to conversation 4
2025-04-20 23:13:47.237 +07:00 [INF] Added message 25 to conversation 4
2025-04-20 23:13:47.237 +07:00 [INF] Added message 25 to conversation 4
2025-04-20 23:13:47.237 +07:00 [INF] Message 24 already exists in Redis
2025-04-20 23:13:47.237 +07:00 [INF] Saved message 24 to Redis
2025-04-20 23:13:47.238 +07:00 [INF] Saved message 24 to Redis
2025-04-20 23:13:47.238 +07:00 [INF] Added message 24 to conversation 4
2025-04-20 23:13:47.238 +07:00 [INF] Added message 24 to conversation 4
2025-04-20 23:13:47.238 +07:00 [INF] Message 23 already exists in Redis
2025-04-20 23:13:47.238 +07:00 [INF] Saved message 23 to Redis
2025-04-20 23:13:47.238 +07:00 [INF] Message 23 already exists in Redis
2025-04-20 23:13:47.238 +07:00 [INF] Added message 23 to conversation 4
2025-04-20 23:13:47.239 +07:00 [INF] Message 22 already exists in Redis
2025-04-20 23:13:47.239 +07:00 [INF] Message 22 already exists in Redis
2025-04-20 23:13:47.239 +07:00 [INF] Saved message 22 to Redis
2025-04-20 23:13:47.239 +07:00 [INF] Added message 22 to conversation 4
2025-04-20 23:13:47.239 +07:00 [INF] Saved message 21 to Redis
2025-04-20 23:13:47.239 +07:00 [INF] Message 21 already exists in Redis
2025-04-20 23:13:47.239 +07:00 [INF] Saved message 21 to Redis
2025-04-20 23:13:47.240 +07:00 [INF] Added message 21 to conversation 4
2025-04-20 23:13:47.240 +07:00 [INF] Added message 21 to conversation 4
2025-04-20 23:13:47.240 +07:00 [INF] Message 20 already exists in Redis
2025-04-20 23:13:47.240 +07:00 [INF] Message 20 already exists in Redis
2025-04-20 23:13:47.240 +07:00 [INF] Saved message 20 to Redis
2025-04-20 23:13:47.240 +07:00 [INF] Added message 20 to conversation 4
2025-04-20 23:13:47.241 +07:00 [INF] Saved message 19 to Redis
2025-04-20 23:13:47.241 +07:00 [INF] Message 19 already exists in Redis
2025-04-20 23:13:47.241 +07:00 [INF] Saved message 19 to Redis
2025-04-20 23:13:47.241 +07:00 [INF] Added message 19 to conversation 4
2025-04-20 23:13:47.241 +07:00 [INF] Added message 19 to conversation 4
2025-04-20 23:13:47.241 +07:00 [INF] Message 18 already exists in Redis
2025-04-20 23:13:47.241 +07:00 [INF] Message 18 already exists in Redis
2025-04-20 23:13:47.241 +07:00 [INF] Saved message 18 to Redis
2025-04-20 23:13:47.242 +07:00 [INF] Added message 18 to conversation 4
2025-04-20 23:13:47.242 +07:00 [INF] Saved message 17 to Redis
2025-04-20 23:13:47.242 +07:00 [INF] Saved message 17 to Redis
2025-04-20 23:13:47.242 +07:00 [INF] Message 17 already exists in Redis
2025-04-20 23:13:47.242 +07:00 [INF] Added message 17 to conversation 4
2025-04-20 23:13:47.242 +07:00 [INF] Added message 17 to conversation 4
2025-04-20 23:13:47.243 +07:00 [INF] Message 16 already exists in Redis
2025-04-20 23:13:47.243 +07:00 [INF] Message 16 already exists in Redis
2025-04-20 23:13:47.243 +07:00 [INF] Saved message 16 to Redis
2025-04-20 23:13:47.243 +07:00 [INF] Added message 16 to conversation 4
2025-04-20 23:13:47.243 +07:00 [INF] Saved message 15 to Redis
2025-04-20 23:13:47.243 +07:00 [INF] Message 15 already exists in Redis
2025-04-20 23:13:47.243 +07:00 [INF] Saved message 15 to Redis
2025-04-20 23:13:47.244 +07:00 [INF] Added message 15 to conversation 4
2025-04-20 23:13:47.244 +07:00 [INF] Added message 15 to conversation 4
2025-04-20 23:13:47.244 +07:00 [INF] Message 14 already exists in Redis
2025-04-20 23:13:47.244 +07:00 [INF] Message 14 already exists in Redis
2025-04-20 23:13:47.244 +07:00 [INF] Saved message 14 to Redis
2025-04-20 23:13:47.244 +07:00 [INF] Added message 14 to conversation 4
2025-04-20 23:13:47.245 +07:00 [INF] Message 13 already exists in Redis
2025-04-20 23:13:47.245 +07:00 [INF] Saved message 13 to Redis
2025-04-20 23:13:47.245 +07:00 [INF] Saved message 13 to Redis
2025-04-20 23:13:47.245 +07:00 [INF] Added message 13 to conversation 4
2025-04-20 23:13:47.245 +07:00 [INF] Added message 13 to conversation 4
2025-04-20 23:13:47.245 +07:00 [INF] Message 12 already exists in Redis
2025-04-20 23:13:47.245 +07:00 [INF] Message 12 already exists in Redis
2025-04-20 23:13:47.245 +07:00 [INF] Saved message 12 to Redis
2025-04-20 23:13:47.246 +07:00 [INF] Added message 12 to conversation 4
2025-04-20 23:13:47.246 +07:00 [INF] Message 10 already exists in Redis
2025-04-20 23:13:47.246 +07:00 [INF] Saved message 10 to Redis
2025-04-20 23:13:47.246 +07:00 [INF] Saved message 10 to Redis
2025-04-20 23:13:47.247 +07:00 [INF] Added message 10 to conversation 4
2025-04-20 23:13:47.247 +07:00 [INF] Added message 10 to conversation 4
2025-04-20 23:13:47.247 +07:00 [INF] Saved message 7 to Redis
2025-04-20 23:13:47.247 +07:00 [INF] Message 7 already exists in Redis
2025-04-20 23:13:47.247 +07:00 [INF] Message 7 already exists in Redis
2025-04-20 23:13:47.248 +07:00 [INF] Added message 7 to conversation 4
2025-04-20 23:13:47.248 +07:00 [INF] Saved message 6 to Redis
2025-04-20 23:13:47.248 +07:00 [INF] Saved message 6 to Redis
2025-04-20 23:13:47.248 +07:00 [INF] Saved message 6 to Redis
2025-04-20 23:13:47.249 +07:00 [INF] Added message 6 to conversation 4
2025-04-20 23:13:47.249 +07:00 [INF] Added message 6 to conversation 4
2025-04-20 23:13:47.249 +07:00 [INF] Added message 6 to conversation 4
2025-04-20 23:13:47.250 +07:00 [INF] Saved message 5 to Redis
2025-04-20 23:13:47.250 +07:00 [INF] Saved message 5 to Redis
2025-04-20 23:13:47.250 +07:00 [INF] Saved message 5 to Redis
2025-04-20 23:13:47.250 +07:00 [INF] Added message 5 to conversation 4
2025-04-20 23:13:47.250 +07:00 [INF] Added message 5 to conversation 4
2025-04-20 23:13:47.250 +07:00 [INF] Added message 5 to conversation 4
2025-04-20 23:14:39.906 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/api/Message/getMessages/1/5 - null null
2025-04-20 23:14:39.907 +07:00 [INF] Executing endpoint 'server.Controllers.MessageController.GetMessages (Message_app)'
2025-04-20 23:14:39.915 +07:00 [INF] Route matched with {action = "GetMessages", controller = "Message"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetMessages(Int32, Int32) on controller server.Controllers.MessageController (Message_app).
2025-04-20 23:14:39.919 +07:00 [INF] Executing ObjectResult, writing value of type 'System.String'.
2025-04-20 23:14:39.919 +07:00 [INF] Executed action server.Controllers.MessageController.GetMessages (Message_app) in 3.9728ms
2025-04-20 23:14:39.920 +07:00 [INF] Executed endpoint 'server.Controllers.MessageController.GetMessages (Message_app)'
2025-04-20 23:14:39.920 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5053/api/Message/getMessages/1/5 - 500 null text/plain; charset=utf-8 14.2845ms
2025-04-20 23:14:40.855 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/api/Message/getMessages/1/5 - null null
2025-04-20 23:14:40.857 +07:00 [INF] Executing endpoint 'server.Controllers.MessageController.GetMessages (Message_app)'
2025-04-20 23:14:40.857 +07:00 [INF] Route matched with {action = "GetMessages", controller = "Message"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetMessages(Int32, Int32) on controller server.Controllers.MessageController (Message_app).
2025-04-20 23:14:40.859 +07:00 [INF] Executing ObjectResult, writing value of type 'System.String'.
2025-04-20 23:14:40.860 +07:00 [INF] Executed action server.Controllers.MessageController.GetMessages (Message_app) in 2.6442ms
2025-04-20 23:14:40.860 +07:00 [INF] Executed endpoint 'server.Controllers.MessageController.GetMessages (Message_app)'
2025-04-20 23:14:40.860 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5053/api/Message/getMessages/1/5 - 500 null text/plain; charset=utf-8 5.4751ms
2025-04-20 23:14:47.317 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/api/Message/getMessages/1/5 - null null
2025-04-20 23:14:47.317 +07:00 [INF] Executing endpoint 'server.Controllers.MessageController.GetMessages (Message_app)'
2025-04-20 23:14:47.317 +07:00 [INF] Route matched with {action = "GetMessages", controller = "Message"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetMessages(Int32, Int32) on controller server.Controllers.MessageController (Message_app).
2025-04-20 23:14:47.319 +07:00 [INF] Retrieved 0 messages from Redis for conversation 1
2025-04-20 23:14:47.337 +07:00 [INF] Executed DbCommand (14ms) [Parameters=[@__user_id_0='?' (DbType = Int32), @__conversationId_1='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[cleared_at]
FROM [messageDeletions] AS [m]
WHERE [m].[user_id] = @__user_id_0 AND CAST([m].[conversation_id] AS bigint) = @__conversationId_1
2025-04-20 23:14:47.352 +07:00 [INF] Executed DbCommand (14ms) [Parameters=[@__p_1='?' (DbType = Int32), @__conversationId_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[id], [t].[content], [t].[conversation_id], [t].[created_at], [t].[isFile], [t].[isRecalled], [t].[is_read], [t].[sender_id], [t].[type], [a].[id], [a].[FileSize], [a].[file_type], [a].[file_url], [a].[is_temporary], [a].[message_id], [a].[uploaded_at]
FROM (
    SELECT TOP(@__p_1) [m].[id], [m].[content], [m].[conversation_id], [m].[created_at], [m].[isFile], [m].[isRecalled], [m].[is_read], [m].[sender_id], [m].[type]
    FROM [Messages] AS [m]
    WHERE CAST([m].[conversation_id] AS bigint) = @__conversationId_0
    ORDER BY [m].[created_at] DESC
) AS [t]
LEFT JOIN [Attachments] AS [a] ON [t].[id] = [a].[message_id]
ORDER BY [t].[created_at] DESC, [t].[id]
2025-04-20 23:14:47.360 +07:00 [INF] Saved message 81 to Redis
2025-04-20 23:14:47.360 +07:00 [INF] Added message 81 to conversation 1
2025-04-20 23:14:47.362 +07:00 [INF] Saved message 80 to Redis
2025-04-20 23:14:47.363 +07:00 [INF] Added message 80 to conversation 1
2025-04-20 23:14:47.364 +07:00 [INF] Saved message 79 to Redis
2025-04-20 23:14:47.364 +07:00 [INF] Added message 79 to conversation 1
2025-04-20 23:14:47.365 +07:00 [INF] Saved message 78 to Redis
2025-04-20 23:14:47.366 +07:00 [INF] Added message 78 to conversation 1
2025-04-20 23:14:47.368 +07:00 [INF] Saved message 77 to Redis
2025-04-20 23:14:47.368 +07:00 [INF] Added message 77 to conversation 1
2025-04-20 23:14:47.369 +07:00 [INF] Saved message 76 to Redis
2025-04-20 23:14:47.369 +07:00 [INF] Added message 76 to conversation 1
2025-04-20 23:14:47.370 +07:00 [INF] Saved message 75 to Redis
2025-04-20 23:14:47.371 +07:00 [INF] Added message 75 to conversation 1
2025-04-20 23:14:47.372 +07:00 [INF] Saved message 74 to Redis
2025-04-20 23:14:47.373 +07:00 [INF] Added message 74 to conversation 1
2025-04-20 23:14:47.374 +07:00 [INF] Saved message 73 to Redis
2025-04-20 23:14:47.375 +07:00 [INF] Added message 73 to conversation 1
2025-04-20 23:14:47.376 +07:00 [INF] Saved message 72 to Redis
2025-04-20 23:14:47.376 +07:00 [INF] Added message 72 to conversation 1
2025-04-20 23:14:47.377 +07:00 [INF] Saved message 71 to Redis
2025-04-20 23:14:47.377 +07:00 [INF] Added message 71 to conversation 1
2025-04-20 23:14:47.378 +07:00 [INF] Saved message 68 to Redis
2025-04-20 23:14:47.378 +07:00 [INF] Added message 68 to conversation 1
2025-04-20 23:14:47.379 +07:00 [INF] Saved message 64 to Redis
2025-04-20 23:14:47.380 +07:00 [INF] Added message 64 to conversation 1
2025-04-20 23:14:47.380 +07:00 [INF] Saved message 62 to Redis
2025-04-20 23:14:47.381 +07:00 [INF] Added message 62 to conversation 1
2025-04-20 23:14:47.381 +07:00 [INF] Saved message 61 to Redis
2025-04-20 23:14:47.382 +07:00 [INF] Added message 61 to conversation 1
2025-04-20 23:14:47.382 +07:00 [INF] Saved message 60 to Redis
2025-04-20 23:14:47.382 +07:00 [INF] Added message 60 to conversation 1
2025-04-20 23:14:47.383 +07:00 [INF] Saved message 59 to Redis
2025-04-20 23:14:47.383 +07:00 [INF] Added message 59 to conversation 1
2025-04-20 23:14:47.384 +07:00 [INF] Saved message 57 to Redis
2025-04-20 23:14:47.384 +07:00 [INF] Added message 57 to conversation 1
2025-04-20 23:14:47.385 +07:00 [INF] Saved message 55 to Redis
2025-04-20 23:14:47.385 +07:00 [INF] Added message 55 to conversation 1
2025-04-20 23:14:47.385 +07:00 [INF] Saved message 54 to Redis
2025-04-20 23:14:47.386 +07:00 [INF] Added message 54 to conversation 1
2025-04-20 23:14:47.387 +07:00 [INF] Saved message 51 to Redis
2025-04-20 23:14:47.387 +07:00 [INF] Added message 51 to conversation 1
2025-04-20 23:14:47.389 +07:00 [INF] Saved message 49 to Redis
2025-04-20 23:14:47.390 +07:00 [INF] Added message 49 to conversation 1
2025-04-20 23:14:47.391 +07:00 [INF] Saved message 11 to Redis
2025-04-20 23:14:47.392 +07:00 [INF] Added message 11 to conversation 1
2025-04-20 23:14:47.393 +07:00 [INF] Saved message 8 to Redis
2025-04-20 23:14:47.394 +07:00 [INF] Added message 8 to conversation 1
2025-04-20 23:14:47.395 +07:00 [INF] Saved message 3 to Redis
2025-04-20 23:14:47.395 +07:00 [INF] Added message 3 to conversation 1
2025-04-20 23:14:47.396 +07:00 [INF] Saved message 2 to Redis
2025-04-20 23:14:47.396 +07:00 [INF] Added message 2 to conversation 1
2025-04-20 23:14:47.398 +07:00 [INF] Saved message 1 to Redis
2025-04-20 23:14:47.399 +07:00 [INF] Added message 1 to conversation 1
2025-04-20 23:14:47.399 +07:00 [INF] Cached 27 messages to Redis for conversation 1
2025-04-20 23:14:47.399 +07:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[server.DTO.MessageWithAttachment, Message_app, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-04-20 23:14:47.407 +07:00 [INF] Executed action server.Controllers.MessageController.GetMessages (Message_app) in 89.5598ms
2025-04-20 23:14:47.407 +07:00 [INF] Executed endpoint 'server.Controllers.MessageController.GetMessages (Message_app)'
2025-04-20 23:14:47.408 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5053/api/Message/getMessages/1/5 - 200 null application/json; charset=utf-8 90.9136ms
2025-04-20 23:14:48.366 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/api/Message/getMessages/1/5 - null null
2025-04-20 23:14:48.366 +07:00 [INF] Executing endpoint 'server.Controllers.MessageController.GetMessages (Message_app)'
2025-04-20 23:14:48.366 +07:00 [INF] Route matched with {action = "GetMessages", controller = "Message"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetMessages(Int32, Int32) on controller server.Controllers.MessageController (Message_app).
2025-04-20 23:14:48.373 +07:00 [INF] Executing ObjectResult, writing value of type 'System.String'.
2025-04-20 23:14:48.374 +07:00 [INF] Executed action server.Controllers.MessageController.GetMessages (Message_app) in 7.6251ms
2025-04-20 23:14:48.374 +07:00 [INF] Executed endpoint 'server.Controllers.MessageController.GetMessages (Message_app)'
2025-04-20 23:14:48.375 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5053/api/Message/getMessages/1/5 - 500 null text/plain; charset=utf-8 8.993ms
2025-04-20 23:21:01.556 +07:00 [INF] Executed DbCommand (20ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [u].[id], [u].[username], [u].[avatar_url]
FROM [Users] AS [u]
2025-04-20 23:21:01.664 +07:00 [INF] User profile is available. Using 'C:\Users\Thao\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-04-20 23:21:01.706 +07:00 [WRN] Overriding address(es) 'http://localhost:5053'. Binding to endpoints defined via IConfiguration and/or UseKestrel() instead.
2025-04-20 23:21:01.713 +07:00 [INF] Now listening on: http://[::]:5053
2025-04-20 23:21:01.713 +07:00 [INF] Now listening on: http://0.0.0.0:5053
2025-04-20 23:21:01.714 +07:00 [INF] Application started. Press Ctrl+C to shut down.
2025-04-20 23:21:01.714 +07:00 [INF] Hosting environment: Development
2025-04-20 23:21:01.714 +07:00 [INF] Content root path: C:\Users\Thao\source\Flutter\Message_app\server
2025-04-20 23:21:02.011 +07:00 [INF] Request starting HTTP/1.1 GET http://192.168.1.3:5053/ws/chat - null null
2025-04-20 23:21:02.011 +07:00 [INF] Request starting HTTP/1.1 GET http://192.168.1.3:5053/ws/chat - null null
2025-04-20 23:21:02.011 +07:00 [INF] Request starting HTTP/1.1 GET http://192.168.1.3:5053/ws/chat - null null
2025-04-20 23:21:02.040 +07:00 [WRN] Failed to determine the https port for redirect.
2025-04-20 23:21:02.057 +07:00 [INF] Executing endpoint '/ws/chat'
2025-04-20 23:21:02.057 +07:00 [INF] Executing endpoint '/ws/chat'
2025-04-20 23:21:02.057 +07:00 [INF] Executing endpoint '/ws/chat'
2025-04-20 23:21:02.179 +07:00 [INF] Executed DbCommand (7ms) [Parameters=[@__client_UserId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[conversation_id]
FROM [Participants] AS [p]
WHERE [p].[user_id] = @__client_UserId_0 AND [p].[is_deleted] = CAST(0 AS bit)
2025-04-20 23:21:02.179 +07:00 [INF] Executed DbCommand (11ms) [Parameters=[@__client_UserId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[conversation_id]
FROM [Participants] AS [p]
WHERE [p].[user_id] = @__client_UserId_0 AND [p].[is_deleted] = CAST(0 AS bit)
2025-04-20 23:21:02.179 +07:00 [INF] Executed DbCommand (15ms) [Parameters=[@__client_UserId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[conversation_id]
FROM [Participants] AS [p]
WHERE [p].[user_id] = @__client_UserId_0 AND [p].[is_deleted] = CAST(0 AS bit)
2025-04-20 23:21:02.200 +07:00 [INF] Executed DbCommand (5ms) [Parameters=[@__p_1='?' (DbType = Int32), @__conversationId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(@__p_1) [m].[id], [m].[conversation_id], [m].[sender_id], [m].[content], [m].[created_at], [m].[isFile], [m].[type], [m].[isRecalled]
FROM [Messages] AS [m]
WHERE [m].[conversation_id] = @__conversationId_0
ORDER BY [m].[created_at] DESC
2025-04-20 23:21:02.200 +07:00 [INF] Executed DbCommand (6ms) [Parameters=[@__p_1='?' (DbType = Int32), @__conversationId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(@__p_1) [m].[id], [m].[conversation_id], [m].[sender_id], [m].[content], [m].[created_at], [m].[isFile], [m].[type], [m].[isRecalled]
FROM [Messages] AS [m]
WHERE [m].[conversation_id] = @__conversationId_0
ORDER BY [m].[created_at] DESC
2025-04-20 23:21:02.200 +07:00 [INF] Executed DbCommand (5ms) [Parameters=[@__p_1='?' (DbType = Int32), @__conversationId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(@__p_1) [m].[id], [m].[conversation_id], [m].[sender_id], [m].[content], [m].[created_at], [m].[isFile], [m].[type], [m].[isRecalled]
FROM [Messages] AS [m]
WHERE [m].[conversation_id] = @__conversationId_0
ORDER BY [m].[created_at] DESC
2025-04-20 23:21:02.208 +07:00 [INF] Saved message 81 to Redis
2025-04-20 23:21:02.208 +07:00 [INF] Saved message 81 to Redis
2025-04-20 23:21:02.208 +07:00 [INF] Saved message 81 to Redis
2025-04-20 23:21:02.209 +07:00 [INF] Added message 81 to conversation 1
2025-04-20 23:21:02.209 +07:00 [INF] Added message 81 to conversation 1
2025-04-20 23:21:02.209 +07:00 [INF] Added message 81 to conversation 1
2025-04-20 23:21:02.210 +07:00 [INF] Saved message 80 to Redis
2025-04-20 23:21:02.210 +07:00 [INF] Saved message 80 to Redis
2025-04-20 23:21:02.210 +07:00 [INF] Saved message 80 to Redis
2025-04-20 23:21:02.211 +07:00 [INF] Added message 80 to conversation 1
2025-04-20 23:21:02.211 +07:00 [INF] Added message 80 to conversation 1
2025-04-20 23:21:02.211 +07:00 [INF] Added message 80 to conversation 1
2025-04-20 23:21:02.212 +07:00 [INF] Saved message 79 to Redis
2025-04-20 23:21:02.212 +07:00 [INF] Saved message 79 to Redis
2025-04-20 23:21:02.212 +07:00 [INF] Saved message 79 to Redis
2025-04-20 23:21:02.212 +07:00 [INF] Added message 79 to conversation 1
2025-04-20 23:21:02.212 +07:00 [INF] Added message 79 to conversation 1
2025-04-20 23:21:02.212 +07:00 [INF] Added message 79 to conversation 1
2025-04-20 23:21:02.213 +07:00 [INF] Saved message 78 to Redis
2025-04-20 23:21:02.213 +07:00 [INF] Saved message 78 to Redis
2025-04-20 23:21:02.213 +07:00 [INF] Saved message 78 to Redis
2025-04-20 23:21:02.213 +07:00 [INF] Added message 78 to conversation 1
2025-04-20 23:21:02.213 +07:00 [INF] Added message 78 to conversation 1
2025-04-20 23:21:02.213 +07:00 [INF] Added message 78 to conversation 1
2025-04-20 23:21:02.215 +07:00 [INF] Saved message 77 to Redis
2025-04-20 23:21:02.215 +07:00 [INF] Saved message 77 to Redis
2025-04-20 23:21:02.215 +07:00 [INF] Saved message 77 to Redis
2025-04-20 23:21:02.215 +07:00 [INF] Added message 77 to conversation 1
2025-04-20 23:21:02.215 +07:00 [INF] Added message 77 to conversation 1
2025-04-20 23:21:02.215 +07:00 [INF] Added message 77 to conversation 1
2025-04-20 23:21:02.216 +07:00 [INF] Saved message 76 to Redis
2025-04-20 23:21:02.216 +07:00 [INF] Saved message 76 to Redis
2025-04-20 23:21:02.216 +07:00 [INF] Saved message 76 to Redis
2025-04-20 23:21:02.217 +07:00 [INF] Added message 76 to conversation 1
2025-04-20 23:21:02.217 +07:00 [INF] Added message 76 to conversation 1
2025-04-20 23:21:02.217 +07:00 [INF] Added message 76 to conversation 1
2025-04-20 23:21:02.218 +07:00 [INF] Saved message 75 to Redis
2025-04-20 23:21:02.218 +07:00 [INF] Saved message 75 to Redis
2025-04-20 23:21:02.218 +07:00 [INF] Saved message 75 to Redis
2025-04-20 23:21:02.219 +07:00 [INF] Added message 75 to conversation 1
2025-04-20 23:21:02.219 +07:00 [INF] Added message 75 to conversation 1
2025-04-20 23:21:02.219 +07:00 [INF] Added message 75 to conversation 1
2025-04-20 23:21:02.220 +07:00 [INF] Saved message 74 to Redis
2025-04-20 23:21:02.220 +07:00 [INF] Saved message 74 to Redis
2025-04-20 23:21:02.220 +07:00 [INF] Saved message 74 to Redis
2025-04-20 23:21:02.220 +07:00 [INF] Added message 74 to conversation 1
2025-04-20 23:21:02.220 +07:00 [INF] Added message 74 to conversation 1
2025-04-20 23:21:02.220 +07:00 [INF] Added message 74 to conversation 1
2025-04-20 23:21:02.221 +07:00 [INF] Saved message 73 to Redis
2025-04-20 23:21:02.221 +07:00 [INF] Saved message 73 to Redis
2025-04-20 23:21:02.221 +07:00 [INF] Saved message 73 to Redis
2025-04-20 23:21:02.222 +07:00 [INF] Added message 73 to conversation 1
2025-04-20 23:21:02.222 +07:00 [INF] Added message 73 to conversation 1
2025-04-20 23:21:02.222 +07:00 [INF] Added message 73 to conversation 1
2025-04-20 23:21:02.223 +07:00 [INF] Saved message 72 to Redis
2025-04-20 23:21:02.223 +07:00 [INF] Saved message 72 to Redis
2025-04-20 23:21:02.223 +07:00 [INF] Saved message 72 to Redis
2025-04-20 23:21:02.223 +07:00 [INF] Added message 72 to conversation 1
2025-04-20 23:21:02.224 +07:00 [INF] Added message 72 to conversation 1
2025-04-20 23:21:02.224 +07:00 [INF] Added message 72 to conversation 1
2025-04-20 23:21:02.225 +07:00 [INF] Saved message 71 to Redis
2025-04-20 23:21:02.225 +07:00 [INF] Saved message 71 to Redis
2025-04-20 23:21:02.225 +07:00 [INF] Saved message 71 to Redis
2025-04-20 23:21:02.225 +07:00 [INF] Added message 71 to conversation 1
2025-04-20 23:21:02.225 +07:00 [INF] Added message 71 to conversation 1
2025-04-20 23:21:02.225 +07:00 [INF] Added message 71 to conversation 1
2025-04-20 23:21:02.226 +07:00 [INF] Saved message 68 to Redis
2025-04-20 23:21:02.226 +07:00 [INF] Saved message 68 to Redis
2025-04-20 23:21:02.226 +07:00 [INF] Saved message 68 to Redis
2025-04-20 23:21:02.226 +07:00 [INF] Added message 68 to conversation 1
2025-04-20 23:21:02.226 +07:00 [INF] Added message 68 to conversation 1
2025-04-20 23:21:02.226 +07:00 [INF] Added message 68 to conversation 1
2025-04-20 23:21:02.227 +07:00 [INF] Saved message 64 to Redis
2025-04-20 23:21:02.227 +07:00 [INF] Saved message 64 to Redis
2025-04-20 23:21:02.227 +07:00 [INF] Saved message 64 to Redis
2025-04-20 23:21:02.228 +07:00 [INF] Added message 64 to conversation 1
2025-04-20 23:21:02.228 +07:00 [INF] Added message 64 to conversation 1
2025-04-20 23:21:02.228 +07:00 [INF] Added message 64 to conversation 1
2025-04-20 23:21:02.229 +07:00 [INF] Saved message 62 to Redis
2025-04-20 23:21:02.229 +07:00 [INF] Saved message 62 to Redis
2025-04-20 23:21:02.229 +07:00 [INF] Saved message 62 to Redis
2025-04-20 23:21:02.229 +07:00 [INF] Added message 62 to conversation 1
2025-04-20 23:21:02.229 +07:00 [INF] Added message 62 to conversation 1
2025-04-20 23:21:02.229 +07:00 [INF] Added message 62 to conversation 1
2025-04-20 23:21:02.230 +07:00 [INF] Saved message 61 to Redis
2025-04-20 23:21:02.230 +07:00 [INF] Saved message 61 to Redis
2025-04-20 23:21:02.230 +07:00 [INF] Saved message 61 to Redis
2025-04-20 23:21:02.230 +07:00 [INF] Added message 61 to conversation 1
2025-04-20 23:21:02.230 +07:00 [INF] Added message 61 to conversation 1
2025-04-20 23:21:02.230 +07:00 [INF] Added message 61 to conversation 1
2025-04-20 23:21:02.231 +07:00 [INF] Saved message 60 to Redis
2025-04-20 23:21:02.231 +07:00 [INF] Saved message 60 to Redis
2025-04-20 23:21:02.231 +07:00 [INF] Saved message 60 to Redis
2025-04-20 23:21:02.232 +07:00 [INF] Added message 60 to conversation 1
2025-04-20 23:21:02.232 +07:00 [INF] Added message 60 to conversation 1
2025-04-20 23:21:02.232 +07:00 [INF] Added message 60 to conversation 1
2025-04-20 23:21:02.233 +07:00 [INF] Saved message 59 to Redis
2025-04-20 23:21:02.233 +07:00 [INF] Saved message 59 to Redis
2025-04-20 23:21:02.233 +07:00 [INF] Saved message 59 to Redis
2025-04-20 23:21:02.234 +07:00 [INF] Added message 59 to conversation 1
2025-04-20 23:21:02.234 +07:00 [INF] Added message 59 to conversation 1
2025-04-20 23:21:02.234 +07:00 [INF] Added message 59 to conversation 1
2025-04-20 23:21:02.235 +07:00 [INF] Saved message 57 to Redis
2025-04-20 23:21:02.235 +07:00 [INF] Saved message 57 to Redis
2025-04-20 23:21:02.235 +07:00 [INF] Saved message 57 to Redis
2025-04-20 23:21:02.235 +07:00 [INF] Added message 57 to conversation 1
2025-04-20 23:21:02.235 +07:00 [INF] Added message 57 to conversation 1
2025-04-20 23:21:02.235 +07:00 [INF] Added message 57 to conversation 1
2025-04-20 23:21:02.236 +07:00 [INF] Saved message 55 to Redis
2025-04-20 23:21:02.236 +07:00 [INF] Saved message 55 to Redis
2025-04-20 23:21:02.236 +07:00 [INF] Saved message 55 to Redis
2025-04-20 23:21:02.237 +07:00 [INF] Added message 55 to conversation 1
2025-04-20 23:21:02.237 +07:00 [INF] Added message 55 to conversation 1
2025-04-20 23:21:02.237 +07:00 [INF] Added message 55 to conversation 1
2025-04-20 23:21:02.238 +07:00 [INF] Saved message 54 to Redis
2025-04-20 23:21:02.238 +07:00 [INF] Saved message 54 to Redis
2025-04-20 23:21:02.238 +07:00 [INF] Saved message 54 to Redis
2025-04-20 23:21:02.238 +07:00 [INF] Added message 54 to conversation 1
2025-04-20 23:21:02.238 +07:00 [INF] Added message 54 to conversation 1
2025-04-20 23:21:02.238 +07:00 [INF] Added message 54 to conversation 1
2025-04-20 23:21:02.239 +07:00 [INF] Saved message 51 to Redis
2025-04-20 23:21:02.239 +07:00 [INF] Saved message 51 to Redis
2025-04-20 23:21:02.239 +07:00 [INF] Saved message 51 to Redis
2025-04-20 23:21:02.239 +07:00 [INF] Added message 51 to conversation 1
2025-04-20 23:21:02.239 +07:00 [INF] Added message 51 to conversation 1
2025-04-20 23:21:02.239 +07:00 [INF] Added message 51 to conversation 1
2025-04-20 23:21:02.241 +07:00 [INF] Saved message 49 to Redis
2025-04-20 23:21:02.241 +07:00 [INF] Saved message 49 to Redis
2025-04-20 23:21:02.241 +07:00 [INF] Saved message 49 to Redis
2025-04-20 23:21:02.241 +07:00 [INF] Added message 49 to conversation 1
2025-04-20 23:21:02.241 +07:00 [INF] Added message 49 to conversation 1
2025-04-20 23:21:02.241 +07:00 [INF] Added message 49 to conversation 1
2025-04-20 23:21:02.242 +07:00 [INF] Saved message 11 to Redis
2025-04-20 23:21:02.242 +07:00 [INF] Saved message 11 to Redis
2025-04-20 23:21:02.242 +07:00 [INF] Saved message 11 to Redis
2025-04-20 23:21:02.242 +07:00 [INF] Added message 11 to conversation 1
2025-04-20 23:21:02.242 +07:00 [INF] Added message 11 to conversation 1
2025-04-20 23:21:02.242 +07:00 [INF] Added message 11 to conversation 1
2025-04-20 23:21:02.243 +07:00 [INF] Saved message 8 to Redis
2025-04-20 23:21:02.243 +07:00 [INF] Saved message 8 to Redis
2025-04-20 23:21:02.243 +07:00 [INF] Saved message 8 to Redis
2025-04-20 23:21:02.243 +07:00 [INF] Added message 8 to conversation 1
2025-04-20 23:21:02.243 +07:00 [INF] Added message 8 to conversation 1
2025-04-20 23:21:02.243 +07:00 [INF] Added message 8 to conversation 1
2025-04-20 23:21:02.244 +07:00 [INF] Saved message 3 to Redis
2025-04-20 23:21:02.244 +07:00 [INF] Saved message 3 to Redis
2025-04-20 23:21:02.244 +07:00 [INF] Saved message 3 to Redis
2025-04-20 23:21:02.245 +07:00 [INF] Added message 3 to conversation 1
2025-04-20 23:21:02.245 +07:00 [INF] Added message 3 to conversation 1
2025-04-20 23:21:02.245 +07:00 [INF] Added message 3 to conversation 1
2025-04-20 23:21:02.246 +07:00 [INF] Saved message 2 to Redis
2025-04-20 23:21:02.246 +07:00 [INF] Saved message 2 to Redis
2025-04-20 23:21:02.246 +07:00 [INF] Saved message 2 to Redis
2025-04-20 23:21:02.247 +07:00 [INF] Added message 2 to conversation 1
2025-04-20 23:21:02.247 +07:00 [INF] Added message 2 to conversation 1
2025-04-20 23:21:02.247 +07:00 [INF] Added message 2 to conversation 1
2025-04-20 23:21:02.247 +07:00 [INF] Saved message 1 to Redis
2025-04-20 23:21:02.247 +07:00 [INF] Saved message 1 to Redis
2025-04-20 23:21:02.247 +07:00 [INF] Saved message 1 to Redis
2025-04-20 23:21:02.248 +07:00 [INF] Added message 1 to conversation 1
2025-04-20 23:21:02.248 +07:00 [INF] Added message 1 to conversation 1
2025-04-20 23:21:02.248 +07:00 [INF] Added message 1 to conversation 1
2025-04-20 23:21:02.254 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_1='?' (DbType = Int32), @__conversationId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(@__p_1) [m].[id], [m].[conversation_id], [m].[sender_id], [m].[content], [m].[created_at], [m].[isFile], [m].[type], [m].[isRecalled]
FROM [Messages] AS [m]
WHERE [m].[conversation_id] = @__conversationId_0
ORDER BY [m].[created_at] DESC
2025-04-20 23:21:02.255 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_1='?' (DbType = Int32), @__conversationId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(@__p_1) [m].[id], [m].[conversation_id], [m].[sender_id], [m].[content], [m].[created_at], [m].[isFile], [m].[type], [m].[isRecalled]
FROM [Messages] AS [m]
WHERE [m].[conversation_id] = @__conversationId_0
ORDER BY [m].[created_at] DESC
2025-04-20 23:21:02.255 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[@__p_1='?' (DbType = Int32), @__conversationId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(@__p_1) [m].[id], [m].[conversation_id], [m].[sender_id], [m].[content], [m].[created_at], [m].[isFile], [m].[type], [m].[isRecalled]
FROM [Messages] AS [m]
WHERE [m].[conversation_id] = @__conversationId_0
ORDER BY [m].[created_at] DESC
2025-04-20 23:21:02.256 +07:00 [INF] Saved message 69 to Redis
2025-04-20 23:21:02.256 +07:00 [INF] Added message 69 to conversation 4
2025-04-20 23:21:02.256 +07:00 [INF] Message 69 already exists in Redis
2025-04-20 23:21:02.257 +07:00 [INF] Message 67 already exists in Redis
2025-04-20 23:21:02.257 +07:00 [INF] Saved message 67 to Redis
2025-04-20 23:21:02.257 +07:00 [INF] Message 69 already exists in Redis
2025-04-20 23:21:02.257 +07:00 [INF] Added message 67 to conversation 4
2025-04-20 23:21:02.257 +07:00 [INF] Message 67 already exists in Redis
2025-04-20 23:21:02.258 +07:00 [INF] Message 66 already exists in Redis
2025-04-20 23:21:02.258 +07:00 [INF] Message 66 already exists in Redis
2025-04-20 23:21:02.258 +07:00 [INF] Saved message 66 to Redis
2025-04-20 23:21:02.258 +07:00 [INF] Added message 66 to conversation 4
2025-04-20 23:21:02.259 +07:00 [INF] Saved message 63 to Redis
2025-04-20 23:21:02.259 +07:00 [INF] Message 63 already exists in Redis
2025-04-20 23:21:02.259 +07:00 [INF] Saved message 63 to Redis
2025-04-20 23:21:02.259 +07:00 [INF] Added message 63 to conversation 4
2025-04-20 23:21:02.259 +07:00 [INF] Added message 63 to conversation 4
2025-04-20 23:21:02.259 +07:00 [INF] Message 58 already exists in Redis
2025-04-20 23:21:02.259 +07:00 [INF] Message 58 already exists in Redis
2025-04-20 23:21:02.259 +07:00 [INF] Saved message 58 to Redis
2025-04-20 23:21:02.260 +07:00 [INF] Added message 58 to conversation 4
2025-04-20 23:21:02.260 +07:00 [INF] Saved message 56 to Redis
2025-04-20 23:21:02.260 +07:00 [INF] Saved message 56 to Redis
2025-04-20 23:21:02.260 +07:00 [INF] Message 56 already exists in Redis
2025-04-20 23:21:02.260 +07:00 [INF] Added message 56 to conversation 4
2025-04-20 23:21:02.260 +07:00 [INF] Added message 56 to conversation 4
2025-04-20 23:21:02.261 +07:00 [INF] Message 53 already exists in Redis
2025-04-20 23:21:02.261 +07:00 [INF] Message 53 already exists in Redis
2025-04-20 23:21:02.261 +07:00 [INF] Saved message 53 to Redis
2025-04-20 23:21:02.261 +07:00 [INF] Added message 53 to conversation 4
2025-04-20 23:21:02.262 +07:00 [INF] Saved message 52 to Redis
2025-04-20 23:21:02.262 +07:00 [INF] Saved message 52 to Redis
2025-04-20 23:21:02.262 +07:00 [INF] Message 52 already exists in Redis
2025-04-20 23:21:02.262 +07:00 [INF] Added message 52 to conversation 4
2025-04-20 23:21:02.262 +07:00 [INF] Added message 52 to conversation 4
2025-04-20 23:21:02.262 +07:00 [INF] Message 50 already exists in Redis
2025-04-20 23:21:02.263 +07:00 [INF] Saved message 50 to Redis
2025-04-20 23:21:02.263 +07:00 [INF] Saved message 50 to Redis
2025-04-20 23:21:02.263 +07:00 [INF] Added message 50 to conversation 4
2025-04-20 23:21:02.263 +07:00 [INF] Saved message 47 to Redis
2025-04-20 23:21:02.263 +07:00 [INF] Added message 50 to conversation 4
2025-04-20 23:21:02.263 +07:00 [INF] Message 47 already exists in Redis
2025-04-20 23:21:02.264 +07:00 [INF] Added message 47 to conversation 4
2025-04-20 23:21:02.264 +07:00 [INF] Message 47 already exists in Redis
2025-04-20 23:21:02.264 +07:00 [INF] Message 46 already exists in Redis
2025-04-20 23:21:02.264 +07:00 [INF] Message 46 already exists in Redis
2025-04-20 23:21:02.264 +07:00 [INF] Saved message 46 to Redis
2025-04-20 23:21:02.265 +07:00 [INF] Added message 46 to conversation 4
2025-04-20 23:21:02.265 +07:00 [INF] Saved message 45 to Redis
2025-04-20 23:21:02.265 +07:00 [INF] Saved message 45 to Redis
2025-04-20 23:21:02.265 +07:00 [INF] Message 45 already exists in Redis
2025-04-20 23:21:02.266 +07:00 [INF] Added message 45 to conversation 4
2025-04-20 23:21:02.266 +07:00 [INF] Added message 45 to conversation 4
2025-04-20 23:21:02.266 +07:00 [INF] Message 44 already exists in Redis
2025-04-20 23:21:02.266 +07:00 [INF] Message 44 already exists in Redis
2025-04-20 23:21:02.266 +07:00 [INF] Saved message 44 to Redis
2025-04-20 23:21:02.267 +07:00 [INF] Added message 44 to conversation 4
2025-04-20 23:21:02.267 +07:00 [INF] Message 43 already exists in Redis
2025-04-20 23:21:02.267 +07:00 [INF] Saved message 43 to Redis
2025-04-20 23:21:02.267 +07:00 [INF] Saved message 43 to Redis
2025-04-20 23:21:02.268 +07:00 [INF] Added message 43 to conversation 4
2025-04-20 23:21:02.268 +07:00 [INF] Added message 43 to conversation 4
2025-04-20 23:21:02.269 +07:00 [INF] Message 42 already exists in Redis
2025-04-20 23:21:02.269 +07:00 [INF] Message 42 already exists in Redis
2025-04-20 23:21:02.269 +07:00 [INF] Saved message 42 to Redis
2025-04-20 23:21:02.269 +07:00 [INF] Added message 42 to conversation 4
2025-04-20 23:21:02.270 +07:00 [INF] Saved message 41 to Redis
2025-04-20 23:21:02.270 +07:00 [INF] Message 41 already exists in Redis
2025-04-20 23:21:02.270 +07:00 [INF] Saved message 41 to Redis
2025-04-20 23:21:02.270 +07:00 [INF] Added message 41 to conversation 4
2025-04-20 23:21:02.270 +07:00 [INF] Added message 41 to conversation 4
2025-04-20 23:21:02.270 +07:00 [INF] Message 40 already exists in Redis
2025-04-20 23:21:02.270 +07:00 [INF] Message 40 already exists in Redis
2025-04-20 23:21:02.271 +07:00 [INF] Saved message 40 to Redis
2025-04-20 23:21:02.271 +07:00 [INF] Added message 40 to conversation 4
2025-04-20 23:21:02.271 +07:00 [INF] Saved message 39 to Redis
2025-04-20 23:21:02.271 +07:00 [INF] Saved message 39 to Redis
2025-04-20 23:21:02.271 +07:00 [INF] Message 39 already exists in Redis
2025-04-20 23:21:02.272 +07:00 [INF] Added message 39 to conversation 4
2025-04-20 23:21:02.272 +07:00 [INF] Added message 39 to conversation 4
2025-04-20 23:21:02.272 +07:00 [INF] Message 38 already exists in Redis
2025-04-20 23:21:02.272 +07:00 [INF] Message 38 already exists in Redis
2025-04-20 23:21:02.272 +07:00 [INF] Saved message 38 to Redis
2025-04-20 23:21:02.273 +07:00 [INF] Added message 38 to conversation 4
2025-04-20 23:21:02.273 +07:00 [INF] Saved message 37 to Redis
2025-04-20 23:21:02.273 +07:00 [INF] Saved message 37 to Redis
2025-04-20 23:21:02.273 +07:00 [INF] Message 37 already exists in Redis
2025-04-20 23:21:02.273 +07:00 [INF] Added message 37 to conversation 4
2025-04-20 23:21:02.273 +07:00 [INF] Added message 37 to conversation 4
2025-04-20 23:21:02.274 +07:00 [INF] Message 36 already exists in Redis
2025-04-20 23:21:02.274 +07:00 [INF] Message 36 already exists in Redis
2025-04-20 23:21:02.274 +07:00 [INF] Saved message 36 to Redis
2025-04-20 23:21:02.274 +07:00 [INF] Added message 36 to conversation 4
2025-04-20 23:21:02.275 +07:00 [INF] Message 35 already exists in Redis
2025-04-20 23:21:02.275 +07:00 [INF] Saved message 35 to Redis
2025-04-20 23:21:02.275 +07:00 [INF] Saved message 35 to Redis
2025-04-20 23:21:02.275 +07:00 [INF] Added message 35 to conversation 4
2025-04-20 23:21:02.275 +07:00 [INF] Added message 35 to conversation 4
2025-04-20 23:21:02.276 +07:00 [INF] Message 34 already exists in Redis
2025-04-20 23:21:02.276 +07:00 [INF] Message 34 already exists in Redis
2025-04-20 23:21:02.276 +07:00 [INF] Saved message 34 to Redis
2025-04-20 23:21:02.276 +07:00 [INF] Added message 34 to conversation 4
2025-04-20 23:21:02.276 +07:00 [INF] Message 33 already exists in Redis
2025-04-20 23:21:02.277 +07:00 [INF] Saved message 33 to Redis
2025-04-20 23:21:02.277 +07:00 [INF] Saved message 33 to Redis
2025-04-20 23:21:02.277 +07:00 [INF] Added message 33 to conversation 4
2025-04-20 23:21:02.277 +07:00 [INF] Added message 33 to conversation 4
2025-04-20 23:21:02.277 +07:00 [INF] Message 32 already exists in Redis
2025-04-20 23:21:02.277 +07:00 [INF] Message 32 already exists in Redis
2025-04-20 23:21:02.278 +07:00 [INF] Saved message 32 to Redis
2025-04-20 23:21:02.278 +07:00 [INF] Added message 32 to conversation 4
2025-04-20 23:21:02.278 +07:00 [INF] Saved message 31 to Redis
2025-04-20 23:21:02.278 +07:00 [INF] Saved message 31 to Redis
2025-04-20 23:21:02.278 +07:00 [INF] Message 31 already exists in Redis
2025-04-20 23:21:02.279 +07:00 [INF] Added message 31 to conversation 4
2025-04-20 23:21:02.279 +07:00 [INF] Added message 31 to conversation 4
2025-04-20 23:21:02.279 +07:00 [INF] Message 30 already exists in Redis
2025-04-20 23:21:02.279 +07:00 [INF] Message 30 already exists in Redis
2025-04-20 23:21:02.279 +07:00 [INF] Saved message 30 to Redis
2025-04-20 23:21:02.280 +07:00 [INF] Added message 30 to conversation 4
2025-04-20 23:21:02.280 +07:00 [INF] Saved message 29 to Redis
2025-04-20 23:21:02.280 +07:00 [INF] Saved message 29 to Redis
2025-04-20 23:21:02.280 +07:00 [INF] Message 29 already exists in Redis
2025-04-20 23:21:02.280 +07:00 [INF] Added message 29 to conversation 4
2025-04-20 23:21:02.280 +07:00 [INF] Added message 29 to conversation 4
2025-04-20 23:21:02.281 +07:00 [INF] Message 28 already exists in Redis
2025-04-20 23:21:02.281 +07:00 [INF] Message 28 already exists in Redis
2025-04-20 23:21:02.281 +07:00 [INF] Saved message 28 to Redis
2025-04-20 23:21:02.281 +07:00 [INF] Added message 28 to conversation 4
2025-04-20 23:21:02.282 +07:00 [INF] Saved message 27 to Redis
2025-04-20 23:21:02.282 +07:00 [INF] Saved message 27 to Redis
2025-04-20 23:21:02.282 +07:00 [INF] Message 27 already exists in Redis
2025-04-20 23:21:02.282 +07:00 [INF] Added message 27 to conversation 4
2025-04-20 23:21:02.282 +07:00 [INF] Added message 27 to conversation 4
2025-04-20 23:21:02.283 +07:00 [INF] Saved message 26 to Redis
2025-04-20 23:21:02.283 +07:00 [INF] Saved message 26 to Redis
2025-04-20 23:21:02.283 +07:00 [INF] Saved message 26 to Redis
2025-04-20 23:21:02.283 +07:00 [INF] Added message 26 to conversation 4
2025-04-20 23:21:02.284 +07:00 [INF] Added message 26 to conversation 4
2025-04-20 23:21:02.284 +07:00 [INF] Added message 26 to conversation 4
2025-04-20 23:21:02.285 +07:00 [INF] Message 25 already exists in Redis
2025-04-20 23:21:02.285 +07:00 [INF] Message 25 already exists in Redis
2025-04-20 23:21:02.285 +07:00 [INF] Saved message 25 to Redis
2025-04-20 23:21:02.286 +07:00 [INF] Added message 25 to conversation 4
2025-04-20 23:21:02.286 +07:00 [INF] Saved message 24 to Redis
2025-04-20 23:21:02.286 +07:00 [INF] Saved message 24 to Redis
2025-04-20 23:21:02.286 +07:00 [INF] Message 24 already exists in Redis
2025-04-20 23:21:02.286 +07:00 [INF] Added message 24 to conversation 4
2025-04-20 23:21:02.286 +07:00 [INF] Added message 24 to conversation 4
2025-04-20 23:21:02.287 +07:00 [INF] Message 23 already exists in Redis
2025-04-20 23:21:02.287 +07:00 [INF] Message 23 already exists in Redis
2025-04-20 23:21:02.287 +07:00 [INF] Saved message 23 to Redis
2025-04-20 23:21:02.287 +07:00 [INF] Added message 23 to conversation 4
2025-04-20 23:21:02.288 +07:00 [INF] Saved message 22 to Redis
2025-04-20 23:21:02.288 +07:00 [INF] Message 22 already exists in Redis
2025-04-20 23:21:02.288 +07:00 [INF] Saved message 22 to Redis
2025-04-20 23:21:02.288 +07:00 [INF] Added message 22 to conversation 4
2025-04-20 23:21:02.288 +07:00 [INF] Added message 22 to conversation 4
2025-04-20 23:21:02.289 +07:00 [INF] Message 21 already exists in Redis
2025-04-20 23:21:02.289 +07:00 [INF] Message 21 already exists in Redis
2025-04-20 23:21:02.289 +07:00 [INF] Saved message 21 to Redis
2025-04-20 23:21:02.289 +07:00 [INF] Added message 21 to conversation 4
2025-04-20 23:21:02.290 +07:00 [INF] Saved message 20 to Redis
2025-04-20 23:21:02.290 +07:00 [INF] Saved message 20 to Redis
2025-04-20 23:21:02.290 +07:00 [INF] Message 20 already exists in Redis
2025-04-20 23:21:02.290 +07:00 [INF] Added message 20 to conversation 4
2025-04-20 23:21:02.290 +07:00 [INF] Added message 20 to conversation 4
2025-04-20 23:21:02.290 +07:00 [INF] Message 19 already exists in Redis
2025-04-20 23:21:02.290 +07:00 [INF] Message 19 already exists in Redis
2025-04-20 23:21:02.291 +07:00 [INF] Saved message 19 to Redis
2025-04-20 23:21:02.291 +07:00 [INF] Added message 19 to conversation 4
2025-04-20 23:21:02.291 +07:00 [INF] Saved message 18 to Redis
2025-04-20 23:21:02.291 +07:00 [INF] Saved message 18 to Redis
2025-04-20 23:21:02.291 +07:00 [INF] Message 18 already exists in Redis
2025-04-20 23:21:02.292 +07:00 [INF] Added message 18 to conversation 4
2025-04-20 23:21:02.292 +07:00 [INF] Added message 18 to conversation 4
2025-04-20 23:21:02.292 +07:00 [INF] Message 17 already exists in Redis
2025-04-20 23:21:02.292 +07:00 [INF] Message 17 already exists in Redis
2025-04-20 23:21:02.292 +07:00 [INF] Saved message 17 to Redis
2025-04-20 23:21:02.293 +07:00 [INF] Added message 17 to conversation 4
2025-04-20 23:21:02.293 +07:00 [INF] Saved message 16 to Redis
2025-04-20 23:21:02.293 +07:00 [INF] Saved message 16 to Redis
2025-04-20 23:21:02.293 +07:00 [INF] Message 16 already exists in Redis
2025-04-20 23:21:02.293 +07:00 [INF] Added message 16 to conversation 4
2025-04-20 23:21:02.293 +07:00 [INF] Added message 16 to conversation 4
2025-04-20 23:21:02.294 +07:00 [INF] Message 15 already exists in Redis
2025-04-20 23:21:02.294 +07:00 [INF] Message 15 already exists in Redis
2025-04-20 23:21:02.294 +07:00 [INF] Saved message 15 to Redis
2025-04-20 23:21:02.294 +07:00 [INF] Added message 15 to conversation 4
2025-04-20 23:21:02.295 +07:00 [INF] Message 14 already exists in Redis
2025-04-20 23:21:02.295 +07:00 [INF] Saved message 14 to Redis
2025-04-20 23:21:02.295 +07:00 [INF] Saved message 14 to Redis
2025-04-20 23:21:02.295 +07:00 [INF] Added message 14 to conversation 4
2025-04-20 23:21:02.295 +07:00 [INF] Added message 14 to conversation 4
2025-04-20 23:21:02.296 +07:00 [INF] Saved message 13 to Redis
2025-04-20 23:21:02.296 +07:00 [INF] Message 13 already exists in Redis
2025-04-20 23:21:02.296 +07:00 [INF] Message 13 already exists in Redis
2025-04-20 23:21:02.296 +07:00 [INF] Added message 13 to conversation 4
2025-04-20 23:21:02.296 +07:00 [INF] Saved message 12 to Redis
2025-04-20 23:21:02.296 +07:00 [INF] Saved message 12 to Redis
2025-04-20 23:21:02.297 +07:00 [INF] Saved message 12 to Redis
2025-04-20 23:21:02.297 +07:00 [INF] Added message 12 to conversation 4
2025-04-20 23:21:02.297 +07:00 [INF] Added message 12 to conversation 4
2025-04-20 23:21:02.297 +07:00 [INF] Added message 12 to conversation 4
2025-04-20 23:21:02.298 +07:00 [INF] Saved message 10 to Redis
2025-04-20 23:21:02.298 +07:00 [INF] Saved message 10 to Redis
2025-04-20 23:21:02.298 +07:00 [INF] Saved message 10 to Redis
2025-04-20 23:21:02.298 +07:00 [INF] Added message 10 to conversation 4
2025-04-20 23:21:02.298 +07:00 [INF] Added message 10 to conversation 4
2025-04-20 23:21:02.298 +07:00 [INF] Added message 10 to conversation 4
2025-04-20 23:21:02.300 +07:00 [INF] Saved message 7 to Redis
2025-04-20 23:21:02.300 +07:00 [INF] Saved message 7 to Redis
2025-04-20 23:21:02.300 +07:00 [INF] Saved message 7 to Redis
2025-04-20 23:21:02.300 +07:00 [INF] Added message 7 to conversation 4
2025-04-20 23:21:02.300 +07:00 [INF] Added message 7 to conversation 4
2025-04-20 23:21:02.300 +07:00 [INF] Added message 7 to conversation 4
2025-04-20 23:21:02.302 +07:00 [INF] Saved message 6 to Redis
2025-04-20 23:21:02.302 +07:00 [INF] Saved message 6 to Redis
2025-04-20 23:21:02.302 +07:00 [INF] Saved message 6 to Redis
2025-04-20 23:21:02.302 +07:00 [INF] Added message 6 to conversation 4
2025-04-20 23:21:02.302 +07:00 [INF] Added message 6 to conversation 4
2025-04-20 23:21:02.302 +07:00 [INF] Added message 6 to conversation 4
2025-04-20 23:21:02.303 +07:00 [INF] Saved message 5 to Redis
2025-04-20 23:21:02.303 +07:00 [INF] Saved message 5 to Redis
2025-04-20 23:21:02.303 +07:00 [INF] Saved message 5 to Redis
2025-04-20 23:21:02.304 +07:00 [INF] Added message 5 to conversation 4
2025-04-20 23:21:02.304 +07:00 [INF] Added message 5 to conversation 4
2025-04-20 23:21:02.304 +07:00 [INF] Added message 5 to conversation 4
2025-04-20 23:21:06.560 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/api/Message/getMessages/1/5 - null null
2025-04-20 23:21:06.567 +07:00 [INF] Executing endpoint 'server.Controllers.MessageController.GetMessages (Message_app)'
2025-04-20 23:21:06.587 +07:00 [INF] Route matched with {action = "GetMessages", controller = "Message"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetMessages(Int32, Int32) on controller server.Controllers.MessageController (Message_app).
2025-04-20 23:21:06.639 +07:00 [INF] Retrieved 27 messages from Redis for conversation 1
2025-04-20 23:21:06.641 +07:00 [INF] Retrieved 27 messages from Redis for conversation 1 and user 5
2025-04-20 23:21:06.647 +07:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[server.DTO.MessageWithAttachment, Message_app, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-04-20 23:21:06.674 +07:00 [INF] Executed action server.Controllers.MessageController.GetMessages (Message_app) in 84.6089ms
2025-04-20 23:21:06.676 +07:00 [INF] Executed endpoint 'server.Controllers.MessageController.GetMessages (Message_app)'
2025-04-20 23:21:06.680 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5053/api/Message/getMessages/1/5 - 200 null application/json; charset=utf-8 119.5477ms
2025-04-20 23:21:08.545 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/api/Message/getMessages/1/5 - null null
2025-04-20 23:21:08.547 +07:00 [INF] Executing endpoint 'server.Controllers.MessageController.GetMessages (Message_app)'
2025-04-20 23:21:08.547 +07:00 [INF] Route matched with {action = "GetMessages", controller = "Message"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetMessages(Int32, Int32) on controller server.Controllers.MessageController (Message_app).
2025-04-20 23:21:08.579 +07:00 [INF] Retrieved 27 messages from Redis for conversation 1
2025-04-20 23:21:08.580 +07:00 [INF] Retrieved 27 messages from Redis for conversation 1 and user 5
2025-04-20 23:21:08.581 +07:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[server.DTO.MessageWithAttachment, Message_app, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-04-20 23:21:08.583 +07:00 [INF] Executed action server.Controllers.MessageController.GetMessages (Message_app) in 36.3173ms
2025-04-20 23:21:08.584 +07:00 [INF] Executed endpoint 'server.Controllers.MessageController.GetMessages (Message_app)'
2025-04-20 23:21:08.589 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5053/api/Message/getMessages/1/5 - 200 null application/json; charset=utf-8 43.6265ms
2025-04-20 23:21:09.571 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/api/Message/getMessages/1/5 - null null
2025-04-20 23:21:09.572 +07:00 [INF] Executing endpoint 'server.Controllers.MessageController.GetMessages (Message_app)'
2025-04-20 23:21:09.572 +07:00 [INF] Route matched with {action = "GetMessages", controller = "Message"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetMessages(Int32, Int32) on controller server.Controllers.MessageController (Message_app).
2025-04-20 23:21:09.598 +07:00 [INF] Retrieved 27 messages from Redis for conversation 1
2025-04-20 23:21:09.598 +07:00 [INF] Retrieved 27 messages from Redis for conversation 1 and user 5
2025-04-20 23:21:09.599 +07:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[server.DTO.MessageWithAttachment, Message_app, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-04-20 23:21:09.601 +07:00 [INF] Executed action server.Controllers.MessageController.GetMessages (Message_app) in 28.6408ms
2025-04-20 23:21:09.601 +07:00 [INF] Executed endpoint 'server.Controllers.MessageController.GetMessages (Message_app)'
2025-04-20 23:21:09.602 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5053/api/Message/getMessages/1/5 - 200 null application/json; charset=utf-8 30.1665ms
2025-04-20 23:21:21.041 +07:00 [INF] Request starting HTTP/1.1 GET http://192.168.1.3:5053/ws/chat - null null
2025-04-20 23:21:21.042 +07:00 [INF] Executing endpoint '/ws/chat'
2025-04-20 23:21:21.105 +07:00 [INF] Request starting HTTP/1.1 GET http://192.168.1.3:5053/api/Message/getMessages/1/5 - null null
2025-04-20 23:21:21.106 +07:00 [INF] Executing endpoint 'server.Controllers.MessageController.GetMessages (Message_app)'
2025-04-20 23:21:21.106 +07:00 [INF] Route matched with {action = "GetMessages", controller = "Message"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetMessages(Int32, Int32) on controller server.Controllers.MessageController (Message_app).
2025-04-20 23:21:21.118 +07:00 [INF] Retrieved 27 messages from Redis for conversation 1
2025-04-20 23:21:21.119 +07:00 [INF] Retrieved 27 messages from Redis for conversation 1 and user 5
2025-04-20 23:21:21.120 +07:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[server.DTO.MessageWithAttachment, Message_app, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-04-20 23:21:21.123 +07:00 [INF] Executed action server.Controllers.MessageController.GetMessages (Message_app) in 16.3245ms
2025-04-20 23:21:21.123 +07:00 [INF] Executed endpoint 'server.Controllers.MessageController.GetMessages (Message_app)'
2025-04-20 23:21:21.124 +07:00 [INF] Request finished HTTP/1.1 GET http://192.168.1.3:5053/api/Message/getMessages/1/5 - 200 null application/json; charset=utf-8 18.7461ms
2025-04-20 23:21:21.162 +07:00 [INF] Executed DbCommand (4ms) [Parameters=[@__client_UserId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[conversation_id]
FROM [Participants] AS [p]
WHERE [p].[user_id] = @__client_UserId_0 AND [p].[is_deleted] = CAST(0 AS bit)
2025-04-20 23:21:21.304 +07:00 [INF] Request starting HTTP/1.1 GET http://192.168.1.3:5053/api/Conversation/get_first_conversation/1 - null null
2025-04-20 23:21:21.304 +07:00 [INF] Executing endpoint 'server.Controllers.ConversationController.GetFirstConversation (Message_app)'
2025-04-20 23:21:21.313 +07:00 [INF] Route matched with {action = "GetFirstConversation", controller = "Conversation"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetFirstConversation(Int32) on controller server.Controllers.ConversationController (Message_app).
2025-04-20 23:21:21.448 +07:00 [INF] Executed DbCommand (8ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[id], [c].[created_at], [c].[is_group], [c].[lastMessage], [c].[lastMessageSender], [c].[lastMessageTime], [c].[name]
FROM [Conversations] AS [c]
WHERE [c].[id] = @__p_0
2025-04-20 23:21:21.568 +07:00 [INF] Executing OkObjectResult, writing value of type 'server.Models.Conversation'.
2025-04-20 23:21:21.622 +07:00 [INF] Executed action server.Controllers.ConversationController.GetFirstConversation (Message_app) in 308.9537ms
2025-04-20 23:21:21.622 +07:00 [INF] Executed endpoint 'server.Controllers.ConversationController.GetFirstConversation (Message_app)'
2025-04-20 23:21:21.627 +07:00 [INF] Request finished HTTP/1.1 GET http://192.168.1.3:5053/api/Conversation/get_first_conversation/1 - 200 null application/json; charset=utf-8 322.8075ms
2025-04-20 23:21:21.710 +07:00 [INF] Request starting HTTP/1.1 GET http://192.168.1.3:5053/api/Participant/get_participants/1 - null null
2025-04-20 23:21:21.710 +07:00 [INF] Executing endpoint 'server.Controllers.ParticipantController.GetParticipants (Message_app)'
2025-04-20 23:21:21.715 +07:00 [INF] Route matched with {action = "GetParticipants", controller = "Participant"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetParticipants(Int32) on controller server.Controllers.ParticipantController (Message_app).
2025-04-20 23:21:21.731 +07:00 [INF] Executed DbCommand (4ms) [Parameters=[@__conversation_id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[id], [p].[conversation_id], [p].[is_deleted], [p].[joined_at], [p].[name], [p].[role], [p].[user_id]
FROM [Participants] AS [p]
WHERE [p].[conversation_id] = @__conversation_id_0
2025-04-20 23:21:21.752 +07:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType16`1[[System.Collections.Generic.List`1[[server.Models.Participants, Message_app, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-04-20 23:21:21.774 +07:00 [INF] Executed action server.Controllers.ParticipantController.GetParticipants (Message_app) in 58.9094ms
2025-04-20 23:21:21.774 +07:00 [INF] Executed endpoint 'server.Controllers.ParticipantController.GetParticipants (Message_app)'
2025-04-20 23:21:21.774 +07:00 [INF] Request finished HTTP/1.1 GET http://192.168.1.3:5053/api/Participant/get_participants/1 - 200 null application/json; charset=utf-8 64.689ms
2025-04-20 23:21:41.358 +07:00 [INF] Request starting HTTP/1.1 GET http://192.168.1.3:5053/api/Participant/get_participants/1 - null null
2025-04-20 23:21:41.359 +07:00 [INF] Executing endpoint 'server.Controllers.ParticipantController.GetParticipants (Message_app)'
2025-04-20 23:21:41.359 +07:00 [INF] Route matched with {action = "GetParticipants", controller = "Participant"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetParticipants(Int32) on controller server.Controllers.ParticipantController (Message_app).
2025-04-20 23:21:41.367 +07:00 [INF] Executed DbCommand (5ms) [Parameters=[@__conversation_id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[id], [p].[conversation_id], [p].[is_deleted], [p].[joined_at], [p].[name], [p].[role], [p].[user_id]
FROM [Participants] AS [p]
WHERE [p].[conversation_id] = @__conversation_id_0
2025-04-20 23:21:41.369 +07:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType16`1[[System.Collections.Generic.List`1[[server.Models.Participants, Message_app, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-04-20 23:21:41.370 +07:00 [INF] Executed action server.Controllers.ParticipantController.GetParticipants (Message_app) in 10.4277ms
2025-04-20 23:21:41.370 +07:00 [INF] Executed endpoint 'server.Controllers.ParticipantController.GetParticipants (Message_app)'
2025-04-20 23:21:41.370 +07:00 [INF] Request finished HTTP/1.1 GET http://192.168.1.3:5053/api/Participant/get_participants/1 - 200 null application/json; charset=utf-8 12.7964ms
2025-04-20 23:21:59.326 +07:00 [INF] Request starting HTTP/1.1 DELETE http://192.168.1.3:5053/api/Message/DeleteMessageForMe/1/5 - null null
2025-04-20 23:21:59.326 +07:00 [INF] Executing endpoint 'server.Controllers.MessageController.DeleteMessageConversationForMe (Message_app)'
2025-04-20 23:21:59.329 +07:00 [INF] Route matched with {action = "DeleteMessageConversationForMe", controller = "Message"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] DeleteMessageConversationForMe(Int32, Int32) on controller server.Controllers.MessageController (Message_app).
2025-04-20 23:21:59.336 +07:00 [INF] Executed DbCommand (4ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[id], [c].[created_at], [c].[is_group], [c].[lastMessage], [c].[lastMessageSender], [c].[lastMessageTime], [c].[name]
FROM [Conversations] AS [c]
WHERE [c].[id] = @__p_0
2025-04-20 23:21:59.349 +07:00 [INF] Executed DbCommand (5ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[id], [u].[avatar_url], [u].[bio], [u].[birthday], [u].[created_at], [u].[email], [u].[gender], [u].[interests], [u].[location], [u].[password], [u].[passwordSalt], [u].[username]
FROM [Users] AS [u]
WHERE [u].[id] = @__p_0
2025-04-20 23:21:59.394 +07:00 [INF] Executed DbCommand (6ms) [Parameters=[@__user_id_0='?' (DbType = Int32), @__conversation_id_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[id], [m].[cleared_at], [m].[conversation_id], [m].[user_id]
FROM [messageDeletions] AS [m]
WHERE [m].[user_id] = @__user_id_0 AND [m].[conversation_id] = @__conversation_id_1
2025-04-20 23:21:59.521 +07:00 [INF] Executed DbCommand (32ms) [Parameters=[@p0='?' (DbType = DateTime2), @p1='?' (DbType = Int32), @p2='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [messageDeletions] ([cleared_at], [conversation_id], [user_id])
OUTPUT INSERTED.[id]
VALUES (@p0, @p1, @p2);
2025-04-20 23:21:59.544 +07:00 [INF] Deleted message 1 from Redis
2025-04-20 23:21:59.544 +07:00 [INF] Deleted all messages for conversation 1 from Redis
2025-04-20 23:21:59.545 +07:00 [INF] Deleted message 2 from Redis
2025-04-20 23:21:59.545 +07:00 [INF] Deleted all messages for conversation 1 from Redis
2025-04-20 23:21:59.545 +07:00 [INF] Deleted message 3 from Redis
2025-04-20 23:21:59.545 +07:00 [INF] Deleted all messages for conversation 1 from Redis
2025-04-20 23:21:59.545 +07:00 [INF] Deleted message 8 from Redis
2025-04-20 23:21:59.546 +07:00 [INF] Deleted all messages for conversation 1 from Redis
2025-04-20 23:21:59.546 +07:00 [INF] Deleted message 11 from Redis
2025-04-20 23:21:59.546 +07:00 [INF] Deleted all messages for conversation 1 from Redis
2025-04-20 23:21:59.546 +07:00 [INF] Deleted message 49 from Redis
2025-04-20 23:21:59.546 +07:00 [INF] Deleted all messages for conversation 1 from Redis
2025-04-20 23:21:59.546 +07:00 [INF] Deleted message 51 from Redis
2025-04-20 23:21:59.547 +07:00 [INF] Deleted all messages for conversation 1 from Redis
2025-04-20 23:21:59.547 +07:00 [INF] Deleted message 54 from Redis
2025-04-20 23:21:59.547 +07:00 [INF] Deleted all messages for conversation 1 from Redis
2025-04-20 23:21:59.547 +07:00 [INF] Deleted message 55 from Redis
2025-04-20 23:21:59.547 +07:00 [INF] Deleted all messages for conversation 1 from Redis
2025-04-20 23:21:59.547 +07:00 [INF] Deleted message 57 from Redis
2025-04-20 23:21:59.547 +07:00 [INF] Deleted all messages for conversation 1 from Redis
2025-04-20 23:21:59.548 +07:00 [INF] Deleted message 59 from Redis
2025-04-20 23:21:59.548 +07:00 [INF] Deleted all messages for conversation 1 from Redis
2025-04-20 23:21:59.548 +07:00 [INF] Deleted message 60 from Redis
2025-04-20 23:21:59.548 +07:00 [INF] Deleted all messages for conversation 1 from Redis
2025-04-20 23:21:59.548 +07:00 [INF] Deleted message 61 from Redis
2025-04-20 23:21:59.549 +07:00 [INF] Deleted all messages for conversation 1 from Redis
2025-04-20 23:21:59.549 +07:00 [INF] Deleted message 62 from Redis
2025-04-20 23:21:59.549 +07:00 [INF] Deleted all messages for conversation 1 from Redis
2025-04-20 23:21:59.549 +07:00 [INF] Deleted message 64 from Redis
2025-04-20 23:21:59.549 +07:00 [INF] Deleted all messages for conversation 1 from Redis
2025-04-20 23:21:59.549 +07:00 [INF] Deleted message 68 from Redis
2025-04-20 23:21:59.550 +07:00 [INF] Deleted all messages for conversation 1 from Redis
2025-04-20 23:21:59.550 +07:00 [INF] Deleted message 71 from Redis
2025-04-20 23:21:59.551 +07:00 [INF] Deleted all messages for conversation 1 from Redis
2025-04-20 23:21:59.551 +07:00 [INF] Deleted message 72 from Redis
2025-04-20 23:21:59.551 +07:00 [INF] Deleted all messages for conversation 1 from Redis
2025-04-20 23:21:59.552 +07:00 [INF] Deleted message 73 from Redis
2025-04-20 23:21:59.553 +07:00 [INF] Deleted all messages for conversation 1 from Redis
2025-04-20 23:21:59.553 +07:00 [INF] Deleted message 74 from Redis
2025-04-20 23:21:59.553 +07:00 [INF] Deleted all messages for conversation 1 from Redis
2025-04-20 23:21:59.553 +07:00 [INF] Deleted message 75 from Redis
2025-04-20 23:21:59.554 +07:00 [INF] Deleted all messages for conversation 1 from Redis
2025-04-20 23:21:59.554 +07:00 [INF] Deleted message 76 from Redis
2025-04-20 23:21:59.554 +07:00 [INF] Deleted all messages for conversation 1 from Redis
2025-04-20 23:21:59.555 +07:00 [INF] Deleted message 77 from Redis
2025-04-20 23:21:59.556 +07:00 [INF] Deleted all messages for conversation 1 from Redis
2025-04-20 23:21:59.556 +07:00 [INF] Deleted message 78 from Redis
2025-04-20 23:21:59.556 +07:00 [INF] Deleted all messages for conversation 1 from Redis
2025-04-20 23:21:59.557 +07:00 [INF] Deleted message 79 from Redis
2025-04-20 23:21:59.557 +07:00 [INF] Deleted all messages for conversation 1 from Redis
2025-04-20 23:21:59.558 +07:00 [INF] Deleted message 80 from Redis
2025-04-20 23:21:59.558 +07:00 [INF] Deleted all messages for conversation 1 from Redis
2025-04-20 23:21:59.558 +07:00 [INF] Deleted message 81 from Redis
2025-04-20 23:21:59.558 +07:00 [INF] Deleted all messages for conversation 1 from Redis
2025-04-20 23:21:59.559 +07:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType12`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-04-20 23:21:59.560 +07:00 [INF] Executed action server.Controllers.MessageController.DeleteMessageConversationForMe (Message_app) in 231.4084ms
2025-04-20 23:21:59.561 +07:00 [INF] Executed endpoint 'server.Controllers.MessageController.DeleteMessageConversationForMe (Message_app)'
2025-04-20 23:21:59.561 +07:00 [INF] Request finished HTTP/1.1 DELETE http://192.168.1.3:5053/api/Message/DeleteMessageForMe/1/5 - 200 null application/json; charset=utf-8 235.0572ms
2025-04-20 23:22:12.683 +07:00 [INF] Request starting HTTP/1.1 GET http://192.168.1.3:5053/ws/chat - null null
2025-04-20 23:22:12.683 +07:00 [INF] Executing endpoint '/ws/chat'
2025-04-20 23:22:12.713 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[@__client_UserId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[conversation_id]
FROM [Participants] AS [p]
WHERE [p].[user_id] = @__client_UserId_0 AND [p].[is_deleted] = CAST(0 AS bit)
2025-04-20 23:22:12.720 +07:00 [INF] Executed DbCommand (5ms) [Parameters=[@__p_1='?' (DbType = Int32), @__conversationId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(@__p_1) [m].[id], [m].[conversation_id], [m].[sender_id], [m].[content], [m].[created_at], [m].[isFile], [m].[type], [m].[isRecalled]
FROM [Messages] AS [m]
WHERE [m].[conversation_id] = @__conversationId_0
ORDER BY [m].[created_at] DESC
2025-04-20 23:22:12.722 +07:00 [INF] Saved message 81 to Redis
2025-04-20 23:22:12.723 +07:00 [INF] Added message 81 to conversation 1
2025-04-20 23:22:12.724 +07:00 [INF] Saved message 80 to Redis
2025-04-20 23:22:12.724 +07:00 [INF] Added message 80 to conversation 1
2025-04-20 23:22:12.725 +07:00 [INF] Saved message 79 to Redis
2025-04-20 23:22:12.725 +07:00 [INF] Added message 79 to conversation 1
2025-04-20 23:22:12.726 +07:00 [INF] Saved message 78 to Redis
2025-04-20 23:22:12.727 +07:00 [INF] Added message 78 to conversation 1
2025-04-20 23:22:12.728 +07:00 [INF] Saved message 77 to Redis
2025-04-20 23:22:12.728 +07:00 [INF] Added message 77 to conversation 1
2025-04-20 23:22:12.729 +07:00 [INF] Saved message 76 to Redis
2025-04-20 23:22:12.729 +07:00 [INF] Added message 76 to conversation 1
2025-04-20 23:22:12.730 +07:00 [INF] Saved message 75 to Redis
2025-04-20 23:22:12.730 +07:00 [INF] Added message 75 to conversation 1
2025-04-20 23:22:12.731 +07:00 [INF] Saved message 74 to Redis
2025-04-20 23:22:12.731 +07:00 [INF] Added message 74 to conversation 1
2025-04-20 23:22:12.732 +07:00 [INF] Saved message 73 to Redis
2025-04-20 23:22:12.732 +07:00 [INF] Added message 73 to conversation 1
2025-04-20 23:22:12.733 +07:00 [INF] Saved message 72 to Redis
2025-04-20 23:22:12.733 +07:00 [INF] Added message 72 to conversation 1
2025-04-20 23:22:12.734 +07:00 [INF] Saved message 71 to Redis
2025-04-20 23:22:12.734 +07:00 [INF] Added message 71 to conversation 1
2025-04-20 23:22:12.735 +07:00 [INF] Saved message 68 to Redis
2025-04-20 23:22:12.736 +07:00 [INF] Added message 68 to conversation 1
2025-04-20 23:22:12.737 +07:00 [INF] Saved message 64 to Redis
2025-04-20 23:22:12.737 +07:00 [INF] Added message 64 to conversation 1
2025-04-20 23:22:12.738 +07:00 [INF] Saved message 62 to Redis
2025-04-20 23:22:12.738 +07:00 [INF] Added message 62 to conversation 1
2025-04-20 23:22:12.739 +07:00 [INF] Saved message 61 to Redis
2025-04-20 23:22:12.740 +07:00 [INF] Added message 61 to conversation 1
2025-04-20 23:22:12.740 +07:00 [INF] Saved message 60 to Redis
2025-04-20 23:22:12.740 +07:00 [INF] Added message 60 to conversation 1
2025-04-20 23:22:12.741 +07:00 [INF] Saved message 59 to Redis
2025-04-20 23:22:12.741 +07:00 [INF] Added message 59 to conversation 1
2025-04-20 23:22:12.742 +07:00 [INF] Request starting HTTP/1.1 GET http://192.168.1.3:5053/api/Message/getMessages/1/5 - null null
2025-04-20 23:22:12.742 +07:00 [INF] Executing endpoint 'server.Controllers.MessageController.GetMessages (Message_app)'
2025-04-20 23:22:12.742 +07:00 [INF] Route matched with {action = "GetMessages", controller = "Message"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetMessages(Int32, Int32) on controller server.Controllers.MessageController (Message_app).
2025-04-20 23:22:12.742 +07:00 [INF] Saved message 57 to Redis
2025-04-20 23:22:12.743 +07:00 [INF] Added message 57 to conversation 1
2025-04-20 23:22:12.744 +07:00 [INF] Saved message 55 to Redis
2025-04-20 23:22:12.744 +07:00 [INF] Retrieved 0 messages from Redis for conversation 1
2025-04-20 23:22:12.744 +07:00 [INF] Added message 55 to conversation 1
2025-04-20 23:22:12.746 +07:00 [INF] Saved message 54 to Redis
2025-04-20 23:22:12.746 +07:00 [INF] Added message 54 to conversation 1
2025-04-20 23:22:12.748 +07:00 [INF] Saved message 51 to Redis
2025-04-20 23:22:12.748 +07:00 [INF] Added message 51 to conversation 1
2025-04-20 23:22:12.749 +07:00 [INF] Saved message 49 to Redis
2025-04-20 23:22:12.750 +07:00 [INF] Added message 49 to conversation 1
2025-04-20 23:22:12.750 +07:00 [INF] Saved message 11 to Redis
2025-04-20 23:22:12.752 +07:00 [INF] Added message 11 to conversation 1
2025-04-20 23:22:12.753 +07:00 [INF] Saved message 8 to Redis
2025-04-20 23:22:12.753 +07:00 [INF] Added message 8 to conversation 1
2025-04-20 23:22:12.755 +07:00 [INF] Saved message 3 to Redis
2025-04-20 23:22:12.755 +07:00 [INF] Added message 3 to conversation 1
2025-04-20 23:22:12.757 +07:00 [INF] Saved message 2 to Redis
2025-04-20 23:22:12.757 +07:00 [INF] Added message 2 to conversation 1
2025-04-20 23:22:12.758 +07:00 [INF] Saved message 1 to Redis
2025-04-20 23:22:12.759 +07:00 [INF] Added message 1 to conversation 1
2025-04-20 23:22:12.779 +07:00 [INF] Executed DbCommand (21ms) [Parameters=[@__user_id_0='?' (DbType = Int32), @__conversationId_1='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[cleared_at]
FROM [messageDeletions] AS [m]
WHERE [m].[user_id] = @__user_id_0 AND CAST([m].[conversation_id] AS bigint) = @__conversationId_1
2025-04-20 23:22:12.856 +07:00 [INF] Executed DbCommand (25ms) [Parameters=[@__p_2='?' (DbType = Int32), @__conversationId_0='?' (DbType = Int64), @__clearedAt_1='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[id], [t].[content], [t].[conversation_id], [t].[created_at], [t].[isFile], [t].[isRecalled], [t].[is_read], [t].[sender_id], [t].[type], [a].[id], [a].[FileSize], [a].[file_type], [a].[file_url], [a].[is_temporary], [a].[message_id], [a].[uploaded_at]
FROM (
    SELECT TOP(@__p_2) [m].[id], [m].[content], [m].[conversation_id], [m].[created_at], [m].[isFile], [m].[isRecalled], [m].[is_read], [m].[sender_id], [m].[type]
    FROM [Messages] AS [m]
    WHERE CAST([m].[conversation_id] AS bigint) = @__conversationId_0 AND [m].[created_at] > @__clearedAt_1
    ORDER BY [m].[created_at] DESC
) AS [t]
LEFT JOIN [Attachments] AS [a] ON [t].[id] = [a].[message_id]
ORDER BY [t].[created_at] DESC, [t].[id]
2025-04-20 23:22:12.867 +07:00 [INF] Message 81 already exists in Redis
2025-04-20 23:22:12.868 +07:00 [INF] Message 80 already exists in Redis
2025-04-20 23:22:12.868 +07:00 [INF] Message 79 already exists in Redis
2025-04-20 23:22:12.868 +07:00 [INF] Message 78 already exists in Redis
2025-04-20 23:22:12.869 +07:00 [INF] Message 77 already exists in Redis
2025-04-20 23:22:12.870 +07:00 [INF] Message 76 already exists in Redis
2025-04-20 23:22:12.870 +07:00 [INF] Cached 6 messages to Redis for conversation 1
2025-04-20 23:22:12.870 +07:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[server.DTO.MessageWithAttachment, Message_app, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-04-20 23:22:12.870 +07:00 [INF] Executed action server.Controllers.MessageController.GetMessages (Message_app) in 127.8054ms
2025-04-20 23:22:12.870 +07:00 [INF] Executed endpoint 'server.Controllers.MessageController.GetMessages (Message_app)'
2025-04-20 23:22:12.871 +07:00 [INF] Request finished HTTP/1.1 GET http://192.168.1.3:5053/api/Message/getMessages/1/5 - 200 null application/json; charset=utf-8 128.7861ms
2025-04-20 23:22:12.960 +07:00 [INF] Request starting HTTP/1.1 GET http://192.168.1.3:5053/api/Conversation/get_first_conversation/1 - null null
2025-04-20 23:22:12.961 +07:00 [INF] Executing endpoint 'server.Controllers.ConversationController.GetFirstConversation (Message_app)'
2025-04-20 23:22:12.961 +07:00 [INF] Route matched with {action = "GetFirstConversation", controller = "Conversation"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetFirstConversation(Int32) on controller server.Controllers.ConversationController (Message_app).
2025-04-20 23:22:12.963 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[id], [c].[created_at], [c].[is_group], [c].[lastMessage], [c].[lastMessageSender], [c].[lastMessageTime], [c].[name]
FROM [Conversations] AS [c]
WHERE [c].[id] = @__p_0
2025-04-20 23:22:12.963 +07:00 [INF] Executing OkObjectResult, writing value of type 'server.Models.Conversation'.
2025-04-20 23:22:12.964 +07:00 [INF] Executed action server.Controllers.ConversationController.GetFirstConversation (Message_app) in 2.6654ms
2025-04-20 23:22:12.964 +07:00 [INF] Executed endpoint 'server.Controllers.ConversationController.GetFirstConversation (Message_app)'
2025-04-20 23:22:12.964 +07:00 [INF] Request finished HTTP/1.1 GET http://192.168.1.3:5053/api/Conversation/get_first_conversation/1 - 200 null application/json; charset=utf-8 4.0675ms
2025-04-20 23:22:13.011 +07:00 [INF] Request starting HTTP/1.1 GET http://192.168.1.3:5053/api/Participant/get_participants/1 - null null
2025-04-20 23:22:13.011 +07:00 [INF] Executing endpoint 'server.Controllers.ParticipantController.GetParticipants (Message_app)'
2025-04-20 23:22:13.011 +07:00 [INF] Route matched with {action = "GetParticipants", controller = "Participant"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetParticipants(Int32) on controller server.Controllers.ParticipantController (Message_app).
2025-04-20 23:22:13.016 +07:00 [INF] Executed DbCommand (4ms) [Parameters=[@__conversation_id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[id], [p].[conversation_id], [p].[is_deleted], [p].[joined_at], [p].[name], [p].[role], [p].[user_id]
FROM [Participants] AS [p]
WHERE [p].[conversation_id] = @__conversation_id_0
2025-04-20 23:22:13.017 +07:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType16`1[[System.Collections.Generic.List`1[[server.Models.Participants, Message_app, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-04-20 23:22:13.017 +07:00 [INF] Executed action server.Controllers.ParticipantController.GetParticipants (Message_app) in 5.3215ms
2025-04-20 23:22:13.017 +07:00 [INF] Executed endpoint 'server.Controllers.ParticipantController.GetParticipants (Message_app)'
2025-04-20 23:22:13.017 +07:00 [INF] Request finished HTTP/1.1 GET http://192.168.1.3:5053/api/Participant/get_participants/1 - 200 null application/json; charset=utf-8 5.9984ms
2025-04-20 23:24:10.632 +07:00 [INF] Request starting HTTP/1.1 POST http://192.168.1.3:5053/api/Auth/login - application/json 57
2025-04-20 23:24:10.639 +07:00 [INF] Executing endpoint 'Message_app.Controllers.AuthController.Login (Message_app)'
2025-04-20 23:24:10.669 +07:00 [INF] Route matched with {action = "Login", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Login(server.DTO.AuthDTO.LoginDTO) on controller Message_app.Controllers.AuthController (Message_app).
2025-04-20 23:24:10.845 +07:00 [INF] Executed DbCommand (46ms) [Parameters=[@__email_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[id], [u].[avatar_url], [u].[bio], [u].[birthday], [u].[created_at], [u].[email], [u].[gender], [u].[interests], [u].[location], [u].[password], [u].[passwordSalt], [u].[username]
FROM [Users] AS [u]
WHERE [u].[email] = @__email_0
2025-04-20 23:24:10.910 +07:00 [INF] Executing OkObjectResult, writing value of type 'server.DTO.AuthDTO.LoginRespose'.
2025-04-20 23:24:10.941 +07:00 [INF] Executed action Message_app.Controllers.AuthController.Login (Message_app) in 272.6043ms
2025-04-20 23:24:10.942 +07:00 [INF] Executed endpoint 'Message_app.Controllers.AuthController.Login (Message_app)'
2025-04-20 23:24:10.943 +07:00 [INF] Request finished HTTP/1.1 POST http://192.168.1.3:5053/api/Auth/login - 200 null application/json; charset=utf-8 312.556ms
2025-04-20 23:24:12.134 +07:00 [INF] Request starting HTTP/1.1 GET http://192.168.1.3:5053/api/Conversation/get_conversations/2 - null null
2025-04-20 23:24:12.135 +07:00 [INF] Request starting HTTP/1.1 GET http://192.168.1.3:5053/api/Conversation/get_conversations/2 - null null
2025-04-20 23:24:12.137 +07:00 [INF] Executing endpoint 'server.Controllers.ConversationController.GetConversations (Message_app)'
2025-04-20 23:24:12.139 +07:00 [INF] Executing endpoint 'server.Controllers.ConversationController.GetConversations (Message_app)'
2025-04-20 23:24:12.147 +07:00 [INF] Route matched with {action = "GetConversations", controller = "Conversation"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetConversations(Int32) on controller server.Controllers.ConversationController (Message_app).
2025-04-20 23:24:12.148 +07:00 [INF] Route matched with {action = "GetConversations", controller = "Conversation"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetConversations(Int32) on controller server.Controllers.ConversationController (Message_app).
2025-04-20 23:24:12.298 +07:00 [INF] Executed DbCommand (41ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[id], [c].[name], [c].[is_group], [c].[created_at], [c].[lastMessage], [c].[lastMessageTime], [t].[Id], [t].[UserId], [t].[ConversationId], [t].[Name], [t].[IsDeleted]
FROM [Conversations] AS [c]
LEFT JOIN (
    SELECT [p0].[id] AS [Id], [p0].[user_id] AS [UserId], [p0].[conversation_id] AS [ConversationId], [p0].[name] AS [Name], [p0].[is_deleted] AS [IsDeleted]
    FROM [Participants] AS [p0]
    WHERE [p0].[is_deleted] = CAST(0 AS bit)
) AS [t] ON [c].[id] = [t].[ConversationId]
WHERE EXISTS (
    SELECT 1
    FROM [Participants] AS [p]
    WHERE [c].[id] = [p].[conversation_id] AND [p].[user_id] = @__userId_0 AND [p].[is_deleted] = CAST(0 AS bit))
ORDER BY [c].[id]
2025-04-20 23:24:12.298 +07:00 [INF] Executed DbCommand (42ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[id], [c].[name], [c].[is_group], [c].[created_at], [c].[lastMessage], [c].[lastMessageTime], [t].[Id], [t].[UserId], [t].[ConversationId], [t].[Name], [t].[IsDeleted]
FROM [Conversations] AS [c]
LEFT JOIN (
    SELECT [p0].[id] AS [Id], [p0].[user_id] AS [UserId], [p0].[conversation_id] AS [ConversationId], [p0].[name] AS [Name], [p0].[is_deleted] AS [IsDeleted]
    FROM [Participants] AS [p0]
    WHERE [p0].[is_deleted] = CAST(0 AS bit)
) AS [t] ON [c].[id] = [t].[ConversationId]
WHERE EXISTS (
    SELECT 1
    FROM [Participants] AS [p]
    WHERE [c].[id] = [p].[conversation_id] AND [p].[user_id] = @__userId_0 AND [p].[is_deleted] = CAST(0 AS bit))
ORDER BY [c].[id]
2025-04-20 23:24:12.320 +07:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[server.DTO.ConversationDto, Message_app, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-04-20 23:24:12.320 +07:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[server.DTO.ConversationDto, Message_app, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-04-20 23:24:12.324 +07:00 [INF] Executed action server.Controllers.ConversationController.GetConversations (Message_app) in 176.6309ms
2025-04-20 23:24:12.324 +07:00 [INF] Executed endpoint 'server.Controllers.ConversationController.GetConversations (Message_app)'
2025-04-20 23:24:12.324 +07:00 [INF] Request finished HTTP/1.1 GET http://192.168.1.3:5053/api/Conversation/get_conversations/2 - 200 null application/json; charset=utf-8 190.1969ms
2025-04-20 23:24:12.325 +07:00 [INF] Executed action server.Controllers.ConversationController.GetConversations (Message_app) in 176.2095ms
2025-04-20 23:24:12.325 +07:00 [INF] Executed endpoint 'server.Controllers.ConversationController.GetConversations (Message_app)'
2025-04-20 23:24:12.326 +07:00 [INF] Request finished HTTP/1.1 GET http://192.168.1.3:5053/api/Conversation/get_conversations/2 - 200 null application/json; charset=utf-8 190.7576ms
2025-04-20 23:24:12.700 +07:00 [INF] Request starting HTTP/1.1 GET http://192.168.1.3:5053/ws/chat - null null
2025-04-20 23:24:12.702 +07:00 [INF] Executing endpoint '/ws/chat'
2025-04-20 23:24:12.778 +07:00 [INF] Executed DbCommand (4ms) [Parameters=[@__client_UserId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[conversation_id]
FROM [Participants] AS [p]
WHERE [p].[user_id] = @__client_UserId_0 AND [p].[is_deleted] = CAST(0 AS bit)
2025-04-20 23:24:12.792 +07:00 [INF] Executed DbCommand (10ms) [Parameters=[@__p_1='?' (DbType = Int32), @__conversationId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(@__p_1) [m].[id], [m].[conversation_id], [m].[sender_id], [m].[content], [m].[created_at], [m].[isFile], [m].[type], [m].[isRecalled]
FROM [Messages] AS [m]
WHERE [m].[conversation_id] = @__conversationId_0
ORDER BY [m].[created_at] DESC
2025-04-20 23:24:12.794 +07:00 [INF] Saved message 70 to Redis
2025-04-20 23:24:12.794 +07:00 [INF] Added message 70 to conversation 3
2025-04-20 23:24:12.795 +07:00 [INF] Saved message 65 to Redis
2025-04-20 23:24:12.796 +07:00 [INF] Added message 65 to conversation 3
2025-04-20 23:24:12.797 +07:00 [INF] Saved message 48 to Redis
2025-04-20 23:24:12.797 +07:00 [INF] Added message 48 to conversation 3
2025-04-20 23:24:16.282 +07:00 [INF] Request starting HTTP/1.1 GET http://192.168.1.3:5053/api/Participant/get_participants/1 - null null
2025-04-20 23:24:16.282 +07:00 [INF] Executing endpoint 'server.Controllers.ParticipantController.GetParticipants (Message_app)'
2025-04-20 23:24:16.283 +07:00 [INF] Route matched with {action = "GetParticipants", controller = "Participant"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetParticipants(Int32) on controller server.Controllers.ParticipantController (Message_app).
2025-04-20 23:24:16.290 +07:00 [INF] Executed DbCommand (5ms) [Parameters=[@__conversation_id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[id], [p].[conversation_id], [p].[is_deleted], [p].[joined_at], [p].[name], [p].[role], [p].[user_id]
FROM [Participants] AS [p]
WHERE [p].[conversation_id] = @__conversation_id_0
2025-04-20 23:24:16.290 +07:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType16`1[[System.Collections.Generic.List`1[[server.Models.Participants, Message_app, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-04-20 23:24:16.291 +07:00 [INF] Executed action server.Controllers.ParticipantController.GetParticipants (Message_app) in 8.1466ms
2025-04-20 23:24:16.291 +07:00 [INF] Executed endpoint 'server.Controllers.ParticipantController.GetParticipants (Message_app)'
2025-04-20 23:24:16.291 +07:00 [INF] Request finished HTTP/1.1 GET http://192.168.1.3:5053/api/Participant/get_participants/1 - 200 null application/json; charset=utf-8 9.3711ms
2025-04-20 23:24:16.506 +07:00 [INF] Request starting HTTP/1.1 GET http://192.168.1.3:5053/ws/chat - null null
2025-04-20 23:24:16.507 +07:00 [INF] Executing endpoint '/ws/chat'
2025-04-20 23:24:16.520 +07:00 [INF] Request starting HTTP/1.1 GET http://192.168.1.3:5053/api/Message/getMessages/1/2 - null null
2025-04-20 23:24:16.521 +07:00 [INF] Executing endpoint 'server.Controllers.MessageController.GetMessages (Message_app)'
2025-04-20 23:24:16.521 +07:00 [INF] Route matched with {action = "GetMessages", controller = "Message"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetMessages(Int32, Int32) on controller server.Controllers.MessageController (Message_app).
2025-04-20 23:24:16.532 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[@__client_UserId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[conversation_id]
FROM [Participants] AS [p]
WHERE [p].[user_id] = @__client_UserId_0 AND [p].[is_deleted] = CAST(0 AS bit)
2025-04-20 23:24:16.566 +07:00 [INF] Retrieved 27 messages from Redis for conversation 1
2025-04-20 23:24:16.566 +07:00 [INF] Retrieved 27 messages from Redis for conversation 1 and user 2
2025-04-20 23:24:16.566 +07:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[server.DTO.MessageWithAttachment, Message_app, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-04-20 23:24:16.566 +07:00 [INF] Executed action server.Controllers.MessageController.GetMessages (Message_app) in 44.7644ms
2025-04-20 23:24:16.566 +07:00 [INF] Executed endpoint 'server.Controllers.MessageController.GetMessages (Message_app)'
2025-04-20 23:24:16.567 +07:00 [INF] Request finished HTTP/1.1 GET http://192.168.1.3:5053/api/Message/getMessages/1/2 - 200 null application/json; charset=utf-8 46.6792ms
2025-04-20 23:24:16.627 +07:00 [INF] Request starting HTTP/1.1 GET http://192.168.1.3:5053/api/Conversation/get_first_conversation/1 - null null
2025-04-20 23:24:16.627 +07:00 [INF] Executing endpoint 'server.Controllers.ConversationController.GetFirstConversation (Message_app)'
2025-04-20 23:24:16.627 +07:00 [INF] Route matched with {action = "GetFirstConversation", controller = "Conversation"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetFirstConversation(Int32) on controller server.Controllers.ConversationController (Message_app).
2025-04-20 23:24:16.633 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[id], [c].[created_at], [c].[is_group], [c].[lastMessage], [c].[lastMessageSender], [c].[lastMessageTime], [c].[name]
FROM [Conversations] AS [c]
WHERE [c].[id] = @__p_0
2025-04-20 23:24:16.633 +07:00 [INF] Executing OkObjectResult, writing value of type 'server.Models.Conversation'.
2025-04-20 23:24:16.633 +07:00 [INF] Executed action server.Controllers.ConversationController.GetFirstConversation (Message_app) in 6.035ms
2025-04-20 23:24:16.634 +07:00 [INF] Executed endpoint 'server.Controllers.ConversationController.GetFirstConversation (Message_app)'
2025-04-20 23:24:16.634 +07:00 [INF] Request finished HTTP/1.1 GET http://192.168.1.3:5053/api/Conversation/get_first_conversation/1 - 200 null application/json; charset=utf-8 7.0052ms
2025-04-20 23:24:16.663 +07:00 [INF] Request starting HTTP/1.1 GET http://192.168.1.3:5053/api/Participant/get_participants/1 - null null
2025-04-20 23:24:16.664 +07:00 [INF] Executing endpoint 'server.Controllers.ParticipantController.GetParticipants (Message_app)'
2025-04-20 23:24:16.664 +07:00 [INF] Route matched with {action = "GetParticipants", controller = "Participant"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetParticipants(Int32) on controller server.Controllers.ParticipantController (Message_app).
2025-04-20 23:24:16.667 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__conversation_id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[id], [p].[conversation_id], [p].[is_deleted], [p].[joined_at], [p].[name], [p].[role], [p].[user_id]
FROM [Participants] AS [p]
WHERE [p].[conversation_id] = @__conversation_id_0
2025-04-20 23:24:16.667 +07:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType16`1[[System.Collections.Generic.List`1[[server.Models.Participants, Message_app, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-04-20 23:24:16.667 +07:00 [INF] Executed action server.Controllers.ParticipantController.GetParticipants (Message_app) in 3.3722ms
2025-04-20 23:24:16.667 +07:00 [INF] Executed endpoint 'server.Controllers.ParticipantController.GetParticipants (Message_app)'
2025-04-20 23:24:16.668 +07:00 [INF] Request finished HTTP/1.1 GET http://192.168.1.3:5053/api/Participant/get_participants/1 - 200 null application/json; charset=utf-8 4.3947ms
2025-04-20 23:24:25.752 +07:00 [INF] Request starting HTTP/1.1 GET http://192.168.1.3:5053/ws/chat - null null
2025-04-20 23:24:25.752 +07:00 [INF] Executing endpoint '/ws/chat'
2025-04-20 23:24:25.790 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[@__client_UserId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[conversation_id]
FROM [Participants] AS [p]
WHERE [p].[user_id] = @__client_UserId_0 AND [p].[is_deleted] = CAST(0 AS bit)
2025-04-20 23:24:25.817 +07:00 [INF] Request starting HTTP/1.1 GET http://192.168.1.3:5053/api/Message/getMessages/1/5 - null null
2025-04-20 23:24:25.817 +07:00 [INF] Executing endpoint 'server.Controllers.MessageController.GetMessages (Message_app)'
2025-04-20 23:24:25.818 +07:00 [INF] Route matched with {action = "GetMessages", controller = "Message"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetMessages(Int32, Int32) on controller server.Controllers.MessageController (Message_app).
2025-04-20 23:24:25.820 +07:00 [INF] Retrieved 0 messages from Redis for conversation 1
2025-04-20 23:24:25.832 +07:00 [INF] Executed DbCommand (10ms) [Parameters=[@__user_id_0='?' (DbType = Int32), @__conversationId_1='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[cleared_at]
FROM [messageDeletions] AS [m]
WHERE [m].[user_id] = @__user_id_0 AND CAST([m].[conversation_id] AS bigint) = @__conversationId_1
2025-04-20 23:24:25.847 +07:00 [INF] Executed DbCommand (13ms) [Parameters=[@__p_2='?' (DbType = Int32), @__conversationId_0='?' (DbType = Int64), @__clearedAt_1='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[id], [t].[content], [t].[conversation_id], [t].[created_at], [t].[isFile], [t].[isRecalled], [t].[is_read], [t].[sender_id], [t].[type], [a].[id], [a].[FileSize], [a].[file_type], [a].[file_url], [a].[is_temporary], [a].[message_id], [a].[uploaded_at]
FROM (
    SELECT TOP(@__p_2) [m].[id], [m].[content], [m].[conversation_id], [m].[created_at], [m].[isFile], [m].[isRecalled], [m].[is_read], [m].[sender_id], [m].[type]
    FROM [Messages] AS [m]
    WHERE CAST([m].[conversation_id] AS bigint) = @__conversationId_0 AND [m].[created_at] > @__clearedAt_1
    ORDER BY [m].[created_at] DESC
) AS [t]
LEFT JOIN [Attachments] AS [a] ON [t].[id] = [a].[message_id]
ORDER BY [t].[created_at] DESC, [t].[id]
2025-04-20 23:24:25.849 +07:00 [INF] Message 81 already exists in Redis
2025-04-20 23:24:25.849 +07:00 [INF] Message 80 already exists in Redis
2025-04-20 23:24:25.849 +07:00 [INF] Message 79 already exists in Redis
2025-04-20 23:24:25.850 +07:00 [INF] Message 78 already exists in Redis
2025-04-20 23:24:25.850 +07:00 [INF] Message 77 already exists in Redis
2025-04-20 23:24:25.850 +07:00 [INF] Message 76 already exists in Redis
2025-04-20 23:24:25.850 +07:00 [INF] Cached 6 messages to Redis for conversation 1
2025-04-20 23:24:25.851 +07:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[server.DTO.MessageWithAttachment, Message_app, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-04-20 23:24:25.851 +07:00 [INF] Executed action server.Controllers.MessageController.GetMessages (Message_app) in 33.0997ms
2025-04-20 23:24:25.851 +07:00 [INF] Executed endpoint 'server.Controllers.MessageController.GetMessages (Message_app)'
2025-04-20 23:24:25.851 +07:00 [INF] Request finished HTTP/1.1 GET http://192.168.1.3:5053/api/Message/getMessages/1/5 - 200 null application/json; charset=utf-8 34.0794ms
2025-04-20 23:24:25.919 +07:00 [INF] Request starting HTTP/1.1 GET http://192.168.1.3:5053/api/Conversation/get_first_conversation/1 - null null
2025-04-20 23:24:25.919 +07:00 [INF] Executing endpoint 'server.Controllers.ConversationController.GetFirstConversation (Message_app)'
2025-04-20 23:24:25.919 +07:00 [INF] Route matched with {action = "GetFirstConversation", controller = "Conversation"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetFirstConversation(Int32) on controller server.Controllers.ConversationController (Message_app).
2025-04-20 23:24:25.922 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[id], [c].[created_at], [c].[is_group], [c].[lastMessage], [c].[lastMessageSender], [c].[lastMessageTime], [c].[name]
FROM [Conversations] AS [c]
WHERE [c].[id] = @__p_0
2025-04-20 23:24:25.922 +07:00 [INF] Executing OkObjectResult, writing value of type 'server.Models.Conversation'.
2025-04-20 23:24:25.922 +07:00 [INF] Executed action server.Controllers.ConversationController.GetFirstConversation (Message_app) in 2.9326ms
2025-04-20 23:24:25.923 +07:00 [INF] Executed endpoint 'server.Controllers.ConversationController.GetFirstConversation (Message_app)'
2025-04-20 23:24:25.923 +07:00 [INF] Request finished HTTP/1.1 GET http://192.168.1.3:5053/api/Conversation/get_first_conversation/1 - 200 null application/json; charset=utf-8 3.6572ms
2025-04-20 23:24:25.981 +07:00 [INF] Request starting HTTP/1.1 GET http://192.168.1.3:5053/api/Participant/get_participants/1 - null null
2025-04-20 23:24:25.981 +07:00 [INF] Executing endpoint 'server.Controllers.ParticipantController.GetParticipants (Message_app)'
2025-04-20 23:24:25.981 +07:00 [INF] Route matched with {action = "GetParticipants", controller = "Participant"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetParticipants(Int32) on controller server.Controllers.ParticipantController (Message_app).
2025-04-20 23:24:25.984 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__conversation_id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[id], [p].[conversation_id], [p].[is_deleted], [p].[joined_at], [p].[name], [p].[role], [p].[user_id]
FROM [Participants] AS [p]
WHERE [p].[conversation_id] = @__conversation_id_0
2025-04-20 23:24:25.985 +07:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType16`1[[System.Collections.Generic.List`1[[server.Models.Participants, Message_app, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-04-20 23:24:25.985 +07:00 [INF] Executed action server.Controllers.ParticipantController.GetParticipants (Message_app) in 3.8571ms
2025-04-20 23:24:25.985 +07:00 [INF] Executed endpoint 'server.Controllers.ParticipantController.GetParticipants (Message_app)'
2025-04-20 23:24:25.985 +07:00 [INF] Request finished HTTP/1.1 GET http://192.168.1.3:5053/api/Participant/get_participants/1 - 200 null application/json; charset=utf-8 4.5577ms
