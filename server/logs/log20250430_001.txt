2025-04-30 08:56:46.799 +07:00 [INF] Executed DbCommand (23ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [u].[id], [u].[username], [u].[avatar_url]
FROM [Users] AS [u]
2025-04-30 08:56:46.933 +07:00 [INF] User profile is available. Using 'C:\Users\Thao\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-04-30 08:56:46.986 +07:00 [WRN] Overriding address(es) 'http://localhost:5053'. Binding to endpoints defined via IConfiguration and/or UseKestrel() instead.
2025-04-30 08:56:46.997 +07:00 [INF] Now listening on: http://[::]:5053
2025-04-30 08:56:46.998 +07:00 [INF] Now listening on: http://0.0.0.0:5053
2025-04-30 08:56:46.998 +07:00 [INF] Application started. Press Ctrl+C to shut down.
2025-04-30 08:56:46.999 +07:00 [INF] Hosting environment: Development
2025-04-30 08:56:46.999 +07:00 [INF] Content root path: C:\Users\Thao\source\Flutter\Message_app\server
2025-04-30 08:57:14.839 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/ws/chat?userId=5 - null null
2025-04-30 08:57:14.861 +07:00 [INF] CORS policy execution successful.
2025-04-30 08:57:14.878 +07:00 [INF] CORS policy execution successful.
2025-04-30 08:57:14.879 +07:00 [WRN] Failed to determine the https port for redirect.
2025-04-30 08:57:14.897 +07:00 [INF] Executing endpoint '/ws/chat'
2025-04-30 08:57:14.934 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/ws/chat?userId=5 - null null
2025-04-30 08:57:14.935 +07:00 [INF] CORS policy execution successful.
2025-04-30 08:57:14.936 +07:00 [INF] CORS policy execution successful.
2025-04-30 08:57:14.937 +07:00 [INF] Executing endpoint '/ws/chat'
2025-04-30 08:57:14.964 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/ws/chat?userId=5 - null null
2025-04-30 08:57:14.964 +07:00 [INF] CORS policy execution successful.
2025-04-30 08:57:14.965 +07:00 [INF] CORS policy execution successful.
2025-04-30 08:57:14.966 +07:00 [INF] Executing endpoint '/ws/chat'
2025-04-30 08:57:15.028 +07:00 [INF] Executed DbCommand (21ms) [Parameters=[@__client_UserId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[conversation_id]
FROM [Participants] AS [p]
WHERE [p].[user_id] = @__client_UserId_0 AND [p].[is_deleted] = CAST(0 AS bit)
2025-04-30 08:57:15.028 +07:00 [INF] Executed DbCommand (12ms) [Parameters=[@__client_UserId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[conversation_id]
FROM [Participants] AS [p]
WHERE [p].[user_id] = @__client_UserId_0 AND [p].[is_deleted] = CAST(0 AS bit)
2025-04-30 08:57:15.028 +07:00 [INF] Executed DbCommand (7ms) [Parameters=[@__client_UserId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[conversation_id]
FROM [Participants] AS [p]
WHERE [p].[user_id] = @__client_UserId_0 AND [p].[is_deleted] = CAST(0 AS bit)
2025-04-30 08:57:37.723 +07:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5053/api/Auth/login - null null
2025-04-30 08:57:37.723 +07:00 [INF] CORS policy execution successful.
2025-04-30 08:57:37.726 +07:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5053/api/Auth/login - 204 null null 2.311ms
2025-04-30 08:57:37.728 +07:00 [INF] Request starting HTTP/1.1 POST http://localhost:5053/api/Auth/login - application/json 53
2025-04-30 08:57:37.729 +07:00 [INF] CORS policy execution successful.
2025-04-30 08:57:37.730 +07:00 [INF] CORS policy execution successful.
2025-04-30 08:57:37.730 +07:00 [INF] Executing endpoint 'Message_app.Controllers.AuthController.Login (Message_app)'
2025-04-30 08:57:37.750 +07:00 [INF] Route matched with {action = "Login", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Login(server.DTO.AuthDTO.LoginDTO) on controller Message_app.Controllers.AuthController (Message_app).
2025-04-30 08:57:37.848 +07:00 [INF] Executed DbCommand (14ms) [Parameters=[@__email_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[id], [u].[avatar_url], [u].[bio], [u].[birthday], [u].[created_at], [u].[email], [u].[gender], [u].[interests], [u].[location], [u].[password], [u].[passwordSalt], [u].[username]
FROM [Users] AS [u]
WHERE [u].[email] = @__email_0
2025-04-30 08:57:37.938 +07:00 [INF] Executing OkObjectResult, writing value of type 'server.DTO.AuthDTO.LoginRespose'.
2025-04-30 08:57:37.982 +07:00 [INF] Executed action Message_app.Controllers.AuthController.Login (Message_app) in 229.6778ms
2025-04-30 08:57:37.982 +07:00 [INF] Executed endpoint 'Message_app.Controllers.AuthController.Login (Message_app)'
2025-04-30 08:57:37.985 +07:00 [INF] Request finished HTTP/1.1 POST http://localhost:5053/api/Auth/login - 200 null application/json; charset=utf-8 256.9676ms
2025-04-30 08:57:38.143 +07:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5053/api/Conversation/get_conversations/5 - null null
2025-04-30 08:57:38.143 +07:00 [INF] CORS policy execution successful.
2025-04-30 08:57:38.144 +07:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5053/api/Conversation/get_conversations/5 - null null
2025-04-30 08:57:38.144 +07:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5053/api/Conversation/get_conversations/5 - 204 null null 1.0973ms
2025-04-30 08:57:38.144 +07:00 [INF] CORS policy execution successful.
2025-04-30 08:57:38.144 +07:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5053/api/Conversation/get_conversations/5 - 204 null null 0.299ms
2025-04-30 08:57:38.145 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/api/Conversation/get_conversations/5 - null null
2025-04-30 08:57:38.146 +07:00 [INF] CORS policy execution successful.
2025-04-30 08:57:38.147 +07:00 [INF] CORS policy execution successful.
2025-04-30 08:57:38.147 +07:00 [INF] Executing endpoint 'server.Controllers.ConversationController.GetConversations (Message_app)'
2025-04-30 08:57:38.151 +07:00 [INF] Route matched with {action = "GetConversations", controller = "Conversation"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetConversations(Int32) on controller server.Controllers.ConversationController (Message_app).
2025-04-30 08:57:38.170 +07:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[server.DTO.ConversationDto, Message_app, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-04-30 08:57:38.175 +07:00 [INF] Executed action server.Controllers.ConversationController.GetConversations (Message_app) in 22.9184ms
2025-04-30 08:57:38.175 +07:00 [INF] Executed endpoint 'server.Controllers.ConversationController.GetConversations (Message_app)'
2025-04-30 08:57:38.175 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5053/api/Conversation/get_conversations/5 - 200 null application/json; charset=utf-8 29.7163ms
2025-04-30 08:57:38.176 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/api/Conversation/get_conversations/5 - null null
2025-04-30 08:57:38.176 +07:00 [INF] CORS policy execution successful.
2025-04-30 08:57:38.177 +07:00 [INF] CORS policy execution successful.
2025-04-30 08:57:38.177 +07:00 [INF] Executing endpoint 'server.Controllers.ConversationController.GetConversations (Message_app)'
2025-04-30 08:57:38.177 +07:00 [INF] Route matched with {action = "GetConversations", controller = "Conversation"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetConversations(Int32) on controller server.Controllers.ConversationController (Message_app).
2025-04-30 08:57:38.179 +07:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[server.DTO.ConversationDto, Message_app, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-04-30 08:57:38.180 +07:00 [INF] Executed action server.Controllers.ConversationController.GetConversations (Message_app) in 2.258ms
2025-04-30 08:57:38.180 +07:00 [INF] Executed endpoint 'server.Controllers.ConversationController.GetConversations (Message_app)'
2025-04-30 08:57:38.180 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5053/api/Conversation/get_conversations/5 - 200 null application/json; charset=utf-8 4.2279ms
2025-04-30 08:57:38.194 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/ws/chat?userId=5 - null null
2025-04-30 08:57:38.194 +07:00 [INF] CORS policy execution successful.
2025-04-30 08:57:38.194 +07:00 [INF] CORS policy execution successful.
2025-04-30 08:57:38.195 +07:00 [INF] Executing endpoint '/ws/chat'
2025-04-30 08:57:38.317 +07:00 [INF] Executed DbCommand (14ms) [Parameters=[@__client_UserId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[conversation_id]
FROM [Participants] AS [p]
WHERE [p].[user_id] = @__client_UserId_0 AND [p].[is_deleted] = CAST(0 AS bit)
2025-04-30 08:59:23.795 +07:00 [INF] Request starting HTTP/1.1 POST http://192.168.1.9:5053/api/Auth/login - application/json 57
2025-04-30 08:59:23.799 +07:00 [INF] Executing endpoint 'Message_app.Controllers.AuthController.Login (Message_app)'
2025-04-30 08:59:23.800 +07:00 [INF] Route matched with {action = "Login", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Login(server.DTO.AuthDTO.LoginDTO) on controller Message_app.Controllers.AuthController (Message_app).
2025-04-30 08:59:23.823 +07:00 [INF] Executed DbCommand (14ms) [Parameters=[@__email_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[id], [u].[avatar_url], [u].[bio], [u].[birthday], [u].[created_at], [u].[email], [u].[gender], [u].[interests], [u].[location], [u].[password], [u].[passwordSalt], [u].[username]
FROM [Users] AS [u]
WHERE [u].[email] = @__email_0
2025-04-30 08:59:23.825 +07:00 [INF] Executing OkObjectResult, writing value of type 'server.DTO.AuthDTO.LoginRespose'.
2025-04-30 08:59:23.825 +07:00 [INF] Executed action Message_app.Controllers.AuthController.Login (Message_app) in 25.3965ms
2025-04-30 08:59:23.825 +07:00 [INF] Executed endpoint 'Message_app.Controllers.AuthController.Login (Message_app)'
2025-04-30 08:59:23.825 +07:00 [INF] Request finished HTTP/1.1 POST http://192.168.1.9:5053/api/Auth/login - 200 null application/json; charset=utf-8 30.5256ms
2025-04-30 08:59:24.900 +07:00 [INF] Request starting HTTP/1.1 GET http://192.168.1.9:5053/api/Conversation/get_conversations/2 - null null
2025-04-30 08:59:24.900 +07:00 [INF] Executing endpoint 'server.Controllers.ConversationController.GetConversations (Message_app)'
2025-04-30 08:59:24.900 +07:00 [INF] Request starting HTTP/1.1 GET http://192.168.1.9:5053/api/Conversation/get_conversations/2 - null null
2025-04-30 08:59:24.900 +07:00 [INF] Route matched with {action = "GetConversations", controller = "Conversation"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetConversations(Int32) on controller server.Controllers.ConversationController (Message_app).
2025-04-30 08:59:24.900 +07:00 [INF] Executing endpoint 'server.Controllers.ConversationController.GetConversations (Message_app)'
2025-04-30 08:59:24.901 +07:00 [INF] Route matched with {action = "GetConversations", controller = "Conversation"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetConversations(Int32) on controller server.Controllers.ConversationController (Message_app).
2025-04-30 08:59:24.906 +07:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[server.DTO.ConversationDto, Message_app, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-04-30 08:59:24.907 +07:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[server.DTO.ConversationDto, Message_app, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-04-30 08:59:24.907 +07:00 [INF] Executed action server.Controllers.ConversationController.GetConversations (Message_app) in 6.7207ms
2025-04-30 08:59:24.907 +07:00 [INF] Executed action server.Controllers.ConversationController.GetConversations (Message_app) in 7.0384ms
2025-04-30 08:59:24.908 +07:00 [INF] Executed endpoint 'server.Controllers.ConversationController.GetConversations (Message_app)'
2025-04-30 08:59:24.908 +07:00 [INF] Executed endpoint 'server.Controllers.ConversationController.GetConversations (Message_app)'
2025-04-30 08:59:24.909 +07:00 [INF] Request finished HTTP/1.1 GET http://192.168.1.9:5053/api/Conversation/get_conversations/2 - 200 null application/json; charset=utf-8 8.8416ms
2025-04-30 08:59:24.909 +07:00 [INF] Request finished HTTP/1.1 GET http://192.168.1.9:5053/api/Conversation/get_conversations/2 - 200 null application/json; charset=utf-8 8.4968ms
2025-04-30 08:59:25.025 +07:00 [INF] Request starting HTTP/1.1 GET http://192.168.1.9:5053/ws/chat?userId=2 - null null
2025-04-30 08:59:25.027 +07:00 [INF] Executing endpoint '/ws/chat'
2025-04-30 08:59:25.413 +07:00 [INF] Executed DbCommand (12ms) [Parameters=[@__client_UserId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[conversation_id]
FROM [Participants] AS [p]
WHERE [p].[user_id] = @__client_UserId_0 AND [p].[is_deleted] = CAST(0 AS bit)
2025-04-30 08:59:26.430 +07:00 [INF] Request starting HTTP/1.1 GET http://192.168.1.9:5053/api/Message/getMessages/1/2 - null null
2025-04-30 08:59:26.431 +07:00 [INF] Executing endpoint 'server.Controllers.MessageController.GetMessages (Message_app)'
2025-04-30 08:59:26.435 +07:00 [INF] Route matched with {action = "GetMessages", controller = "Message"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetMessages(Int32, Int32) on controller server.Controllers.MessageController (Message_app).
2025-04-30 08:59:26.487 +07:00 [WRN] Message 81 not found in Redis
2025-04-30 08:59:26.487 +07:00 [WRN] Message 80 not found in Redis
2025-04-30 08:59:26.488 +07:00 [WRN] Message 79 not found in Redis
2025-04-30 08:59:26.488 +07:00 [WRN] Message 78 not found in Redis
2025-04-30 08:59:26.488 +07:00 [WRN] Message 77 not found in Redis
2025-04-30 08:59:26.489 +07:00 [WRN] Message 76 not found in Redis
2025-04-30 08:59:26.489 +07:00 [WRN] Message 75 not found in Redis
2025-04-30 08:59:26.489 +07:00 [WRN] Message 74 not found in Redis
2025-04-30 08:59:26.489 +07:00 [WRN] Message 73 not found in Redis
2025-04-30 08:59:26.490 +07:00 [WRN] Message 72 not found in Redis
2025-04-30 08:59:26.490 +07:00 [WRN] Message 71 not found in Redis
2025-04-30 08:59:26.490 +07:00 [WRN] Message 68 not found in Redis
2025-04-30 08:59:26.491 +07:00 [WRN] Message 64 not found in Redis
2025-04-30 08:59:26.491 +07:00 [WRN] Message 62 not found in Redis
2025-04-30 08:59:26.492 +07:00 [WRN] Message 61 not found in Redis
2025-04-30 08:59:26.492 +07:00 [WRN] Message 60 not found in Redis
2025-04-30 08:59:26.492 +07:00 [WRN] Message 59 not found in Redis
2025-04-30 08:59:26.493 +07:00 [WRN] Message 57 not found in Redis
2025-04-30 08:59:26.493 +07:00 [WRN] Message 55 not found in Redis
2025-04-30 08:59:26.493 +07:00 [WRN] Message 54 not found in Redis
2025-04-30 08:59:26.494 +07:00 [WRN] Message 51 not found in Redis
2025-04-30 08:59:26.494 +07:00 [WRN] Message 49 not found in Redis
2025-04-30 08:59:26.494 +07:00 [WRN] Message 11 not found in Redis
2025-04-30 08:59:26.495 +07:00 [WRN] Message 8 not found in Redis
2025-04-30 08:59:26.495 +07:00 [WRN] Message 3 not found in Redis
2025-04-30 08:59:26.495 +07:00 [WRN] Message 2 not found in Redis
2025-04-30 08:59:26.496 +07:00 [WRN] Message 1 not found in Redis
2025-04-30 08:59:26.496 +07:00 [INF] Retrieved 12 messages from Redis for conversation 1
2025-04-30 08:59:26.498 +07:00 [INF] Retrieved 12 messages from Redis for conversation 1 and user 2
2025-04-30 08:59:26.498 +07:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[server.DTO.MessageWithAttachment, Message_app, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-04-30 08:59:26.501 +07:00 [INF] Executed action server.Controllers.MessageController.GetMessages (Message_app) in 65.5268ms
2025-04-30 08:59:26.501 +07:00 [INF] Executed endpoint 'server.Controllers.MessageController.GetMessages (Message_app)'
2025-04-30 08:59:26.502 +07:00 [INF] Request finished HTTP/1.1 GET http://192.168.1.9:5053/api/Message/getMessages/1/2 - 200 null application/json; charset=utf-8 71.9606ms
2025-04-30 08:59:26.549 +07:00 [INF] Request starting HTTP/1.1 GET http://192.168.1.9:5053/api/Conversation/get_first_conversation/1 - null null
2025-04-30 08:59:26.549 +07:00 [INF] Executing endpoint 'server.Controllers.ConversationController.GetFirstConversation (Message_app)'
2025-04-30 08:59:26.551 +07:00 [INF] Route matched with {action = "GetFirstConversation", controller = "Conversation"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetFirstConversation(Int32) on controller server.Controllers.ConversationController (Message_app).
2025-04-30 08:59:26.586 +07:00 [INF] Executed DbCommand (10ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[id], [c].[created_at], [c].[is_group], [c].[lastMessage], [c].[lastMessageSender], [c].[lastMessageTime], [c].[name]
FROM [Conversations] AS [c]
WHERE [c].[id] = @__p_0
2025-04-30 08:59:26.604 +07:00 [INF] Executing OkObjectResult, writing value of type 'server.Models.Conversation'.
2025-04-30 08:59:26.605 +07:00 [INF] Executed action server.Controllers.ConversationController.GetFirstConversation (Message_app) in 53.1863ms
2025-04-30 08:59:26.605 +07:00 [INF] Executed endpoint 'server.Controllers.ConversationController.GetFirstConversation (Message_app)'
2025-04-30 08:59:26.605 +07:00 [INF] Request finished HTTP/1.1 GET http://192.168.1.9:5053/api/Conversation/get_first_conversation/1 - 200 null application/json; charset=utf-8 56.3331ms
2025-04-30 08:59:26.729 +07:00 [INF] Request starting HTTP/1.1 GET http://192.168.1.9:5053/api/Participant/get_participants/1 - null null
2025-04-30 08:59:26.729 +07:00 [INF] Executing endpoint 'server.Controllers.ParticipantController.GetParticipants (Message_app)'
2025-04-30 08:59:26.732 +07:00 [INF] Route matched with {action = "GetParticipants", controller = "Participant"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetParticipants(Int32) on controller server.Controllers.ParticipantController (Message_app).
2025-04-30 08:59:26.755 +07:00 [INF] Executed DbCommand (18ms) [Parameters=[@__conversation_id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[id], [p].[adder], [p].[conversation_id], [p].[is_deleted], [p].[joined_at], [p].[name], [p].[role], [p].[user_id]
FROM [Participants] AS [p]
WHERE [p].[conversation_id] = @__conversation_id_0
2025-04-30 08:59:26.763 +07:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType17`1[[System.Collections.Generic.List`1[[server.Models.Participants, Message_app, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-04-30 08:59:26.770 +07:00 [INF] Executed action server.Controllers.ParticipantController.GetParticipants (Message_app) in 38.7126ms
2025-04-30 08:59:26.770 +07:00 [INF] Executed endpoint 'server.Controllers.ParticipantController.GetParticipants (Message_app)'
2025-04-30 08:59:26.771 +07:00 [INF] Request finished HTTP/1.1 GET http://192.168.1.9:5053/api/Participant/get_participants/1 - 200 null application/json; charset=utf-8 41.6394ms
2025-04-30 08:59:41.595 +07:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5053/api/Message/getMessages/1/5 - null null
2025-04-30 08:59:41.595 +07:00 [INF] CORS policy execution successful.
2025-04-30 08:59:41.596 +07:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5053/api/Message/getMessages/1/5 - 204 null null 0.8454ms
2025-04-30 08:59:41.597 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/api/Message/getMessages/1/5 - null null
2025-04-30 08:59:41.598 +07:00 [INF] CORS policy execution successful.
2025-04-30 08:59:41.598 +07:00 [INF] CORS policy execution successful.
2025-04-30 08:59:41.599 +07:00 [INF] Executing endpoint 'server.Controllers.MessageController.GetMessages (Message_app)'
2025-04-30 08:59:41.599 +07:00 [INF] Route matched with {action = "GetMessages", controller = "Message"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetMessages(Int32, Int32) on controller server.Controllers.MessageController (Message_app).
2025-04-30 08:59:41.602 +07:00 [WRN] Message 81 not found in Redis
2025-04-30 08:59:41.603 +07:00 [WRN] Message 80 not found in Redis
2025-04-30 08:59:41.603 +07:00 [WRN] Message 79 not found in Redis
2025-04-30 08:59:41.604 +07:00 [WRN] Message 78 not found in Redis
2025-04-30 08:59:41.604 +07:00 [WRN] Message 77 not found in Redis
2025-04-30 08:59:41.604 +07:00 [WRN] Message 76 not found in Redis
2025-04-30 08:59:41.605 +07:00 [WRN] Message 75 not found in Redis
2025-04-30 08:59:41.605 +07:00 [WRN] Message 74 not found in Redis
2025-04-30 08:59:41.605 +07:00 [WRN] Message 73 not found in Redis
2025-04-30 08:59:41.606 +07:00 [WRN] Message 72 not found in Redis
2025-04-30 08:59:41.606 +07:00 [WRN] Message 71 not found in Redis
2025-04-30 08:59:41.607 +07:00 [WRN] Message 68 not found in Redis
2025-04-30 08:59:41.608 +07:00 [WRN] Message 64 not found in Redis
2025-04-30 08:59:41.609 +07:00 [WRN] Message 62 not found in Redis
2025-04-30 08:59:41.609 +07:00 [WRN] Message 61 not found in Redis
2025-04-30 08:59:41.609 +07:00 [WRN] Message 60 not found in Redis
2025-04-30 08:59:41.610 +07:00 [WRN] Message 59 not found in Redis
2025-04-30 08:59:41.610 +07:00 [WRN] Message 57 not found in Redis
2025-04-30 08:59:41.611 +07:00 [WRN] Message 55 not found in Redis
2025-04-30 08:59:41.611 +07:00 [WRN] Message 54 not found in Redis
2025-04-30 08:59:41.611 +07:00 [WRN] Message 51 not found in Redis
2025-04-30 08:59:41.612 +07:00 [WRN] Message 49 not found in Redis
2025-04-30 08:59:41.612 +07:00 [WRN] Message 11 not found in Redis
2025-04-30 08:59:41.612 +07:00 [WRN] Message 8 not found in Redis
2025-04-30 08:59:41.613 +07:00 [WRN] Message 3 not found in Redis
2025-04-30 08:59:41.613 +07:00 [WRN] Message 2 not found in Redis
2025-04-30 08:59:41.613 +07:00 [WRN] Message 1 not found in Redis
2025-04-30 08:59:41.613 +07:00 [INF] Retrieved 12 messages from Redis for conversation 1
2025-04-30 08:59:41.614 +07:00 [INF] Retrieved 12 messages from Redis for conversation 1 and user 5
2025-04-30 08:59:41.614 +07:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[server.DTO.MessageWithAttachment, Message_app, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-04-30 08:59:41.614 +07:00 [INF] Executed action server.Controllers.MessageController.GetMessages (Message_app) in 15.2995ms
2025-04-30 08:59:41.614 +07:00 [INF] Executed endpoint 'server.Controllers.MessageController.GetMessages (Message_app)'
2025-04-30 08:59:41.614 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5053/api/Message/getMessages/1/5 - 200 null application/json; charset=utf-8 16.8729ms
2025-04-30 08:59:41.631 +07:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5053/api/Conversation/get_first_conversation/1 - null null
2025-04-30 08:59:41.631 +07:00 [INF] CORS policy execution successful.
2025-04-30 08:59:41.631 +07:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5053/api/Conversation/get_first_conversation/1 - 204 null null 0.3516ms
2025-04-30 08:59:41.632 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/api/Conversation/get_first_conversation/1 - null null
2025-04-30 08:59:41.632 +07:00 [INF] CORS policy execution successful.
2025-04-30 08:59:41.632 +07:00 [INF] CORS policy execution successful.
2025-04-30 08:59:41.632 +07:00 [INF] Executing endpoint 'server.Controllers.ConversationController.GetFirstConversation (Message_app)'
2025-04-30 08:59:41.632 +07:00 [INF] Route matched with {action = "GetFirstConversation", controller = "Conversation"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetFirstConversation(Int32) on controller server.Controllers.ConversationController (Message_app).
2025-04-30 08:59:41.643 +07:00 [INF] Executed DbCommand (8ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[id], [c].[created_at], [c].[is_group], [c].[lastMessage], [c].[lastMessageSender], [c].[lastMessageTime], [c].[name]
FROM [Conversations] AS [c]
WHERE [c].[id] = @__p_0
2025-04-30 08:59:41.643 +07:00 [INF] Executing OkObjectResult, writing value of type 'server.Models.Conversation'.
2025-04-30 08:59:41.643 +07:00 [INF] Executed action server.Controllers.ConversationController.GetFirstConversation (Message_app) in 10.9327ms
2025-04-30 08:59:41.643 +07:00 [INF] Executed endpoint 'server.Controllers.ConversationController.GetFirstConversation (Message_app)'
2025-04-30 08:59:41.644 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5053/api/Conversation/get_first_conversation/1 - 200 null application/json; charset=utf-8 11.5407ms
2025-04-30 08:59:41.659 +07:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5053/api/Participant/get_participants/1 - null null
2025-04-30 08:59:41.659 +07:00 [INF] CORS policy execution successful.
2025-04-30 08:59:41.659 +07:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5053/api/Participant/get_participants/1 - 204 null null 0.2771ms
2025-04-30 08:59:41.661 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/api/Participant/get_participants/1 - null null
2025-04-30 08:59:41.661 +07:00 [INF] CORS policy execution successful.
2025-04-30 08:59:41.662 +07:00 [INF] CORS policy execution successful.
2025-04-30 08:59:41.662 +07:00 [INF] Executing endpoint 'server.Controllers.ParticipantController.GetParticipants (Message_app)'
2025-04-30 08:59:41.662 +07:00 [INF] Route matched with {action = "GetParticipants", controller = "Participant"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetParticipants(Int32) on controller server.Controllers.ParticipantController (Message_app).
2025-04-30 08:59:41.668 +07:00 [INF] Executed DbCommand (5ms) [Parameters=[@__conversation_id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[id], [p].[adder], [p].[conversation_id], [p].[is_deleted], [p].[joined_at], [p].[name], [p].[role], [p].[user_id]
FROM [Participants] AS [p]
WHERE [p].[conversation_id] = @__conversation_id_0
2025-04-30 08:59:41.669 +07:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType17`1[[System.Collections.Generic.List`1[[server.Models.Participants, Message_app, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-04-30 08:59:41.669 +07:00 [INF] Executed action server.Controllers.ParticipantController.GetParticipants (Message_app) in 6.8609ms
2025-04-30 08:59:41.669 +07:00 [INF] Executed endpoint 'server.Controllers.ParticipantController.GetParticipants (Message_app)'
2025-04-30 08:59:41.669 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5053/api/Participant/get_participants/1 - 200 null application/json; charset=utf-8 8.6426ms
2025-04-30 09:00:35.049 +07:00 [INF] Application is shutting down...
2025-04-30 09:01:05.059 +07:00 [INF] Executed endpoint '/ws/chat'
2025-04-30 09:01:05.059 +07:00 [INF] Executed endpoint '/ws/chat'
2025-04-30 09:01:05.059 +07:00 [INF] Executed endpoint '/ws/chat'
2025-04-30 09:01:05.059 +07:00 [INF] Executed endpoint '/ws/chat'
2025-04-30 09:01:05.060 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5053/ws/chat?userId=5 - 101 null null 230125.924ms
2025-04-30 09:01:05.060 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5053/ws/chat?userId=5 - 101 null null 230096.5613ms
2025-04-30 09:01:05.060 +07:00 [INF] Executed endpoint '/ws/chat'
2025-04-30 09:01:05.060 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5053/ws/chat?userId=5 - 101 null null 230222.5726ms
2025-04-30 09:01:05.061 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5053/ws/chat?userId=5 - 101 null null 206866.8054ms
2025-04-30 09:01:05.060 +07:00 [ERR] An unhandled exception has occurred while executing the request.
Microsoft.AspNetCore.Connections.ConnectionAbortedException: The connection was aborted because the server is shutting down and request processing didn't complete within the time specified by HostOptions.ShutdownTimeout.
   at System.IO.Pipelines.Pipe.GetReadAsyncResult()
   at System.IO.Pipelines.Pipe.DefaultPipeReader.GetResult(Int16 token)
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.Http.Http1UpgradeMessageBody.ReadAsyncInternalAwaited(ValueTask`1 readTask, CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.Http.HttpRequestStream.ReadAsyncInternal(Memory`1 destination, CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at System.IO.Stream.ReadAtLeastAsyncCore(Memory`1 buffer, Int32 minimumBytes, Boolean throwOnEndOfStream, CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at System.Net.WebSockets.ManagedWebSocket.EnsureBufferContainsAsync(Int32 minimumRequiredBytes, CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.WebSockets.ManagedWebSocket.ReceiveAsyncPrivate[TResult](Memory`1 payloadBuffer, CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at System.Threading.Tasks.ValueTask`1.ValueTaskSourceAsTask.<>c.<.cctor>b__4_0(Object state)
--- End of stack trace from previous location ---
   at server.Services.WebSocketService.webSocket.Receiver(Client client) in C:\Users\Thao\source\Flutter\Message_app\server\Services\WebSocketService\websocket.cs:line 108
   at server.Services.WebSocketService.webSocket.HandleWebSocket(HttpContext context) in C:\Users\Thao\source\Flutter\Message_app\server\Services\WebSocketService\websocket.cs:line 91
   at Program.<>c.<<<Main>$>b__0_4>d.MoveNext() in C:\Users\Thao\source\Flutter\Message_app\server\Program.cs:line 89
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
2025-04-30 09:01:05.074 +07:00 [WRN] The response has already started, the error page middleware will not be executed.
2025-04-30 09:01:05.074 +07:00 [INF] Request finished HTTP/1.1 GET http://192.168.1.9:5053/ws/chat?userId=2 - 101 null null 100049.388ms
