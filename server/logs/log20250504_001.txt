2025-05-04 14:57:17.887 +07:00 [INF] Executed DbCommand (32ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [u].[id], [u].[username], [u].[avatar_url]
FROM [Users] AS [u]
2025-05-04 14:57:18.066 +07:00 [INF] User profile is available. Using 'C:\Users\Thao\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-05-04 14:57:18.168 +07:00 [WRN] Overriding address(es) 'http://localhost:5053'. Binding to endpoints defined via IConfiguration and/or UseKestrel() instead.
2025-05-04 14:57:18.178 +07:00 [INF] Now listening on: http://[::]:5053
2025-05-04 14:57:18.179 +07:00 [INF] Now listening on: http://0.0.0.0:5053
2025-05-04 14:57:18.179 +07:00 [INF] Application started. Press Ctrl+C to shut down.
2025-05-04 14:57:18.179 +07:00 [INF] Hosting environment: Development
2025-05-04 14:57:18.179 +07:00 [INF] Content root path: C:\Users\Thao\source\Flutter\Message_app\server
2025-05-04 14:57:40.712 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/ws/chat?userId=5 - null null
2025-05-04 14:57:40.741 +07:00 [INF] CORS policy execution successful.
2025-05-04 14:57:40.758 +07:00 [INF] CORS policy execution successful.
2025-05-04 14:57:40.758 +07:00 [WRN] Failed to determine the https port for redirect.
2025-05-04 14:57:40.782 +07:00 [INF] Executing endpoint '/ws/chat'
2025-05-04 14:57:40.817 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/ws/chat?userId=5 - null null
2025-05-04 14:57:40.818 +07:00 [INF] CORS policy execution successful.
2025-05-04 14:57:40.819 +07:00 [INF] CORS policy execution successful.
2025-05-04 14:57:40.824 +07:00 [INF] Executing endpoint '/ws/chat'
2025-05-04 14:57:40.867 +07:00 [INF] Request starting HTTP/1.1 GET http://192.168.1.9:5053/ws/chat?userId=2 - null null
2025-05-04 14:57:40.867 +07:00 [INF] Request starting HTTP/1.1 GET http://192.168.1.9:5053/ws/chat?userId=2 - null null
2025-05-04 14:57:40.870 +07:00 [INF] Executing endpoint '/ws/chat'
2025-05-04 14:57:40.870 +07:00 [INF] Executing endpoint '/ws/chat'
2025-05-04 14:57:40.928 +07:00 [INF] Executed DbCommand (34ms) [Parameters=[@__client_UserId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[conversation_id]
FROM [Participants] AS [p]
WHERE [p].[user_id] = @__client_UserId_0 AND [p].[is_deleted] = CAST(0 AS bit)
2025-05-04 14:57:40.928 +07:00 [INF] Executed DbCommand (43ms) [Parameters=[@__client_UserId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[conversation_id]
FROM [Participants] AS [p]
WHERE [p].[user_id] = @__client_UserId_0 AND [p].[is_deleted] = CAST(0 AS bit)
2025-05-04 14:57:40.939 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__client_UserId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[conversation_id]
FROM [Participants] AS [p]
WHERE [p].[user_id] = @__client_UserId_0 AND [p].[is_deleted] = CAST(0 AS bit)
2025-05-04 14:57:40.940 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[@__client_UserId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[conversation_id]
FROM [Participants] AS [p]
WHERE [p].[user_id] = @__client_UserId_0 AND [p].[is_deleted] = CAST(0 AS bit)
2025-05-04 15:03:58.233 +07:00 [INF] Executed endpoint '/ws/chat'
2025-05-04 15:03:58.233 +07:00 [INF] Executed endpoint '/ws/chat'
2025-05-04 15:03:58.238 +07:00 [ERR] An unhandled exception has occurred while executing the request.
System.Net.WebSockets.WebSocketException (0x80004005): The remote party closed the WebSocket connection without completing the close handshake.
   at System.Net.WebSockets.ManagedWebSocket.ThrowEOFUnexpected()
   at System.Net.WebSockets.ManagedWebSocket.EnsureBufferContainsAsync(Int32 minimumRequiredBytes, CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.WebSockets.ManagedWebSocket.ReceiveAsyncPrivate[TResult](Memory`1 payloadBuffer, CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at System.Threading.Tasks.ValueTask`1.ValueTaskSourceAsTask.<>c.<.cctor>b__4_0(Object state)
--- End of stack trace from previous location ---
   at server.Services.WebSocketService.webSocket.Receiver(Client client) in C:\Users\Thao\source\Flutter\Message_app\server\Services\WebSocketService\websocket.cs:line 108
   at server.Services.WebSocketService.webSocket.HandleWebSocket(HttpContext context) in C:\Users\Thao\source\Flutter\Message_app\server\Services\WebSocketService\websocket.cs:line 91
   at Program.<>c.<<<Main>$>b__0_4>d.MoveNext() in C:\Users\Thao\source\Flutter\Message_app\server\Program.cs:line 89
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
2025-05-04 15:03:58.238 +07:00 [ERR] An unhandled exception has occurred while executing the request.
System.Net.WebSockets.WebSocketException (0x80004005): The remote party closed the WebSocket connection without completing the close handshake.
   at System.Net.WebSockets.ManagedWebSocket.ThrowEOFUnexpected()
   at System.Net.WebSockets.ManagedWebSocket.EnsureBufferContainsAsync(Int32 minimumRequiredBytes, CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.WebSockets.ManagedWebSocket.ReceiveAsyncPrivate[TResult](Memory`1 payloadBuffer, CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at System.Threading.Tasks.ValueTask`1.ValueTaskSourceAsTask.<>c.<.cctor>b__4_0(Object state)
--- End of stack trace from previous location ---
   at server.Services.WebSocketService.webSocket.Receiver(Client client) in C:\Users\Thao\source\Flutter\Message_app\server\Services\WebSocketService\websocket.cs:line 108
   at server.Services.WebSocketService.webSocket.HandleWebSocket(HttpContext context) in C:\Users\Thao\source\Flutter\Message_app\server\Services\WebSocketService\websocket.cs:line 91
   at Program.<>c.<<<Main>$>b__0_4>d.MoveNext() in C:\Users\Thao\source\Flutter\Message_app\server\Program.cs:line 89
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
2025-05-04 15:03:58.269 +07:00 [WRN] The response has already started, the error page middleware will not be executed.
2025-05-04 15:03:58.271 +07:00 [WRN] The response has already started, the error page middleware will not be executed.
2025-05-04 15:03:58.277 +07:00 [ERR] Connection id "0HNCAS5C1G4L4", Request id "0HNCAS5C1G4L4:00000001": An unhandled exception was thrown by the application.
System.Net.WebSockets.WebSocketException (0x80004005): The remote party closed the WebSocket connection without completing the close handshake.
   at System.Net.WebSockets.ManagedWebSocket.ThrowEOFUnexpected()
   at System.Net.WebSockets.ManagedWebSocket.EnsureBufferContainsAsync(Int32 minimumRequiredBytes, CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.WebSockets.ManagedWebSocket.ReceiveAsyncPrivate[TResult](Memory`1 payloadBuffer, CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at System.Threading.Tasks.ValueTask`1.ValueTaskSourceAsTask.<>c.<.cctor>b__4_0(Object state)
--- End of stack trace from previous location ---
   at server.Services.WebSocketService.webSocket.Receiver(Client client) in C:\Users\Thao\source\Flutter\Message_app\server\Services\WebSocketService\websocket.cs:line 108
   at server.Services.WebSocketService.webSocket.HandleWebSocket(HttpContext context) in C:\Users\Thao\source\Flutter\Message_app\server\Services\WebSocketService\websocket.cs:line 91
   at Program.<>c.<<<Main>$>b__0_4>d.MoveNext() in C:\Users\Thao\source\Flutter\Message_app\server\Program.cs:line 89
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Watch.BrowserRefresh.BrowserRefreshMiddleware.InvokeAsync(HttpContext context)
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.Http.HttpProtocol.ProcessRequests[TContext](IHttpApplication`1 application)
2025-05-04 15:03:58.277 +07:00 [ERR] Connection id "0HNCAS5C1G4L5", Request id "0HNCAS5C1G4L5:00000001": An unhandled exception was thrown by the application.
System.Net.WebSockets.WebSocketException (0x80004005): The remote party closed the WebSocket connection without completing the close handshake.
   at System.Net.WebSockets.ManagedWebSocket.ThrowEOFUnexpected()
   at System.Net.WebSockets.ManagedWebSocket.EnsureBufferContainsAsync(Int32 minimumRequiredBytes, CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.WebSockets.ManagedWebSocket.ReceiveAsyncPrivate[TResult](Memory`1 payloadBuffer, CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at System.Threading.Tasks.ValueTask`1.ValueTaskSourceAsTask.<>c.<.cctor>b__4_0(Object state)
--- End of stack trace from previous location ---
   at server.Services.WebSocketService.webSocket.Receiver(Client client) in C:\Users\Thao\source\Flutter\Message_app\server\Services\WebSocketService\websocket.cs:line 108
   at server.Services.WebSocketService.webSocket.HandleWebSocket(HttpContext context) in C:\Users\Thao\source\Flutter\Message_app\server\Services\WebSocketService\websocket.cs:line 91
   at Program.<>c.<<<Main>$>b__0_4>d.MoveNext() in C:\Users\Thao\source\Flutter\Message_app\server\Program.cs:line 89
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Watch.BrowserRefresh.BrowserRefreshMiddleware.InvokeAsync(HttpContext context)
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.Http.HttpProtocol.ProcessRequests[TContext](IHttpApplication`1 application)
2025-05-04 15:03:58.290 +07:00 [INF] Request finished HTTP/1.1 GET http://192.168.1.9:5053/ws/chat?userId=2 - 101 null null 377421.4513ms
2025-05-04 15:03:58.288 +07:00 [INF] Request finished HTTP/1.1 GET http://192.168.1.9:5053/ws/chat?userId=2 - 101 null null 377418.645ms
2025-05-04 15:04:01.496 +07:00 [INF] Executed endpoint '/ws/chat'
2025-05-04 15:04:01.498 +07:00 [INF] Executed endpoint '/ws/chat'
2025-05-04 15:04:01.498 +07:00 [ERR] An unhandled exception has occurred while executing the request.
StackExchange.Redis.RedisServerException: WRONGTYPE Operation against a key holding the wrong kind of value
   at server.Services.WebSocketService.webSocket.CleanupClient(Client client) in C:\Users\Thao\source\Flutter\Message_app\server\Services\WebSocketService\websocket.cs:line 455
   at server.Services.WebSocketService.webSocket.HandleWebSocket(HttpContext context) in C:\Users\Thao\source\Flutter\Message_app\server\Services\WebSocketService\websocket.cs:line 93
   at Program.<>c.<<<Main>$>b__0_4>d.MoveNext() in C:\Users\Thao\source\Flutter\Message_app\server\Program.cs:line 89
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
2025-05-04 15:04:01.498 +07:00 [ERR] An unhandled exception has occurred while executing the request.
StackExchange.Redis.RedisServerException: WRONGTYPE Operation against a key holding the wrong kind of value
   at server.Services.WebSocketService.webSocket.CleanupClient(Client client) in C:\Users\Thao\source\Flutter\Message_app\server\Services\WebSocketService\websocket.cs:line 455
   at server.Services.WebSocketService.webSocket.HandleWebSocket(HttpContext context) in C:\Users\Thao\source\Flutter\Message_app\server\Services\WebSocketService\websocket.cs:line 93
   at Program.<>c.<<<Main>$>b__0_4>d.MoveNext() in C:\Users\Thao\source\Flutter\Message_app\server\Program.cs:line 89
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
2025-05-04 15:04:01.500 +07:00 [WRN] The response has already started, the error page middleware will not be executed.
2025-05-04 15:04:01.500 +07:00 [WRN] The response has already started, the error page middleware will not be executed.
2025-05-04 15:04:01.501 +07:00 [ERR] Connection id "0HNCAS5C1G4L3", Request id "0HNCAS5C1G4L3:00000001": An unhandled exception was thrown by the application.
StackExchange.Redis.RedisServerException: WRONGTYPE Operation against a key holding the wrong kind of value
   at server.Services.WebSocketService.webSocket.CleanupClient(Client client) in C:\Users\Thao\source\Flutter\Message_app\server\Services\WebSocketService\websocket.cs:line 455
   at server.Services.WebSocketService.webSocket.HandleWebSocket(HttpContext context) in C:\Users\Thao\source\Flutter\Message_app\server\Services\WebSocketService\websocket.cs:line 93
   at Program.<>c.<<<Main>$>b__0_4>d.MoveNext() in C:\Users\Thao\source\Flutter\Message_app\server\Program.cs:line 89
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Watch.BrowserRefresh.BrowserRefreshMiddleware.InvokeAsync(HttpContext context)
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.Http.HttpProtocol.ProcessRequests[TContext](IHttpApplication`1 application)
2025-05-04 15:04:01.501 +07:00 [ERR] Connection id "0HNCAS5C1G4L2", Request id "0HNCAS5C1G4L2:00000001": An unhandled exception was thrown by the application.
StackExchange.Redis.RedisServerException: WRONGTYPE Operation against a key holding the wrong kind of value
   at server.Services.WebSocketService.webSocket.CleanupClient(Client client) in C:\Users\Thao\source\Flutter\Message_app\server\Services\WebSocketService\websocket.cs:line 455
   at server.Services.WebSocketService.webSocket.HandleWebSocket(HttpContext context) in C:\Users\Thao\source\Flutter\Message_app\server\Services\WebSocketService\websocket.cs:line 93
   at Program.<>c.<<<Main>$>b__0_4>d.MoveNext() in C:\Users\Thao\source\Flutter\Message_app\server\Program.cs:line 89
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Watch.BrowserRefresh.BrowserRefreshMiddleware.InvokeAsync(HttpContext context)
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.Http.HttpProtocol.ProcessRequests[TContext](IHttpApplication`1 application)
2025-05-04 15:04:01.502 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5053/ws/chat?userId=5 - 101 null null 380685.1848ms
2025-05-04 15:04:01.505 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5053/ws/chat?userId=5 - 101 null null 380794.9579ms
2025-05-04 15:05:06.190 +07:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5053/api/Auth/login - null null
2025-05-04 15:05:06.198 +07:00 [INF] CORS policy execution successful.
2025-05-04 15:05:06.211 +07:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5053/api/Auth/login - 204 null null 23.5736ms
2025-05-04 15:05:06.219 +07:00 [INF] Request starting HTTP/1.1 POST http://localhost:5053/api/Auth/login - application/json 53
2025-05-04 15:05:06.220 +07:00 [INF] CORS policy execution successful.
2025-05-04 15:05:06.228 +07:00 [INF] CORS policy execution successful.
2025-05-04 15:05:06.233 +07:00 [INF] Executing endpoint 'Message_app.Controllers.AuthController.Login (Message_app)'
2025-05-04 15:05:06.326 +07:00 [INF] Route matched with {action = "Login", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Login(server.DTO.AuthDTO.LoginDTO) on controller Message_app.Controllers.AuthController (Message_app).
2025-05-04 15:05:06.817 +07:00 [INF] Executed DbCommand (76ms) [Parameters=[@__email_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[id], [u].[avatar_url], [u].[bio], [u].[birthday], [u].[created_at], [u].[email], [u].[gender], [u].[interests], [u].[location], [u].[password], [u].[passwordSalt], [u].[username]
FROM [Users] AS [u]
WHERE [u].[email] = @__email_0
2025-05-04 15:05:06.936 +07:00 [INF] Executing OkObjectResult, writing value of type 'server.DTO.AuthDTO.LoginRespose'.
2025-05-04 15:05:06.969 +07:00 [INF] Executed action Message_app.Controllers.AuthController.Login (Message_app) in 641.0721ms
2025-05-04 15:05:06.970 +07:00 [INF] Executed endpoint 'Message_app.Controllers.AuthController.Login (Message_app)'
2025-05-04 15:05:06.975 +07:00 [INF] Request finished HTTP/1.1 POST http://localhost:5053/api/Auth/login - 200 null application/json; charset=utf-8 755.9726ms
2025-05-04 15:05:07.172 +07:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5053/api/Conversation/get_conversations/5 - null null
2025-05-04 15:05:07.172 +07:00 [INF] CORS policy execution successful.
2025-05-04 15:05:07.173 +07:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5053/api/Conversation/get_conversations/5 - 204 null null 0.7579ms
2025-05-04 15:05:07.174 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/api/Conversation/get_conversations/5 - null null
2025-05-04 15:05:07.174 +07:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5053/api/Conversation/get_conversations/5 - null null
2025-05-04 15:05:07.175 +07:00 [INF] CORS policy execution successful.
2025-05-04 15:05:07.175 +07:00 [INF] CORS policy execution successful.
2025-05-04 15:05:07.176 +07:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5053/api/Conversation/get_conversations/5 - 204 null null 1.0351ms
2025-05-04 15:05:07.178 +07:00 [INF] CORS policy execution successful.
2025-05-04 15:05:07.178 +07:00 [INF] Executing endpoint 'server.Controllers.ConversationController.GetConversations (Message_app)'
2025-05-04 15:05:07.187 +07:00 [INF] Route matched with {action = "GetConversations", controller = "Conversation"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetConversations(Int32) on controller server.Controllers.ConversationController (Message_app).
2025-05-04 15:05:07.213 +07:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[server.DTO.ConversationDto, Message_app, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-05-04 15:05:07.217 +07:00 [INF] Executed action server.Controllers.ConversationController.GetConversations (Message_app) in 29.833ms
2025-05-04 15:05:07.218 +07:00 [INF] Executed endpoint 'server.Controllers.ConversationController.GetConversations (Message_app)'
2025-05-04 15:05:07.218 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5053/api/Conversation/get_conversations/5 - 200 null application/json; charset=utf-8 43.4018ms
2025-05-04 15:05:07.219 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/api/Conversation/get_conversations/5 - null null
2025-05-04 15:05:07.219 +07:00 [INF] CORS policy execution successful.
2025-05-04 15:05:07.220 +07:00 [INF] CORS policy execution successful.
2025-05-04 15:05:07.220 +07:00 [INF] Executing endpoint 'server.Controllers.ConversationController.GetConversations (Message_app)'
2025-05-04 15:05:07.220 +07:00 [INF] Route matched with {action = "GetConversations", controller = "Conversation"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetConversations(Int32) on controller server.Controllers.ConversationController (Message_app).
2025-05-04 15:05:07.223 +07:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[server.DTO.ConversationDto, Message_app, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-05-04 15:05:07.223 +07:00 [INF] Executed action server.Controllers.ConversationController.GetConversations (Message_app) in 2.8647ms
2025-05-04 15:05:07.224 +07:00 [INF] Executed endpoint 'server.Controllers.ConversationController.GetConversations (Message_app)'
2025-05-04 15:05:07.224 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5053/api/Conversation/get_conversations/5 - 200 null application/json; charset=utf-8 5.6308ms
2025-05-04 15:05:07.345 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/ws/chat?userId=5 - null null
2025-05-04 15:05:07.346 +07:00 [INF] CORS policy execution successful.
2025-05-04 15:05:07.346 +07:00 [INF] CORS policy execution successful.
2025-05-04 15:05:07.346 +07:00 [INF] Executing endpoint '/ws/chat'
2025-05-04 15:05:07.440 +07:00 [INF] Executed DbCommand (15ms) [Parameters=[@__client_UserId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[conversation_id]
FROM [Participants] AS [p]
WHERE [p].[user_id] = @__client_UserId_0 AND [p].[is_deleted] = CAST(0 AS bit)
2025-05-04 15:05:21.068 +07:00 [INF] Request starting HTTP/1.1 POST http://192.168.1.9:5053/api/Auth/login - application/json 57
2025-05-04 15:05:21.073 +07:00 [INF] Executing endpoint 'Message_app.Controllers.AuthController.Login (Message_app)'
2025-05-04 15:05:21.073 +07:00 [INF] Route matched with {action = "Login", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Login(server.DTO.AuthDTO.LoginDTO) on controller Message_app.Controllers.AuthController (Message_app).
2025-05-04 15:05:21.099 +07:00 [INF] Executed DbCommand (10ms) [Parameters=[@__email_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[id], [u].[avatar_url], [u].[bio], [u].[birthday], [u].[created_at], [u].[email], [u].[gender], [u].[interests], [u].[location], [u].[password], [u].[passwordSalt], [u].[username]
FROM [Users] AS [u]
WHERE [u].[email] = @__email_0
2025-05-04 15:05:21.101 +07:00 [INF] Executing OkObjectResult, writing value of type 'server.DTO.AuthDTO.LoginRespose'.
2025-05-04 15:05:21.102 +07:00 [INF] Executed action Message_app.Controllers.AuthController.Login (Message_app) in 28.6123ms
2025-05-04 15:05:21.102 +07:00 [INF] Executed endpoint 'Message_app.Controllers.AuthController.Login (Message_app)'
2025-05-04 15:05:21.102 +07:00 [INF] Request finished HTTP/1.1 POST http://192.168.1.9:5053/api/Auth/login - 200 null application/json; charset=utf-8 34.5388ms
2025-05-04 15:05:23.235 +07:00 [INF] Request starting HTTP/1.1 GET http://192.168.1.9:5053/api/Conversation/get_conversations/2 - null null
2025-05-04 15:05:23.236 +07:00 [INF] Executing endpoint 'server.Controllers.ConversationController.GetConversations (Message_app)'
2025-05-04 15:05:23.238 +07:00 [INF] Route matched with {action = "GetConversations", controller = "Conversation"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetConversations(Int32) on controller server.Controllers.ConversationController (Message_app).
2025-05-04 15:05:23.238 +07:00 [INF] Request starting HTTP/1.1 GET http://192.168.1.9:5053/api/Conversation/get_conversations/2 - null null
2025-05-04 15:05:23.238 +07:00 [INF] Executing endpoint 'server.Controllers.ConversationController.GetConversations (Message_app)'
2025-05-04 15:05:23.238 +07:00 [INF] Route matched with {action = "GetConversations", controller = "Conversation"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetConversations(Int32) on controller server.Controllers.ConversationController (Message_app).
2025-05-04 15:05:23.241 +07:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[server.DTO.ConversationDto, Message_app, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-05-04 15:05:23.241 +07:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[server.DTO.ConversationDto, Message_app, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-05-04 15:05:23.242 +07:00 [INF] Executed action server.Controllers.ConversationController.GetConversations (Message_app) in 3.5485ms
2025-05-04 15:05:23.242 +07:00 [INF] Executed action server.Controllers.ConversationController.GetConversations (Message_app) in 3.2002ms
2025-05-04 15:05:23.242 +07:00 [INF] Executed endpoint 'server.Controllers.ConversationController.GetConversations (Message_app)'
2025-05-04 15:05:23.242 +07:00 [INF] Request finished HTTP/1.1 GET http://192.168.1.9:5053/api/Conversation/get_conversations/2 - 200 null application/json; charset=utf-8 3.6092ms
2025-05-04 15:05:23.242 +07:00 [INF] Executed endpoint 'server.Controllers.ConversationController.GetConversations (Message_app)'
2025-05-04 15:05:23.242 +07:00 [INF] Request finished HTTP/1.1 GET http://192.168.1.9:5053/api/Conversation/get_conversations/2 - 200 null application/json; charset=utf-8 6.8107ms
2025-05-04 15:05:23.345 +07:00 [INF] Request starting HTTP/1.1 GET http://192.168.1.9:5053/ws/chat?userId=2 - null null
2025-05-04 15:05:23.345 +07:00 [INF] Executing endpoint '/ws/chat'
2025-05-04 15:05:23.681 +07:00 [INF] Executed DbCommand (6ms) [Parameters=[@__client_UserId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[conversation_id]
FROM [Participants] AS [p]
WHERE [p].[user_id] = @__client_UserId_0 AND [p].[is_deleted] = CAST(0 AS bit)
2025-05-04 15:05:25.154 +07:00 [INF] Request starting HTTP/1.1 GET http://192.168.1.9:5053/api/Participant/get_participants/1 - null null
2025-05-04 15:05:25.155 +07:00 [INF] Executing endpoint 'server.Controllers.ParticipantController.GetParticipants (Message_app)'
2025-05-04 15:05:25.158 +07:00 [INF] Route matched with {action = "GetParticipants", controller = "Participant"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetParticipants(Int32) on controller server.Controllers.ParticipantController (Message_app).
2025-05-04 15:05:25.174 +07:00 [INF] Executed DbCommand (8ms) [Parameters=[@__conversation_id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[id], [p].[adder], [p].[conversation_id], [p].[is_deleted], [p].[joined_at], [p].[name], [p].[role], [p].[user_id]
FROM [Participants] AS [p]
WHERE [p].[conversation_id] = @__conversation_id_0
2025-05-04 15:05:25.187 +07:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType17`1[[System.Collections.Generic.List`1[[server.Models.Participants, Message_app, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-05-04 15:05:25.193 +07:00 [INF] Executed action server.Controllers.ParticipantController.GetParticipants (Message_app) in 35.5382ms
2025-05-04 15:05:25.193 +07:00 [INF] Executed endpoint 'server.Controllers.ParticipantController.GetParticipants (Message_app)'
2025-05-04 15:05:25.194 +07:00 [INF] Request finished HTTP/1.1 GET http://192.168.1.9:5053/api/Participant/get_participants/1 - 200 null application/json; charset=utf-8 39.6047ms
2025-05-04 15:05:25.544 +07:00 [INF] Request starting HTTP/1.1 GET http://192.168.1.9:5053/api/Message/getMessages/1/2 - null null
2025-05-04 15:05:25.544 +07:00 [INF] Executing endpoint 'server.Controllers.MessageController.GetMessages (Message_app)'
2025-05-04 15:05:25.550 +07:00 [INF] Route matched with {action = "GetMessages", controller = "Message"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetMessages(Int32, Int32) on controller server.Controllers.MessageController (Message_app).
2025-05-04 15:05:25.590 +07:00 [WRN] Message 87 not found in Redis
2025-05-04 15:05:25.591 +07:00 [WRN] Message 86 not found in Redis
2025-05-04 15:05:25.591 +07:00 [WRN] Message 85 not found in Redis
2025-05-04 15:05:25.591 +07:00 [WRN] Message 84 not found in Redis
2025-05-04 15:05:25.591 +07:00 [WRN] Message 83 not found in Redis
2025-05-04 15:05:25.592 +07:00 [WRN] Message 82 not found in Redis
2025-05-04 15:05:25.592 +07:00 [WRN] Message 81 not found in Redis
2025-05-04 15:05:25.592 +07:00 [WRN] Message 80 not found in Redis
2025-05-04 15:05:25.592 +07:00 [WRN] Message 79 not found in Redis
2025-05-04 15:05:25.593 +07:00 [WRN] Message 78 not found in Redis
2025-05-04 15:05:25.593 +07:00 [WRN] Message 77 not found in Redis
2025-05-04 15:05:25.593 +07:00 [WRN] Message 76 not found in Redis
2025-05-04 15:05:25.593 +07:00 [WRN] Message 75 not found in Redis
2025-05-04 15:05:25.594 +07:00 [WRN] Message 74 not found in Redis
2025-05-04 15:05:25.594 +07:00 [WRN] Message 73 not found in Redis
2025-05-04 15:05:25.594 +07:00 [WRN] Message 72 not found in Redis
2025-05-04 15:05:25.594 +07:00 [WRN] Message 71 not found in Redis
2025-05-04 15:05:25.595 +07:00 [WRN] Message 68 not found in Redis
2025-05-04 15:05:25.595 +07:00 [WRN] Message 64 not found in Redis
2025-05-04 15:05:25.595 +07:00 [WRN] Message 62 not found in Redis
2025-05-04 15:05:25.596 +07:00 [WRN] Message 61 not found in Redis
2025-05-04 15:05:25.596 +07:00 [WRN] Message 60 not found in Redis
2025-05-04 15:05:25.597 +07:00 [WRN] Message 59 not found in Redis
2025-05-04 15:05:25.597 +07:00 [WRN] Message 57 not found in Redis
2025-05-04 15:05:25.597 +07:00 [WRN] Message 55 not found in Redis
2025-05-04 15:05:25.598 +07:00 [WRN] Message 54 not found in Redis
2025-05-04 15:05:25.598 +07:00 [WRN] Message 51 not found in Redis
2025-05-04 15:05:25.599 +07:00 [WRN] Message 49 not found in Redis
2025-05-04 15:05:25.601 +07:00 [WRN] Message 11 not found in Redis
2025-05-04 15:05:25.602 +07:00 [WRN] Message 8 not found in Redis
2025-05-04 15:05:25.603 +07:00 [WRN] Message 3 not found in Redis
2025-05-04 15:05:25.604 +07:00 [WRN] Message 2 not found in Redis
2025-05-04 15:05:25.605 +07:00 [WRN] Message 1 not found in Redis
2025-05-04 15:05:25.605 +07:00 [INF] Retrieved 19 messages from Redis for conversation 1
2025-05-04 15:05:25.609 +07:00 [INF] Retrieved 19 messages from Redis for conversation 1 and user 2
2025-05-04 15:05:25.610 +07:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[server.DTO.MessageWithAttachment, Message_app, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-05-04 15:05:25.613 +07:00 [INF] Executed action server.Controllers.MessageController.GetMessages (Message_app) in 62.6676ms
2025-05-04 15:05:25.613 +07:00 [INF] Executed endpoint 'server.Controllers.MessageController.GetMessages (Message_app)'
2025-05-04 15:05:25.613 +07:00 [INF] Request finished HTTP/1.1 GET http://192.168.1.9:5053/api/Message/getMessages/1/2 - 200 null application/json; charset=utf-8 69.2893ms
2025-05-04 15:05:25.653 +07:00 [INF] Request starting HTTP/1.1 GET http://192.168.1.9:5053/api/Conversation/get_first_conversation/1 - null null
2025-05-04 15:05:25.655 +07:00 [INF] Executing endpoint 'server.Controllers.ConversationController.GetFirstConversation (Message_app)'
2025-05-04 15:05:25.660 +07:00 [INF] Route matched with {action = "GetFirstConversation", controller = "Conversation"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetFirstConversation(Int32) on controller server.Controllers.ConversationController (Message_app).
2025-05-04 15:05:25.717 +07:00 [INF] Executed DbCommand (8ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[id], [c].[created_at], [c].[is_group], [c].[lastMessage], [c].[lastMessageSender], [c].[lastMessageTime], [c].[name]
FROM [Conversations] AS [c]
WHERE [c].[id] = @__p_0
2025-05-04 15:05:25.734 +07:00 [INF] Executing OkObjectResult, writing value of type 'server.Models.Conversation'.
2025-05-04 15:05:25.735 +07:00 [INF] Executed action server.Controllers.ConversationController.GetFirstConversation (Message_app) in 75.5159ms
2025-05-04 15:05:25.736 +07:00 [INF] Executed endpoint 'server.Controllers.ConversationController.GetFirstConversation (Message_app)'
2025-05-04 15:05:25.736 +07:00 [INF] Request finished HTTP/1.1 GET http://192.168.1.9:5053/api/Conversation/get_first_conversation/1 - 200 null application/json; charset=utf-8 82.4994ms
2025-05-04 15:05:25.769 +07:00 [INF] Request starting HTTP/1.1 GET http://192.168.1.9:5053/api/Participant/get_participants/1 - null null
2025-05-04 15:05:25.770 +07:00 [INF] Executing endpoint 'server.Controllers.ParticipantController.GetParticipants (Message_app)'
2025-05-04 15:05:25.770 +07:00 [INF] Route matched with {action = "GetParticipants", controller = "Participant"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetParticipants(Int32) on controller server.Controllers.ParticipantController (Message_app).
2025-05-04 15:05:25.773 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__conversation_id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[id], [p].[adder], [p].[conversation_id], [p].[is_deleted], [p].[joined_at], [p].[name], [p].[role], [p].[user_id]
FROM [Participants] AS [p]
WHERE [p].[conversation_id] = @__conversation_id_0
2025-05-04 15:05:25.774 +07:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType17`1[[System.Collections.Generic.List`1[[server.Models.Participants, Message_app, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-05-04 15:05:25.774 +07:00 [INF] Executed action server.Controllers.ParticipantController.GetParticipants (Message_app) in 3.9411ms
2025-05-04 15:05:25.774 +07:00 [INF] Executed endpoint 'server.Controllers.ParticipantController.GetParticipants (Message_app)'
2025-05-04 15:05:25.774 +07:00 [INF] Request finished HTTP/1.1 GET http://192.168.1.9:5053/api/Participant/get_participants/1 - 200 null application/json; charset=utf-8 5.7822ms
2025-05-04 15:05:26.811 +07:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5053/api/Participant/get_participants/1 - null null
2025-05-04 15:05:26.812 +07:00 [INF] CORS policy execution successful.
2025-05-04 15:05:26.813 +07:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5053/api/Participant/get_participants/1 - 204 null null 1.6253ms
2025-05-04 15:05:26.815 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/api/Participant/get_participants/1 - null null
2025-05-04 15:05:26.816 +07:00 [INF] CORS policy execution successful.
2025-05-04 15:05:26.816 +07:00 [INF] CORS policy execution successful.
2025-05-04 15:05:26.817 +07:00 [INF] Executing endpoint 'server.Controllers.ParticipantController.GetParticipants (Message_app)'
2025-05-04 15:05:26.817 +07:00 [INF] Route matched with {action = "GetParticipants", controller = "Participant"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetParticipants(Int32) on controller server.Controllers.ParticipantController (Message_app).
2025-05-04 15:05:26.823 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__conversation_id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[id], [p].[adder], [p].[conversation_id], [p].[is_deleted], [p].[joined_at], [p].[name], [p].[role], [p].[user_id]
FROM [Participants] AS [p]
WHERE [p].[conversation_id] = @__conversation_id_0
2025-05-04 15:05:26.824 +07:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType17`1[[System.Collections.Generic.List`1[[server.Models.Participants, Message_app, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-05-04 15:05:26.825 +07:00 [INF] Executed action server.Controllers.ParticipantController.GetParticipants (Message_app) in 6.6463ms
2025-05-04 15:05:26.826 +07:00 [INF] Executed endpoint 'server.Controllers.ParticipantController.GetParticipants (Message_app)'
2025-05-04 15:05:26.826 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5053/api/Participant/get_participants/1 - 200 null application/json; charset=utf-8 11.2936ms
2025-05-04 15:05:26.970 +07:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5053/api/Message/getMessages/1/5 - null null
2025-05-04 15:05:26.970 +07:00 [INF] CORS policy execution successful.
2025-05-04 15:05:26.970 +07:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5053/api/Message/getMessages/1/5 - 204 null null 0.4211ms
2025-05-04 15:05:26.972 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/api/Message/getMessages/1/5 - null null
2025-05-04 15:05:26.972 +07:00 [INF] CORS policy execution successful.
2025-05-04 15:05:26.973 +07:00 [INF] CORS policy execution successful.
2025-05-04 15:05:26.973 +07:00 [INF] Executing endpoint 'server.Controllers.MessageController.GetMessages (Message_app)'
2025-05-04 15:05:26.973 +07:00 [INF] Route matched with {action = "GetMessages", controller = "Message"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetMessages(Int32, Int32) on controller server.Controllers.MessageController (Message_app).
2025-05-04 15:05:26.979 +07:00 [WRN] Message 87 not found in Redis
2025-05-04 15:05:26.980 +07:00 [WRN] Message 86 not found in Redis
2025-05-04 15:05:26.980 +07:00 [WRN] Message 85 not found in Redis
2025-05-04 15:05:26.980 +07:00 [WRN] Message 84 not found in Redis
2025-05-04 15:05:26.980 +07:00 [WRN] Message 83 not found in Redis
2025-05-04 15:05:26.981 +07:00 [WRN] Message 82 not found in Redis
2025-05-04 15:05:26.981 +07:00 [WRN] Message 81 not found in Redis
2025-05-04 15:05:26.981 +07:00 [WRN] Message 80 not found in Redis
2025-05-04 15:05:26.981 +07:00 [WRN] Message 79 not found in Redis
2025-05-04 15:05:26.982 +07:00 [WRN] Message 78 not found in Redis
2025-05-04 15:05:26.982 +07:00 [WRN] Message 77 not found in Redis
2025-05-04 15:05:26.982 +07:00 [WRN] Message 76 not found in Redis
2025-05-04 15:05:26.983 +07:00 [WRN] Message 75 not found in Redis
2025-05-04 15:05:26.983 +07:00 [WRN] Message 74 not found in Redis
2025-05-04 15:05:26.984 +07:00 [WRN] Message 73 not found in Redis
2025-05-04 15:05:26.984 +07:00 [WRN] Message 72 not found in Redis
2025-05-04 15:05:26.984 +07:00 [WRN] Message 71 not found in Redis
2025-05-04 15:05:26.985 +07:00 [WRN] Message 68 not found in Redis
2025-05-04 15:05:26.985 +07:00 [WRN] Message 64 not found in Redis
2025-05-04 15:05:26.986 +07:00 [WRN] Message 62 not found in Redis
2025-05-04 15:05:26.986 +07:00 [WRN] Message 61 not found in Redis
2025-05-04 15:05:26.987 +07:00 [WRN] Message 60 not found in Redis
2025-05-04 15:05:26.987 +07:00 [WRN] Message 59 not found in Redis
2025-05-04 15:05:26.988 +07:00 [WRN] Message 57 not found in Redis
2025-05-04 15:05:26.988 +07:00 [WRN] Message 55 not found in Redis
2025-05-04 15:05:26.989 +07:00 [WRN] Message 54 not found in Redis
2025-05-04 15:05:26.989 +07:00 [WRN] Message 51 not found in Redis
2025-05-04 15:05:26.989 +07:00 [WRN] Message 49 not found in Redis
2025-05-04 15:05:26.990 +07:00 [WRN] Message 11 not found in Redis
2025-05-04 15:05:26.990 +07:00 [WRN] Message 8 not found in Redis
2025-05-04 15:05:26.991 +07:00 [WRN] Message 3 not found in Redis
2025-05-04 15:05:26.991 +07:00 [WRN] Message 2 not found in Redis
2025-05-04 15:05:26.992 +07:00 [WRN] Message 1 not found in Redis
2025-05-04 15:05:26.992 +07:00 [INF] Retrieved 19 messages from Redis for conversation 1
2025-05-04 15:05:26.992 +07:00 [INF] Retrieved 19 messages from Redis for conversation 1 and user 5
2025-05-04 15:05:26.992 +07:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[server.DTO.MessageWithAttachment, Message_app, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-05-04 15:05:26.993 +07:00 [INF] Executed action server.Controllers.MessageController.GetMessages (Message_app) in 19.5174ms
2025-05-04 15:05:26.993 +07:00 [INF] Executed endpoint 'server.Controllers.MessageController.GetMessages (Message_app)'
2025-05-04 15:05:26.993 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5053/api/Message/getMessages/1/5 - 200 null application/json; charset=utf-8 21.2532ms
2025-05-04 15:05:27.004 +07:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5053/api/Conversation/get_first_conversation/1 - null null
2025-05-04 15:05:27.004 +07:00 [INF] CORS policy execution successful.
2025-05-04 15:05:27.004 +07:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5053/api/Conversation/get_first_conversation/1 - 204 null null 0.3251ms
2025-05-04 15:05:27.010 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/api/Conversation/get_first_conversation/1 - null null
2025-05-04 15:05:27.010 +07:00 [INF] CORS policy execution successful.
2025-05-04 15:05:27.010 +07:00 [INF] CORS policy execution successful.
2025-05-04 15:05:27.010 +07:00 [INF] Executing endpoint 'server.Controllers.ConversationController.GetFirstConversation (Message_app)'
2025-05-04 15:05:27.010 +07:00 [INF] Route matched with {action = "GetFirstConversation", controller = "Conversation"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetFirstConversation(Int32) on controller server.Controllers.ConversationController (Message_app).
2025-05-04 15:05:27.023 +07:00 [INF] Executed DbCommand (8ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[id], [c].[created_at], [c].[is_group], [c].[lastMessage], [c].[lastMessageSender], [c].[lastMessageTime], [c].[name]
FROM [Conversations] AS [c]
WHERE [c].[id] = @__p_0
2025-05-04 15:05:27.023 +07:00 [INF] Executing OkObjectResult, writing value of type 'server.Models.Conversation'.
2025-05-04 15:05:27.023 +07:00 [INF] Executed action server.Controllers.ConversationController.GetFirstConversation (Message_app) in 13.1538ms
2025-05-04 15:05:27.024 +07:00 [INF] Executed endpoint 'server.Controllers.ConversationController.GetFirstConversation (Message_app)'
2025-05-04 15:05:27.024 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5053/api/Conversation/get_first_conversation/1 - 200 null application/json; charset=utf-8 13.9387ms
2025-05-04 15:05:27.032 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/api/Participant/get_participants/1 - null null
2025-05-04 15:05:27.033 +07:00 [INF] CORS policy execution successful.
2025-05-04 15:05:27.033 +07:00 [INF] CORS policy execution successful.
2025-05-04 15:05:27.033 +07:00 [INF] Executing endpoint 'server.Controllers.ParticipantController.GetParticipants (Message_app)'
2025-05-04 15:05:27.033 +07:00 [INF] Route matched with {action = "GetParticipants", controller = "Participant"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetParticipants(Int32) on controller server.Controllers.ParticipantController (Message_app).
2025-05-04 15:05:27.037 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__conversation_id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[id], [p].[adder], [p].[conversation_id], [p].[is_deleted], [p].[joined_at], [p].[name], [p].[role], [p].[user_id]
FROM [Participants] AS [p]
WHERE [p].[conversation_id] = @__conversation_id_0
2025-05-04 15:05:27.038 +07:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType17`1[[System.Collections.Generic.List`1[[server.Models.Participants, Message_app, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-05-04 15:05:27.038 +07:00 [INF] Executed action server.Controllers.ParticipantController.GetParticipants (Message_app) in 4.6607ms
2025-05-04 15:05:27.038 +07:00 [INF] Executed endpoint 'server.Controllers.ParticipantController.GetParticipants (Message_app)'
2025-05-04 15:05:27.039 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5053/api/Participant/get_participants/1 - 200 null application/json; charset=utf-8 6.2636ms
2025-05-04 15:05:31.633 +07:00 [INF] Request starting HTTP/1.1 GET http://192.168.1.9:5053/api/Message/getMessages/1/2 - null null
2025-05-04 15:05:31.634 +07:00 [INF] Executing endpoint 'server.Controllers.MessageController.GetMessages (Message_app)'
2025-05-04 15:05:31.634 +07:00 [INF] Route matched with {action = "GetMessages", controller = "Message"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetMessages(Int32, Int32) on controller server.Controllers.MessageController (Message_app).
2025-05-04 15:05:31.645 +07:00 [WRN] Message 87 not found in Redis
2025-05-04 15:05:31.645 +07:00 [WRN] Message 86 not found in Redis
2025-05-04 15:05:31.645 +07:00 [WRN] Message 85 not found in Redis
2025-05-04 15:05:31.646 +07:00 [WRN] Message 84 not found in Redis
2025-05-04 15:05:31.646 +07:00 [WRN] Message 83 not found in Redis
2025-05-04 15:05:31.646 +07:00 [WRN] Message 82 not found in Redis
2025-05-04 15:05:31.646 +07:00 [WRN] Message 81 not found in Redis
2025-05-04 15:05:31.647 +07:00 [WRN] Message 80 not found in Redis
2025-05-04 15:05:31.647 +07:00 [WRN] Message 79 not found in Redis
2025-05-04 15:05:31.647 +07:00 [WRN] Message 78 not found in Redis
2025-05-04 15:05:31.647 +07:00 [WRN] Message 77 not found in Redis
2025-05-04 15:05:31.648 +07:00 [WRN] Message 76 not found in Redis
2025-05-04 15:05:31.648 +07:00 [WRN] Message 75 not found in Redis
2025-05-04 15:05:31.648 +07:00 [WRN] Message 74 not found in Redis
2025-05-04 15:05:31.648 +07:00 [WRN] Message 73 not found in Redis
2025-05-04 15:05:31.649 +07:00 [WRN] Message 72 not found in Redis
2025-05-04 15:05:31.649 +07:00 [WRN] Message 71 not found in Redis
2025-05-04 15:05:31.649 +07:00 [WRN] Message 68 not found in Redis
2025-05-04 15:05:31.650 +07:00 [WRN] Message 64 not found in Redis
2025-05-04 15:05:31.650 +07:00 [WRN] Message 62 not found in Redis
2025-05-04 15:05:31.651 +07:00 [WRN] Message 61 not found in Redis
2025-05-04 15:05:31.651 +07:00 [WRN] Message 60 not found in Redis
2025-05-04 15:05:31.651 +07:00 [WRN] Message 59 not found in Redis
2025-05-04 15:05:31.652 +07:00 [WRN] Message 57 not found in Redis
2025-05-04 15:05:31.652 +07:00 [WRN] Message 55 not found in Redis
2025-05-04 15:05:31.652 +07:00 [WRN] Message 54 not found in Redis
2025-05-04 15:05:31.653 +07:00 [WRN] Message 51 not found in Redis
2025-05-04 15:05:31.653 +07:00 [WRN] Message 49 not found in Redis
2025-05-04 15:05:31.653 +07:00 [WRN] Message 11 not found in Redis
2025-05-04 15:05:31.653 +07:00 [WRN] Message 8 not found in Redis
2025-05-04 15:05:31.654 +07:00 [WRN] Message 3 not found in Redis
2025-05-04 15:05:31.654 +07:00 [WRN] Message 2 not found in Redis
2025-05-04 15:05:31.654 +07:00 [WRN] Message 1 not found in Redis
2025-05-04 15:05:31.654 +07:00 [INF] Retrieved 19 messages from Redis for conversation 1
2025-05-04 15:05:31.654 +07:00 [INF] Retrieved 19 messages from Redis for conversation 1 and user 2
2025-05-04 15:05:31.655 +07:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[server.DTO.MessageWithAttachment, Message_app, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-05-04 15:05:31.655 +07:00 [INF] Executed action server.Controllers.MessageController.GetMessages (Message_app) in 20.6418ms
2025-05-04 15:05:31.655 +07:00 [INF] Executed endpoint 'server.Controllers.MessageController.GetMessages (Message_app)'
2025-05-04 15:05:31.655 +07:00 [INF] Request finished HTTP/1.1 GET http://192.168.1.9:5053/api/Message/getMessages/1/2 - 200 null application/json; charset=utf-8 21.8007ms
2025-05-04 15:05:31.704 +07:00 [INF] Request starting HTTP/1.1 GET http://192.168.1.9:5053/api/Conversation/get_first_conversation/1 - null null
2025-05-04 15:05:31.705 +07:00 [INF] Executing endpoint 'server.Controllers.ConversationController.GetFirstConversation (Message_app)'
2025-05-04 15:05:31.705 +07:00 [INF] Route matched with {action = "GetFirstConversation", controller = "Conversation"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetFirstConversation(Int32) on controller server.Controllers.ConversationController (Message_app).
2025-05-04 15:05:31.708 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[id], [c].[created_at], [c].[is_group], [c].[lastMessage], [c].[lastMessageSender], [c].[lastMessageTime], [c].[name]
FROM [Conversations] AS [c]
WHERE [c].[id] = @__p_0
2025-05-04 15:05:31.708 +07:00 [INF] Executing OkObjectResult, writing value of type 'server.Models.Conversation'.
2025-05-04 15:05:31.709 +07:00 [INF] Executed action server.Controllers.ConversationController.GetFirstConversation (Message_app) in 3.7453ms
2025-05-04 15:05:31.709 +07:00 [INF] Executed endpoint 'server.Controllers.ConversationController.GetFirstConversation (Message_app)'
2025-05-04 15:05:31.709 +07:00 [INF] Request finished HTTP/1.1 GET http://192.168.1.9:5053/api/Conversation/get_first_conversation/1 - 200 null application/json; charset=utf-8 4.721ms
2025-05-04 15:05:31.734 +07:00 [INF] Request starting HTTP/1.1 GET http://192.168.1.9:5053/api/Participant/get_participants/1 - null null
2025-05-04 15:05:31.734 +07:00 [INF] Executing endpoint 'server.Controllers.ParticipantController.GetParticipants (Message_app)'
2025-05-04 15:05:31.735 +07:00 [INF] Route matched with {action = "GetParticipants", controller = "Participant"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetParticipants(Int32) on controller server.Controllers.ParticipantController (Message_app).
2025-05-04 15:05:31.737 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__conversation_id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[id], [p].[adder], [p].[conversation_id], [p].[is_deleted], [p].[joined_at], [p].[name], [p].[role], [p].[user_id]
FROM [Participants] AS [p]
WHERE [p].[conversation_id] = @__conversation_id_0
2025-05-04 15:05:31.738 +07:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType17`1[[System.Collections.Generic.List`1[[server.Models.Participants, Message_app, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-05-04 15:05:31.738 +07:00 [INF] Executed action server.Controllers.ParticipantController.GetParticipants (Message_app) in 3.7701ms
2025-05-04 15:05:31.738 +07:00 [INF] Executed endpoint 'server.Controllers.ParticipantController.GetParticipants (Message_app)'
2025-05-04 15:05:31.739 +07:00 [INF] Request finished HTTP/1.1 GET http://192.168.1.9:5053/api/Participant/get_participants/1 - 200 null application/json; charset=utf-8 4.7217ms
2025-05-04 15:05:42.209 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/ws/chat?userId=5 - null null
2025-05-04 15:05:42.209 +07:00 [INF] CORS policy execution successful.
2025-05-04 15:05:42.210 +07:00 [INF] CORS policy execution successful.
2025-05-04 15:05:42.211 +07:00 [INF] Executing endpoint '/ws/chat'
2025-05-04 15:05:42.237 +07:00 [INF] Executed DbCommand (7ms) [Parameters=[@__client_UserId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[conversation_id]
FROM [Participants] AS [p]
WHERE [p].[user_id] = @__client_UserId_0 AND [p].[is_deleted] = CAST(0 AS bit)
2025-05-04 15:05:45.313 +07:00 [INF] Request starting HTTP/1.1 GET http://192.168.1.9:5053/ws/chat?userId=2 - null null
2025-05-04 15:05:45.314 +07:00 [INF] Executing endpoint '/ws/chat'
2025-05-04 15:05:45.365 +07:00 [INF] Executed DbCommand (7ms) [Parameters=[@__client_UserId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[conversation_id]
FROM [Participants] AS [p]
WHERE [p].[user_id] = @__client_UserId_0 AND [p].[is_deleted] = CAST(0 AS bit)
2025-05-04 15:06:08.427 +07:00 [INF] Handling message from user 2: hhjs
2025-05-04 15:06:08.434 +07:00 [INF] Executed DbCommand (4ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[id], [c].[created_at], [c].[is_group], [c].[lastMessage], [c].[lastMessageSender], [c].[lastMessageTime], [c].[name]
FROM [Conversations] AS [c]
WHERE [c].[id] = @__p_0
2025-05-04 15:06:08.569 +07:00 [WRN] Savepoints are disabled because Multiple Active Result Sets (MARS) is enabled. If 'SaveChanges' fails, then the transaction cannot be automatically rolled back to a known clean state. Instead, the transaction should be rolled back by the application before retrying 'SaveChanges'. See https://go.microsoft.com/fwlink/?linkid=2149338 for more information and examples. To identify the code which triggers this warning, call 'ConfigureWarnings(w => w.Throw(SqlServerEventId.SavepointsDisabledBecauseOfMARS))'.
2025-05-04 15:06:08.615 +07:00 [INF] Executed DbCommand (44ms) [Parameters=[@p0='?' (Size = 500), @p1='?' (DbType = Int32), @p2='?' (DbType = DateTime2), @p3='?' (DbType = Boolean), @p4='?' (DbType = Boolean), @p5='?' (DbType = Boolean), @p6='?' (DbType = Int32), @p7='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Messages] ([content], [conversation_id], [created_at], [isFile], [isRecalled], [is_read], [sender_id], [type])
OUTPUT INSERTED.[id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7);
2025-05-04 15:06:08.631 +07:00 [INF] Message saved to DB with ID: 112
2025-05-04 15:06:08.635 +07:00 [WRN] Savepoints are disabled because Multiple Active Result Sets (MARS) is enabled. If 'SaveChanges' fails, then the transaction cannot be automatically rolled back to a known clean state. Instead, the transaction should be rolled back by the application before retrying 'SaveChanges'. See https://go.microsoft.com/fwlink/?linkid=2149338 for more information and examples. To identify the code which triggers this warning, call 'ConfigureWarnings(w => w.Throw(SqlServerEventId.SavepointsDisabledBecauseOfMARS))'.
2025-05-04 15:06:08.649 +07:00 [INF] Executed DbCommand (14ms) [Parameters=[@p6='?' (DbType = Int32), @p0='?' (DbType = DateTime2), @p1='?' (DbType = Boolean), @p2='?' (Size = 4000), @p3='?' (Size = 4000), @p4='?' (DbType = DateTime2), @p5='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
UPDATE [Conversations] SET [created_at] = @p0, [is_group] = @p1, [lastMessage] = @p2, [lastMessageSender] = @p3, [lastMessageTime] = @p4, [name] = @p5
OUTPUT 1
WHERE [id] = @p6;
2025-05-04 15:06:08.669 +07:00 [INF] Transaction committed for message: 112
2025-05-04 15:06:08.676 +07:00 [INF] Saved message 112 to Redis
2025-05-04 15:06:08.678 +07:00 [INF] Added message 112 to conversation 1
2025-05-04 15:06:08.684 +07:00 [INF] Published message to channel conversation:1
2025-05-04 15:06:13.478 +07:00 [INF] Handling message from user 5: njl
2025-05-04 15:06:13.484 +07:00 [INF] Executed DbCommand (4ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[id], [c].[created_at], [c].[is_group], [c].[lastMessage], [c].[lastMessageSender], [c].[lastMessageTime], [c].[name]
FROM [Conversations] AS [c]
WHERE [c].[id] = @__p_0
2025-05-04 15:06:13.489 +07:00 [WRN] Savepoints are disabled because Multiple Active Result Sets (MARS) is enabled. If 'SaveChanges' fails, then the transaction cannot be automatically rolled back to a known clean state. Instead, the transaction should be rolled back by the application before retrying 'SaveChanges'. See https://go.microsoft.com/fwlink/?linkid=2149338 for more information and examples. To identify the code which triggers this warning, call 'ConfigureWarnings(w => w.Throw(SqlServerEventId.SavepointsDisabledBecauseOfMARS))'.
2025-05-04 15:06:13.494 +07:00 [INF] Executed DbCommand (4ms) [Parameters=[@p0='?' (Size = 500), @p1='?' (DbType = Int32), @p2='?' (DbType = DateTime2), @p3='?' (DbType = Boolean), @p4='?' (DbType = Boolean), @p5='?' (DbType = Boolean), @p6='?' (DbType = Int32), @p7='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Messages] ([content], [conversation_id], [created_at], [isFile], [isRecalled], [is_read], [sender_id], [type])
OUTPUT INSERTED.[id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7);
2025-05-04 15:06:13.494 +07:00 [INF] Message saved to DB with ID: 113
2025-05-04 15:06:13.495 +07:00 [WRN] Savepoints are disabled because Multiple Active Result Sets (MARS) is enabled. If 'SaveChanges' fails, then the transaction cannot be automatically rolled back to a known clean state. Instead, the transaction should be rolled back by the application before retrying 'SaveChanges'. See https://go.microsoft.com/fwlink/?linkid=2149338 for more information and examples. To identify the code which triggers this warning, call 'ConfigureWarnings(w => w.Throw(SqlServerEventId.SavepointsDisabledBecauseOfMARS))'.
2025-05-04 15:06:13.499 +07:00 [INF] Executed DbCommand (4ms) [Parameters=[@p6='?' (DbType = Int32), @p0='?' (DbType = DateTime2), @p1='?' (DbType = Boolean), @p2='?' (Size = 4000), @p3='?' (Size = 4000), @p4='?' (DbType = DateTime2), @p5='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
UPDATE [Conversations] SET [created_at] = @p0, [is_group] = @p1, [lastMessage] = @p2, [lastMessageSender] = @p3, [lastMessageTime] = @p4, [name] = @p5
OUTPUT 1
WHERE [id] = @p6;
2025-05-04 15:06:13.500 +07:00 [INF] Transaction committed for message: 113
2025-05-04 15:06:13.502 +07:00 [INF] Saved message 113 to Redis
2025-05-04 15:06:13.502 +07:00 [INF] Added message 113 to conversation 1
2025-05-04 15:06:13.503 +07:00 [INF] Published message to channel conversation:1
2025-05-04 15:06:16.613 +07:00 [INF] Handling message from user 2: dd
2025-05-04 15:06:16.626 +07:00 [INF] Executed DbCommand (8ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[id], [c].[created_at], [c].[is_group], [c].[lastMessage], [c].[lastMessageSender], [c].[lastMessageTime], [c].[name]
FROM [Conversations] AS [c]
WHERE [c].[id] = @__p_0
2025-05-04 15:06:16.650 +07:00 [WRN] Savepoints are disabled because Multiple Active Result Sets (MARS) is enabled. If 'SaveChanges' fails, then the transaction cannot be automatically rolled back to a known clean state. Instead, the transaction should be rolled back by the application before retrying 'SaveChanges'. See https://go.microsoft.com/fwlink/?linkid=2149338 for more information and examples. To identify the code which triggers this warning, call 'ConfigureWarnings(w => w.Throw(SqlServerEventId.SavepointsDisabledBecauseOfMARS))'.
2025-05-04 15:06:16.655 +07:00 [INF] Executed DbCommand (5ms) [Parameters=[@p0='?' (Size = 500), @p1='?' (DbType = Int32), @p2='?' (DbType = DateTime2), @p3='?' (DbType = Boolean), @p4='?' (DbType = Boolean), @p5='?' (DbType = Boolean), @p6='?' (DbType = Int32), @p7='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Messages] ([content], [conversation_id], [created_at], [isFile], [isRecalled], [is_read], [sender_id], [type])
OUTPUT INSERTED.[id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7);
2025-05-04 15:06:16.656 +07:00 [INF] Message saved to DB with ID: 114
2025-05-04 15:06:16.656 +07:00 [WRN] Savepoints are disabled because Multiple Active Result Sets (MARS) is enabled. If 'SaveChanges' fails, then the transaction cannot be automatically rolled back to a known clean state. Instead, the transaction should be rolled back by the application before retrying 'SaveChanges'. See https://go.microsoft.com/fwlink/?linkid=2149338 for more information and examples. To identify the code which triggers this warning, call 'ConfigureWarnings(w => w.Throw(SqlServerEventId.SavepointsDisabledBecauseOfMARS))'.
2025-05-04 15:06:16.664 +07:00 [INF] Executed DbCommand (6ms) [Parameters=[@p6='?' (DbType = Int32), @p0='?' (DbType = DateTime2), @p1='?' (DbType = Boolean), @p2='?' (Size = 4000), @p3='?' (Size = 4000), @p4='?' (DbType = DateTime2), @p5='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
UPDATE [Conversations] SET [created_at] = @p0, [is_group] = @p1, [lastMessage] = @p2, [lastMessageSender] = @p3, [lastMessageTime] = @p4, [name] = @p5
OUTPUT 1
WHERE [id] = @p6;
2025-05-04 15:06:16.665 +07:00 [INF] Transaction committed for message: 114
2025-05-04 15:06:16.667 +07:00 [INF] Saved message 114 to Redis
2025-05-04 15:06:16.667 +07:00 [INF] Added message 114 to conversation 1
2025-05-04 15:06:16.668 +07:00 [INF] Published message to channel conversation:1
2025-05-04 15:10:57.213 +07:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5053/api/Auth/login - null null
2025-05-04 15:10:57.213 +07:00 [INF] CORS policy execution successful.
2025-05-04 15:10:57.213 +07:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5053/api/Auth/login - 204 null null 0.5719ms
2025-05-04 15:10:57.215 +07:00 [INF] Request starting HTTP/1.1 POST http://localhost:5053/api/Auth/login - application/json 53
2025-05-04 15:10:57.215 +07:00 [INF] CORS policy execution successful.
2025-05-04 15:10:57.215 +07:00 [INF] CORS policy execution successful.
2025-05-04 15:10:57.215 +07:00 [INF] Executing endpoint 'Message_app.Controllers.AuthController.Login (Message_app)'
2025-05-04 15:10:57.215 +07:00 [INF] Route matched with {action = "Login", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Login(server.DTO.AuthDTO.LoginDTO) on controller Message_app.Controllers.AuthController (Message_app).
2025-05-04 15:10:57.233 +07:00 [INF] Executed DbCommand (13ms) [Parameters=[@__email_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[id], [u].[avatar_url], [u].[bio], [u].[birthday], [u].[created_at], [u].[email], [u].[gender], [u].[interests], [u].[location], [u].[password], [u].[passwordSalt], [u].[username]
FROM [Users] AS [u]
WHERE [u].[email] = @__email_0
2025-05-04 15:10:57.234 +07:00 [INF] Executing OkObjectResult, writing value of type 'server.DTO.AuthDTO.LoginRespose'.
2025-05-04 15:10:57.234 +07:00 [INF] Executed action Message_app.Controllers.AuthController.Login (Message_app) in 18.9683ms
2025-05-04 15:10:57.235 +07:00 [INF] Executed endpoint 'Message_app.Controllers.AuthController.Login (Message_app)'
2025-05-04 15:10:57.235 +07:00 [INF] Request finished HTTP/1.1 POST http://localhost:5053/api/Auth/login - 200 null application/json; charset=utf-8 20.0526ms
2025-05-04 15:10:57.370 +07:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5053/api/Conversation/get_conversations/5 - null null
2025-05-04 15:10:57.371 +07:00 [INF] CORS policy execution successful.
2025-05-04 15:10:57.371 +07:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5053/api/Conversation/get_conversations/5 - 204 null null 0.7277ms
2025-05-04 15:10:57.371 +07:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5053/api/Conversation/get_conversations/5 - null null
2025-05-04 15:10:57.372 +07:00 [INF] CORS policy execution successful.
2025-05-04 15:10:57.372 +07:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5053/api/Conversation/get_conversations/5 - 204 null null 0.3751ms
2025-05-04 15:10:57.374 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/api/Conversation/get_conversations/5 - null null
2025-05-04 15:10:57.374 +07:00 [INF] CORS policy execution successful.
2025-05-04 15:10:57.374 +07:00 [INF] CORS policy execution successful.
2025-05-04 15:10:57.375 +07:00 [INF] Executing endpoint 'server.Controllers.ConversationController.GetConversations (Message_app)'
2025-05-04 15:10:57.375 +07:00 [INF] Route matched with {action = "GetConversations", controller = "Conversation"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetConversations(Int32) on controller server.Controllers.ConversationController (Message_app).
2025-05-04 15:10:57.376 +07:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[server.DTO.ConversationDto, Message_app, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-05-04 15:10:57.376 +07:00 [INF] Executed action server.Controllers.ConversationController.GetConversations (Message_app) in 1.5074ms
2025-05-04 15:10:57.376 +07:00 [INF] Executed endpoint 'server.Controllers.ConversationController.GetConversations (Message_app)'
2025-05-04 15:10:57.377 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5053/api/Conversation/get_conversations/5 - 200 null application/json; charset=utf-8 2.696ms
2025-05-04 15:10:57.378 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/api/Conversation/get_conversations/5 - null null
2025-05-04 15:10:57.378 +07:00 [INF] CORS policy execution successful.
2025-05-04 15:10:57.380 +07:00 [INF] CORS policy execution successful.
2025-05-04 15:10:57.380 +07:00 [INF] Executing endpoint 'server.Controllers.ConversationController.GetConversations (Message_app)'
2025-05-04 15:10:57.381 +07:00 [INF] Route matched with {action = "GetConversations", controller = "Conversation"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetConversations(Int32) on controller server.Controllers.ConversationController (Message_app).
2025-05-04 15:10:57.382 +07:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[server.DTO.ConversationDto, Message_app, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-05-04 15:10:57.382 +07:00 [INF] Executed action server.Controllers.ConversationController.GetConversations (Message_app) in 1.2284ms
2025-05-04 15:10:57.382 +07:00 [INF] Executed endpoint 'server.Controllers.ConversationController.GetConversations (Message_app)'
2025-05-04 15:10:57.382 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5053/api/Conversation/get_conversations/5 - 200 null application/json; charset=utf-8 4.4052ms
2025-05-04 15:10:57.395 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/ws/chat?userId=5 - null null
2025-05-04 15:10:57.395 +07:00 [INF] CORS policy execution successful.
2025-05-04 15:10:57.395 +07:00 [INF] CORS policy execution successful.
2025-05-04 15:10:57.396 +07:00 [INF] Executing endpoint '/ws/chat'
2025-05-04 15:10:57.499 +07:00 [INF] Executed DbCommand (5ms) [Parameters=[@__client_UserId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[conversation_id]
FROM [Participants] AS [p]
WHERE [p].[user_id] = @__client_UserId_0 AND [p].[is_deleted] = CAST(0 AS bit)
2025-05-04 15:17:04.715 +07:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5053/api/Participant/get_participants/4 - null null
2025-05-04 15:17:04.715 +07:00 [INF] CORS policy execution successful.
2025-05-04 15:17:04.716 +07:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5053/api/Participant/get_participants/4 - 204 null null 0.3829ms
2025-05-04 15:17:04.718 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/api/Participant/get_participants/4 - null null
2025-05-04 15:17:04.719 +07:00 [INF] CORS policy execution successful.
2025-05-04 15:17:04.721 +07:00 [INF] CORS policy execution successful.
2025-05-04 15:17:04.721 +07:00 [INF] Executing endpoint 'server.Controllers.ParticipantController.GetParticipants (Message_app)'
2025-05-04 15:17:04.738 +07:00 [INF] Route matched with {action = "GetParticipants", controller = "Participant"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetParticipants(Int32) on controller server.Controllers.ParticipantController (Message_app).
2025-05-04 15:17:04.862 +07:00 [INF] Executed DbCommand (17ms) [Parameters=[@__conversation_id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[id], [p].[adder], [p].[conversation_id], [p].[is_deleted], [p].[joined_at], [p].[name], [p].[role], [p].[user_id]
FROM [Participants] AS [p]
WHERE [p].[conversation_id] = @__conversation_id_0
2025-05-04 15:17:04.864 +07:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType17`1[[System.Collections.Generic.List`1[[server.Models.Participants, Message_app, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-05-04 15:17:04.886 +07:00 [INF] Executed action server.Controllers.ParticipantController.GetParticipants (Message_app) in 147.1977ms
2025-05-04 15:17:04.886 +07:00 [INF] Executed endpoint 'server.Controllers.ParticipantController.GetParticipants (Message_app)'
2025-05-04 15:17:04.886 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5053/api/Participant/get_participants/4 - 200 null application/json; charset=utf-8 167.9246ms
2025-05-04 15:17:05.017 +07:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5053/api/Message/getMessages/4/5 - null null
2025-05-04 15:17:05.017 +07:00 [INF] CORS policy execution successful.
2025-05-04 15:17:05.017 +07:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5053/api/Message/getMessages/4/5 - 204 null null 0.7125ms
2025-05-04 15:17:05.019 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/api/Message/getMessages/4/5 - null null
2025-05-04 15:17:05.019 +07:00 [INF] CORS policy execution successful.
2025-05-04 15:17:05.022 +07:00 [INF] CORS policy execution successful.
2025-05-04 15:17:05.022 +07:00 [INF] Executing endpoint 'server.Controllers.MessageController.GetMessages (Message_app)'
2025-05-04 15:17:05.031 +07:00 [INF] Route matched with {action = "GetMessages", controller = "Message"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetMessages(Int32, Int32) on controller server.Controllers.MessageController (Message_app).
2025-05-04 15:17:05.033 +07:00 [INF] Retrieved 0 messages from Redis for conversation 4
2025-05-04 15:17:05.093 +07:00 [INF] Executed DbCommand (15ms) [Parameters=[@__user_id_0='?' (DbType = Int32), @__conversationId_1='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[cleared_at]
FROM [messageDeletions] AS [m]
WHERE [m].[user_id] = @__user_id_0 AND CAST([m].[conversation_id] AS bigint) = @__conversationId_1
2025-05-04 15:17:05.221 +07:00 [INF] Executed DbCommand (35ms) [Parameters=[@__p_1='?' (DbType = Int32), @__conversationId_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[id], [t].[content], [t].[conversation_id], [t].[created_at], [t].[isFile], [t].[isRecalled], [t].[is_read], [t].[sender_id], [t].[type], [a].[id], [a].[FileSize], [a].[file_type], [a].[file_url], [a].[is_temporary], [a].[message_id], [a].[uploaded_at]
FROM (
    SELECT TOP(@__p_1) [m].[id], [m].[content], [m].[conversation_id], [m].[created_at], [m].[isFile], [m].[isRecalled], [m].[is_read], [m].[sender_id], [m].[type]
    FROM [Messages] AS [m]
    WHERE CAST([m].[conversation_id] AS bigint) = @__conversationId_0
    ORDER BY [m].[created_at] DESC
) AS [t]
LEFT JOIN [Attachments] AS [a] ON [t].[id] = [a].[message_id]
ORDER BY [t].[created_at] DESC, [t].[id]
2025-05-04 15:17:05.264 +07:00 [INF] Saved message 111 to Redis
2025-05-04 15:17:05.265 +07:00 [INF] Added message 111 to conversation 4
2025-05-04 15:17:05.265 +07:00 [INF] Saved message 97 to Redis
2025-05-04 15:17:05.266 +07:00 [INF] Added message 97 to conversation 4
2025-05-04 15:17:05.274 +07:00 [INF] Saved message 96 to Redis
2025-05-04 15:17:05.275 +07:00 [INF] Added message 96 to conversation 4
2025-05-04 15:17:05.276 +07:00 [INF] Saved message 89 to Redis
2025-05-04 15:17:05.276 +07:00 [INF] Added message 89 to conversation 4
2025-05-04 15:17:05.277 +07:00 [INF] Saved message 69 to Redis
2025-05-04 15:17:05.277 +07:00 [INF] Added message 69 to conversation 4
2025-05-04 15:17:05.278 +07:00 [INF] Saved message 67 to Redis
2025-05-04 15:17:05.278 +07:00 [INF] Added message 67 to conversation 4
2025-05-04 15:17:05.279 +07:00 [INF] Saved message 66 to Redis
2025-05-04 15:17:05.279 +07:00 [INF] Added message 66 to conversation 4
2025-05-04 15:17:05.280 +07:00 [INF] Saved message 63 to Redis
2025-05-04 15:17:05.280 +07:00 [INF] Added message 63 to conversation 4
2025-05-04 15:17:05.281 +07:00 [INF] Saved message 58 to Redis
2025-05-04 15:17:05.281 +07:00 [INF] Added message 58 to conversation 4
2025-05-04 15:17:05.282 +07:00 [INF] Saved message 56 to Redis
2025-05-04 15:17:05.282 +07:00 [INF] Added message 56 to conversation 4
2025-05-04 15:17:05.283 +07:00 [INF] Saved message 53 to Redis
2025-05-04 15:17:05.283 +07:00 [INF] Added message 53 to conversation 4
2025-05-04 15:17:05.284 +07:00 [INF] Saved message 52 to Redis
2025-05-04 15:17:05.286 +07:00 [INF] Added message 52 to conversation 4
2025-05-04 15:17:05.287 +07:00 [INF] Saved message 50 to Redis
2025-05-04 15:17:05.287 +07:00 [INF] Added message 50 to conversation 4
2025-05-04 15:17:05.288 +07:00 [INF] Saved message 47 to Redis
2025-05-04 15:17:05.289 +07:00 [INF] Added message 47 to conversation 4
2025-05-04 15:17:05.290 +07:00 [INF] Saved message 46 to Redis
2025-05-04 15:17:05.290 +07:00 [INF] Added message 46 to conversation 4
2025-05-04 15:17:05.291 +07:00 [INF] Saved message 45 to Redis
2025-05-04 15:17:05.291 +07:00 [INF] Added message 45 to conversation 4
2025-05-04 15:17:05.292 +07:00 [INF] Saved message 44 to Redis
2025-05-04 15:17:05.293 +07:00 [INF] Added message 44 to conversation 4
2025-05-04 15:17:05.293 +07:00 [INF] Saved message 43 to Redis
2025-05-04 15:17:05.294 +07:00 [INF] Added message 43 to conversation 4
2025-05-04 15:17:05.295 +07:00 [INF] Saved message 42 to Redis
2025-05-04 15:17:05.295 +07:00 [INF] Added message 42 to conversation 4
2025-05-04 15:17:05.296 +07:00 [INF] Saved message 41 to Redis
2025-05-04 15:17:05.296 +07:00 [INF] Added message 41 to conversation 4
2025-05-04 15:17:05.297 +07:00 [INF] Saved message 40 to Redis
2025-05-04 15:17:05.297 +07:00 [INF] Added message 40 to conversation 4
2025-05-04 15:17:05.299 +07:00 [INF] Saved message 39 to Redis
2025-05-04 15:17:05.300 +07:00 [INF] Added message 39 to conversation 4
2025-05-04 15:17:05.301 +07:00 [INF] Saved message 38 to Redis
2025-05-04 15:17:05.301 +07:00 [INF] Added message 38 to conversation 4
2025-05-04 15:17:05.303 +07:00 [INF] Saved message 37 to Redis
2025-05-04 15:17:05.303 +07:00 [INF] Added message 37 to conversation 4
2025-05-04 15:17:05.305 +07:00 [INF] Saved message 36 to Redis
2025-05-04 15:17:05.305 +07:00 [INF] Added message 36 to conversation 4
2025-05-04 15:17:05.306 +07:00 [INF] Saved message 35 to Redis
2025-05-04 15:17:05.306 +07:00 [INF] Added message 35 to conversation 4
2025-05-04 15:17:05.307 +07:00 [INF] Saved message 34 to Redis
2025-05-04 15:17:05.307 +07:00 [INF] Added message 34 to conversation 4
2025-05-04 15:17:05.307 +07:00 [INF] Saved message 33 to Redis
2025-05-04 15:17:05.308 +07:00 [INF] Added message 33 to conversation 4
2025-05-04 15:17:05.308 +07:00 [INF] Saved message 32 to Redis
2025-05-04 15:17:05.308 +07:00 [INF] Added message 32 to conversation 4
2025-05-04 15:17:05.309 +07:00 [INF] Saved message 31 to Redis
2025-05-04 15:17:05.310 +07:00 [INF] Added message 31 to conversation 4
2025-05-04 15:17:05.311 +07:00 [INF] Saved message 30 to Redis
2025-05-04 15:17:05.311 +07:00 [INF] Added message 30 to conversation 4
2025-05-04 15:17:05.312 +07:00 [INF] Saved message 29 to Redis
2025-05-04 15:17:05.312 +07:00 [INF] Added message 29 to conversation 4
2025-05-04 15:17:05.312 +07:00 [INF] Saved message 28 to Redis
2025-05-04 15:17:05.312 +07:00 [INF] Added message 28 to conversation 4
2025-05-04 15:17:05.313 +07:00 [INF] Saved message 27 to Redis
2025-05-04 15:17:05.314 +07:00 [INF] Added message 27 to conversation 4
2025-05-04 15:17:05.315 +07:00 [INF] Saved message 26 to Redis
2025-05-04 15:17:05.315 +07:00 [INF] Added message 26 to conversation 4
2025-05-04 15:17:05.316 +07:00 [INF] Saved message 25 to Redis
2025-05-04 15:17:05.317 +07:00 [INF] Added message 25 to conversation 4
2025-05-04 15:17:05.317 +07:00 [INF] Saved message 24 to Redis
2025-05-04 15:17:05.318 +07:00 [INF] Added message 24 to conversation 4
2025-05-04 15:17:05.318 +07:00 [INF] Saved message 23 to Redis
2025-05-04 15:17:05.319 +07:00 [INF] Added message 23 to conversation 4
2025-05-04 15:17:05.319 +07:00 [INF] Saved message 22 to Redis
2025-05-04 15:17:05.320 +07:00 [INF] Added message 22 to conversation 4
2025-05-04 15:17:05.321 +07:00 [INF] Saved message 21 to Redis
2025-05-04 15:17:05.321 +07:00 [INF] Added message 21 to conversation 4
2025-05-04 15:17:05.322 +07:00 [INF] Saved message 20 to Redis
2025-05-04 15:17:05.323 +07:00 [INF] Added message 20 to conversation 4
2025-05-04 15:17:05.324 +07:00 [INF] Saved message 19 to Redis
2025-05-04 15:17:05.324 +07:00 [INF] Added message 19 to conversation 4
2025-05-04 15:17:05.325 +07:00 [INF] Saved message 18 to Redis
2025-05-04 15:17:05.325 +07:00 [INF] Added message 18 to conversation 4
2025-05-04 15:17:05.326 +07:00 [INF] Saved message 17 to Redis
2025-05-04 15:17:05.327 +07:00 [INF] Added message 17 to conversation 4
2025-05-04 15:17:05.327 +07:00 [INF] Saved message 16 to Redis
2025-05-04 15:17:05.328 +07:00 [INF] Added message 16 to conversation 4
2025-05-04 15:17:05.328 +07:00 [INF] Saved message 15 to Redis
2025-05-04 15:17:05.328 +07:00 [INF] Added message 15 to conversation 4
2025-05-04 15:17:05.329 +07:00 [INF] Saved message 14 to Redis
2025-05-04 15:17:05.330 +07:00 [INF] Added message 14 to conversation 4
2025-05-04 15:17:05.330 +07:00 [INF] Saved message 13 to Redis
2025-05-04 15:17:05.331 +07:00 [INF] Added message 13 to conversation 4
2025-05-04 15:17:05.332 +07:00 [INF] Saved message 12 to Redis
2025-05-04 15:17:05.333 +07:00 [INF] Added message 12 to conversation 4
2025-05-04 15:17:05.333 +07:00 [INF] Saved message 10 to Redis
2025-05-04 15:17:05.334 +07:00 [INF] Added message 10 to conversation 4
2025-05-04 15:17:05.334 +07:00 [INF] Cached 50 messages to Redis for conversation 4
2025-05-04 15:17:05.334 +07:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[server.DTO.MessageWithAttachment, Message_app, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-05-04 15:17:05.346 +07:00 [INF] Executed action server.Controllers.MessageController.GetMessages (Message_app) in 315.2694ms
2025-05-04 15:17:05.346 +07:00 [INF] Executed endpoint 'server.Controllers.MessageController.GetMessages (Message_app)'
2025-05-04 15:17:05.346 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5053/api/Message/getMessages/4/5 - 200 null application/json; charset=utf-8 327.2071ms
2025-05-04 15:17:05.365 +07:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5053/api/Conversation/get_first_conversation/4 - null null
2025-05-04 15:17:05.366 +07:00 [INF] CORS policy execution successful.
2025-05-04 15:17:05.366 +07:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5053/api/Conversation/get_first_conversation/4 - 204 null null 0.2885ms
2025-05-04 15:17:05.374 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/api/Conversation/get_first_conversation/4 - null null
2025-05-04 15:17:05.376 +07:00 [INF] CORS policy execution successful.
2025-05-04 15:17:05.376 +07:00 [INF] CORS policy execution successful.
2025-05-04 15:17:05.376 +07:00 [INF] Executing endpoint 'server.Controllers.ConversationController.GetFirstConversation (Message_app)'
2025-05-04 15:17:05.409 +07:00 [INF] Route matched with {action = "GetFirstConversation", controller = "Conversation"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetFirstConversation(Int32) on controller server.Controllers.ConversationController (Message_app).
2025-05-04 15:17:05.416 +07:00 [INF] Executed DbCommand (4ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[id], [c].[created_at], [c].[is_group], [c].[lastMessage], [c].[lastMessageSender], [c].[lastMessageTime], [c].[name]
FROM [Conversations] AS [c]
WHERE [c].[id] = @__p_0
2025-05-04 15:17:05.417 +07:00 [INF] Executing OkObjectResult, writing value of type 'server.Models.Conversation'.
2025-05-04 15:17:05.422 +07:00 [INF] Executed action server.Controllers.ConversationController.GetFirstConversation (Message_app) in 12.3087ms
2025-05-04 15:17:05.422 +07:00 [INF] Executed endpoint 'server.Controllers.ConversationController.GetFirstConversation (Message_app)'
2025-05-04 15:17:05.422 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5053/api/Conversation/get_first_conversation/4 - 200 null application/json; charset=utf-8 48.4944ms
2025-05-04 15:17:05.433 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/api/Participant/get_participants/4 - null null
2025-05-04 15:17:05.433 +07:00 [INF] CORS policy execution successful.
2025-05-04 15:17:05.437 +07:00 [INF] CORS policy execution successful.
2025-05-04 15:17:05.437 +07:00 [INF] Executing endpoint 'server.Controllers.ParticipantController.GetParticipants (Message_app)'
2025-05-04 15:17:05.437 +07:00 [INF] Route matched with {action = "GetParticipants", controller = "Participant"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetParticipants(Int32) on controller server.Controllers.ParticipantController (Message_app).
2025-05-04 15:17:05.441 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[@__conversation_id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[id], [p].[adder], [p].[conversation_id], [p].[is_deleted], [p].[joined_at], [p].[name], [p].[role], [p].[user_id]
FROM [Participants] AS [p]
WHERE [p].[conversation_id] = @__conversation_id_0
2025-05-04 15:17:05.443 +07:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType17`1[[System.Collections.Generic.List`1[[server.Models.Participants, Message_app, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-05-04 15:17:05.444 +07:00 [INF] Executed action server.Controllers.ParticipantController.GetParticipants (Message_app) in 6.1616ms
2025-05-04 15:17:05.444 +07:00 [INF] Executed endpoint 'server.Controllers.ParticipantController.GetParticipants (Message_app)'
2025-05-04 15:17:05.444 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5053/api/Participant/get_participants/4 - 200 null application/json; charset=utf-8 11.3914ms
2025-05-04 15:17:11.750 +07:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5053/api/Participant/get_participants/1 - null null
2025-05-04 15:17:11.750 +07:00 [INF] CORS policy execution successful.
2025-05-04 15:17:11.752 +07:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5053/api/Participant/get_participants/1 - 204 null null 1.6545ms
2025-05-04 15:17:11.755 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/api/Participant/get_participants/1 - null null
2025-05-04 15:17:11.756 +07:00 [INF] CORS policy execution successful.
2025-05-04 15:17:11.757 +07:00 [INF] CORS policy execution successful.
2025-05-04 15:17:11.758 +07:00 [INF] Executing endpoint 'server.Controllers.ParticipantController.GetParticipants (Message_app)'
2025-05-04 15:17:11.758 +07:00 [INF] Route matched with {action = "GetParticipants", controller = "Participant"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetParticipants(Int32) on controller server.Controllers.ParticipantController (Message_app).
2025-05-04 15:17:11.769 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[@__conversation_id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[id], [p].[adder], [p].[conversation_id], [p].[is_deleted], [p].[joined_at], [p].[name], [p].[role], [p].[user_id]
FROM [Participants] AS [p]
WHERE [p].[conversation_id] = @__conversation_id_0
2025-05-04 15:17:11.771 +07:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType17`1[[System.Collections.Generic.List`1[[server.Models.Participants, Message_app, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-05-04 15:17:11.777 +07:00 [INF] Executed action server.Controllers.ParticipantController.GetParticipants (Message_app) in 18.3439ms
2025-05-04 15:17:11.777 +07:00 [INF] Executed endpoint 'server.Controllers.ParticipantController.GetParticipants (Message_app)'
2025-05-04 15:17:11.777 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5053/api/Participant/get_participants/1 - 200 null application/json; charset=utf-8 22.1955ms
2025-05-04 15:17:11.892 +07:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5053/api/Message/getMessages/1/5 - null null
2025-05-04 15:17:11.892 +07:00 [INF] CORS policy execution successful.
2025-05-04 15:17:11.893 +07:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5053/api/Message/getMessages/1/5 - 204 null null 0.2976ms
2025-05-04 15:17:11.894 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/api/Message/getMessages/1/5 - null null
2025-05-04 15:17:11.894 +07:00 [INF] CORS policy execution successful.
2025-05-04 15:17:11.897 +07:00 [INF] CORS policy execution successful.
2025-05-04 15:17:11.897 +07:00 [INF] Executing endpoint 'server.Controllers.MessageController.GetMessages (Message_app)'
2025-05-04 15:17:11.897 +07:00 [INF] Route matched with {action = "GetMessages", controller = "Message"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetMessages(Int32, Int32) on controller server.Controllers.MessageController (Message_app).
2025-05-04 15:17:11.898 +07:00 [INF] Retrieved 0 messages from Redis for conversation 1
2025-05-04 15:17:11.904 +07:00 [INF] Executed DbCommand (4ms) [Parameters=[@__user_id_0='?' (DbType = Int32), @__conversationId_1='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[cleared_at]
FROM [messageDeletions] AS [m]
WHERE [m].[user_id] = @__user_id_0 AND CAST([m].[conversation_id] AS bigint) = @__conversationId_1
2025-05-04 15:17:11.942 +07:00 [INF] Executed DbCommand (15ms) [Parameters=[@__p_2='?' (DbType = Int32), @__conversationId_0='?' (DbType = Int64), @__clearedAt_1='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[id], [t].[content], [t].[conversation_id], [t].[created_at], [t].[isFile], [t].[isRecalled], [t].[is_read], [t].[sender_id], [t].[type], [a].[id], [a].[FileSize], [a].[file_type], [a].[file_url], [a].[is_temporary], [a].[message_id], [a].[uploaded_at]
FROM (
    SELECT TOP(@__p_2) [m].[id], [m].[content], [m].[conversation_id], [m].[created_at], [m].[isFile], [m].[isRecalled], [m].[is_read], [m].[sender_id], [m].[type]
    FROM [Messages] AS [m]
    WHERE CAST([m].[conversation_id] AS bigint) = @__conversationId_0 AND [m].[created_at] > @__clearedAt_1
    ORDER BY [m].[created_at] DESC
) AS [t]
LEFT JOIN [Attachments] AS [a] ON [t].[id] = [a].[message_id]
ORDER BY [t].[created_at] DESC, [t].[id]
2025-05-04 15:17:11.945 +07:00 [INF] Saved message 114 to Redis
2025-05-04 15:17:11.945 +07:00 [INF] Added message 114 to conversation 1
2025-05-04 15:17:11.947 +07:00 [INF] Saved message 113 to Redis
2025-05-04 15:17:11.947 +07:00 [INF] Added message 113 to conversation 1
2025-05-04 15:17:11.948 +07:00 [INF] Saved message 112 to Redis
2025-05-04 15:17:11.948 +07:00 [INF] Added message 112 to conversation 1
2025-05-04 15:17:11.950 +07:00 [INF] Saved message 110 to Redis
2025-05-04 15:17:11.950 +07:00 [INF] Added message 110 to conversation 1
2025-05-04 15:17:11.953 +07:00 [INF] Saved message 109 to Redis
2025-05-04 15:17:11.954 +07:00 [INF] Added message 109 to conversation 1
2025-05-04 15:17:11.959 +07:00 [INF] Saved message 108 to Redis
2025-05-04 15:17:11.959 +07:00 [INF] Added message 108 to conversation 1
2025-05-04 15:17:11.960 +07:00 [INF] Saved message 107 to Redis
2025-05-04 15:17:11.961 +07:00 [INF] Added message 107 to conversation 1
2025-05-04 15:17:11.962 +07:00 [INF] Saved message 106 to Redis
2025-05-04 15:17:11.963 +07:00 [INF] Added message 106 to conversation 1
2025-05-04 15:17:11.966 +07:00 [INF] Saved message 105 to Redis
2025-05-04 15:17:11.967 +07:00 [INF] Added message 105 to conversation 1
2025-05-04 15:17:11.969 +07:00 [INF] Saved message 104 to Redis
2025-05-04 15:17:11.969 +07:00 [INF] Added message 104 to conversation 1
2025-05-04 15:17:11.973 +07:00 [INF] Saved message 103 to Redis
2025-05-04 15:17:11.974 +07:00 [INF] Added message 103 to conversation 1
2025-05-04 15:17:11.976 +07:00 [INF] Saved message 102 to Redis
2025-05-04 15:17:11.976 +07:00 [INF] Added message 102 to conversation 1
2025-05-04 15:17:11.978 +07:00 [INF] Saved message 101 to Redis
2025-05-04 15:17:11.978 +07:00 [INF] Added message 101 to conversation 1
2025-05-04 15:17:11.979 +07:00 [INF] Saved message 100 to Redis
2025-05-04 15:17:11.979 +07:00 [INF] Added message 100 to conversation 1
2025-05-04 15:17:11.980 +07:00 [INF] Saved message 99 to Redis
2025-05-04 15:17:11.981 +07:00 [INF] Added message 99 to conversation 1
2025-05-04 15:17:11.981 +07:00 [INF] Saved message 98 to Redis
2025-05-04 15:17:11.982 +07:00 [INF] Added message 98 to conversation 1
2025-05-04 15:17:11.982 +07:00 [INF] Saved message 95 to Redis
2025-05-04 15:17:11.983 +07:00 [INF] Added message 95 to conversation 1
2025-05-04 15:17:11.984 +07:00 [INF] Saved message 94 to Redis
2025-05-04 15:17:11.985 +07:00 [INF] Added message 94 to conversation 1
2025-05-04 15:17:11.987 +07:00 [INF] Saved message 93 to Redis
2025-05-04 15:17:11.991 +07:00 [INF] Added message 93 to conversation 1
2025-05-04 15:17:11.995 +07:00 [INF] Saved message 92 to Redis
2025-05-04 15:17:11.995 +07:00 [INF] Added message 92 to conversation 1
2025-05-04 15:17:11.996 +07:00 [INF] Saved message 91 to Redis
2025-05-04 15:17:11.997 +07:00 [INF] Added message 91 to conversation 1
2025-05-04 15:17:11.997 +07:00 [INF] Saved message 90 to Redis
2025-05-04 15:17:11.998 +07:00 [INF] Added message 90 to conversation 1
2025-05-04 15:17:11.998 +07:00 [INF] Saved message 87 to Redis
2025-05-04 15:17:11.998 +07:00 [INF] Added message 87 to conversation 1
2025-05-04 15:17:11.999 +07:00 [INF] Saved message 86 to Redis
2025-05-04 15:17:11.999 +07:00 [INF] Added message 86 to conversation 1
2025-05-04 15:17:12.000 +07:00 [INF] Saved message 85 to Redis
2025-05-04 15:17:12.000 +07:00 [INF] Added message 85 to conversation 1
2025-05-04 15:17:12.002 +07:00 [INF] Saved message 84 to Redis
2025-05-04 15:17:12.003 +07:00 [INF] Added message 84 to conversation 1
2025-05-04 15:17:12.004 +07:00 [INF] Saved message 83 to Redis
2025-05-04 15:17:12.004 +07:00 [INF] Added message 83 to conversation 1
2025-05-04 15:17:12.006 +07:00 [INF] Saved message 82 to Redis
2025-05-04 15:17:12.007 +07:00 [INF] Added message 82 to conversation 1
2025-05-04 15:17:12.007 +07:00 [INF] Cached 28 messages to Redis for conversation 1
2025-05-04 15:17:12.007 +07:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[server.DTO.MessageWithAttachment, Message_app, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-05-04 15:17:12.007 +07:00 [INF] Executed action server.Controllers.MessageController.GetMessages (Message_app) in 110.2276ms
2025-05-04 15:17:12.007 +07:00 [INF] Executed endpoint 'server.Controllers.MessageController.GetMessages (Message_app)'
2025-05-04 15:17:12.007 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5053/api/Message/getMessages/1/5 - 200 null application/json; charset=utf-8 113.5117ms
2025-05-04 15:17:12.017 +07:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5053/api/Conversation/get_first_conversation/1 - null null
2025-05-04 15:17:12.017 +07:00 [INF] CORS policy execution successful.
2025-05-04 15:17:12.017 +07:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5053/api/Conversation/get_first_conversation/1 - 204 null null 0.3709ms
2025-05-04 15:17:12.019 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/api/Conversation/get_first_conversation/1 - null null
2025-05-04 15:17:12.019 +07:00 [INF] CORS policy execution successful.
2025-05-04 15:17:12.022 +07:00 [INF] CORS policy execution successful.
2025-05-04 15:17:12.023 +07:00 [INF] Executing endpoint 'server.Controllers.ConversationController.GetFirstConversation (Message_app)'
2025-05-04 15:17:12.023 +07:00 [INF] Route matched with {action = "GetFirstConversation", controller = "Conversation"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetFirstConversation(Int32) on controller server.Controllers.ConversationController (Message_app).
2025-05-04 15:17:12.026 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[id], [c].[created_at], [c].[is_group], [c].[lastMessage], [c].[lastMessageSender], [c].[lastMessageTime], [c].[name]
FROM [Conversations] AS [c]
WHERE [c].[id] = @__p_0
2025-05-04 15:17:12.028 +07:00 [INF] Executing OkObjectResult, writing value of type 'server.Models.Conversation'.
2025-05-04 15:17:12.028 +07:00 [INF] Executed action server.Controllers.ConversationController.GetFirstConversation (Message_app) in 5.1574ms
2025-05-04 15:17:12.028 +07:00 [INF] Executed endpoint 'server.Controllers.ConversationController.GetFirstConversation (Message_app)'
2025-05-04 15:17:12.028 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5053/api/Conversation/get_first_conversation/1 - 200 null application/json; charset=utf-8 9.8687ms
2025-05-04 15:17:12.034 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/api/Participant/get_participants/1 - null null
2025-05-04 15:17:12.034 +07:00 [INF] CORS policy execution successful.
2025-05-04 15:17:12.034 +07:00 [INF] CORS policy execution successful.
2025-05-04 15:17:12.035 +07:00 [INF] Executing endpoint 'server.Controllers.ParticipantController.GetParticipants (Message_app)'
2025-05-04 15:17:12.036 +07:00 [INF] Route matched with {action = "GetParticipants", controller = "Participant"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetParticipants(Int32) on controller server.Controllers.ParticipantController (Message_app).
2025-05-04 15:17:12.042 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__conversation_id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[id], [p].[adder], [p].[conversation_id], [p].[is_deleted], [p].[joined_at], [p].[name], [p].[role], [p].[user_id]
FROM [Participants] AS [p]
WHERE [p].[conversation_id] = @__conversation_id_0
2025-05-04 15:17:12.043 +07:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType17`1[[System.Collections.Generic.List`1[[server.Models.Participants, Message_app, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-05-04 15:17:12.044 +07:00 [INF] Executed action server.Controllers.ParticipantController.GetParticipants (Message_app) in 8.0212ms
2025-05-04 15:17:12.044 +07:00 [INF] Executed endpoint 'server.Controllers.ParticipantController.GetParticipants (Message_app)'
2025-05-04 15:17:12.044 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5053/api/Participant/get_participants/1 - 200 null application/json; charset=utf-8 10.2127ms
2025-05-04 15:17:16.731 +07:00 [INF] Executed endpoint '/ws/chat'
2025-05-04 15:17:16.731 +07:00 [INF] Executed endpoint '/ws/chat'
2025-05-04 15:17:16.731 +07:00 [INF] Executed endpoint '/ws/chat'
2025-05-04 15:17:16.731 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5053/ws/chat?userId=5 - 101 null null 379336.2755ms
2025-05-04 15:17:16.731 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5053/ws/chat?userId=5 - 101 null null 729386.7752ms
2025-05-04 15:17:16.731 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5053/ws/chat?userId=5 - 101 null null 694522.4262ms
2025-05-04 15:17:47.080 +07:00 [INF] Request starting HTTP/1.1 POST http://192.168.1.9:5053/api/Auth/login - application/json 57
2025-05-04 15:17:47.082 +07:00 [INF] Executing endpoint 'Message_app.Controllers.AuthController.Login (Message_app)'
2025-05-04 15:17:47.086 +07:00 [INF] Route matched with {action = "Login", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Login(server.DTO.AuthDTO.LoginDTO) on controller Message_app.Controllers.AuthController (Message_app).
2025-05-04 15:17:47.103 +07:00 [INF] Executed DbCommand (13ms) [Parameters=[@__email_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[id], [u].[avatar_url], [u].[bio], [u].[birthday], [u].[created_at], [u].[email], [u].[gender], [u].[interests], [u].[location], [u].[password], [u].[passwordSalt], [u].[username]
FROM [Users] AS [u]
WHERE [u].[email] = @__email_0
2025-05-04 15:17:47.105 +07:00 [INF] Executing OkObjectResult, writing value of type 'server.DTO.AuthDTO.LoginRespose'.
2025-05-04 15:17:47.108 +07:00 [INF] Executed action Message_app.Controllers.AuthController.Login (Message_app) in 21.6412ms
2025-05-04 15:17:47.108 +07:00 [INF] Executed endpoint 'Message_app.Controllers.AuthController.Login (Message_app)'
2025-05-04 15:17:47.108 +07:00 [INF] Request finished HTTP/1.1 POST http://192.168.1.9:5053/api/Auth/login - 200 null application/json; charset=utf-8 27.5795ms
2025-05-04 15:17:47.322 +07:00 [INF] Request starting HTTP/1.1 GET http://192.168.1.9:5053/api/Conversation/get_conversations/2 - null null
2025-05-04 15:17:47.323 +07:00 [INF] Executing endpoint 'server.Controllers.ConversationController.GetConversations (Message_app)'
2025-05-04 15:17:47.325 +07:00 [INF] Request starting HTTP/1.1 GET http://192.168.1.9:5053/api/Conversation/get_conversations/2 - null null
2025-05-04 15:17:47.326 +07:00 [INF] Executing endpoint 'server.Controllers.ConversationController.GetConversations (Message_app)'
2025-05-04 15:17:47.326 +07:00 [INF] Route matched with {action = "GetConversations", controller = "Conversation"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetConversations(Int32) on controller server.Controllers.ConversationController (Message_app).
2025-05-04 15:17:47.330 +07:00 [INF] Route matched with {action = "GetConversations", controller = "Conversation"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetConversations(Int32) on controller server.Controllers.ConversationController (Message_app).
2025-05-04 15:17:47.395 +07:00 [INF] Executed DbCommand (31ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[id], [c].[name], [c].[is_group], [c].[created_at], [c].[lastMessage], [c].[lastMessageTime], [t].[Id], [t].[UserId], [t].[ConversationId], [t].[Name], [t].[IsDeleted]
FROM [Conversations] AS [c]
LEFT JOIN (
    SELECT [p0].[id] AS [Id], [p0].[user_id] AS [UserId], [p0].[conversation_id] AS [ConversationId], [p0].[name] AS [Name], [p0].[is_deleted] AS [IsDeleted]
    FROM [Participants] AS [p0]
    WHERE [p0].[is_deleted] = CAST(0 AS bit)
) AS [t] ON [c].[id] = [t].[ConversationId]
WHERE EXISTS (
    SELECT 1
    FROM [Participants] AS [p]
    WHERE [c].[id] = [p].[conversation_id] AND [p].[user_id] = @__userId_0 AND [p].[is_deleted] = CAST(0 AS bit))
ORDER BY [c].[id]
2025-05-04 15:17:47.395 +07:00 [INF] Executed DbCommand (21ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[id], [c].[name], [c].[is_group], [c].[created_at], [c].[lastMessage], [c].[lastMessageTime], [t].[Id], [t].[UserId], [t].[ConversationId], [t].[Name], [t].[IsDeleted]
FROM [Conversations] AS [c]
LEFT JOIN (
    SELECT [p0].[id] AS [Id], [p0].[user_id] AS [UserId], [p0].[conversation_id] AS [ConversationId], [p0].[name] AS [Name], [p0].[is_deleted] AS [IsDeleted]
    FROM [Participants] AS [p0]
    WHERE [p0].[is_deleted] = CAST(0 AS bit)
) AS [t] ON [c].[id] = [t].[ConversationId]
WHERE EXISTS (
    SELECT 1
    FROM [Participants] AS [p]
    WHERE [c].[id] = [p].[conversation_id] AND [p].[user_id] = @__userId_0 AND [p].[is_deleted] = CAST(0 AS bit))
ORDER BY [c].[id]
2025-05-04 15:17:47.406 +07:00 [ERR] An exception occurred while iterating over the results of a query for context type 'server.Data.ApplicationDbContext'.
System.MissingMethodException: Attempted to invoke a deleted method implementation. This can happen when a method is deleted or its name or signature is changed while the application is running.
   at server.DTO.ConversationDto.set_IsGroup(Boolean value)
   at lambda_method576(Closure, QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
System.MissingMethodException: Attempted to invoke a deleted method implementation. This can happen when a method is deleted or its name or signature is changed while the application is running.
   at server.DTO.ConversationDto.set_IsGroup(Boolean value)
   at lambda_method576(Closure, QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
2025-05-04 15:17:47.406 +07:00 [ERR] An exception occurred while iterating over the results of a query for context type 'server.Data.ApplicationDbContext'.
System.MissingMethodException: Attempted to invoke a deleted method implementation. This can happen when a method is deleted or its name or signature is changed while the application is running.
   at server.DTO.ConversationDto.set_IsGroup(Boolean value)
   at lambda_method576(Closure, QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
System.MissingMethodException: Attempted to invoke a deleted method implementation. This can happen when a method is deleted or its name or signature is changed while the application is running.
   at server.DTO.ConversationDto.set_IsGroup(Boolean value)
   at lambda_method576(Closure, QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
2025-05-04 15:17:47.409 +07:00 [INF] Executing BadRequestObjectResult, writing value of type 'System.String'.
2025-05-04 15:17:47.409 +07:00 [INF] Executing BadRequestObjectResult, writing value of type 'System.String'.
2025-05-04 15:17:47.410 +07:00 [INF] Executed action server.Controllers.ConversationController.GetConversations (Message_app) in 79.3304ms
2025-05-04 15:17:47.410 +07:00 [INF] Executed endpoint 'server.Controllers.ConversationController.GetConversations (Message_app)'
2025-05-04 15:17:47.410 +07:00 [INF] Request finished HTTP/1.1 GET http://192.168.1.9:5053/api/Conversation/get_conversations/2 - 400 null text/plain; charset=utf-8 84.6983ms
2025-05-04 15:17:47.410 +07:00 [INF] Executed action server.Controllers.ConversationController.GetConversations (Message_app) in 84.059ms
2025-05-04 15:17:47.410 +07:00 [INF] Executed endpoint 'server.Controllers.ConversationController.GetConversations (Message_app)'
2025-05-04 15:17:47.410 +07:00 [INF] Request finished HTTP/1.1 GET http://192.168.1.9:5053/api/Conversation/get_conversations/2 - 400 null text/plain; charset=utf-8 87.8359ms
2025-05-04 15:18:50.971 +07:00 [INF] Application is shutting down...
2025-05-04 15:20:03.335 +07:00 [INF] Executed DbCommand (44ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [u].[id], [u].[username], [u].[avatar_url]
FROM [Users] AS [u]
2025-05-04 15:20:03.596 +07:00 [INF] User profile is available. Using 'C:\Users\Thao\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-05-04 15:20:03.682 +07:00 [WRN] Overriding address(es) 'http://localhost:5053'. Binding to endpoints defined via IConfiguration and/or UseKestrel() instead.
2025-05-04 15:20:03.701 +07:00 [INF] Now listening on: http://[::]:5053
2025-05-04 15:20:03.701 +07:00 [INF] Now listening on: http://0.0.0.0:5053
2025-05-04 15:20:03.702 +07:00 [INF] Application started. Press Ctrl+C to shut down.
2025-05-04 15:20:03.702 +07:00 [INF] Hosting environment: Development
2025-05-04 15:20:03.702 +07:00 [INF] Content root path: C:\Users\Thao\source\Flutter\Message_app\server
2025-05-04 15:20:51.240 +07:00 [INF] Request starting HTTP/1.1 POST http://192.168.1.9:5053/api/Auth/login - application/json 57
2025-05-04 15:20:51.335 +07:00 [WRN] Failed to determine the https port for redirect.
2025-05-04 15:20:51.395 +07:00 [INF] Executing endpoint 'Message_app.Controllers.AuthController.Login (Message_app)'
2025-05-04 15:20:51.423 +07:00 [INF] Route matched with {action = "Login", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Login(server.DTO.AuthDTO.LoginDTO) on controller Message_app.Controllers.AuthController (Message_app).
2025-05-04 15:20:51.725 +07:00 [INF] Executed DbCommand (29ms) [Parameters=[@__email_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[id], [u].[avatar_url], [u].[bio], [u].[birthday], [u].[created_at], [u].[email], [u].[gender], [u].[interests], [u].[location], [u].[password], [u].[passwordSalt], [u].[username]
FROM [Users] AS [u]
WHERE [u].[email] = @__email_0
2025-05-04 15:20:51.933 +07:00 [INF] Executing OkObjectResult, writing value of type 'server.DTO.AuthDTO.LoginRespose'.
2025-05-04 15:20:52.066 +07:00 [INF] Executed action Message_app.Controllers.AuthController.Login (Message_app) in 638.1889ms
2025-05-04 15:20:52.069 +07:00 [INF] Executed endpoint 'Message_app.Controllers.AuthController.Login (Message_app)'
2025-05-04 15:20:52.079 +07:00 [INF] Request finished HTTP/1.1 POST http://192.168.1.9:5053/api/Auth/login - 200 null application/json; charset=utf-8 841.3492ms
2025-05-04 15:20:53.187 +07:00 [INF] Request starting HTTP/1.1 GET http://192.168.1.9:5053/api/Conversation/get_conversations/2 - null null
2025-05-04 15:20:53.205 +07:00 [INF] Executing endpoint 'server.Controllers.ConversationController.GetConversations (Message_app)'
2025-05-04 15:20:53.223 +07:00 [INF] Route matched with {action = "GetConversations", controller = "Conversation"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetConversations(Int32) on controller server.Controllers.ConversationController (Message_app).
2025-05-04 15:20:53.301 +07:00 [INF] Request starting HTTP/1.1 GET http://192.168.1.9:5053/api/Conversation/get_conversations/2 - null null
2025-05-04 15:20:53.309 +07:00 [INF] Executing endpoint 'server.Controllers.ConversationController.GetConversations (Message_app)'
2025-05-04 15:20:53.310 +07:00 [INF] Route matched with {action = "GetConversations", controller = "Conversation"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetConversations(Int32) on controller server.Controllers.ConversationController (Message_app).
2025-05-04 15:20:53.593 +07:00 [INF] Executed DbCommand (22ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[id], [c].[name], [c].[is_group], [c].[created_at], [c].[lastMessage], [c].[lastMessageTime], [t].[Id], [t].[UserId], [t].[ConversationId], [t].[Name], [t].[IsDeleted]
FROM [Conversations] AS [c]
LEFT JOIN (
    SELECT [p0].[id] AS [Id], [p0].[user_id] AS [UserId], [p0].[conversation_id] AS [ConversationId], [p0].[name] AS [Name], [p0].[is_deleted] AS [IsDeleted]
    FROM [Participants] AS [p0]
    WHERE [p0].[is_deleted] = CAST(0 AS bit)
) AS [t] ON [c].[id] = [t].[ConversationId]
WHERE EXISTS (
    SELECT 1
    FROM [Participants] AS [p]
    WHERE [c].[id] = [p].[conversation_id] AND [p].[user_id] = @__userId_0 AND [p].[is_deleted] = CAST(0 AS bit))
ORDER BY [c].[id]
2025-05-04 15:20:53.604 +07:00 [INF] Executed DbCommand (19ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[id], [c].[name], [c].[is_group], [c].[created_at], [c].[lastMessage], [c].[lastMessageTime], [t].[Id], [t].[UserId], [t].[ConversationId], [t].[Name], [t].[IsDeleted]
FROM [Conversations] AS [c]
LEFT JOIN (
    SELECT [p0].[id] AS [Id], [p0].[user_id] AS [UserId], [p0].[conversation_id] AS [ConversationId], [p0].[name] AS [Name], [p0].[is_deleted] AS [IsDeleted]
    FROM [Participants] AS [p0]
    WHERE [p0].[is_deleted] = CAST(0 AS bit)
) AS [t] ON [c].[id] = [t].[ConversationId]
WHERE EXISTS (
    SELECT 1
    FROM [Participants] AS [p]
    WHERE [c].[id] = [p].[conversation_id] AND [p].[user_id] = @__userId_0 AND [p].[is_deleted] = CAST(0 AS bit))
ORDER BY [c].[id]
2025-05-04 15:20:53.664 +07:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[server.DTO.ConversationDto, Message_app, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-05-04 15:20:53.667 +07:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[server.DTO.ConversationDto, Message_app, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-05-04 15:20:53.669 +07:00 [INF] Executed action server.Controllers.ConversationController.GetConversations (Message_app) in 358.9252ms
2025-05-04 15:20:53.669 +07:00 [INF] Executed action server.Controllers.ConversationController.GetConversations (Message_app) in 444.2182ms
2025-05-04 15:20:53.669 +07:00 [INF] Executed endpoint 'server.Controllers.ConversationController.GetConversations (Message_app)'
2025-05-04 15:20:53.669 +07:00 [INF] Executed endpoint 'server.Controllers.ConversationController.GetConversations (Message_app)'
2025-05-04 15:20:53.670 +07:00 [INF] Request finished HTTP/1.1 GET http://192.168.1.9:5053/api/Conversation/get_conversations/2 - 200 null application/json; charset=utf-8 368.8806ms
2025-05-04 15:20:53.670 +07:00 [INF] Request finished HTTP/1.1 GET http://192.168.1.9:5053/api/Conversation/get_conversations/2 - 200 null application/json; charset=utf-8 482.9945ms
2025-05-04 15:20:53.812 +07:00 [INF] Request starting HTTP/1.1 GET http://192.168.1.9:5053/ws/chat?userId=2 - null null
2025-05-04 15:20:53.814 +07:00 [INF] Executing endpoint '/ws/chat'
2025-05-04 15:20:54.255 +07:00 [INF] Executed DbCommand (4ms) [Parameters=[@__client_UserId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[conversation_id]
FROM [Participants] AS [p]
WHERE [p].[user_id] = @__client_UserId_0 AND [p].[is_deleted] = CAST(0 AS bit)
2025-05-04 15:20:54.323 +07:00 [INF] Executed DbCommand (28ms) [Parameters=[@__p_1='?' (DbType = Int32), @__conversationId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(@__p_1) [m].[id], [m].[conversation_id], [m].[sender_id], [m].[content], [m].[created_at], [m].[isFile], [m].[type], [m].[isRecalled]
FROM [Messages] AS [m]
WHERE [m].[conversation_id] = @__conversationId_0
ORDER BY [m].[created_at] DESC
2025-05-04 15:20:54.344 +07:00 [INF] Saved message 88 to Redis
2025-05-04 15:20:54.348 +07:00 [INF] Added message 88 to conversation 3
2025-05-04 15:20:54.352 +07:00 [INF] Saved message 70 to Redis
2025-05-04 15:20:54.355 +07:00 [INF] Added message 70 to conversation 3
2025-05-04 15:20:54.359 +07:00 [INF] Saved message 65 to Redis
2025-05-04 15:20:54.360 +07:00 [INF] Added message 65 to conversation 3
2025-05-04 15:20:54.363 +07:00 [INF] Saved message 48 to Redis
2025-05-04 15:20:54.364 +07:00 [INF] Added message 48 to conversation 3
2025-05-04 15:21:00.510 +07:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5053/api/Auth/login - null null
2025-05-04 15:21:00.513 +07:00 [INF] CORS policy execution successful.
2025-05-04 15:21:00.515 +07:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5053/api/Auth/login - 204 null null 5.1278ms
2025-05-04 15:21:00.517 +07:00 [INF] Request starting HTTP/1.1 POST http://localhost:5053/api/Auth/login - application/json 53
2025-05-04 15:21:00.517 +07:00 [INF] CORS policy execution successful.
2025-05-04 15:21:00.519 +07:00 [INF] CORS policy execution successful.
2025-05-04 15:21:00.520 +07:00 [INF] Executing endpoint 'Message_app.Controllers.AuthController.Login (Message_app)'
2025-05-04 15:21:00.520 +07:00 [INF] Route matched with {action = "Login", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Login(server.DTO.AuthDTO.LoginDTO) on controller Message_app.Controllers.AuthController (Message_app).
2025-05-04 15:21:00.537 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__email_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[id], [u].[avatar_url], [u].[bio], [u].[birthday], [u].[created_at], [u].[email], [u].[gender], [u].[interests], [u].[location], [u].[password], [u].[passwordSalt], [u].[username]
FROM [Users] AS [u]
WHERE [u].[email] = @__email_0
2025-05-04 15:21:00.550 +07:00 [INF] Executing OkObjectResult, writing value of type 'server.DTO.AuthDTO.LoginRespose'.
2025-05-04 15:21:00.552 +07:00 [INF] Executed action Message_app.Controllers.AuthController.Login (Message_app) in 31.7357ms
2025-05-04 15:21:00.553 +07:00 [INF] Executed endpoint 'Message_app.Controllers.AuthController.Login (Message_app)'
2025-05-04 15:21:00.553 +07:00 [INF] Request finished HTTP/1.1 POST http://localhost:5053/api/Auth/login - 200 null application/json; charset=utf-8 36.1794ms
2025-05-04 15:21:00.799 +07:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5053/api/Conversation/get_conversations/5 - null null
2025-05-04 15:21:00.799 +07:00 [INF] CORS policy execution successful.
2025-05-04 15:21:00.799 +07:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5053/api/Conversation/get_conversations/5 - 204 null null 0.6634ms
2025-05-04 15:21:00.802 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/api/Conversation/get_conversations/5 - null null
2025-05-04 15:21:00.802 +07:00 [INF] CORS policy execution successful.
2025-05-04 15:21:00.803 +07:00 [INF] CORS policy execution successful.
2025-05-04 15:21:00.803 +07:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5053/api/Conversation/get_conversations/5 - null null
2025-05-04 15:21:00.803 +07:00 [INF] Executing endpoint 'server.Controllers.ConversationController.GetConversations (Message_app)'
2025-05-04 15:21:00.803 +07:00 [INF] CORS policy execution successful.
2025-05-04 15:21:00.803 +07:00 [INF] Route matched with {action = "GetConversations", controller = "Conversation"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetConversations(Int32) on controller server.Controllers.ConversationController (Message_app).
2025-05-04 15:21:00.803 +07:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5053/api/Conversation/get_conversations/5 - 204 null null 0.7065ms
2025-05-04 15:21:00.822 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[id], [c].[name], [c].[is_group], [c].[created_at], [c].[lastMessage], [c].[lastMessageTime], [t].[Id], [t].[UserId], [t].[ConversationId], [t].[Name], [t].[IsDeleted]
FROM [Conversations] AS [c]
LEFT JOIN (
    SELECT [p0].[id] AS [Id], [p0].[user_id] AS [UserId], [p0].[conversation_id] AS [ConversationId], [p0].[name] AS [Name], [p0].[is_deleted] AS [IsDeleted]
    FROM [Participants] AS [p0]
    WHERE [p0].[is_deleted] = CAST(0 AS bit)
) AS [t] ON [c].[id] = [t].[ConversationId]
WHERE EXISTS (
    SELECT 1
    FROM [Participants] AS [p]
    WHERE [c].[id] = [p].[conversation_id] AND [p].[user_id] = @__userId_0 AND [p].[is_deleted] = CAST(0 AS bit))
ORDER BY [c].[id]
2025-05-04 15:21:00.827 +07:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[server.DTO.ConversationDto, Message_app, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-05-04 15:21:00.828 +07:00 [INF] Executed action server.Controllers.ConversationController.GetConversations (Message_app) in 24.968ms
2025-05-04 15:21:00.828 +07:00 [INF] Executed endpoint 'server.Controllers.ConversationController.GetConversations (Message_app)'
2025-05-04 15:21:00.829 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5053/api/Conversation/get_conversations/5 - 200 null application/json; charset=utf-8 26.4358ms
2025-05-04 15:21:00.832 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/api/Conversation/get_conversations/5 - null null
2025-05-04 15:21:00.833 +07:00 [INF] CORS policy execution successful.
2025-05-04 15:21:00.833 +07:00 [INF] CORS policy execution successful.
2025-05-04 15:21:00.834 +07:00 [INF] Executing endpoint 'server.Controllers.ConversationController.GetConversations (Message_app)'
2025-05-04 15:21:00.834 +07:00 [INF] Route matched with {action = "GetConversations", controller = "Conversation"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetConversations(Int32) on controller server.Controllers.ConversationController (Message_app).
2025-05-04 15:21:00.862 +07:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[server.DTO.ConversationDto, Message_app, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-05-04 15:21:00.863 +07:00 [INF] Executed action server.Controllers.ConversationController.GetConversations (Message_app) in 28.8216ms
2025-05-04 15:21:00.863 +07:00 [INF] Executed endpoint 'server.Controllers.ConversationController.GetConversations (Message_app)'
2025-05-04 15:21:00.864 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5053/api/Conversation/get_conversations/5 - 200 null application/json; charset=utf-8 31.5306ms
2025-05-04 15:21:00.953 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/ws/chat?userId=5 - null null
2025-05-04 15:21:00.953 +07:00 [INF] CORS policy execution successful.
2025-05-04 15:21:00.954 +07:00 [INF] CORS policy execution successful.
2025-05-04 15:21:00.955 +07:00 [INF] Executing endpoint '/ws/chat'
2025-05-04 15:21:00.963 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__client_UserId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[conversation_id]
FROM [Participants] AS [p]
WHERE [p].[user_id] = @__client_UserId_0 AND [p].[is_deleted] = CAST(0 AS bit)
2025-05-04 15:22:31.218 +07:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5053/api/Message/getMessages/1/5 - null null
2025-05-04 15:22:31.218 +07:00 [INF] CORS policy execution successful.
2025-05-04 15:22:31.219 +07:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5053/api/Message/getMessages/1/5 - 204 null null 0.4874ms
2025-05-04 15:22:31.220 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/api/Message/getMessages/1/5 - null null
2025-05-04 15:22:31.220 +07:00 [INF] CORS policy execution successful.
2025-05-04 15:22:31.220 +07:00 [INF] CORS policy execution successful.
2025-05-04 15:22:31.220 +07:00 [INF] Executing endpoint 'server.Controllers.MessageController.GetMessages (Message_app)'
2025-05-04 15:22:31.226 +07:00 [INF] Route matched with {action = "GetMessages", controller = "Message"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetMessages(Int32, Int32) on controller server.Controllers.MessageController (Message_app).
2025-05-04 15:22:31.262 +07:00 [INF] Retrieved 28 messages from Redis for conversation 1
2025-05-04 15:22:31.266 +07:00 [INF] Retrieved 28 messages from Redis for conversation 1 and user 5
2025-05-04 15:22:31.267 +07:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[server.DTO.MessageWithAttachment, Message_app, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-05-04 15:22:31.269 +07:00 [INF] Executed action server.Controllers.MessageController.GetMessages (Message_app) in 42.7017ms
2025-05-04 15:22:31.269 +07:00 [INF] Executed endpoint 'server.Controllers.MessageController.GetMessages (Message_app)'
2025-05-04 15:22:31.270 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5053/api/Message/getMessages/1/5 - 200 null application/json; charset=utf-8 50.016ms
2025-05-04 15:22:31.282 +07:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5053/api/Conversation/get_first_conversation/1 - null null
2025-05-04 15:22:31.283 +07:00 [INF] CORS policy execution successful.
2025-05-04 15:22:31.283 +07:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5053/api/Conversation/get_first_conversation/1 - 204 null null 0.4883ms
2025-05-04 15:22:31.285 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/api/Conversation/get_first_conversation/1 - null null
2025-05-04 15:22:31.285 +07:00 [INF] CORS policy execution successful.
2025-05-04 15:22:31.285 +07:00 [INF] CORS policy execution successful.
2025-05-04 15:22:31.285 +07:00 [INF] Executing endpoint 'server.Controllers.ConversationController.GetFirstConversation (Message_app)'
2025-05-04 15:22:31.288 +07:00 [INF] Route matched with {action = "GetFirstConversation", controller = "Conversation"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetFirstConversation(Int32) on controller server.Controllers.ConversationController (Message_app).
2025-05-04 15:22:31.315 +07:00 [INF] Executed DbCommand (5ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[id], [c].[created_at], [c].[is_group], [c].[lastMessage], [c].[lastMessageSender], [c].[lastMessageTime], [c].[name]
FROM [Conversations] AS [c]
WHERE [c].[id] = @__p_0
2025-05-04 15:22:31.335 +07:00 [INF] Executing OkObjectResult, writing value of type 'server.Models.Conversation'.
2025-05-04 15:22:31.337 +07:00 [INF] Executed action server.Controllers.ConversationController.GetFirstConversation (Message_app) in 48.3559ms
2025-05-04 15:22:31.337 +07:00 [INF] Executed endpoint 'server.Controllers.ConversationController.GetFirstConversation (Message_app)'
2025-05-04 15:22:31.337 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5053/api/Conversation/get_first_conversation/1 - 200 null application/json; charset=utf-8 52.4488ms
2025-05-04 15:22:31.342 +07:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5053/api/Participant/get_participants/1 - null null
2025-05-04 15:22:31.342 +07:00 [INF] CORS policy execution successful.
2025-05-04 15:22:31.342 +07:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5053/api/Participant/get_participants/1 - 204 null null 0.3073ms
2025-05-04 15:22:31.343 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/api/Participant/get_participants/1 - null null
2025-05-04 15:22:31.344 +07:00 [INF] CORS policy execution successful.
2025-05-04 15:22:31.344 +07:00 [INF] CORS policy execution successful.
2025-05-04 15:22:31.344 +07:00 [INF] Executing endpoint 'server.Controllers.ParticipantController.GetParticipants (Message_app)'
2025-05-04 15:22:31.348 +07:00 [INF] Route matched with {action = "GetParticipants", controller = "Participant"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetParticipants(Int32) on controller server.Controllers.ParticipantController (Message_app).
2025-05-04 15:22:31.358 +07:00 [INF] Executed DbCommand (4ms) [Parameters=[@__conversation_id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[id], [p].[adder], [p].[conversation_id], [p].[is_deleted], [p].[joined_at], [p].[name], [p].[role], [p].[user_id]
FROM [Participants] AS [p]
WHERE [p].[conversation_id] = @__conversation_id_0
2025-05-04 15:22:31.367 +07:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType17`1[[System.Collections.Generic.List`1[[server.Models.Participants, Message_app, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-05-04 15:22:31.373 +07:00 [INF] Executed action server.Controllers.ParticipantController.GetParticipants (Message_app) in 24.7989ms
2025-05-04 15:22:31.373 +07:00 [INF] Executed endpoint 'server.Controllers.ParticipantController.GetParticipants (Message_app)'
2025-05-04 15:22:31.373 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5053/api/Participant/get_participants/1 - 200 null application/json; charset=utf-8 29.444ms
2025-05-04 15:22:34.990 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/api/Participant/get_participants/1 - null null
2025-05-04 15:22:34.990 +07:00 [INF] CORS policy execution successful.
2025-05-04 15:22:34.991 +07:00 [INF] CORS policy execution successful.
2025-05-04 15:22:34.991 +07:00 [INF] Executing endpoint 'server.Controllers.ParticipantController.GetParticipants (Message_app)'
2025-05-04 15:22:34.991 +07:00 [INF] Route matched with {action = "GetParticipants", controller = "Participant"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetParticipants(Int32) on controller server.Controllers.ParticipantController (Message_app).
2025-05-04 15:22:34.995 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[@__conversation_id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[id], [p].[adder], [p].[conversation_id], [p].[is_deleted], [p].[joined_at], [p].[name], [p].[role], [p].[user_id]
FROM [Participants] AS [p]
WHERE [p].[conversation_id] = @__conversation_id_0
2025-05-04 15:22:34.996 +07:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType17`1[[System.Collections.Generic.List`1[[server.Models.Participants, Message_app, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-05-04 15:22:34.996 +07:00 [INF] Executed action server.Controllers.ParticipantController.GetParticipants (Message_app) in 4.5029ms
2025-05-04 15:22:34.996 +07:00 [INF] Executed endpoint 'server.Controllers.ParticipantController.GetParticipants (Message_app)'
2025-05-04 15:22:34.997 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5053/api/Participant/get_participants/1 - 200 null application/json; charset=utf-8 6.3485ms
2025-05-04 15:22:39.545 +07:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5053/api/Conversation/update_conversation_name/1 - null null
2025-05-04 15:22:39.545 +07:00 [INF] CORS policy execution successful.
2025-05-04 15:22:39.546 +07:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5053/api/Conversation/update_conversation_name/1 - 204 null null 1.0241ms
2025-05-04 15:22:39.547 +07:00 [INF] Request starting HTTP/1.1 PUT http://localhost:5053/api/Conversation/update_conversation_name/1 - application/json 9
2025-05-04 15:22:39.547 +07:00 [INF] CORS policy execution successful.
2025-05-04 15:22:39.548 +07:00 [INF] CORS policy execution successful.
2025-05-04 15:22:39.548 +07:00 [INF] Executing endpoint 'server.Controllers.ConversationController.UpdateConversationName (Message_app)'
2025-05-04 15:22:39.552 +07:00 [INF] Route matched with {action = "UpdateConversationName", controller = "Conversation"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] UpdateConversationName(Int32, System.String) on controller server.Controllers.ConversationController (Message_app).
2025-05-04 15:22:39.586 +07:00 [INF] Executed DbCommand (7ms) [Parameters=[@__conversation_id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[id], [t].[created_at], [t].[is_group], [t].[lastMessage], [t].[lastMessageSender], [t].[lastMessageTime], [t].[name], [p].[id], [p].[adder], [p].[conversation_id], [p].[is_deleted], [p].[joined_at], [p].[name], [p].[role], [p].[user_id]
FROM (
    SELECT TOP(1) [c].[id], [c].[created_at], [c].[is_group], [c].[lastMessage], [c].[lastMessageSender], [c].[lastMessageTime], [c].[name]
    FROM [Conversations] AS [c]
    WHERE [c].[id] = @__conversation_id_0
) AS [t]
LEFT JOIN [Participants] AS [p] ON [t].[id] = [p].[conversation_id]
ORDER BY [t].[id]
2025-05-04 15:22:39.686 +07:00 [INF] Executed DbCommand (32ms) [Parameters=[@p6='?' (DbType = Int32), @p0='?' (DbType = DateTime2), @p1='?' (DbType = Boolean), @p2='?' (Size = 4000), @p3='?' (Size = 4000), @p4='?' (DbType = DateTime2), @p5='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
UPDATE [Conversations] SET [created_at] = @p0, [is_group] = @p1, [lastMessage] = @p2, [lastMessageSender] = @p3, [lastMessageTime] = @p4, [name] = @p5
OUTPUT 1
WHERE [id] = @p6;
2025-05-04 15:22:39.702 +07:00 [INF] Executing OkObjectResult, writing value of type 'server.Models.Conversation'.
2025-05-04 15:22:39.703 +07:00 [INF] Executed action server.Controllers.ConversationController.UpdateConversationName (Message_app) in 151.5112ms
2025-05-04 15:22:39.703 +07:00 [INF] Executed endpoint 'server.Controllers.ConversationController.UpdateConversationName (Message_app)'
2025-05-04 15:22:39.704 +07:00 [INF] Request finished HTTP/1.1 PUT http://localhost:5053/api/Conversation/update_conversation_name/1 - 200 null application/json; charset=utf-8 156.2497ms
2025-05-04 15:22:50.212 +07:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5053/api/Conversation/get_conversations/5 - null null
2025-05-04 15:22:50.212 +07:00 [INF] CORS policy execution successful.
2025-05-04 15:22:50.213 +07:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5053/api/Conversation/get_conversations/5 - 204 null null 0.5544ms
2025-05-04 15:22:50.214 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/api/Conversation/get_conversations/5 - null null
2025-05-04 15:22:50.215 +07:00 [INF] CORS policy execution successful.
2025-05-04 15:22:50.215 +07:00 [INF] CORS policy execution successful.
2025-05-04 15:22:50.215 +07:00 [INF] Executing endpoint 'server.Controllers.ConversationController.GetConversations (Message_app)'
2025-05-04 15:22:50.215 +07:00 [INF] Route matched with {action = "GetConversations", controller = "Conversation"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetConversations(Int32) on controller server.Controllers.ConversationController (Message_app).
2025-05-04 15:22:50.229 +07:00 [INF] Executed DbCommand (11ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[id], [c].[name], [c].[is_group], [c].[created_at], [c].[lastMessage], [c].[lastMessageTime], [t].[Id], [t].[UserId], [t].[ConversationId], [t].[Name], [t].[IsDeleted]
FROM [Conversations] AS [c]
LEFT JOIN (
    SELECT [p0].[id] AS [Id], [p0].[user_id] AS [UserId], [p0].[conversation_id] AS [ConversationId], [p0].[name] AS [Name], [p0].[is_deleted] AS [IsDeleted]
    FROM [Participants] AS [p0]
    WHERE [p0].[is_deleted] = CAST(0 AS bit)
) AS [t] ON [c].[id] = [t].[ConversationId]
WHERE EXISTS (
    SELECT 1
    FROM [Participants] AS [p]
    WHERE [c].[id] = [p].[conversation_id] AND [p].[user_id] = @__userId_0 AND [p].[is_deleted] = CAST(0 AS bit))
ORDER BY [c].[id]
2025-05-04 15:22:50.231 +07:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[server.DTO.ConversationDto, Message_app, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-05-04 15:22:50.231 +07:00 [INF] Executed action server.Controllers.ConversationController.GetConversations (Message_app) in 16.0052ms
2025-05-04 15:22:50.231 +07:00 [INF] Executed endpoint 'server.Controllers.ConversationController.GetConversations (Message_app)'
2025-05-04 15:22:50.232 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5053/api/Conversation/get_conversations/5 - 200 null application/json; charset=utf-8 17.3529ms
2025-05-04 15:22:53.180 +07:00 [INF] Request starting HTTP/1.1 GET http://192.168.1.9:5053/api/Message/getMessages/1/2 - null null
2025-05-04 15:22:53.182 +07:00 [INF] Executing endpoint 'server.Controllers.MessageController.GetMessages (Message_app)'
2025-05-04 15:22:53.182 +07:00 [INF] Route matched with {action = "GetMessages", controller = "Message"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetMessages(Int32, Int32) on controller server.Controllers.MessageController (Message_app).
2025-05-04 15:22:53.205 +07:00 [INF] Retrieved 28 messages from Redis for conversation 1
2025-05-04 15:22:53.206 +07:00 [INF] Retrieved 28 messages from Redis for conversation 1 and user 2
2025-05-04 15:22:53.206 +07:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[server.DTO.MessageWithAttachment, Message_app, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-05-04 15:22:53.206 +07:00 [INF] Executed action server.Controllers.MessageController.GetMessages (Message_app) in 24.0187ms
2025-05-04 15:22:53.206 +07:00 [INF] Executed endpoint 'server.Controllers.MessageController.GetMessages (Message_app)'
2025-05-04 15:22:53.206 +07:00 [INF] Request finished HTTP/1.1 GET http://192.168.1.9:5053/api/Message/getMessages/1/2 - 200 null application/json; charset=utf-8 26.5915ms
2025-05-04 15:22:53.339 +07:00 [INF] Request starting HTTP/1.1 GET http://192.168.1.9:5053/api/Conversation/get_first_conversation/1 - null null
2025-05-04 15:22:53.339 +07:00 [INF] Executing endpoint 'server.Controllers.ConversationController.GetFirstConversation (Message_app)'
2025-05-04 15:22:53.339 +07:00 [INF] Route matched with {action = "GetFirstConversation", controller = "Conversation"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetFirstConversation(Int32) on controller server.Controllers.ConversationController (Message_app).
2025-05-04 15:22:53.342 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[id], [c].[created_at], [c].[is_group], [c].[lastMessage], [c].[lastMessageSender], [c].[lastMessageTime], [c].[name]
FROM [Conversations] AS [c]
WHERE [c].[id] = @__p_0
2025-05-04 15:22:53.342 +07:00 [INF] Executing OkObjectResult, writing value of type 'server.Models.Conversation'.
2025-05-04 15:22:53.343 +07:00 [INF] Executed action server.Controllers.ConversationController.GetFirstConversation (Message_app) in 3.0865ms
2025-05-04 15:22:53.343 +07:00 [INF] Executed endpoint 'server.Controllers.ConversationController.GetFirstConversation (Message_app)'
2025-05-04 15:22:53.343 +07:00 [INF] Request finished HTTP/1.1 GET http://192.168.1.9:5053/api/Conversation/get_first_conversation/1 - 200 null application/json; charset=utf-8 3.69ms
2025-05-04 15:22:53.390 +07:00 [INF] Request starting HTTP/1.1 GET http://192.168.1.9:5053/api/Participant/get_participants/1 - null null
2025-05-04 15:22:53.390 +07:00 [INF] Executing endpoint 'server.Controllers.ParticipantController.GetParticipants (Message_app)'
2025-05-04 15:22:53.391 +07:00 [INF] Route matched with {action = "GetParticipants", controller = "Participant"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetParticipants(Int32) on controller server.Controllers.ParticipantController (Message_app).
2025-05-04 15:22:53.392 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__conversation_id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[id], [p].[adder], [p].[conversation_id], [p].[is_deleted], [p].[joined_at], [p].[name], [p].[role], [p].[user_id]
FROM [Participants] AS [p]
WHERE [p].[conversation_id] = @__conversation_id_0
2025-05-04 15:22:53.393 +07:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType17`1[[System.Collections.Generic.List`1[[server.Models.Participants, Message_app, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-05-04 15:22:53.393 +07:00 [INF] Executed action server.Controllers.ParticipantController.GetParticipants (Message_app) in 2.2448ms
2025-05-04 15:22:53.393 +07:00 [INF] Executed endpoint 'server.Controllers.ParticipantController.GetParticipants (Message_app)'
2025-05-04 15:22:53.393 +07:00 [INF] Request finished HTTP/1.1 GET http://192.168.1.9:5053/api/Participant/get_participants/1 - 200 null application/json; charset=utf-8 2.7481ms
2025-05-04 15:27:22.234 +07:00 [INF] Executed endpoint '/ws/chat'
2025-05-04 15:27:22.235 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5053/ws/chat?userId=5 - 101 null null 381281.9801ms
2025-05-04 15:27:36.903 +07:00 [INF] Request starting HTTP/1.1 POST http://192.168.1.9:5053/api/Auth/login - application/json 57
2025-05-04 15:27:36.905 +07:00 [INF] Executing endpoint 'Message_app.Controllers.AuthController.Login (Message_app)'
2025-05-04 15:27:36.906 +07:00 [INF] Route matched with {action = "Login", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Login(server.DTO.AuthDTO.LoginDTO) on controller Message_app.Controllers.AuthController (Message_app).
2025-05-04 15:27:37.021 +07:00 [INF] Executed DbCommand (15ms) [Parameters=[@__email_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[id], [u].[avatar_url], [u].[bio], [u].[birthday], [u].[created_at], [u].[email], [u].[gender], [u].[interests], [u].[location], [u].[password], [u].[passwordSalt], [u].[username]
FROM [Users] AS [u]
WHERE [u].[email] = @__email_0
2025-05-04 15:27:37.022 +07:00 [INF] Executing OkObjectResult, writing value of type 'server.DTO.AuthDTO.LoginRespose'.
2025-05-04 15:27:37.022 +07:00 [INF] Executed action Message_app.Controllers.AuthController.Login (Message_app) in 115.1978ms
2025-05-04 15:27:37.022 +07:00 [INF] Executed endpoint 'Message_app.Controllers.AuthController.Login (Message_app)'
2025-05-04 15:27:37.022 +07:00 [INF] Request finished HTTP/1.1 POST http://192.168.1.9:5053/api/Auth/login - 200 null application/json; charset=utf-8 118.6594ms
2025-05-04 15:27:38.130 +07:00 [INF] Request starting HTTP/1.1 GET http://192.168.1.9:5053/api/Conversation/get_conversations/2 - null null
2025-05-04 15:27:38.131 +07:00 [INF] Request starting HTTP/1.1 GET http://192.168.1.9:5053/api/Conversation/get_conversations/2 - null null
2025-05-04 15:27:38.131 +07:00 [INF] Executing endpoint 'server.Controllers.ConversationController.GetConversations (Message_app)'
2025-05-04 15:27:38.131 +07:00 [INF] Executing endpoint 'server.Controllers.ConversationController.GetConversations (Message_app)'
2025-05-04 15:27:38.131 +07:00 [INF] Route matched with {action = "GetConversations", controller = "Conversation"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetConversations(Int32) on controller server.Controllers.ConversationController (Message_app).
2025-05-04 15:27:38.131 +07:00 [INF] Route matched with {action = "GetConversations", controller = "Conversation"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetConversations(Int32) on controller server.Controllers.ConversationController (Message_app).
2025-05-04 15:27:38.157 +07:00 [INF] Executed DbCommand (19ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[id], [c].[name], [c].[is_group], [c].[created_at], [c].[lastMessage], [c].[lastMessageTime], [t].[Id], [t].[UserId], [t].[ConversationId], [t].[Name], [t].[IsDeleted]
FROM [Conversations] AS [c]
LEFT JOIN (
    SELECT [p0].[id] AS [Id], [p0].[user_id] AS [UserId], [p0].[conversation_id] AS [ConversationId], [p0].[name] AS [Name], [p0].[is_deleted] AS [IsDeleted]
    FROM [Participants] AS [p0]
    WHERE [p0].[is_deleted] = CAST(0 AS bit)
) AS [t] ON [c].[id] = [t].[ConversationId]
WHERE EXISTS (
    SELECT 1
    FROM [Participants] AS [p]
    WHERE [c].[id] = [p].[conversation_id] AND [p].[user_id] = @__userId_0 AND [p].[is_deleted] = CAST(0 AS bit))
ORDER BY [c].[id]
2025-05-04 15:27:38.157 +07:00 [INF] Executed DbCommand (24ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[id], [c].[name], [c].[is_group], [c].[created_at], [c].[lastMessage], [c].[lastMessageTime], [t].[Id], [t].[UserId], [t].[ConversationId], [t].[Name], [t].[IsDeleted]
FROM [Conversations] AS [c]
LEFT JOIN (
    SELECT [p0].[id] AS [Id], [p0].[user_id] AS [UserId], [p0].[conversation_id] AS [ConversationId], [p0].[name] AS [Name], [p0].[is_deleted] AS [IsDeleted]
    FROM [Participants] AS [p0]
    WHERE [p0].[is_deleted] = CAST(0 AS bit)
) AS [t] ON [c].[id] = [t].[ConversationId]
WHERE EXISTS (
    SELECT 1
    FROM [Participants] AS [p]
    WHERE [c].[id] = [p].[conversation_id] AND [p].[user_id] = @__userId_0 AND [p].[is_deleted] = CAST(0 AS bit))
ORDER BY [c].[id]
2025-05-04 15:27:38.159 +07:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[server.DTO.ConversationDto, Message_app, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-05-04 15:27:38.159 +07:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[server.DTO.ConversationDto, Message_app, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-05-04 15:27:38.159 +07:00 [INF] Executed action server.Controllers.ConversationController.GetConversations (Message_app) in 28.2121ms
2025-05-04 15:27:38.159 +07:00 [INF] Executed action server.Controllers.ConversationController.GetConversations (Message_app) in 28.1889ms
2025-05-04 15:27:38.160 +07:00 [INF] Executed endpoint 'server.Controllers.ConversationController.GetConversations (Message_app)'
2025-05-04 15:27:38.160 +07:00 [INF] Executed endpoint 'server.Controllers.ConversationController.GetConversations (Message_app)'
2025-05-04 15:27:38.160 +07:00 [INF] Request finished HTTP/1.1 GET http://192.168.1.9:5053/api/Conversation/get_conversations/2 - 200 null application/json; charset=utf-8 29.4364ms
2025-05-04 15:27:38.160 +07:00 [INF] Request finished HTTP/1.1 GET http://192.168.1.9:5053/api/Conversation/get_conversations/2 - 200 null application/json; charset=utf-8 29.6208ms
2025-05-04 15:27:38.263 +07:00 [INF] Request starting HTTP/1.1 GET http://192.168.1.9:5053/ws/chat?userId=2 - null null
2025-05-04 15:27:38.263 +07:00 [INF] Executing endpoint '/ws/chat'
2025-05-04 15:27:38.292 +07:00 [INF] Executed DbCommand (4ms) [Parameters=[@__client_UserId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[conversation_id]
FROM [Participants] AS [p]
WHERE [p].[user_id] = @__client_UserId_0 AND [p].[is_deleted] = CAST(0 AS bit)
2025-05-04 15:29:30.258 +07:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5053/api/Auth/login - null null
2025-05-04 15:29:30.258 +07:00 [INF] CORS policy execution successful.
2025-05-04 15:29:30.259 +07:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5053/api/Auth/login - 204 null null 0.6741ms
2025-05-04 15:29:30.260 +07:00 [INF] Request starting HTTP/1.1 POST http://localhost:5053/api/Auth/login - application/json 53
2025-05-04 15:29:30.260 +07:00 [INF] CORS policy execution successful.
2025-05-04 15:29:30.260 +07:00 [INF] CORS policy execution successful.
2025-05-04 15:29:30.260 +07:00 [INF] Executing endpoint 'Message_app.Controllers.AuthController.Login (Message_app)'
2025-05-04 15:29:30.261 +07:00 [INF] Route matched with {action = "Login", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Login(server.DTO.AuthDTO.LoginDTO) on controller Message_app.Controllers.AuthController (Message_app).
2025-05-04 15:29:30.275 +07:00 [INF] Executed DbCommand (11ms) [Parameters=[@__email_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[id], [u].[avatar_url], [u].[bio], [u].[birthday], [u].[created_at], [u].[email], [u].[gender], [u].[interests], [u].[location], [u].[password], [u].[passwordSalt], [u].[username]
FROM [Users] AS [u]
WHERE [u].[email] = @__email_0
2025-05-04 15:29:30.276 +07:00 [INF] Executing OkObjectResult, writing value of type 'server.DTO.AuthDTO.LoginRespose'.
2025-05-04 15:29:30.276 +07:00 [INF] Executed action Message_app.Controllers.AuthController.Login (Message_app) in 15.5417ms
2025-05-04 15:29:30.276 +07:00 [INF] Executed endpoint 'Message_app.Controllers.AuthController.Login (Message_app)'
2025-05-04 15:29:30.276 +07:00 [INF] Request finished HTTP/1.1 POST http://localhost:5053/api/Auth/login - 200 null application/json; charset=utf-8 16.5525ms
2025-05-04 15:29:30.525 +07:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5053/api/Conversation/get_conversations/5 - null null
2025-05-04 15:29:30.526 +07:00 [INF] CORS policy execution successful.
2025-05-04 15:29:30.526 +07:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5053/api/Conversation/get_conversations/5 - 204 null null 0.3881ms
2025-05-04 15:29:30.528 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/api/Conversation/get_conversations/5 - null null
2025-05-04 15:29:30.528 +07:00 [INF] CORS policy execution successful.
2025-05-04 15:29:30.528 +07:00 [INF] CORS policy execution successful.
2025-05-04 15:29:30.529 +07:00 [INF] Executing endpoint 'server.Controllers.ConversationController.GetConversations (Message_app)'
2025-05-04 15:29:30.529 +07:00 [INF] Route matched with {action = "GetConversations", controller = "Conversation"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetConversations(Int32) on controller server.Controllers.ConversationController (Message_app).
2025-05-04 15:29:30.531 +07:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[server.DTO.ConversationDto, Message_app, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-05-04 15:29:30.531 +07:00 [INF] Executed action server.Controllers.ConversationController.GetConversations (Message_app) in 2.1851ms
2025-05-04 15:29:30.531 +07:00 [INF] Executed endpoint 'server.Controllers.ConversationController.GetConversations (Message_app)'
2025-05-04 15:29:30.531 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5053/api/Conversation/get_conversations/5 - 200 null application/json; charset=utf-8 2.8419ms
2025-05-04 15:29:30.534 +07:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5053/api/Conversation/get_conversations/5 - null null
2025-05-04 15:29:30.534 +07:00 [INF] CORS policy execution successful.
2025-05-04 15:29:30.534 +07:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5053/api/Conversation/get_conversations/5 - 204 null null 0.2812ms
2025-05-04 15:29:30.550 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/api/Conversation/get_conversations/5 - null null
2025-05-04 15:29:30.565 +07:00 [INF] CORS policy execution successful.
2025-05-04 15:29:30.565 +07:00 [INF] CORS policy execution successful.
2025-05-04 15:29:30.566 +07:00 [INF] Executing endpoint 'server.Controllers.ConversationController.GetConversations (Message_app)'
2025-05-04 15:29:30.566 +07:00 [INF] Route matched with {action = "GetConversations", controller = "Conversation"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetConversations(Int32) on controller server.Controllers.ConversationController (Message_app).
2025-05-04 15:29:30.567 +07:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[server.DTO.ConversationDto, Message_app, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-05-04 15:29:30.567 +07:00 [INF] Executed action server.Controllers.ConversationController.GetConversations (Message_app) in 1.6046ms
2025-05-04 15:29:30.568 +07:00 [INF] Executed endpoint 'server.Controllers.ConversationController.GetConversations (Message_app)'
2025-05-04 15:29:30.568 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5053/api/Conversation/get_conversations/5 - 200 null application/json; charset=utf-8 17.9667ms
2025-05-04 15:29:30.707 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/ws/chat?userId=5 - null null
2025-05-04 15:29:30.707 +07:00 [INF] CORS policy execution successful.
2025-05-04 15:29:30.708 +07:00 [INF] CORS policy execution successful.
2025-05-04 15:29:30.708 +07:00 [INF] Executing endpoint '/ws/chat'
2025-05-04 15:29:30.816 +07:00 [INF] Executed DbCommand (11ms) [Parameters=[@__client_UserId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[conversation_id]
FROM [Participants] AS [p]
WHERE [p].[user_id] = @__client_UserId_0 AND [p].[is_deleted] = CAST(0 AS bit)
2025-05-04 15:29:37.794 +07:00 [INF] Request starting HTTP/1.1 GET http://192.168.1.9:5053/api/Message/getMessages/1/2 - null null
2025-05-04 15:29:37.794 +07:00 [INF] Executing endpoint 'server.Controllers.MessageController.GetMessages (Message_app)'
2025-05-04 15:29:37.795 +07:00 [INF] Route matched with {action = "GetMessages", controller = "Message"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetMessages(Int32, Int32) on controller server.Controllers.MessageController (Message_app).
2025-05-04 15:29:37.808 +07:00 [INF] Retrieved 28 messages from Redis for conversation 1
2025-05-04 15:29:37.809 +07:00 [INF] Retrieved 28 messages from Redis for conversation 1 and user 2
2025-05-04 15:29:37.809 +07:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[server.DTO.MessageWithAttachment, Message_app, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-05-04 15:29:37.809 +07:00 [INF] Executed action server.Controllers.MessageController.GetMessages (Message_app) in 14.3826ms
2025-05-04 15:29:37.809 +07:00 [INF] Executed endpoint 'server.Controllers.MessageController.GetMessages (Message_app)'
2025-05-04 15:29:37.809 +07:00 [INF] Request finished HTTP/1.1 GET http://192.168.1.9:5053/api/Message/getMessages/1/2 - 200 null application/json; charset=utf-8 14.9633ms
2025-05-04 15:29:37.844 +07:00 [INF] Request starting HTTP/1.1 GET http://192.168.1.9:5053/api/Conversation/get_first_conversation/1 - null null
2025-05-04 15:29:37.845 +07:00 [INF] Executing endpoint 'server.Controllers.ConversationController.GetFirstConversation (Message_app)'
2025-05-04 15:29:37.845 +07:00 [INF] Route matched with {action = "GetFirstConversation", controller = "Conversation"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetFirstConversation(Int32) on controller server.Controllers.ConversationController (Message_app).
2025-05-04 15:29:37.856 +07:00 [INF] Executed DbCommand (10ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[id], [c].[created_at], [c].[is_group], [c].[lastMessage], [c].[lastMessageSender], [c].[lastMessageTime], [c].[name]
FROM [Conversations] AS [c]
WHERE [c].[id] = @__p_0
2025-05-04 15:29:37.856 +07:00 [INF] Executing OkObjectResult, writing value of type 'server.Models.Conversation'.
2025-05-04 15:29:37.857 +07:00 [INF] Executed action server.Controllers.ConversationController.GetFirstConversation (Message_app) in 12.0766ms
2025-05-04 15:29:37.857 +07:00 [INF] Executed endpoint 'server.Controllers.ConversationController.GetFirstConversation (Message_app)'
2025-05-04 15:29:37.857 +07:00 [INF] Request finished HTTP/1.1 GET http://192.168.1.9:5053/api/Conversation/get_first_conversation/1 - 200 null application/json; charset=utf-8 12.7937ms
2025-05-04 15:29:37.896 +07:00 [INF] Request starting HTTP/1.1 GET http://192.168.1.9:5053/api/Participant/get_participants/1 - null null
2025-05-04 15:29:37.896 +07:00 [INF] Executing endpoint 'server.Controllers.ParticipantController.GetParticipants (Message_app)'
2025-05-04 15:29:37.896 +07:00 [INF] Route matched with {action = "GetParticipants", controller = "Participant"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetParticipants(Int32) on controller server.Controllers.ParticipantController (Message_app).
2025-05-04 15:29:37.903 +07:00 [INF] Executed DbCommand (5ms) [Parameters=[@__conversation_id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[id], [p].[adder], [p].[conversation_id], [p].[is_deleted], [p].[joined_at], [p].[name], [p].[role], [p].[user_id]
FROM [Participants] AS [p]
WHERE [p].[conversation_id] = @__conversation_id_0
2025-05-04 15:29:37.903 +07:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType17`1[[System.Collections.Generic.List`1[[server.Models.Participants, Message_app, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-05-04 15:29:37.903 +07:00 [INF] Executed action server.Controllers.ParticipantController.GetParticipants (Message_app) in 7.2794ms
2025-05-04 15:29:37.904 +07:00 [INF] Executed endpoint 'server.Controllers.ParticipantController.GetParticipants (Message_app)'
2025-05-04 15:29:37.904 +07:00 [INF] Request finished HTTP/1.1 GET http://192.168.1.9:5053/api/Participant/get_participants/1 - 200 null application/json; charset=utf-8 7.9459ms
2025-05-04 15:29:40.142 +07:00 [INF] Request starting HTTP/1.1 GET http://192.168.1.9:5053/api/Participant/get_participants/1 - null null
2025-05-04 15:29:40.143 +07:00 [INF] Executing endpoint 'server.Controllers.ParticipantController.GetParticipants (Message_app)'
2025-05-04 15:29:40.143 +07:00 [INF] Route matched with {action = "GetParticipants", controller = "Participant"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetParticipants(Int32) on controller server.Controllers.ParticipantController (Message_app).
2025-05-04 15:29:40.154 +07:00 [INF] Executed DbCommand (10ms) [Parameters=[@__conversation_id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[id], [p].[adder], [p].[conversation_id], [p].[is_deleted], [p].[joined_at], [p].[name], [p].[role], [p].[user_id]
FROM [Participants] AS [p]
WHERE [p].[conversation_id] = @__conversation_id_0
2025-05-04 15:29:40.155 +07:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType17`1[[System.Collections.Generic.List`1[[server.Models.Participants, Message_app, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-05-04 15:29:40.155 +07:00 [INF] Executed action server.Controllers.ParticipantController.GetParticipants (Message_app) in 12.0819ms
2025-05-04 15:29:40.155 +07:00 [INF] Executed endpoint 'server.Controllers.ParticipantController.GetParticipants (Message_app)'
2025-05-04 15:29:40.155 +07:00 [INF] Request finished HTTP/1.1 GET http://192.168.1.9:5053/api/Participant/get_participants/1 - 200 null application/json; charset=utf-8 12.7382ms
2025-05-04 15:29:46.000 +07:00 [INF] Request starting HTTP/1.1 PUT http://192.168.1.9:5053/api/Conversation/update_conversation_name/1 - application/json 9
2025-05-04 15:29:46.001 +07:00 [INF] Executing endpoint 'server.Controllers.ConversationController.UpdateConversationName (Message_app)'
2025-05-04 15:29:46.001 +07:00 [INF] Route matched with {action = "UpdateConversationName", controller = "Conversation"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] UpdateConversationName(Int32, System.String) on controller server.Controllers.ConversationController (Message_app).
2025-05-04 15:29:46.019 +07:00 [INF] Executed DbCommand (17ms) [Parameters=[@__conversation_id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[id], [t].[created_at], [t].[is_group], [t].[lastMessage], [t].[lastMessageSender], [t].[lastMessageTime], [t].[name], [p].[id], [p].[adder], [p].[conversation_id], [p].[is_deleted], [p].[joined_at], [p].[name], [p].[role], [p].[user_id]
FROM (
    SELECT TOP(1) [c].[id], [c].[created_at], [c].[is_group], [c].[lastMessage], [c].[lastMessageSender], [c].[lastMessageTime], [c].[name]
    FROM [Conversations] AS [c]
    WHERE [c].[id] = @__conversation_id_0
) AS [t]
LEFT JOIN [Participants] AS [p] ON [t].[id] = [p].[conversation_id]
ORDER BY [t].[id]
2025-05-04 15:29:46.029 +07:00 [INF] Executed DbCommand (7ms) [Parameters=[@p6='?' (DbType = Int32), @p0='?' (DbType = DateTime2), @p1='?' (DbType = Boolean), @p2='?' (Size = 4000), @p3='?' (Size = 4000), @p4='?' (DbType = DateTime2), @p5='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
UPDATE [Conversations] SET [created_at] = @p0, [is_group] = @p1, [lastMessage] = @p2, [lastMessageSender] = @p3, [lastMessageTime] = @p4, [name] = @p5
OUTPUT 1
WHERE [id] = @p6;
2025-05-04 15:29:46.032 +07:00 [INF] Executing OkObjectResult, writing value of type 'server.Models.Conversation'.
2025-05-04 15:29:46.032 +07:00 [INF] Executed action server.Controllers.ConversationController.UpdateConversationName (Message_app) in 31.7622ms
2025-05-04 15:29:46.032 +07:00 [INF] Executed endpoint 'server.Controllers.ConversationController.UpdateConversationName (Message_app)'
2025-05-04 15:29:46.033 +07:00 [INF] Request finished HTTP/1.1 PUT http://192.168.1.9:5053/api/Conversation/update_conversation_name/1 - 200 null application/json; charset=utf-8 32.2166ms
2025-05-04 15:29:51.555 +07:00 [INF] Request starting HTTP/1.1 GET http://192.168.1.9:5053/api/Conversation/get_conversations/2 - null null
2025-05-04 15:29:51.555 +07:00 [INF] Executing endpoint 'server.Controllers.ConversationController.GetConversations (Message_app)'
2025-05-04 15:29:51.556 +07:00 [INF] Route matched with {action = "GetConversations", controller = "Conversation"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetConversations(Int32) on controller server.Controllers.ConversationController (Message_app).
2025-05-04 15:29:51.580 +07:00 [INF] Executed DbCommand (10ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[id], [c].[name], [c].[is_group], [c].[created_at], [c].[lastMessage], [c].[lastMessageTime], [t].[Id], [t].[UserId], [t].[ConversationId], [t].[Name], [t].[IsDeleted]
FROM [Conversations] AS [c]
LEFT JOIN (
    SELECT [p0].[id] AS [Id], [p0].[user_id] AS [UserId], [p0].[conversation_id] AS [ConversationId], [p0].[name] AS [Name], [p0].[is_deleted] AS [IsDeleted]
    FROM [Participants] AS [p0]
    WHERE [p0].[is_deleted] = CAST(0 AS bit)
) AS [t] ON [c].[id] = [t].[ConversationId]
WHERE EXISTS (
    SELECT 1
    FROM [Participants] AS [p]
    WHERE [c].[id] = [p].[conversation_id] AND [p].[user_id] = @__userId_0 AND [p].[is_deleted] = CAST(0 AS bit))
ORDER BY [c].[id]
2025-05-04 15:29:51.580 +07:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[server.DTO.ConversationDto, Message_app, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-05-04 15:29:51.581 +07:00 [INF] Executed action server.Controllers.ConversationController.GetConversations (Message_app) in 25.0291ms
2025-05-04 15:29:51.581 +07:00 [INF] Executed endpoint 'server.Controllers.ConversationController.GetConversations (Message_app)'
2025-05-04 15:29:51.581 +07:00 [INF] Request finished HTTP/1.1 GET http://192.168.1.9:5053/api/Conversation/get_conversations/2 - 200 null application/json; charset=utf-8 25.9853ms
2025-05-04 15:31:42.076 +07:00 [INF] Request starting HTTP/1.1 GET http://192.168.1.9:5053/ws/chat?userId=2 - null null
2025-05-04 15:31:42.076 +07:00 [INF] Request starting HTTP/1.1 GET http://192.168.1.9:5053/ws/chat?userId=2 - null null
2025-05-04 15:31:42.077 +07:00 [INF] Executing endpoint '/ws/chat'
2025-05-04 15:31:42.077 +07:00 [INF] Executing endpoint '/ws/chat'
2025-05-04 15:31:42.324 +07:00 [INF] Executed DbCommand (13ms) [Parameters=[@__client_UserId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[conversation_id]
FROM [Participants] AS [p]
WHERE [p].[user_id] = @__client_UserId_0 AND [p].[is_deleted] = CAST(0 AS bit)
2025-05-04 15:31:42.342 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__client_UserId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[conversation_id]
FROM [Participants] AS [p]
WHERE [p].[user_id] = @__client_UserId_0 AND [p].[is_deleted] = CAST(0 AS bit)
2025-05-04 15:31:57.516 +07:00 [INF] Executed endpoint '/ws/chat'
2025-05-04 15:31:57.519 +07:00 [ERR] An unhandled exception has occurred while executing the request.
System.Net.WebSockets.WebSocketException (0x80004005): The remote party closed the WebSocket connection without completing the close handshake.
 ---> Microsoft.AspNetCore.Connections.ConnectionResetException: An existing connection was forcibly closed by the remote host.
 ---> System.Net.Sockets.SocketException (10054): An existing connection was forcibly closed by the remote host.
   --- End of inner exception stack trace ---
   at System.IO.Pipelines.Pipe.GetReadAsyncResult()
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.Http.Http1UpgradeMessageBody.ReadAsyncInternalAwaited(ValueTask`1 readTask, CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.Http.HttpRequestStream.ReadAsyncInternal(Memory`1 destination, CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at System.IO.Stream.ReadAtLeastAsyncCore(Memory`1 buffer, Int32 minimumBytes, Boolean throwOnEndOfStream, CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at System.Net.WebSockets.ManagedWebSocket.EnsureBufferContainsAsync(Int32 minimumRequiredBytes, CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.WebSockets.ManagedWebSocket.ReceiveAsyncPrivate[TResult](Memory`1 payloadBuffer, CancellationToken cancellationToken)
   at System.Net.WebSockets.ManagedWebSocket.ReceiveAsyncPrivate[TResult](Memory`1 payloadBuffer, CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at System.Threading.Tasks.ValueTask`1.ValueTaskSourceAsTask.<>c.<.cctor>b__4_0(Object state)
--- End of stack trace from previous location ---
   at server.Services.WebSocketService.webSocket.Receiver(Client client) in C:\Users\Thao\source\Flutter\Message_app\server\Services\WebSocketService\websocket.cs:line 108
   at server.Services.WebSocketService.webSocket.HandleWebSocket(HttpContext context) in C:\Users\Thao\source\Flutter\Message_app\server\Services\WebSocketService\websocket.cs:line 91
   at Program.<>c.<<<Main>$>b__0_4>d.MoveNext() in C:\Users\Thao\source\Flutter\Message_app\server\Program.cs:line 89
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
2025-05-04 15:31:57.571 +07:00 [WRN] The response has already started, the error page middleware will not be executed.
2025-05-04 15:31:57.573 +07:00 [ERR] Connection id "0HNCASIADRL43", Request id "0HNCASIADRL43:00000001": An unhandled exception was thrown by the application.
System.Net.WebSockets.WebSocketException (0x80004005): The remote party closed the WebSocket connection without completing the close handshake.
 ---> Microsoft.AspNetCore.Connections.ConnectionResetException: An existing connection was forcibly closed by the remote host.
 ---> System.Net.Sockets.SocketException (10054): An existing connection was forcibly closed by the remote host.
   --- End of inner exception stack trace ---
   at System.IO.Pipelines.Pipe.GetReadAsyncResult()
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.Http.Http1UpgradeMessageBody.ReadAsyncInternalAwaited(ValueTask`1 readTask, CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.Http.HttpRequestStream.ReadAsyncInternal(Memory`1 destination, CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at System.IO.Stream.ReadAtLeastAsyncCore(Memory`1 buffer, Int32 minimumBytes, Boolean throwOnEndOfStream, CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at System.Net.WebSockets.ManagedWebSocket.EnsureBufferContainsAsync(Int32 minimumRequiredBytes, CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.WebSockets.ManagedWebSocket.ReceiveAsyncPrivate[TResult](Memory`1 payloadBuffer, CancellationToken cancellationToken)
   at System.Net.WebSockets.ManagedWebSocket.ReceiveAsyncPrivate[TResult](Memory`1 payloadBuffer, CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at System.Threading.Tasks.ValueTask`1.ValueTaskSourceAsTask.<>c.<.cctor>b__4_0(Object state)
--- End of stack trace from previous location ---
   at server.Services.WebSocketService.webSocket.Receiver(Client client) in C:\Users\Thao\source\Flutter\Message_app\server\Services\WebSocketService\websocket.cs:line 108
   at server.Services.WebSocketService.webSocket.HandleWebSocket(HttpContext context) in C:\Users\Thao\source\Flutter\Message_app\server\Services\WebSocketService\websocket.cs:line 91
   at Program.<>c.<<<Main>$>b__0_4>d.MoveNext() in C:\Users\Thao\source\Flutter\Message_app\server\Program.cs:line 89
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Watch.BrowserRefresh.BrowserRefreshMiddleware.InvokeAsync(HttpContext context)
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.Http.HttpProtocol.ProcessRequests[TContext](IHttpApplication`1 application)
2025-05-04 15:31:57.578 +07:00 [INF] Request finished HTTP/1.1 GET http://192.168.1.9:5053/ws/chat?userId=2 - 101 null null 259314.4528ms
2025-05-04 15:32:13.240 +07:00 [INF] Executed endpoint '/ws/chat'
2025-05-04 15:32:13.241 +07:00 [ERR] An unhandled exception has occurred while executing the request.
System.Net.WebSockets.WebSocketException (0x80004005): The remote party closed the WebSocket connection without completing the close handshake.
 ---> Microsoft.AspNetCore.Connections.ConnectionResetException: An existing connection was forcibly closed by the remote host.
 ---> System.Net.Sockets.SocketException (10054): An existing connection was forcibly closed by the remote host.
   --- End of inner exception stack trace ---
   at System.IO.Pipelines.Pipe.GetReadAsyncResult()
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.Http.Http1UpgradeMessageBody.ReadAsyncInternalAwaited(ValueTask`1 readTask, CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.Http.HttpRequestStream.ReadAsyncInternal(Memory`1 destination, CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at System.IO.Stream.ReadAtLeastAsyncCore(Memory`1 buffer, Int32 minimumBytes, Boolean throwOnEndOfStream, CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at System.Net.WebSockets.ManagedWebSocket.EnsureBufferContainsAsync(Int32 minimumRequiredBytes, CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.WebSockets.ManagedWebSocket.ReceiveAsyncPrivate[TResult](Memory`1 payloadBuffer, CancellationToken cancellationToken)
   at System.Net.WebSockets.ManagedWebSocket.ReceiveAsyncPrivate[TResult](Memory`1 payloadBuffer, CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at System.Threading.Tasks.ValueTask`1.ValueTaskSourceAsTask.<>c.<.cctor>b__4_0(Object state)
--- End of stack trace from previous location ---
   at server.Services.WebSocketService.webSocket.Receiver(Client client) in C:\Users\Thao\source\Flutter\Message_app\server\Services\WebSocketService\websocket.cs:line 108
   at server.Services.WebSocketService.webSocket.HandleWebSocket(HttpContext context) in C:\Users\Thao\source\Flutter\Message_app\server\Services\WebSocketService\websocket.cs:line 91
   at Program.<>c.<<<Main>$>b__0_4>d.MoveNext() in C:\Users\Thao\source\Flutter\Message_app\server\Program.cs:line 89
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
2025-05-04 15:32:13.243 +07:00 [WRN] The response has already started, the error page middleware will not be executed.
2025-05-04 15:32:13.243 +07:00 [ERR] Connection id "0HNCASIADRL3O", Request id "0HNCASIADRL3O:00000001": An unhandled exception was thrown by the application.
System.Net.WebSockets.WebSocketException (0x80004005): The remote party closed the WebSocket connection without completing the close handshake.
 ---> Microsoft.AspNetCore.Connections.ConnectionResetException: An existing connection was forcibly closed by the remote host.
 ---> System.Net.Sockets.SocketException (10054): An existing connection was forcibly closed by the remote host.
   --- End of inner exception stack trace ---
   at System.IO.Pipelines.Pipe.GetReadAsyncResult()
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.Http.Http1UpgradeMessageBody.ReadAsyncInternalAwaited(ValueTask`1 readTask, CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.Http.HttpRequestStream.ReadAsyncInternal(Memory`1 destination, CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at System.IO.Stream.ReadAtLeastAsyncCore(Memory`1 buffer, Int32 minimumBytes, Boolean throwOnEndOfStream, CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at System.Net.WebSockets.ManagedWebSocket.EnsureBufferContainsAsync(Int32 minimumRequiredBytes, CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.WebSockets.ManagedWebSocket.ReceiveAsyncPrivate[TResult](Memory`1 payloadBuffer, CancellationToken cancellationToken)
   at System.Net.WebSockets.ManagedWebSocket.ReceiveAsyncPrivate[TResult](Memory`1 payloadBuffer, CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at System.Threading.Tasks.ValueTask`1.ValueTaskSourceAsTask.<>c.<.cctor>b__4_0(Object state)
--- End of stack trace from previous location ---
   at server.Services.WebSocketService.webSocket.Receiver(Client client) in C:\Users\Thao\source\Flutter\Message_app\server\Services\WebSocketService\websocket.cs:line 108
   at server.Services.WebSocketService.webSocket.HandleWebSocket(HttpContext context) in C:\Users\Thao\source\Flutter\Message_app\server\Services\WebSocketService\websocket.cs:line 91
   at Program.<>c.<<<Main>$>b__0_4>d.MoveNext() in C:\Users\Thao\source\Flutter\Message_app\server\Program.cs:line 89
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Watch.BrowserRefresh.BrowserRefreshMiddleware.InvokeAsync(HttpContext context)
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.Http.HttpProtocol.ProcessRequests[TContext](IHttpApplication`1 application)
2025-05-04 15:32:13.246 +07:00 [INF] Request finished HTTP/1.1 GET http://192.168.1.9:5053/ws/chat?userId=2 - 101 null null 679433.5385ms
2025-05-04 16:07:42.124 +07:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5053/api/Auth/login - null null
2025-05-04 16:07:42.126 +07:00 [INF] CORS policy execution successful.
2025-05-04 16:07:42.127 +07:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5053/api/Auth/login - 204 null null 2.199ms
2025-05-04 16:07:42.127 +07:00 [INF] Request starting HTTP/1.1 POST http://localhost:5053/api/Auth/login - application/json 53
2025-05-04 16:07:42.128 +07:00 [INF] CORS policy execution successful.
2025-05-04 16:07:42.128 +07:00 [INF] CORS policy execution successful.
2025-05-04 16:07:42.129 +07:00 [INF] Executing endpoint 'Message_app.Controllers.AuthController.Login (Message_app)'
2025-05-04 16:07:42.130 +07:00 [INF] Route matched with {action = "Login", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Login(server.DTO.AuthDTO.LoginDTO) on controller Message_app.Controllers.AuthController (Message_app).
2025-05-04 16:07:42.233 +07:00 [INF] Executed DbCommand (16ms) [Parameters=[@__email_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[id], [u].[avatar_url], [u].[bio], [u].[birthday], [u].[created_at], [u].[email], [u].[gender], [u].[interests], [u].[location], [u].[password], [u].[passwordSalt], [u].[username]
FROM [Users] AS [u]
WHERE [u].[email] = @__email_0
2025-05-04 16:07:42.235 +07:00 [INF] Executing OkObjectResult, writing value of type 'server.DTO.AuthDTO.LoginRespose'.
2025-05-04 16:07:42.235 +07:00 [INF] Executed action Message_app.Controllers.AuthController.Login (Message_app) in 105.3ms
2025-05-04 16:07:42.236 +07:00 [INF] Executed endpoint 'Message_app.Controllers.AuthController.Login (Message_app)'
2025-05-04 16:07:42.236 +07:00 [INF] Request finished HTTP/1.1 POST http://localhost:5053/api/Auth/login - 200 null application/json; charset=utf-8 108.1426ms
2025-05-04 16:07:42.420 +07:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5053/api/Conversation/get_conversations/5 - null null
2025-05-04 16:07:42.420 +07:00 [INF] CORS policy execution successful.
2025-05-04 16:07:42.421 +07:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5053/api/Conversation/get_conversations/5 - 204 null null 0.2117ms
2025-05-04 16:07:42.422 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/api/Conversation/get_conversations/5 - null null
2025-05-04 16:07:42.422 +07:00 [INF] CORS policy execution successful.
2025-05-04 16:07:42.422 +07:00 [INF] CORS policy execution successful.
2025-05-04 16:07:42.422 +07:00 [INF] Executing endpoint 'server.Controllers.ConversationController.GetConversations (Message_app)'
2025-05-04 16:07:42.422 +07:00 [INF] Route matched with {action = "GetConversations", controller = "Conversation"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetConversations(Int32) on controller server.Controllers.ConversationController (Message_app).
2025-05-04 16:07:42.445 +07:00 [INF] Executed DbCommand (19ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[id], [c].[name], [c].[is_group], [c].[created_at], [c].[lastMessage], [c].[lastMessageTime], [t].[Id], [t].[UserId], [t].[ConversationId], [t].[Name], [t].[IsDeleted]
FROM [Conversations] AS [c]
LEFT JOIN (
    SELECT [p0].[id] AS [Id], [p0].[user_id] AS [UserId], [p0].[conversation_id] AS [ConversationId], [p0].[name] AS [Name], [p0].[is_deleted] AS [IsDeleted]
    FROM [Participants] AS [p0]
    WHERE [p0].[is_deleted] = CAST(0 AS bit)
) AS [t] ON [c].[id] = [t].[ConversationId]
WHERE EXISTS (
    SELECT 1
    FROM [Participants] AS [p]
    WHERE [c].[id] = [p].[conversation_id] AND [p].[user_id] = @__userId_0 AND [p].[is_deleted] = CAST(0 AS bit))
ORDER BY [c].[id]
2025-05-04 16:07:42.459 +07:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[server.DTO.ConversationDto, Message_app, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-05-04 16:07:42.459 +07:00 [INF] Executed action server.Controllers.ConversationController.GetConversations (Message_app) in 36.6059ms
2025-05-04 16:07:42.459 +07:00 [INF] Executed endpoint 'server.Controllers.ConversationController.GetConversations (Message_app)'
2025-05-04 16:07:42.459 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5053/api/Conversation/get_conversations/5 - 200 null application/json; charset=utf-8 37.4791ms
2025-05-04 16:07:42.460 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/api/Conversation/get_conversations/5 - null null
2025-05-04 16:07:42.461 +07:00 [INF] CORS policy execution successful.
2025-05-04 16:07:42.461 +07:00 [INF] CORS policy execution successful.
2025-05-04 16:07:42.461 +07:00 [INF] Executing endpoint 'server.Controllers.ConversationController.GetConversations (Message_app)'
2025-05-04 16:07:42.461 +07:00 [INF] Route matched with {action = "GetConversations", controller = "Conversation"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetConversations(Int32) on controller server.Controllers.ConversationController (Message_app).
2025-05-04 16:07:42.462 +07:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[server.DTO.ConversationDto, Message_app, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-05-04 16:07:42.462 +07:00 [INF] Executed action server.Controllers.ConversationController.GetConversations (Message_app) in 1.2274ms
2025-05-04 16:07:42.462 +07:00 [INF] Executed endpoint 'server.Controllers.ConversationController.GetConversations (Message_app)'
2025-05-04 16:07:42.462 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5053/api/Conversation/get_conversations/5 - 200 null application/json; charset=utf-8 1.753ms
2025-05-04 16:07:42.531 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/ws/chat?userId=5 - null null
2025-05-04 16:07:42.531 +07:00 [INF] CORS policy execution successful.
2025-05-04 16:07:42.531 +07:00 [INF] CORS policy execution successful.
2025-05-04 16:07:42.532 +07:00 [INF] Executing endpoint '/ws/chat'
2025-05-04 16:07:42.613 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[@__client_UserId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[conversation_id]
FROM [Participants] AS [p]
WHERE [p].[user_id] = @__client_UserId_0 AND [p].[is_deleted] = CAST(0 AS bit)
2025-05-04 16:07:45.351 +07:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5053/api/Message/getMessages/1/5 - null null
2025-05-04 16:07:45.352 +07:00 [INF] CORS policy execution successful.
2025-05-04 16:07:45.352 +07:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5053/api/Message/getMessages/1/5 - 204 null null 0.5662ms
2025-05-04 16:07:45.354 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/api/Message/getMessages/1/5 - null null
2025-05-04 16:07:45.354 +07:00 [INF] CORS policy execution successful.
2025-05-04 16:07:45.354 +07:00 [INF] CORS policy execution successful.
2025-05-04 16:07:45.354 +07:00 [INF] Executing endpoint 'server.Controllers.MessageController.GetMessages (Message_app)'
2025-05-04 16:07:45.354 +07:00 [INF] Route matched with {action = "GetMessages", controller = "Message"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetMessages(Int32, Int32) on controller server.Controllers.MessageController (Message_app).
2025-05-04 16:07:45.359 +07:00 [INF] Retrieved 28 messages from Redis for conversation 1
2025-05-04 16:07:45.359 +07:00 [INF] Retrieved 28 messages from Redis for conversation 1 and user 5
2025-05-04 16:07:45.359 +07:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[server.DTO.MessageWithAttachment, Message_app, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-05-04 16:07:45.359 +07:00 [INF] Executed action server.Controllers.MessageController.GetMessages (Message_app) in 5.3336ms
2025-05-04 16:07:45.360 +07:00 [INF] Executed endpoint 'server.Controllers.MessageController.GetMessages (Message_app)'
2025-05-04 16:07:45.360 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5053/api/Message/getMessages/1/5 - 200 null application/json; charset=utf-8 5.9297ms
2025-05-04 16:07:45.371 +07:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5053/api/Conversation/get_first_conversation/1 - null null
2025-05-04 16:07:45.371 +07:00 [INF] CORS policy execution successful.
2025-05-04 16:07:45.371 +07:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5053/api/Conversation/get_first_conversation/1 - 204 null null 0.4399ms
2025-05-04 16:07:45.373 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/api/Conversation/get_first_conversation/1 - null null
2025-05-04 16:07:45.373 +07:00 [INF] CORS policy execution successful.
2025-05-04 16:07:45.373 +07:00 [INF] CORS policy execution successful.
2025-05-04 16:07:45.373 +07:00 [INF] Executing endpoint 'server.Controllers.ConversationController.GetFirstConversation (Message_app)'
2025-05-04 16:07:45.373 +07:00 [INF] Route matched with {action = "GetFirstConversation", controller = "Conversation"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetFirstConversation(Int32) on controller server.Controllers.ConversationController (Message_app).
2025-05-04 16:07:45.377 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[id], [c].[created_at], [c].[is_group], [c].[lastMessage], [c].[lastMessageSender], [c].[lastMessageTime], [c].[name]
FROM [Conversations] AS [c]
WHERE [c].[id] = @__p_0
2025-05-04 16:07:45.378 +07:00 [INF] Executing OkObjectResult, writing value of type 'server.Models.Conversation'.
2025-05-04 16:07:45.378 +07:00 [INF] Executed action server.Controllers.ConversationController.GetFirstConversation (Message_app) in 5.0596ms
2025-05-04 16:07:45.378 +07:00 [INF] Executed endpoint 'server.Controllers.ConversationController.GetFirstConversation (Message_app)'
2025-05-04 16:07:45.378 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5053/api/Conversation/get_first_conversation/1 - 200 null application/json; charset=utf-8 5.8231ms
2025-05-04 16:07:45.384 +07:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5053/api/Participant/get_participants/1 - null null
2025-05-04 16:07:45.384 +07:00 [INF] CORS policy execution successful.
2025-05-04 16:07:45.385 +07:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5053/api/Participant/get_participants/1 - 204 null null 0.4867ms
2025-05-04 16:07:45.386 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/api/Participant/get_participants/1 - null null
2025-05-04 16:07:45.386 +07:00 [INF] CORS policy execution successful.
2025-05-04 16:07:45.386 +07:00 [INF] CORS policy execution successful.
2025-05-04 16:07:45.387 +07:00 [INF] Executing endpoint 'server.Controllers.ParticipantController.GetParticipants (Message_app)'
2025-05-04 16:07:45.387 +07:00 [INF] Route matched with {action = "GetParticipants", controller = "Participant"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetParticipants(Int32) on controller server.Controllers.ParticipantController (Message_app).
2025-05-04 16:07:45.390 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[@__conversation_id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[id], [p].[adder], [p].[conversation_id], [p].[is_deleted], [p].[joined_at], [p].[name], [p].[role], [p].[user_id]
FROM [Participants] AS [p]
WHERE [p].[conversation_id] = @__conversation_id_0
2025-05-04 16:07:45.391 +07:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType17`1[[System.Collections.Generic.List`1[[server.Models.Participants, Message_app, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-05-04 16:07:45.391 +07:00 [INF] Executed action server.Controllers.ParticipantController.GetParticipants (Message_app) in 4.299ms
2025-05-04 16:07:45.391 +07:00 [INF] Executed endpoint 'server.Controllers.ParticipantController.GetParticipants (Message_app)'
2025-05-04 16:07:45.391 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5053/api/Participant/get_participants/1 - 200 null application/json; charset=utf-8 5.0541ms
2025-05-04 16:07:46.709 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/api/Participant/get_participants/1 - null null
2025-05-04 16:07:46.709 +07:00 [INF] CORS policy execution successful.
2025-05-04 16:07:46.709 +07:00 [INF] CORS policy execution successful.
2025-05-04 16:07:46.709 +07:00 [INF] Executing endpoint 'server.Controllers.ParticipantController.GetParticipants (Message_app)'
2025-05-04 16:07:46.710 +07:00 [INF] Route matched with {action = "GetParticipants", controller = "Participant"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetParticipants(Int32) on controller server.Controllers.ParticipantController (Message_app).
2025-05-04 16:07:46.711 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__conversation_id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[id], [p].[adder], [p].[conversation_id], [p].[is_deleted], [p].[joined_at], [p].[name], [p].[role], [p].[user_id]
FROM [Participants] AS [p]
WHERE [p].[conversation_id] = @__conversation_id_0
2025-05-04 16:07:46.711 +07:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType17`1[[System.Collections.Generic.List`1[[server.Models.Participants, Message_app, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-05-04 16:07:46.712 +07:00 [INF] Executed action server.Controllers.ParticipantController.GetParticipants (Message_app) in 2.0626ms
2025-05-04 16:07:46.712 +07:00 [INF] Executed endpoint 'server.Controllers.ParticipantController.GetParticipants (Message_app)'
2025-05-04 16:07:46.712 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5053/api/Participant/get_participants/1 - 200 null application/json; charset=utf-8 2.7218ms
2025-05-04 16:07:51.442 +07:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5053/api/Conversation/update_conversation_name/1 - null null
2025-05-04 16:07:51.442 +07:00 [INF] CORS policy execution successful.
2025-05-04 16:07:51.442 +07:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5053/api/Conversation/update_conversation_name/1 - 204 null null 0.3122ms
2025-05-04 16:07:51.443 +07:00 [INF] Request starting HTTP/1.1 PUT http://localhost:5053/api/Conversation/update_conversation_name/1 - application/json 10
2025-05-04 16:07:51.443 +07:00 [INF] CORS policy execution successful.
2025-05-04 16:07:51.445 +07:00 [INF] CORS policy execution successful.
2025-05-04 16:07:51.445 +07:00 [INF] Executing endpoint 'server.Controllers.ConversationController.UpdateConversationName (Message_app)'
2025-05-04 16:07:51.445 +07:00 [INF] Route matched with {action = "UpdateConversationName", controller = "Conversation"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] UpdateConversationName(Int32, System.String) on controller server.Controllers.ConversationController (Message_app).
2025-05-04 16:07:51.453 +07:00 [INF] Executed DbCommand (6ms) [Parameters=[@__conversation_id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[id], [t].[created_at], [t].[is_group], [t].[lastMessage], [t].[lastMessageSender], [t].[lastMessageTime], [t].[name], [p].[id], [p].[adder], [p].[conversation_id], [p].[is_deleted], [p].[joined_at], [p].[name], [p].[role], [p].[user_id]
FROM (
    SELECT TOP(1) [c].[id], [c].[created_at], [c].[is_group], [c].[lastMessage], [c].[lastMessageSender], [c].[lastMessageTime], [c].[name]
    FROM [Conversations] AS [c]
    WHERE [c].[id] = @__conversation_id_0
) AS [t]
LEFT JOIN [Participants] AS [p] ON [t].[id] = [p].[conversation_id]
ORDER BY [t].[id]
2025-05-04 16:07:51.462 +07:00 [INF] Executed DbCommand (6ms) [Parameters=[@p6='?' (DbType = Int32), @p0='?' (DbType = DateTime2), @p1='?' (DbType = Boolean), @p2='?' (Size = 4000), @p3='?' (Size = 4000), @p4='?' (DbType = DateTime2), @p5='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
UPDATE [Conversations] SET [created_at] = @p0, [is_group] = @p1, [lastMessage] = @p2, [lastMessageSender] = @p3, [lastMessageTime] = @p4, [name] = @p5
OUTPUT 1
WHERE [id] = @p6;
2025-05-04 16:07:51.465 +07:00 [INF] Executing OkObjectResult, writing value of type 'server.Models.Conversation'.
2025-05-04 16:07:51.465 +07:00 [INF] Executed action server.Controllers.ConversationController.UpdateConversationName (Message_app) in 20.282ms
2025-05-04 16:07:51.465 +07:00 [INF] Executed endpoint 'server.Controllers.ConversationController.UpdateConversationName (Message_app)'
2025-05-04 16:07:51.466 +07:00 [INF] Request finished HTTP/1.1 PUT http://localhost:5053/api/Conversation/update_conversation_name/1 - 200 null application/json; charset=utf-8 22.4509ms
2025-05-04 16:08:34.165 +07:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5053/api/Participant/get_participants/1 - null null
2025-05-04 16:08:34.166 +07:00 [INF] CORS policy execution successful.
2025-05-04 16:08:34.166 +07:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5053/api/Participant/get_participants/1 - 204 null null 1.1232ms
2025-05-04 16:08:34.168 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/api/Participant/get_participants/1 - null null
2025-05-04 16:08:34.169 +07:00 [INF] CORS policy execution successful.
2025-05-04 16:08:34.169 +07:00 [INF] CORS policy execution successful.
2025-05-04 16:08:34.169 +07:00 [INF] Executing endpoint 'server.Controllers.ParticipantController.GetParticipants (Message_app)'
2025-05-04 16:08:34.169 +07:00 [INF] Route matched with {action = "GetParticipants", controller = "Participant"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetParticipants(Int32) on controller server.Controllers.ParticipantController (Message_app).
2025-05-04 16:08:34.181 +07:00 [INF] Executed DbCommand (10ms) [Parameters=[@__conversation_id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[id], [p].[adder], [p].[conversation_id], [p].[is_deleted], [p].[joined_at], [p].[name], [p].[role], [p].[user_id]
FROM [Participants] AS [p]
WHERE [p].[conversation_id] = @__conversation_id_0
2025-05-04 16:08:34.182 +07:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType17`1[[System.Collections.Generic.List`1[[server.Models.Participants, Message_app, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-05-04 16:08:34.182 +07:00 [INF] Executed action server.Controllers.ParticipantController.GetParticipants (Message_app) in 12.768ms
2025-05-04 16:08:34.182 +07:00 [INF] Executed endpoint 'server.Controllers.ParticipantController.GetParticipants (Message_app)'
2025-05-04 16:08:34.183 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5053/api/Participant/get_participants/1 - 200 null application/json; charset=utf-8 14.6911ms
2025-05-04 16:11:25.486 +07:00 [INF] Application is shutting down...
2025-05-04 16:11:55.507 +07:00 [INF] Executed endpoint '/ws/chat'
2025-05-04 16:11:55.508 +07:00 [INF] Executed endpoint '/ws/chat'
2025-05-04 16:11:55.508 +07:00 [INF] Executed endpoint '/ws/chat'
2025-05-04 16:11:55.508 +07:00 [INF] Executed endpoint '/ws/chat'
2025-05-04 16:11:55.508 +07:00 [INF] Request finished HTTP/1.1 GET http://192.168.1.9:5053/ws/chat?userId=2 - 101 null null 2412383.7822ms
2025-05-04 16:11:55.508 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5053/ws/chat?userId=5 - 101 null null 2543752.3163ms
2025-05-04 16:11:55.508 +07:00 [INF] Request finished HTTP/1.1 GET http://192.168.1.9:5053/ws/chat?userId=2 - 101 null null 2412383.7558ms
2025-05-04 16:11:55.508 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5053/ws/chat?userId=5 - 101 null null 252977.3744ms
2025-05-04 16:12:11.068 +07:00 [INF] Executed DbCommand (11ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-05-04 16:12:11.112 +07:00 [INF] Executed DbCommand (12ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-05-04 16:12:11.115 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-05-04 16:12:11.118 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-05-04 16:12:11.138 +07:00 [INF] Executed DbCommand (10ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-05-04 16:12:11.151 +07:00 [INF] Applying migration '20250504091157_updateConvesation'.
2025-05-04 16:12:11.231 +07:00 [INF] Executed DbCommand (26ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [Conversations] ADD [img_url] nvarchar(max) NULL;
2025-05-04 16:12:11.246 +07:00 [INF] Executed DbCommand (12ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT INTO [__EFMigrationsHistory] ([MigrationId], [ProductVersion])
VALUES (N'20250504091157_updateConvesation', N'8.0.4');
2025-05-04 16:29:28.555 +07:00 [INF] Executed DbCommand (31ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [u].[id], [u].[username], [u].[avatar_url]
FROM [Users] AS [u]
2025-05-04 16:29:28.691 +07:00 [INF] User profile is available. Using 'C:\Users\Thao\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-05-04 16:29:28.766 +07:00 [WRN] Overriding address(es) 'http://localhost:5053'. Binding to endpoints defined via IConfiguration and/or UseKestrel() instead.
2025-05-04 16:29:28.774 +07:00 [INF] Now listening on: http://[::]:5053
2025-05-04 16:29:28.775 +07:00 [INF] Now listening on: http://0.0.0.0:5053
2025-05-04 16:29:28.775 +07:00 [INF] Application started. Press Ctrl+C to shut down.
2025-05-04 16:29:28.775 +07:00 [INF] Hosting environment: Development
2025-05-04 16:29:28.775 +07:00 [INF] Content root path: C:\Users\Thao\source\Flutter\Message_app\server
2025-05-04 16:29:34.337 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/ws/chat?userId=5 - null null
2025-05-04 16:29:34.406 +07:00 [INF] CORS policy execution successful.
2025-05-04 16:29:34.454 +07:00 [INF] CORS policy execution successful.
2025-05-04 16:29:34.457 +07:00 [WRN] Failed to determine the https port for redirect.
2025-05-04 16:29:34.513 +07:00 [INF] Executing endpoint '/ws/chat'
2025-05-04 16:29:34.808 +07:00 [INF] Executed DbCommand (36ms) [Parameters=[@__client_UserId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[conversation_id]
FROM [Participants] AS [p]
WHERE [p].[user_id] = @__client_UserId_0 AND [p].[is_deleted] = CAST(0 AS bit)
2025-05-04 16:29:35.369 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/ws/chat?userId=5 - null null
2025-05-04 16:29:35.371 +07:00 [INF] CORS policy execution successful.
2025-05-04 16:29:35.372 +07:00 [INF] CORS policy execution successful.
2025-05-04 16:29:35.374 +07:00 [INF] Executing endpoint '/ws/chat'
2025-05-04 16:29:35.513 +07:00 [INF] Executed DbCommand (6ms) [Parameters=[@__client_UserId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[conversation_id]
FROM [Participants] AS [p]
WHERE [p].[user_id] = @__client_UserId_0 AND [p].[is_deleted] = CAST(0 AS bit)
2025-05-04 16:33:57.119 +07:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5053/api/Auth/login - null null
2025-05-04 16:33:57.121 +07:00 [INF] CORS policy execution successful.
2025-05-04 16:33:57.129 +07:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5053/api/Auth/login - 204 null null 8.8102ms
2025-05-04 16:33:57.136 +07:00 [INF] Request starting HTTP/1.1 POST http://localhost:5053/api/Auth/login - application/json 53
2025-05-04 16:33:57.136 +07:00 [INF] CORS policy execution successful.
2025-05-04 16:33:57.137 +07:00 [INF] CORS policy execution successful.
2025-05-04 16:33:57.150 +07:00 [INF] Executing endpoint 'Message_app.Controllers.AuthController.Login (Message_app)'
2025-05-04 16:33:57.209 +07:00 [INF] Route matched with {action = "Login", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Login(server.DTO.AuthDTO.LoginDTO) on controller Message_app.Controllers.AuthController (Message_app).
2025-05-04 16:33:57.355 +07:00 [INF] Executed DbCommand (17ms) [Parameters=[@__email_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[id], [u].[avatar_url], [u].[bio], [u].[birthday], [u].[created_at], [u].[email], [u].[gender], [u].[interests], [u].[location], [u].[password], [u].[passwordSalt], [u].[username]
FROM [Users] AS [u]
WHERE [u].[email] = @__email_0
2025-05-04 16:33:57.587 +07:00 [INF] Executing OkObjectResult, writing value of type 'server.DTO.AuthDTO.LoginRespose'.
2025-05-04 16:33:57.712 +07:00 [INF] Executed action Message_app.Controllers.AuthController.Login (Message_app) in 496.395ms
2025-05-04 16:33:57.713 +07:00 [INF] Executed endpoint 'Message_app.Controllers.AuthController.Login (Message_app)'
2025-05-04 16:33:57.722 +07:00 [INF] Request finished HTTP/1.1 POST http://localhost:5053/api/Auth/login - 200 null application/json; charset=utf-8 586.3271ms
2025-05-04 16:33:57.849 +07:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5053/api/Conversation/get_conversations/5 - null null
2025-05-04 16:33:57.850 +07:00 [INF] CORS policy execution successful.
2025-05-04 16:33:57.850 +07:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5053/api/Conversation/get_conversations/5 - null null
2025-05-04 16:33:57.850 +07:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5053/api/Conversation/get_conversations/5 - 204 null null 0.5702ms
2025-05-04 16:33:57.850 +07:00 [INF] CORS policy execution successful.
2025-05-04 16:33:57.850 +07:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5053/api/Conversation/get_conversations/5 - 204 null null 0.3556ms
2025-05-04 16:33:57.852 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/api/Conversation/get_conversations/5 - null null
2025-05-04 16:33:57.854 +07:00 [INF] CORS policy execution successful.
2025-05-04 16:33:57.860 +07:00 [INF] CORS policy execution successful.
2025-05-04 16:33:57.861 +07:00 [INF] Executing endpoint 'server.Controllers.ConversationController.GetConversations (Message_app)'
2025-05-04 16:33:57.881 +07:00 [INF] Route matched with {action = "GetConversations", controller = "Conversation"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetConversations(Int32) on controller server.Controllers.ConversationController (Message_app).
2025-05-04 16:33:58.101 +07:00 [INF] Executed DbCommand (21ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[id], [c].[name], [c].[is_group], [c].[created_at], [c].[lastMessage], [c].[lastMessageTime], [c].[img_url], [t].[Id], [t].[UserId], [t].[ConversationId], [t].[Name], [t].[IsDeleted]
FROM [Conversations] AS [c]
LEFT JOIN (
    SELECT [p0].[id] AS [Id], [p0].[user_id] AS [UserId], [p0].[conversation_id] AS [ConversationId], [p0].[name] AS [Name], [p0].[is_deleted] AS [IsDeleted]
    FROM [Participants] AS [p0]
    WHERE [p0].[is_deleted] = CAST(0 AS bit)
) AS [t] ON [c].[id] = [t].[ConversationId]
WHERE EXISTS (
    SELECT 1
    FROM [Participants] AS [p]
    WHERE [c].[id] = [p].[conversation_id] AND [p].[user_id] = @__userId_0 AND [p].[is_deleted] = CAST(0 AS bit))
ORDER BY [c].[id]
2025-05-04 16:33:58.150 +07:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[server.DTO.ConversationDto, Message_app, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-05-04 16:33:58.153 +07:00 [INF] Executed action server.Controllers.ConversationController.GetConversations (Message_app) in 271.7897ms
2025-05-04 16:33:58.153 +07:00 [INF] Executed endpoint 'server.Controllers.ConversationController.GetConversations (Message_app)'
2025-05-04 16:33:58.154 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5053/api/Conversation/get_conversations/5 - 200 null application/json; charset=utf-8 302.3133ms
2025-05-04 16:33:58.156 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/api/Conversation/get_conversations/5 - null null
2025-05-04 16:33:58.156 +07:00 [INF] CORS policy execution successful.
2025-05-04 16:33:58.159 +07:00 [INF] CORS policy execution successful.
2025-05-04 16:33:58.160 +07:00 [INF] Executing endpoint 'server.Controllers.ConversationController.GetConversations (Message_app)'
2025-05-04 16:33:58.165 +07:00 [INF] Route matched with {action = "GetConversations", controller = "Conversation"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetConversations(Int32) on controller server.Controllers.ConversationController (Message_app).
2025-05-04 16:33:58.197 +07:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[server.DTO.ConversationDto, Message_app, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-05-04 16:33:58.198 +07:00 [INF] Executed action server.Controllers.ConversationController.GetConversations (Message_app) in 32.8828ms
2025-05-04 16:33:58.198 +07:00 [INF] Executed endpoint 'server.Controllers.ConversationController.GetConversations (Message_app)'
2025-05-04 16:33:58.199 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5053/api/Conversation/get_conversations/5 - 200 null application/json; charset=utf-8 43.3799ms
2025-05-04 16:33:58.231 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/ws/chat?userId=5 - null null
2025-05-04 16:33:58.231 +07:00 [INF] CORS policy execution successful.
2025-05-04 16:33:58.231 +07:00 [INF] CORS policy execution successful.
2025-05-04 16:33:58.232 +07:00 [INF] Executing endpoint '/ws/chat'
2025-05-04 16:33:58.248 +07:00 [INF] Executed DbCommand (4ms) [Parameters=[@__client_UserId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[conversation_id]
FROM [Participants] AS [p]
WHERE [p].[user_id] = @__client_UserId_0 AND [p].[is_deleted] = CAST(0 AS bit)
2025-05-04 16:41:17.848 +07:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5053/api/Auth/login - null null
2025-05-04 16:41:17.849 +07:00 [INF] CORS policy execution successful.
2025-05-04 16:41:17.849 +07:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5053/api/Auth/login - 204 null null 0.9902ms
2025-05-04 16:41:17.850 +07:00 [INF] Request starting HTTP/1.1 POST http://localhost:5053/api/Auth/login - application/json 53
2025-05-04 16:41:17.851 +07:00 [INF] CORS policy execution successful.
2025-05-04 16:41:17.851 +07:00 [INF] CORS policy execution successful.
2025-05-04 16:41:17.852 +07:00 [INF] Executing endpoint 'Message_app.Controllers.AuthController.Login (Message_app)'
2025-05-04 16:41:17.852 +07:00 [INF] Route matched with {action = "Login", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Login(server.DTO.AuthDTO.LoginDTO) on controller Message_app.Controllers.AuthController (Message_app).
2025-05-04 16:41:17.960 +07:00 [INF] Executed DbCommand (15ms) [Parameters=[@__email_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[id], [u].[avatar_url], [u].[bio], [u].[birthday], [u].[created_at], [u].[email], [u].[gender], [u].[interests], [u].[location], [u].[password], [u].[passwordSalt], [u].[username]
FROM [Users] AS [u]
WHERE [u].[email] = @__email_0
2025-05-04 16:41:17.962 +07:00 [INF] Executing OkObjectResult, writing value of type 'server.DTO.AuthDTO.LoginRespose'.
2025-05-04 16:41:17.962 +07:00 [INF] Executed action Message_app.Controllers.AuthController.Login (Message_app) in 109.4573ms
2025-05-04 16:41:17.962 +07:00 [INF] Executed endpoint 'Message_app.Controllers.AuthController.Login (Message_app)'
2025-05-04 16:41:17.962 +07:00 [INF] Request finished HTTP/1.1 POST http://localhost:5053/api/Auth/login - 200 null application/json; charset=utf-8 111.9186ms
2025-05-04 16:41:18.104 +07:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5053/api/Conversation/get_conversations/5 - null null
2025-05-04 16:41:18.104 +07:00 [INF] CORS policy execution successful.
2025-05-04 16:41:18.105 +07:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5053/api/Conversation/get_conversations/5 - 204 null null 0.6537ms
2025-05-04 16:41:18.106 +07:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5053/api/Conversation/get_conversations/5 - null null
2025-05-04 16:41:18.106 +07:00 [INF] CORS policy execution successful.
2025-05-04 16:41:18.107 +07:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5053/api/Conversation/get_conversations/5 - 204 null null 0.6829ms
2025-05-04 16:41:18.107 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/api/Conversation/get_conversations/5 - null null
2025-05-04 16:41:18.107 +07:00 [INF] CORS policy execution successful.
2025-05-04 16:41:18.107 +07:00 [INF] CORS policy execution successful.
2025-05-04 16:41:18.107 +07:00 [INF] Executing endpoint 'server.Controllers.ConversationController.GetConversations (Message_app)'
2025-05-04 16:41:18.107 +07:00 [INF] Route matched with {action = "GetConversations", controller = "Conversation"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetConversations(Int32) on controller server.Controllers.ConversationController (Message_app).
2025-05-04 16:41:18.110 +07:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[server.DTO.ConversationDto, Message_app, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-05-04 16:41:18.111 +07:00 [INF] Executed action server.Controllers.ConversationController.GetConversations (Message_app) in 3.2691ms
2025-05-04 16:41:18.111 +07:00 [INF] Executed endpoint 'server.Controllers.ConversationController.GetConversations (Message_app)'
2025-05-04 16:41:18.111 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5053/api/Conversation/get_conversations/5 - 200 null application/json; charset=utf-8 4.2633ms
2025-05-04 16:41:18.112 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/api/Conversation/get_conversations/5 - null null
2025-05-04 16:41:18.112 +07:00 [INF] CORS policy execution successful.
2025-05-04 16:41:18.113 +07:00 [INF] CORS policy execution successful.
2025-05-04 16:41:18.113 +07:00 [INF] Executing endpoint 'server.Controllers.ConversationController.GetConversations (Message_app)'
2025-05-04 16:41:18.113 +07:00 [INF] Route matched with {action = "GetConversations", controller = "Conversation"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetConversations(Int32) on controller server.Controllers.ConversationController (Message_app).
2025-05-04 16:41:18.114 +07:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[server.DTO.ConversationDto, Message_app, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-05-04 16:41:18.115 +07:00 [INF] Executed action server.Controllers.ConversationController.GetConversations (Message_app) in 1.763ms
2025-05-04 16:41:18.115 +07:00 [INF] Executed endpoint 'server.Controllers.ConversationController.GetConversations (Message_app)'
2025-05-04 16:41:18.115 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5053/api/Conversation/get_conversations/5 - 200 null application/json; charset=utf-8 2.9193ms
2025-05-04 16:41:18.157 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/ws/chat?userId=5 - null null
2025-05-04 16:41:18.157 +07:00 [INF] CORS policy execution successful.
2025-05-04 16:41:18.158 +07:00 [INF] CORS policy execution successful.
2025-05-04 16:41:18.158 +07:00 [INF] Executing endpoint '/ws/chat'
2025-05-04 16:41:18.267 +07:00 [INF] Executed DbCommand (12ms) [Parameters=[@__client_UserId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[conversation_id]
FROM [Participants] AS [p]
WHERE [p].[user_id] = @__client_UserId_0 AND [p].[is_deleted] = CAST(0 AS bit)
2025-05-04 16:42:10.765 +07:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5053/api/Participant/get_participants/4 - null null
2025-05-04 16:42:10.766 +07:00 [INF] CORS policy execution successful.
2025-05-04 16:42:10.766 +07:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5053/api/Participant/get_participants/4 - 204 null null 0.5574ms
2025-05-04 16:42:10.768 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/api/Participant/get_participants/4 - null null
2025-05-04 16:42:10.768 +07:00 [INF] CORS policy execution successful.
2025-05-04 16:42:10.768 +07:00 [INF] CORS policy execution successful.
2025-05-04 16:42:10.768 +07:00 [INF] Executing endpoint 'server.Controllers.ParticipantController.GetParticipants (Message_app)'
2025-05-04 16:42:10.773 +07:00 [INF] Route matched with {action = "GetParticipants", controller = "Participant"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetParticipants(Int32) on controller server.Controllers.ParticipantController (Message_app).
2025-05-04 16:42:10.796 +07:00 [INF] Executed DbCommand (9ms) [Parameters=[@__conversation_id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[id], [p].[adder], [p].[conversation_id], [p].[is_deleted], [p].[joined_at], [p].[name], [p].[role], [p].[user_id]
FROM [Participants] AS [p]
WHERE [p].[conversation_id] = @__conversation_id_0
2025-05-04 16:42:10.812 +07:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType17`1[[System.Collections.Generic.List`1[[server.Models.Participants, Message_app, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-05-04 16:42:10.822 +07:00 [INF] Executed action server.Controllers.ParticipantController.GetParticipants (Message_app) in 48.9044ms
2025-05-04 16:42:10.823 +07:00 [INF] Executed endpoint 'server.Controllers.ParticipantController.GetParticipants (Message_app)'
2025-05-04 16:42:10.823 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5053/api/Participant/get_participants/4 - 200 null application/json; charset=utf-8 55.1048ms
2025-05-04 16:42:10.942 +07:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5053/api/Message/getMessages/4/5 - null null
2025-05-04 16:42:10.943 +07:00 [INF] CORS policy execution successful.
2025-05-04 16:42:10.943 +07:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5053/api/Message/getMessages/4/5 - 204 null null 0.2955ms
2025-05-04 16:42:10.944 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/api/Message/getMessages/4/5 - null null
2025-05-04 16:42:10.944 +07:00 [INF] CORS policy execution successful.
2025-05-04 16:42:10.945 +07:00 [INF] CORS policy execution successful.
2025-05-04 16:42:10.945 +07:00 [INF] Executing endpoint 'server.Controllers.MessageController.GetMessages (Message_app)'
2025-05-04 16:42:10.948 +07:00 [INF] Route matched with {action = "GetMessages", controller = "Message"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetMessages(Int32, Int32) on controller server.Controllers.MessageController (Message_app).
2025-05-04 16:42:10.996 +07:00 [INF] Retrieved 50 messages from Redis for conversation 4
2025-05-04 16:42:10.999 +07:00 [INF] Retrieved 50 messages from Redis for conversation 4 and user 5
2025-05-04 16:42:10.999 +07:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[server.DTO.MessageWithAttachment, Message_app, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-05-04 16:42:11.006 +07:00 [INF] Executed action server.Controllers.MessageController.GetMessages (Message_app) in 57.531ms
2025-05-04 16:42:11.006 +07:00 [INF] Executed endpoint 'server.Controllers.MessageController.GetMessages (Message_app)'
2025-05-04 16:42:11.006 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5053/api/Message/getMessages/4/5 - 200 null application/json; charset=utf-8 62.0391ms
2025-05-04 16:42:11.023 +07:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5053/api/Conversation/get_first_conversation/4 - null null
2025-05-04 16:42:11.023 +07:00 [INF] CORS policy execution successful.
2025-05-04 16:42:11.024 +07:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5053/api/Conversation/get_first_conversation/4 - 204 null null 0.3915ms
2025-05-04 16:42:11.025 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/api/Conversation/get_first_conversation/4 - null null
2025-05-04 16:42:11.025 +07:00 [INF] CORS policy execution successful.
2025-05-04 16:42:11.025 +07:00 [INF] CORS policy execution successful.
2025-05-04 16:42:11.026 +07:00 [INF] Executing endpoint 'server.Controllers.ConversationController.GetFirstConversation (Message_app)'
2025-05-04 16:42:11.029 +07:00 [INF] Route matched with {action = "GetFirstConversation", controller = "Conversation"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetFirstConversation(Int32) on controller server.Controllers.ConversationController (Message_app).
2025-05-04 16:42:11.059 +07:00 [INF] Executed DbCommand (8ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[id], [c].[created_at], [c].[img_url], [c].[is_group], [c].[lastMessage], [c].[lastMessageSender], [c].[lastMessageTime], [c].[name]
FROM [Conversations] AS [c]
WHERE [c].[id] = @__p_0
2025-05-04 16:42:11.304 +07:00 [INF] Executing OkObjectResult, writing value of type 'server.Models.Conversation'.
2025-05-04 16:42:11.305 +07:00 [INF] Executed action server.Controllers.ConversationController.GetFirstConversation (Message_app) in 275.7804ms
2025-05-04 16:42:11.305 +07:00 [INF] Executed endpoint 'server.Controllers.ConversationController.GetFirstConversation (Message_app)'
2025-05-04 16:42:11.305 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5053/api/Conversation/get_first_conversation/4 - 200 null application/json; charset=utf-8 279.7177ms
2025-05-04 16:42:11.310 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/api/Participant/get_participants/4 - null null
2025-05-04 16:42:11.310 +07:00 [INF] CORS policy execution successful.
2025-05-04 16:42:11.311 +07:00 [INF] CORS policy execution successful.
2025-05-04 16:42:11.312 +07:00 [INF] Executing endpoint 'server.Controllers.ParticipantController.GetParticipants (Message_app)'
2025-05-04 16:42:11.312 +07:00 [INF] Route matched with {action = "GetParticipants", controller = "Participant"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetParticipants(Int32) on controller server.Controllers.ParticipantController (Message_app).
2025-05-04 16:42:11.317 +07:00 [INF] Executed DbCommand (4ms) [Parameters=[@__conversation_id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[id], [p].[adder], [p].[conversation_id], [p].[is_deleted], [p].[joined_at], [p].[name], [p].[role], [p].[user_id]
FROM [Participants] AS [p]
WHERE [p].[conversation_id] = @__conversation_id_0
2025-05-04 16:42:11.318 +07:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType17`1[[System.Collections.Generic.List`1[[server.Models.Participants, Message_app, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-05-04 16:42:11.318 +07:00 [INF] Executed action server.Controllers.ParticipantController.GetParticipants (Message_app) in 6.4753ms
2025-05-04 16:42:11.318 +07:00 [INF] Executed endpoint 'server.Controllers.ParticipantController.GetParticipants (Message_app)'
2025-05-04 16:42:11.318 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5053/api/Participant/get_participants/4 - 200 null application/json; charset=utf-8 8.3738ms
2025-05-04 16:42:46.021 +07:00 [INF] Application is shutting down...
2025-05-04 16:43:16.534 +07:00 [INF] Executed DbCommand (12ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-05-04 16:43:16.581 +07:00 [INF] Executed DbCommand (12ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-05-04 16:43:16.585 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT 1
2025-05-04 16:43:16.589 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT OBJECT_ID(N'[__EFMigrationsHistory]');
2025-05-04 16:43:16.609 +07:00 [INF] Executed DbCommand (10ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [MigrationId], [ProductVersion]
FROM [__EFMigrationsHistory]
ORDER BY [MigrationId];
2025-05-04 16:43:16.621 +07:00 [INF] Applying migration '20250504094309_updateParticipant'.
2025-05-04 16:43:16.680 +07:00 [INF] Executed DbCommand (20ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
ALTER TABLE [Participants] ADD [img_url] nvarchar(max) NULL;
2025-05-04 16:43:16.690 +07:00 [INF] Executed DbCommand (8ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT INTO [__EFMigrationsHistory] ([MigrationId], [ProductVersion])
VALUES (N'20250504094309_updateParticipant', N'8.0.4');
