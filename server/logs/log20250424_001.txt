2025-04-24 22:09:06.978 +07:00 [INF] Executed DbCommand (32ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [u].[id], [u].[username], [u].[avatar_url]
FROM [Users] AS [u]
2025-04-24 22:09:07.171 +07:00 [INF] User profile is available. Using 'C:\Users\Thao\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-04-24 22:09:07.263 +07:00 [WRN] Overriding address(es) 'http://localhost:5053'. Binding to endpoints defined via IConfiguration and/or UseKestrel() instead.
2025-04-24 22:09:07.285 +07:00 [ERR] Hosting failed to start
System.IO.IOException: Failed to bind to address http://[::]:5053: address already in use.
 ---> Microsoft.AspNetCore.Connections.AddressInUseException: Only one usage of each socket address (protocol/network address/port) is normally permitted.
 ---> System.Net.Sockets.SocketException (10048): Only one usage of each socket address (protocol/network address/port) is normally permitted.
   at System.Net.Sockets.Socket.UpdateStatusAfterSocketErrorAndThrowException(SocketError error, Boolean disconnectOnFailure, String callerName)
   at System.Net.Sockets.Socket.DoBind(EndPoint endPointSnapshot, SocketAddress socketAddress)
   at System.Net.Sockets.Socket.Bind(EndPoint localEP)
   at Microsoft.AspNetCore.Server.Kestrel.Transport.Sockets.SocketTransportOptions.CreateDefaultBoundListenSocket(EndPoint endpoint)
   at Microsoft.AspNetCore.Server.Kestrel.Transport.Sockets.SocketConnectionListener.Bind()
   --- End of inner exception stack trace ---
   at Microsoft.AspNetCore.Server.Kestrel.Transport.Sockets.SocketConnectionListener.Bind()
   at Microsoft.AspNetCore.Server.Kestrel.Transport.Sockets.SocketTransportFactory.BindAsync(EndPoint endpoint, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.Infrastructure.TransportManager.BindAsync(EndPoint endPoint, ConnectionDelegate connectionDelegate, EndpointConfig endpointConfig, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Core.KestrelServerImpl.<>c__DisplayClass28_0`1.<<StartAsync>g__OnBind|0>d.MoveNext()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.AddressBinder.BindEndpointAsync(ListenOptions endpoint, AddressBindContext context, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.AddressBinder.BindEndpointAsync(ListenOptions endpoint, AddressBindContext context, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Core.ListenOptions.BindAsync(AddressBindContext context, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Core.AnyIPListenOptions.BindAsync(AddressBindContext context, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.AddressBinder.EndpointsStrategy.BindAsync(AddressBindContext context, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.AddressBinder.BindAsync(ListenOptions[] listenOptions, AddressBindContext context, Func`2 useHttps, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Core.KestrelServerImpl.BindAsync(CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Server.Kestrel.Core.KestrelServerImpl.StartAsync[TContext](IHttpApplication`1 application, CancellationToken cancellationToken)
   at Microsoft.AspNetCore.Hosting.GenericWebHostService.StartAsync(CancellationToken cancellationToken)
   at Microsoft.Extensions.Hosting.Internal.Host.<StartAsync>b__15_1(IHostedService service, CancellationToken token)
   at Microsoft.Extensions.Hosting.Internal.Host.ForeachService[T](IEnumerable`1 services, CancellationToken token, Boolean concurrent, Boolean abortOnFirstException, List`1 exceptions, Func`3 operation)
2025-04-24 22:09:36.206 +07:00 [INF] Executed DbCommand (61ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [u].[id], [u].[username], [u].[avatar_url]
FROM [Users] AS [u]
2025-04-24 22:09:36.548 +07:00 [INF] User profile is available. Using 'C:\Users\Thao\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-04-24 22:09:36.705 +07:00 [WRN] Overriding address(es) 'http://localhost:5053'. Binding to endpoints defined via IConfiguration and/or UseKestrel() instead.
2025-04-24 22:09:36.729 +07:00 [INF] Now listening on: http://[::]:5053
2025-04-24 22:09:36.730 +07:00 [INF] Now listening on: http://0.0.0.0:5053
2025-04-24 22:09:36.731 +07:00 [INF] Application started. Press Ctrl+C to shut down.
2025-04-24 22:09:36.731 +07:00 [INF] Hosting environment: Development
2025-04-24 22:09:36.731 +07:00 [INF] Content root path: C:\Users\Thao\source\Flutter\Message_app\server
2025-04-24 22:10:45.276 +07:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5053/api/Auth/login - null null
2025-04-24 22:10:45.318 +07:00 [INF] CORS policy execution successful.
2025-04-24 22:10:45.339 +07:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5053/api/Auth/login - 204 null null 66.0075ms
2025-04-24 22:10:45.345 +07:00 [INF] Request starting HTTP/1.1 POST http://localhost:5053/api/Auth/login - application/json 57
2025-04-24 22:10:45.347 +07:00 [INF] CORS policy execution successful.
2025-04-24 22:10:45.388 +07:00 [INF] CORS policy execution successful.
2025-04-24 22:10:45.389 +07:00 [WRN] Failed to determine the https port for redirect.
2025-04-24 22:10:45.477 +07:00 [INF] Executing endpoint 'Message_app.Controllers.AuthController.Login (Message_app)'
2025-04-24 22:10:45.511 +07:00 [INF] Route matched with {action = "Login", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Login(server.DTO.AuthDTO.LoginDTO) on controller Message_app.Controllers.AuthController (Message_app).
2025-04-24 22:10:45.841 +07:00 [INF] Executed DbCommand (59ms) [Parameters=[@__email_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[id], [u].[avatar_url], [u].[bio], [u].[birthday], [u].[created_at], [u].[email], [u].[gender], [u].[interests], [u].[location], [u].[password], [u].[passwordSalt], [u].[username]
FROM [Users] AS [u]
WHERE [u].[email] = @__email_0
2025-04-24 22:10:46.020 +07:00 [INF] Executing OkObjectResult, writing value of type 'server.DTO.AuthDTO.LoginRespose'.
2025-04-24 22:10:46.117 +07:00 [INF] Executed action Message_app.Controllers.AuthController.Login (Message_app) in 599.6439ms
2025-04-24 22:10:46.118 +07:00 [INF] Executed endpoint 'Message_app.Controllers.AuthController.Login (Message_app)'
2025-04-24 22:10:46.125 +07:00 [INF] Request finished HTTP/1.1 POST http://localhost:5053/api/Auth/login - 200 null application/json; charset=utf-8 779.4908ms
2025-04-24 22:10:46.395 +07:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5053/api/Conversation/get_conversations/2 - null null
2025-04-24 22:10:46.395 +07:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5053/api/Conversation/get_conversations/2 - null null
2025-04-24 22:10:46.397 +07:00 [INF] CORS policy execution successful.
2025-04-24 22:10:46.397 +07:00 [INF] CORS policy execution successful.
2025-04-24 22:10:46.397 +07:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5053/api/Conversation/get_conversations/2 - 204 null null 1.9313ms
2025-04-24 22:10:46.398 +07:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5053/api/Conversation/get_conversations/2 - 204 null null 2.456ms
2025-04-24 22:10:46.400 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/api/Conversation/get_conversations/2 - null null
2025-04-24 22:10:46.407 +07:00 [INF] CORS policy execution successful.
2025-04-24 22:10:46.411 +07:00 [INF] CORS policy execution successful.
2025-04-24 22:10:46.413 +07:00 [INF] Executing endpoint 'server.Controllers.ConversationController.GetConversations (Message_app)'
2025-04-24 22:10:46.420 +07:00 [INF] Route matched with {action = "GetConversations", controller = "Conversation"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetConversations(Int32) on controller server.Controllers.ConversationController (Message_app).
2025-04-24 22:10:46.462 +07:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[server.DTO.ConversationDto, Message_app, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-04-24 22:10:46.470 +07:00 [INF] Executed action server.Controllers.ConversationController.GetConversations (Message_app) in 50.1299ms
2025-04-24 22:10:46.470 +07:00 [INF] Executed endpoint 'server.Controllers.ConversationController.GetConversations (Message_app)'
2025-04-24 22:10:46.471 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5053/api/Conversation/get_conversations/2 - 200 null application/json; charset=utf-8 70.558ms
2025-04-24 22:10:46.471 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/api/Conversation/get_conversations/2 - null null
2025-04-24 22:10:46.472 +07:00 [INF] CORS policy execution successful.
2025-04-24 22:10:46.473 +07:00 [INF] CORS policy execution successful.
2025-04-24 22:10:46.476 +07:00 [INF] Executing endpoint 'server.Controllers.ConversationController.GetConversations (Message_app)'
2025-04-24 22:10:46.476 +07:00 [INF] Route matched with {action = "GetConversations", controller = "Conversation"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetConversations(Int32) on controller server.Controllers.ConversationController (Message_app).
2025-04-24 22:10:46.480 +07:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[server.DTO.ConversationDto, Message_app, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-04-24 22:10:46.480 +07:00 [INF] Executed action server.Controllers.ConversationController.GetConversations (Message_app) in 4.1389ms
2025-04-24 22:10:46.481 +07:00 [INF] Executed endpoint 'server.Controllers.ConversationController.GetConversations (Message_app)'
2025-04-24 22:10:46.481 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5053/api/Conversation/get_conversations/2 - 200 null application/json; charset=utf-8 9.7019ms
2025-04-24 22:10:46.483 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/ws/chat?userId=2 - null null
2025-04-24 22:10:46.483 +07:00 [INF] CORS policy execution successful.
2025-04-24 22:10:46.483 +07:00 [INF] CORS policy execution successful.
2025-04-24 22:10:46.483 +07:00 [INF] Executing endpoint '/ws/chat'
2025-04-24 22:10:46.727 +07:00 [INF] Executed DbCommand (18ms) [Parameters=[@__client_UserId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[conversation_id]
FROM [Participants] AS [p]
WHERE [p].[user_id] = @__client_UserId_0 AND [p].[is_deleted] = CAST(0 AS bit)
2025-04-24 22:10:49.028 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/ws/chat?userId=2 - null null
2025-04-24 22:10:49.029 +07:00 [INF] CORS policy execution successful.
2025-04-24 22:10:49.030 +07:00 [INF] CORS policy execution successful.
2025-04-24 22:10:49.030 +07:00 [INF] Executing endpoint '/ws/chat'
2025-04-24 22:10:49.126 +07:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5053/api/Message/getMessages/1/2 - null null
2025-04-24 22:10:49.126 +07:00 [INF] CORS policy execution successful.
2025-04-24 22:10:49.126 +07:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5053/api/Message/getMessages/1/2 - 204 null null 0.5658ms
2025-04-24 22:10:49.127 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/api/Message/getMessages/1/2 - null null
2025-04-24 22:10:49.128 +07:00 [INF] CORS policy execution successful.
2025-04-24 22:10:49.128 +07:00 [INF] CORS policy execution successful.
2025-04-24 22:10:49.128 +07:00 [INF] Executing endpoint 'server.Controllers.MessageController.GetMessages (Message_app)'
2025-04-24 22:10:49.135 +07:00 [INF] Executed DbCommand (6ms) [Parameters=[@__client_UserId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[conversation_id]
FROM [Participants] AS [p]
WHERE [p].[user_id] = @__client_UserId_0 AND [p].[is_deleted] = CAST(0 AS bit)
2025-04-24 22:10:49.135 +07:00 [INF] Route matched with {action = "GetMessages", controller = "Message"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetMessages(Int32, Int32) on controller server.Controllers.MessageController (Message_app).
2025-04-24 22:15:56.467 +07:00 [INF] Executed DbCommand (42ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [u].[id], [u].[username], [u].[avatar_url]
FROM [Users] AS [u]
2025-04-24 22:15:56.613 +07:00 [INF] User profile is available. Using 'C:\Users\Thao\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-04-24 22:15:56.685 +07:00 [WRN] Overriding address(es) 'http://localhost:5053'. Binding to endpoints defined via IConfiguration and/or UseKestrel() instead.
2025-04-24 22:15:56.694 +07:00 [INF] Now listening on: http://[::]:5053
2025-04-24 22:15:56.694 +07:00 [INF] Now listening on: http://0.0.0.0:5053
2025-04-24 22:15:56.694 +07:00 [INF] Application started. Press Ctrl+C to shut down.
2025-04-24 22:15:56.694 +07:00 [INF] Hosting environment: Development
2025-04-24 22:15:56.695 +07:00 [INF] Content root path: C:\Users\Thao\source\Flutter\Message_app\server
2025-04-24 22:15:56.718 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/ws/chat?userId=2 - null null
2025-04-24 22:15:56.741 +07:00 [INF] CORS policy execution successful.
2025-04-24 22:15:56.754 +07:00 [INF] CORS policy execution successful.
2025-04-24 22:15:56.754 +07:00 [WRN] Failed to determine the https port for redirect.
2025-04-24 22:15:56.774 +07:00 [INF] Executing endpoint '/ws/chat'
2025-04-24 22:15:56.931 +07:00 [INF] Executed DbCommand (27ms) [Parameters=[@__client_UserId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[conversation_id]
FROM [Participants] AS [p]
WHERE [p].[user_id] = @__client_UserId_0 AND [p].[is_deleted] = CAST(0 AS bit)
2025-04-24 22:15:58.212 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/ws/chat?userId=2 - null null
2025-04-24 22:15:58.213 +07:00 [INF] CORS policy execution successful.
2025-04-24 22:15:58.214 +07:00 [INF] CORS policy execution successful.
2025-04-24 22:15:58.215 +07:00 [INF] Executing endpoint '/ws/chat'
2025-04-24 22:15:58.275 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__client_UserId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[conversation_id]
FROM [Participants] AS [p]
WHERE [p].[user_id] = @__client_UserId_0 AND [p].[is_deleted] = CAST(0 AS bit)
2025-04-24 22:16:01.473 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/ws/chat?userId=2 - null null
2025-04-24 22:16:01.475 +07:00 [INF] CORS policy execution successful.
2025-04-24 22:16:01.475 +07:00 [INF] CORS policy execution successful.
2025-04-24 22:16:01.477 +07:00 [INF] Executing endpoint '/ws/chat'
2025-04-24 22:16:01.483 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__client_UserId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[conversation_id]
FROM [Participants] AS [p]
WHERE [p].[user_id] = @__client_UserId_0 AND [p].[is_deleted] = CAST(0 AS bit)
2025-04-24 22:16:06.988 +07:00 [INF] Request starting HTTP/1.1 GET http://172.16.16.66:5053/ws/chat?userId=5 - null null
2025-04-24 22:16:06.988 +07:00 [INF] Executing endpoint '/ws/chat'
2025-04-24 22:16:07.041 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__client_UserId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[conversation_id]
FROM [Participants] AS [p]
WHERE [p].[user_id] = @__client_UserId_0 AND [p].[is_deleted] = CAST(0 AS bit)
2025-04-24 22:16:07.083 +07:00 [INF] Request starting HTTP/1.1 GET http://172.16.16.66:5053/api/Message/getMessages/1/5 - null null
2025-04-24 22:16:07.084 +07:00 [INF] Executing endpoint 'server.Controllers.MessageController.GetMessages (Message_app)'
2025-04-24 22:16:07.101 +07:00 [INF] Route matched with {action = "GetMessages", controller = "Message"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetMessages(Int32, Int32) on controller server.Controllers.MessageController (Message_app).
2025-04-24 22:16:07.134 +07:00 [INF] Retrieved 1 messages from Redis for conversation 1
2025-04-24 22:16:07.136 +07:00 [INF] Retrieved 1 messages from Redis for conversation 1 and user 5
2025-04-24 22:16:07.141 +07:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[server.DTO.MessageWithAttachment, Message_app, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-04-24 22:16:07.175 +07:00 [INF] Executed action server.Controllers.MessageController.GetMessages (Message_app) in 71.0569ms
2025-04-24 22:16:07.176 +07:00 [INF] Executed endpoint 'server.Controllers.MessageController.GetMessages (Message_app)'
2025-04-24 22:16:07.178 +07:00 [INF] Request finished HTTP/1.1 GET http://172.16.16.66:5053/api/Message/getMessages/1/5 - 200 null application/json; charset=utf-8 94.1835ms
2025-04-24 22:16:07.252 +07:00 [INF] Request starting HTTP/1.1 GET http://172.16.16.66:5053/api/Conversation/get_first_conversation/1 - null null
2025-04-24 22:16:07.253 +07:00 [INF] Executing endpoint 'server.Controllers.ConversationController.GetFirstConversation (Message_app)'
2025-04-24 22:16:07.257 +07:00 [INF] Route matched with {action = "GetFirstConversation", controller = "Conversation"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetFirstConversation(Int32) on controller server.Controllers.ConversationController (Message_app).
2025-04-24 22:16:07.313 +07:00 [INF] Executed DbCommand (7ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[id], [c].[created_at], [c].[is_group], [c].[lastMessage], [c].[lastMessageSender], [c].[lastMessageTime], [c].[name]
FROM [Conversations] AS [c]
WHERE [c].[id] = @__p_0
2025-04-24 22:16:07.357 +07:00 [INF] Executing OkObjectResult, writing value of type 'server.Models.Conversation'.
2025-04-24 22:16:07.370 +07:00 [INF] Executed action server.Controllers.ConversationController.GetFirstConversation (Message_app) in 113.0067ms
2025-04-24 22:16:07.371 +07:00 [INF] Executed endpoint 'server.Controllers.ConversationController.GetFirstConversation (Message_app)'
2025-04-24 22:16:07.373 +07:00 [INF] Request finished HTTP/1.1 GET http://172.16.16.66:5053/api/Conversation/get_first_conversation/1 - 200 null application/json; charset=utf-8 120.933ms
2025-04-24 22:16:07.407 +07:00 [INF] Request starting HTTP/1.1 GET http://172.16.16.66:5053/api/Participant/get_participants/1 - null null
2025-04-24 22:16:07.407 +07:00 [INF] Executing endpoint 'server.Controllers.ParticipantController.GetParticipants (Message_app)'
2025-04-24 22:16:07.410 +07:00 [INF] Route matched with {action = "GetParticipants", controller = "Participant"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetParticipants(Int32) on controller server.Controllers.ParticipantController (Message_app).
2025-04-24 22:16:07.421 +07:00 [INF] Executed DbCommand (5ms) [Parameters=[@__conversation_id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[id], [p].[adder], [p].[conversation_id], [p].[is_deleted], [p].[joined_at], [p].[name], [p].[role], [p].[user_id]
FROM [Participants] AS [p]
WHERE [p].[conversation_id] = @__conversation_id_0
2025-04-24 22:16:07.432 +07:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType17`1[[System.Collections.Generic.List`1[[server.Models.Participants, Message_app, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-04-24 22:16:07.440 +07:00 [INF] Executed action server.Controllers.ParticipantController.GetParticipants (Message_app) in 29.9002ms
2025-04-24 22:16:07.440 +07:00 [INF] Executed endpoint 'server.Controllers.ParticipantController.GetParticipants (Message_app)'
2025-04-24 22:16:07.440 +07:00 [INF] Request finished HTTP/1.1 GET http://172.16.16.66:5053/api/Participant/get_participants/1 - 200 null application/json; charset=utf-8 33.5383ms
2025-04-24 22:16:08.794 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/ws/chat?userId=2 - null null
2025-04-24 22:16:08.794 +07:00 [INF] CORS policy execution successful.
2025-04-24 22:16:08.794 +07:00 [INF] CORS policy execution successful.
2025-04-24 22:16:08.795 +07:00 [INF] Executing endpoint '/ws/chat'
2025-04-24 22:16:08.863 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/ws/chat?userId=2 - null null
2025-04-24 22:16:08.863 +07:00 [INF] CORS policy execution successful.
2025-04-24 22:16:08.863 +07:00 [INF] CORS policy execution successful.
2025-04-24 22:16:08.864 +07:00 [INF] Executing endpoint '/ws/chat'
2025-04-24 22:16:08.904 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/ws/chat?userId=2 - null null
2025-04-24 22:16:08.904 +07:00 [INF] CORS policy execution successful.
2025-04-24 22:16:08.904 +07:00 [INF] CORS policy execution successful.
2025-04-24 22:16:08.904 +07:00 [INF] Executing endpoint '/ws/chat'
2025-04-24 22:16:09.053 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__client_UserId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[conversation_id]
FROM [Participants] AS [p]
WHERE [p].[user_id] = @__client_UserId_0 AND [p].[is_deleted] = CAST(0 AS bit)
2025-04-24 22:16:09.059 +07:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5053/api/Message/getMessages/3/2 - null null
2025-04-24 22:16:09.059 +07:00 [INF] CORS policy execution successful.
2025-04-24 22:16:09.060 +07:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5053/api/Message/getMessages/3/2 - null null
2025-04-24 22:16:09.060 +07:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5053/api/Message/getMessages/4/2 - null null
2025-04-24 22:16:09.060 +07:00 [INF] CORS policy execution successful.
2025-04-24 22:16:09.060 +07:00 [INF] CORS policy execution successful.
2025-04-24 22:16:09.061 +07:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5053/api/Message/getMessages/3/2 - 204 null null 0.8598ms
2025-04-24 22:16:09.061 +07:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5053/api/Message/getMessages/4/2 - 204 null null 0.7114ms
2025-04-24 22:16:09.061 +07:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5053/api/Message/getMessages/3/2 - 204 null null 1.9032ms
2025-04-24 22:16:09.062 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__client_UserId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[conversation_id]
FROM [Participants] AS [p]
WHERE [p].[user_id] = @__client_UserId_0 AND [p].[is_deleted] = CAST(0 AS bit)
2025-04-24 22:16:09.062 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__client_UserId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[conversation_id]
FROM [Participants] AS [p]
WHERE [p].[user_id] = @__client_UserId_0 AND [p].[is_deleted] = CAST(0 AS bit)
2025-04-24 22:16:09.063 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/api/Message/getMessages/3/2 - null null
2025-04-24 22:16:09.063 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/api/Message/getMessages/4/2 - null null
2025-04-24 22:16:09.064 +07:00 [INF] CORS policy execution successful.
2025-04-24 22:16:09.064 +07:00 [INF] CORS policy execution successful.
2025-04-24 22:16:09.065 +07:00 [INF] CORS policy execution successful.
2025-04-24 22:16:09.065 +07:00 [INF] CORS policy execution successful.
2025-04-24 22:16:09.065 +07:00 [INF] Executing endpoint 'server.Controllers.MessageController.GetMessages (Message_app)'
2025-04-24 22:16:09.065 +07:00 [INF] Executing endpoint 'server.Controllers.MessageController.GetMessages (Message_app)'
2025-04-24 22:16:09.065 +07:00 [INF] Route matched with {action = "GetMessages", controller = "Message"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetMessages(Int32, Int32) on controller server.Controllers.MessageController (Message_app).
2025-04-24 22:16:09.065 +07:00 [INF] Route matched with {action = "GetMessages", controller = "Message"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetMessages(Int32, Int32) on controller server.Controllers.MessageController (Message_app).
2025-04-24 22:16:09.072 +07:00 [INF] Retrieved 3 messages from Redis for conversation 3
2025-04-24 22:16:09.073 +07:00 [INF] Retrieved 3 messages from Redis for conversation 3 and user 2
2025-04-24 22:16:09.075 +07:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[server.DTO.MessageWithAttachment, Message_app, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-04-24 22:16:09.075 +07:00 [INF] Executed action server.Controllers.MessageController.GetMessages (Message_app) in 9.702ms
2025-04-24 22:16:09.076 +07:00 [INF] Executed endpoint 'server.Controllers.MessageController.GetMessages (Message_app)'
2025-04-24 22:16:09.076 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5053/api/Message/getMessages/3/2 - 200 null application/json; charset=utf-8 12.9151ms
2025-04-24 22:16:09.077 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/api/Message/getMessages/3/2 - null null
2025-04-24 22:16:09.077 +07:00 [INF] CORS policy execution successful.
2025-04-24 22:16:09.077 +07:00 [INF] CORS policy execution successful.
2025-04-24 22:16:09.077 +07:00 [INF] Executing endpoint 'server.Controllers.MessageController.GetMessages (Message_app)'
2025-04-24 22:16:09.078 +07:00 [INF] Route matched with {action = "GetMessages", controller = "Message"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetMessages(Int32, Int32) on controller server.Controllers.MessageController (Message_app).
2025-04-24 22:16:09.082 +07:00 [INF] Retrieved 3 messages from Redis for conversation 3
2025-04-24 22:16:09.082 +07:00 [INF] Retrieved 3 messages from Redis for conversation 3 and user 2
2025-04-24 22:16:09.082 +07:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[server.DTO.MessageWithAttachment, Message_app, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-04-24 22:16:09.082 +07:00 [INF] Executed action server.Controllers.MessageController.GetMessages (Message_app) in 4.8657ms
2025-04-24 22:16:09.083 +07:00 [INF] Executed endpoint 'server.Controllers.MessageController.GetMessages (Message_app)'
2025-04-24 22:16:09.083 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5053/api/Message/getMessages/3/2 - 200 null application/json; charset=utf-8 6.0251ms
2025-04-24 22:16:09.103 +07:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5053/api/Conversation/get_first_conversation/3 - null null
2025-04-24 22:16:09.104 +07:00 [INF] CORS policy execution successful.
2025-04-24 22:16:09.104 +07:00 [INF] Retrieved 49 messages from Redis for conversation 4
2025-04-24 22:16:09.104 +07:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5053/api/Conversation/get_first_conversation/3 - 204 null null 0.4907ms
2025-04-24 22:16:09.104 +07:00 [INF] Retrieved 49 messages from Redis for conversation 4 and user 2
2025-04-24 22:16:09.104 +07:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[server.DTO.MessageWithAttachment, Message_app, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-04-24 22:16:09.106 +07:00 [INF] Executed action server.Controllers.MessageController.GetMessages (Message_app) in 39.9477ms
2025-04-24 22:16:09.106 +07:00 [INF] Executed endpoint 'server.Controllers.MessageController.GetMessages (Message_app)'
2025-04-24 22:16:09.106 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/api/Conversation/get_first_conversation/3 - null null
2025-04-24 22:16:09.106 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5053/api/Message/getMessages/4/2 - 200 null application/json; charset=utf-8 42.3693ms
2025-04-24 22:16:09.106 +07:00 [INF] CORS policy execution successful.
2025-04-24 22:16:09.108 +07:00 [INF] CORS policy execution successful.
2025-04-24 22:16:09.108 +07:00 [INF] Executing endpoint 'server.Controllers.ConversationController.GetFirstConversation (Message_app)'
2025-04-24 22:16:09.108 +07:00 [INF] Route matched with {action = "GetFirstConversation", controller = "Conversation"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetFirstConversation(Int32) on controller server.Controllers.ConversationController (Message_app).
2025-04-24 22:16:09.114 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[id], [c].[created_at], [c].[is_group], [c].[lastMessage], [c].[lastMessageSender], [c].[lastMessageTime], [c].[name]
FROM [Conversations] AS [c]
WHERE [c].[id] = @__p_0
2025-04-24 22:16:09.115 +07:00 [INF] Executing OkObjectResult, writing value of type 'server.Models.Conversation'.
2025-04-24 22:16:09.115 +07:00 [INF] Executed action server.Controllers.ConversationController.GetFirstConversation (Message_app) in 6.7893ms
2025-04-24 22:16:09.115 +07:00 [INF] Executed endpoint 'server.Controllers.ConversationController.GetFirstConversation (Message_app)'
2025-04-24 22:16:09.115 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5053/api/Conversation/get_first_conversation/3 - 200 null application/json; charset=utf-8 9.7768ms
2025-04-24 22:16:09.119 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/api/Conversation/get_first_conversation/3 - null null
2025-04-24 22:16:09.119 +07:00 [INF] CORS policy execution successful.
2025-04-24 22:16:09.120 +07:00 [INF] CORS policy execution successful.
2025-04-24 22:16:09.120 +07:00 [INF] Executing endpoint 'server.Controllers.ConversationController.GetFirstConversation (Message_app)'
2025-04-24 22:16:09.120 +07:00 [INF] Route matched with {action = "GetFirstConversation", controller = "Conversation"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetFirstConversation(Int32) on controller server.Controllers.ConversationController (Message_app).
2025-04-24 22:16:09.125 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[id], [c].[created_at], [c].[is_group], [c].[lastMessage], [c].[lastMessageSender], [c].[lastMessageTime], [c].[name]
FROM [Conversations] AS [c]
WHERE [c].[id] = @__p_0
2025-04-24 22:16:09.126 +07:00 [INF] Executing OkObjectResult, writing value of type 'server.Models.Conversation'.
2025-04-24 22:16:09.126 +07:00 [INF] Executed action server.Controllers.ConversationController.GetFirstConversation (Message_app) in 5.8258ms
2025-04-24 22:16:09.126 +07:00 [INF] Executed endpoint 'server.Controllers.ConversationController.GetFirstConversation (Message_app)'
2025-04-24 22:16:09.127 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5053/api/Conversation/get_first_conversation/3 - 200 null application/json; charset=utf-8 8.0129ms
2025-04-24 22:16:09.138 +07:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5053/api/Conversation/get_first_conversation/4 - null null
2025-04-24 22:16:09.138 +07:00 [INF] CORS policy execution successful.
2025-04-24 22:16:09.138 +07:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5053/api/Conversation/get_first_conversation/4 - 204 null null 0.4361ms
2025-04-24 22:16:09.138 +07:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5053/api/Participant/get_participants/3 - null null
2025-04-24 22:16:09.139 +07:00 [INF] CORS policy execution successful.
2025-04-24 22:16:09.139 +07:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5053/api/Participant/get_participants/3 - 204 null null 0.4976ms
2025-04-24 22:16:09.140 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/api/Conversation/get_first_conversation/4 - null null
2025-04-24 22:16:09.140 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/api/Participant/get_participants/3 - null null
2025-04-24 22:16:09.141 +07:00 [INF] CORS policy execution successful.
2025-04-24 22:16:09.141 +07:00 [INF] CORS policy execution successful.
2025-04-24 22:16:09.141 +07:00 [INF] CORS policy execution successful.
2025-04-24 22:16:09.141 +07:00 [INF] Executing endpoint 'server.Controllers.ConversationController.GetFirstConversation (Message_app)'
2025-04-24 22:16:09.141 +07:00 [INF] Route matched with {action = "GetFirstConversation", controller = "Conversation"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetFirstConversation(Int32) on controller server.Controllers.ConversationController (Message_app).
2025-04-24 22:16:09.142 +07:00 [INF] CORS policy execution successful.
2025-04-24 22:16:09.142 +07:00 [INF] Executing endpoint 'server.Controllers.ParticipantController.GetParticipants (Message_app)'
2025-04-24 22:16:09.142 +07:00 [INF] Route matched with {action = "GetParticipants", controller = "Participant"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetParticipants(Int32) on controller server.Controllers.ParticipantController (Message_app).
2025-04-24 22:16:09.144 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[id], [c].[created_at], [c].[is_group], [c].[lastMessage], [c].[lastMessageSender], [c].[lastMessageTime], [c].[name]
FROM [Conversations] AS [c]
WHERE [c].[id] = @__p_0
2025-04-24 22:16:09.144 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[@__conversation_id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[id], [p].[adder], [p].[conversation_id], [p].[is_deleted], [p].[joined_at], [p].[name], [p].[role], [p].[user_id]
FROM [Participants] AS [p]
WHERE [p].[conversation_id] = @__conversation_id_0
2025-04-24 22:16:09.145 +07:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType17`1[[System.Collections.Generic.List`1[[server.Models.Participants, Message_app, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-04-24 22:16:09.145 +07:00 [INF] Executing OkObjectResult, writing value of type 'server.Models.Conversation'.
2025-04-24 22:16:09.145 +07:00 [INF] Executed action server.Controllers.ParticipantController.GetParticipants (Message_app) in 2.6676ms
2025-04-24 22:16:09.145 +07:00 [INF] Executed endpoint 'server.Controllers.ParticipantController.GetParticipants (Message_app)'
2025-04-24 22:16:09.145 +07:00 [INF] Executed action server.Controllers.ConversationController.GetFirstConversation (Message_app) in 3.9766ms
2025-04-24 22:16:09.145 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5053/api/Participant/get_participants/3 - 200 null application/json; charset=utf-8 4.9635ms
2025-04-24 22:16:09.145 +07:00 [INF] Executed endpoint 'server.Controllers.ConversationController.GetFirstConversation (Message_app)'
2025-04-24 22:16:09.147 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5053/api/Conversation/get_first_conversation/4 - 200 null application/json; charset=utf-8 6.8097ms
2025-04-24 22:16:09.147 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/api/Participant/get_participants/3 - null null
2025-04-24 22:16:09.148 +07:00 [INF] CORS policy execution successful.
2025-04-24 22:16:09.148 +07:00 [INF] CORS policy execution successful.
2025-04-24 22:16:09.148 +07:00 [INF] Executing endpoint 'server.Controllers.ParticipantController.GetParticipants (Message_app)'
2025-04-24 22:16:09.149 +07:00 [INF] Route matched with {action = "GetParticipants", controller = "Participant"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetParticipants(Int32) on controller server.Controllers.ParticipantController (Message_app).
2025-04-24 22:16:09.156 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__conversation_id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[id], [p].[adder], [p].[conversation_id], [p].[is_deleted], [p].[joined_at], [p].[name], [p].[role], [p].[user_id]
FROM [Participants] AS [p]
WHERE [p].[conversation_id] = @__conversation_id_0
2025-04-24 22:16:09.157 +07:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType17`1[[System.Collections.Generic.List`1[[server.Models.Participants, Message_app, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-04-24 22:16:09.158 +07:00 [INF] Executed action server.Controllers.ParticipantController.GetParticipants (Message_app) in 8.4306ms
2025-04-24 22:16:09.158 +07:00 [INF] Executed endpoint 'server.Controllers.ParticipantController.GetParticipants (Message_app)'
2025-04-24 22:16:09.159 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5053/api/Participant/get_participants/3 - 200 null application/json; charset=utf-8 11.4937ms
2025-04-24 22:16:09.301 +07:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5053/api/Participant/get_participants/4 - null null
2025-04-24 22:16:09.301 +07:00 [INF] CORS policy execution successful.
2025-04-24 22:16:09.302 +07:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5053/api/Participant/get_participants/4 - 204 null null 0.3864ms
2025-04-24 22:16:09.303 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/api/Participant/get_participants/4 - null null
2025-04-24 22:16:09.303 +07:00 [INF] CORS policy execution successful.
2025-04-24 22:16:09.304 +07:00 [INF] CORS policy execution successful.
2025-04-24 22:16:09.304 +07:00 [INF] Executing endpoint 'server.Controllers.ParticipantController.GetParticipants (Message_app)'
2025-04-24 22:16:09.304 +07:00 [INF] Route matched with {action = "GetParticipants", controller = "Participant"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetParticipants(Int32) on controller server.Controllers.ParticipantController (Message_app).
2025-04-24 22:16:09.306 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__conversation_id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[id], [p].[adder], [p].[conversation_id], [p].[is_deleted], [p].[joined_at], [p].[name], [p].[role], [p].[user_id]
FROM [Participants] AS [p]
WHERE [p].[conversation_id] = @__conversation_id_0
2025-04-24 22:16:09.307 +07:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType17`1[[System.Collections.Generic.List`1[[server.Models.Participants, Message_app, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-04-24 22:16:09.307 +07:00 [INF] Executed action server.Controllers.ParticipantController.GetParticipants (Message_app) in 2.97ms
2025-04-24 22:16:09.307 +07:00 [INF] Executed endpoint 'server.Controllers.ParticipantController.GetParticipants (Message_app)'
2025-04-24 22:16:09.308 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5053/api/Participant/get_participants/4 - 200 null application/json; charset=utf-8 4.459ms
2025-04-24 22:16:14.683 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/ws/chat?userId=2 - null null
2025-04-24 22:16:14.684 +07:00 [INF] CORS policy execution successful.
2025-04-24 22:16:14.684 +07:00 [INF] CORS policy execution successful.
2025-04-24 22:16:14.684 +07:00 [INF] Executing endpoint '/ws/chat'
2025-04-24 22:16:14.762 +07:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5053/api/Message/getMessages/1/2 - null null
2025-04-24 22:16:14.762 +07:00 [INF] CORS policy execution successful.
2025-04-24 22:16:14.763 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__client_UserId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[conversation_id]
FROM [Participants] AS [p]
WHERE [p].[user_id] = @__client_UserId_0 AND [p].[is_deleted] = CAST(0 AS bit)
2025-04-24 22:16:14.763 +07:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5053/api/Message/getMessages/1/2 - 204 null null 0.3461ms
2025-04-24 22:16:14.764 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/api/Message/getMessages/1/2 - null null
2025-04-24 22:16:14.764 +07:00 [INF] CORS policy execution successful.
2025-04-24 22:16:14.764 +07:00 [INF] CORS policy execution successful.
2025-04-24 22:16:14.764 +07:00 [INF] Executing endpoint 'server.Controllers.MessageController.GetMessages (Message_app)'
2025-04-24 22:16:14.764 +07:00 [INF] Route matched with {action = "GetMessages", controller = "Message"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetMessages(Int32, Int32) on controller server.Controllers.MessageController (Message_app).
2025-04-24 22:16:14.774 +07:00 [INF] Retrieved 28 messages from Redis for conversation 1
2025-04-24 22:16:14.774 +07:00 [INF] Retrieved 28 messages from Redis for conversation 1 and user 2
2025-04-24 22:16:14.774 +07:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[server.DTO.MessageWithAttachment, Message_app, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-04-24 22:16:14.777 +07:00 [INF] Executed action server.Controllers.MessageController.GetMessages (Message_app) in 13.1415ms
2025-04-24 22:16:14.777 +07:00 [INF] Executed endpoint 'server.Controllers.MessageController.GetMessages (Message_app)'
2025-04-24 22:16:14.777 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5053/api/Message/getMessages/1/2 - 200 null application/json; charset=utf-8 13.8587ms
2025-04-24 22:16:14.798 +07:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5053/api/Conversation/get_first_conversation/1 - null null
2025-04-24 22:16:14.799 +07:00 [INF] CORS policy execution successful.
2025-04-24 22:16:14.799 +07:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5053/api/Conversation/get_first_conversation/1 - 204 null null 0.2757ms
2025-04-24 22:16:14.800 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/api/Conversation/get_first_conversation/1 - null null
2025-04-24 22:16:14.800 +07:00 [INF] CORS policy execution successful.
2025-04-24 22:16:14.801 +07:00 [INF] CORS policy execution successful.
2025-04-24 22:16:14.801 +07:00 [INF] Executing endpoint 'server.Controllers.ConversationController.GetFirstConversation (Message_app)'
2025-04-24 22:16:14.802 +07:00 [INF] Route matched with {action = "GetFirstConversation", controller = "Conversation"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetFirstConversation(Int32) on controller server.Controllers.ConversationController (Message_app).
2025-04-24 22:16:14.805 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[id], [c].[created_at], [c].[is_group], [c].[lastMessage], [c].[lastMessageSender], [c].[lastMessageTime], [c].[name]
FROM [Conversations] AS [c]
WHERE [c].[id] = @__p_0
2025-04-24 22:16:14.806 +07:00 [INF] Executing OkObjectResult, writing value of type 'server.Models.Conversation'.
2025-04-24 22:16:14.806 +07:00 [INF] Executed action server.Controllers.ConversationController.GetFirstConversation (Message_app) in 4.013ms
2025-04-24 22:16:14.806 +07:00 [INF] Executed endpoint 'server.Controllers.ConversationController.GetFirstConversation (Message_app)'
2025-04-24 22:16:14.806 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5053/api/Conversation/get_first_conversation/1 - 200 null application/json; charset=utf-8 6.4114ms
2025-04-24 22:16:14.822 +07:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5053/api/Participant/get_participants/1 - null null
2025-04-24 22:16:14.822 +07:00 [INF] CORS policy execution successful.
2025-04-24 22:16:14.822 +07:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5053/api/Participant/get_participants/1 - 204 null null 0.3792ms
2025-04-24 22:16:14.824 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/api/Participant/get_participants/1 - null null
2025-04-24 22:16:14.824 +07:00 [INF] CORS policy execution successful.
2025-04-24 22:16:14.824 +07:00 [INF] CORS policy execution successful.
2025-04-24 22:16:14.824 +07:00 [INF] Executing endpoint 'server.Controllers.ParticipantController.GetParticipants (Message_app)'
2025-04-24 22:16:14.825 +07:00 [INF] Route matched with {action = "GetParticipants", controller = "Participant"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetParticipants(Int32) on controller server.Controllers.ParticipantController (Message_app).
2025-04-24 22:16:14.827 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__conversation_id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[id], [p].[adder], [p].[conversation_id], [p].[is_deleted], [p].[joined_at], [p].[name], [p].[role], [p].[user_id]
FROM [Participants] AS [p]
WHERE [p].[conversation_id] = @__conversation_id_0
2025-04-24 22:16:14.828 +07:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType17`1[[System.Collections.Generic.List`1[[server.Models.Participants, Message_app, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-04-24 22:16:14.828 +07:00 [INF] Executed action server.Controllers.ParticipantController.GetParticipants (Message_app) in 3.229ms
2025-04-24 22:16:14.828 +07:00 [INF] Executed endpoint 'server.Controllers.ParticipantController.GetParticipants (Message_app)'
2025-04-24 22:16:14.828 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5053/api/Participant/get_participants/1 - 200 null application/json; charset=utf-8 4.0344ms
2025-04-24 22:16:18.932 +07:00 [INF] Handling message from user 2: s
2025-04-24 22:16:18.945 +07:00 [INF] Executed DbCommand (11ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[id], [c].[created_at], [c].[is_group], [c].[lastMessage], [c].[lastMessageSender], [c].[lastMessageTime], [c].[name]
FROM [Conversations] AS [c]
WHERE [c].[id] = @__p_0
2025-04-24 22:16:19.104 +07:00 [WRN] Savepoints are disabled because Multiple Active Result Sets (MARS) is enabled. If 'SaveChanges' fails, then the transaction cannot be automatically rolled back to a known clean state. Instead, the transaction should be rolled back by the application before retrying 'SaveChanges'. See https://go.microsoft.com/fwlink/?linkid=2149338 for more information and examples. To identify the code which triggers this warning, call 'ConfigureWarnings(w => w.Throw(SqlServerEventId.SavepointsDisabledBecauseOfMARS))'.
2025-04-24 22:16:19.165 +07:00 [INF] Executed DbCommand (57ms) [Parameters=[@p0='?' (Size = 500), @p1='?' (DbType = Int32), @p2='?' (DbType = DateTime2), @p3='?' (DbType = Boolean), @p4='?' (DbType = Boolean), @p5='?' (DbType = Boolean), @p6='?' (DbType = Int32), @p7='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Messages] ([content], [conversation_id], [created_at], [isFile], [isRecalled], [is_read], [sender_id], [type])
OUTPUT INSERTED.[id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7);
2025-04-24 22:16:19.177 +07:00 [INF] Message saved to DB with ID: 83
2025-04-24 22:16:19.179 +07:00 [WRN] Savepoints are disabled because Multiple Active Result Sets (MARS) is enabled. If 'SaveChanges' fails, then the transaction cannot be automatically rolled back to a known clean state. Instead, the transaction should be rolled back by the application before retrying 'SaveChanges'. See https://go.microsoft.com/fwlink/?linkid=2149338 for more information and examples. To identify the code which triggers this warning, call 'ConfigureWarnings(w => w.Throw(SqlServerEventId.SavepointsDisabledBecauseOfMARS))'.
2025-04-24 22:16:19.197 +07:00 [INF] Executed DbCommand (18ms) [Parameters=[@p6='?' (DbType = Int32), @p0='?' (DbType = DateTime2), @p1='?' (DbType = Boolean), @p2='?' (Size = 4000), @p3='?' (Size = 4000), @p4='?' (DbType = DateTime2), @p5='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
UPDATE [Conversations] SET [created_at] = @p0, [is_group] = @p1, [lastMessage] = @p2, [lastMessageSender] = @p3, [lastMessageTime] = @p4, [name] = @p5
OUTPUT 1
WHERE [id] = @p6;
2025-04-24 22:16:19.207 +07:00 [INF] Transaction committed for message: 83
2025-04-24 22:16:19.213 +07:00 [INF] Saved message 83 to Redis
2025-04-24 22:16:19.216 +07:00 [INF] Added message 83 to conversation 1
2025-04-24 22:16:19.223 +07:00 [INF] Published message to channel conversation:1
2025-04-24 22:17:57.650 +07:00 [INF] Request starting HTTP/1.1 GET http://172.16.16.66:5053/ws/chat?userId=5 - null null
2025-04-24 22:17:57.650 +07:00 [INF] Executing endpoint '/ws/chat'
2025-04-24 22:17:57.661 +07:00 [INF] Request starting HTTP/1.1 GET http://172.16.16.66:5053/ws/chat?userId=5 - null null
2025-04-24 22:17:57.661 +07:00 [INF] Executing endpoint '/ws/chat'
2025-04-24 22:17:57.678 +07:00 [INF] Executed DbCommand (11ms) [Parameters=[@__client_UserId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[conversation_id]
FROM [Participants] AS [p]
WHERE [p].[user_id] = @__client_UserId_0 AND [p].[is_deleted] = CAST(0 AS bit)
2025-04-24 22:17:57.684 +07:00 [INF] Request starting HTTP/1.1 GET http://172.16.16.66:5053/ws/chat?userId=5 - null null
2025-04-24 22:17:57.685 +07:00 [INF] Executing endpoint '/ws/chat'
2025-04-24 22:17:57.694 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__client_UserId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[conversation_id]
FROM [Participants] AS [p]
WHERE [p].[user_id] = @__client_UserId_0 AND [p].[is_deleted] = CAST(0 AS bit)
2025-04-24 22:17:57.694 +07:00 [INF] Request starting HTTP/1.1 GET http://172.16.16.66:5053/ws/chat?userId=5 - null null
2025-04-24 22:17:57.695 +07:00 [INF] Executing endpoint '/ws/chat'
2025-04-24 22:17:57.696 +07:00 [INF] Request starting HTTP/1.1 GET http://172.16.16.66:5053/ws/chat?userId=5 - null null
2025-04-24 22:17:57.696 +07:00 [INF] Executing endpoint '/ws/chat'
2025-04-24 22:17:57.701 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__client_UserId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[conversation_id]
FROM [Participants] AS [p]
WHERE [p].[user_id] = @__client_UserId_0 AND [p].[is_deleted] = CAST(0 AS bit)
2025-04-24 22:17:57.704 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__client_UserId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[conversation_id]
FROM [Participants] AS [p]
WHERE [p].[user_id] = @__client_UserId_0 AND [p].[is_deleted] = CAST(0 AS bit)
2025-04-24 22:17:57.712 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__client_UserId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[conversation_id]
FROM [Participants] AS [p]
WHERE [p].[user_id] = @__client_UserId_0 AND [p].[is_deleted] = CAST(0 AS bit)
2025-04-24 22:47:21.710 +07:00 [INF] Request starting HTTP/1.1 GET http://172.16.16.66:5053/ws/chat?userId=5 - null null
2025-04-24 22:47:21.729 +07:00 [INF] Executing endpoint '/ws/chat'
2025-04-24 22:47:21.876 +07:00 [INF] Request starting HTTP/1.1 GET http://172.16.16.66:5053/api/Message/getMessages/1/5 - null null
2025-04-24 22:47:21.876 +07:00 [INF] Executing endpoint 'server.Controllers.MessageController.GetMessages (Message_app)'
2025-04-24 22:47:21.883 +07:00 [INF] Route matched with {action = "GetMessages", controller = "Message"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetMessages(Int32, Int32) on controller server.Controllers.MessageController (Message_app).
2025-04-24 22:47:21.897 +07:00 [INF] Retrieved 2 messages from Redis for conversation 1
2025-04-24 22:47:21.899 +07:00 [INF] Retrieved 2 messages from Redis for conversation 1 and user 5
2025-04-24 22:47:21.901 +07:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[server.DTO.MessageWithAttachment, Message_app, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-04-24 22:47:21.905 +07:00 [INF] Executed action server.Controllers.MessageController.GetMessages (Message_app) in 21.8234ms
2025-04-24 22:47:21.905 +07:00 [INF] Executed endpoint 'server.Controllers.MessageController.GetMessages (Message_app)'
2025-04-24 22:47:21.908 +07:00 [INF] Request finished HTTP/1.1 GET http://172.16.16.66:5053/api/Message/getMessages/1/5 - 200 null application/json; charset=utf-8 30.6516ms
2025-04-24 22:47:21.994 +07:00 [INF] Request starting HTTP/1.1 GET http://172.16.16.66:5053/api/Conversation/get_first_conversation/1 - null null
2025-04-24 22:47:21.995 +07:00 [INF] Executing endpoint 'server.Controllers.ConversationController.GetFirstConversation (Message_app)'
2025-04-24 22:47:21.995 +07:00 [INF] Route matched with {action = "GetFirstConversation", controller = "Conversation"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetFirstConversation(Int32) on controller server.Controllers.ConversationController (Message_app).
2025-04-24 22:47:22.136 +07:00 [INF] Executed DbCommand (49ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[id], [c].[created_at], [c].[is_group], [c].[lastMessage], [c].[lastMessageSender], [c].[lastMessageTime], [c].[name]
FROM [Conversations] AS [c]
WHERE [c].[id] = @__p_0
2025-04-24 22:47:22.136 +07:00 [INF] Executed DbCommand (55ms) [Parameters=[@__client_UserId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[conversation_id]
FROM [Participants] AS [p]
WHERE [p].[user_id] = @__client_UserId_0 AND [p].[is_deleted] = CAST(0 AS bit)
2025-04-24 22:47:22.138 +07:00 [INF] Executing OkObjectResult, writing value of type 'server.Models.Conversation'.
2025-04-24 22:47:22.138 +07:00 [INF] Executed action server.Controllers.ConversationController.GetFirstConversation (Message_app) in 143.3427ms
2025-04-24 22:47:22.138 +07:00 [INF] Executed endpoint 'server.Controllers.ConversationController.GetFirstConversation (Message_app)'
2025-04-24 22:47:22.138 +07:00 [INF] Request finished HTTP/1.1 GET http://172.16.16.66:5053/api/Conversation/get_first_conversation/1 - 200 null application/json; charset=utf-8 144.1211ms
2025-04-24 22:47:22.193 +07:00 [INF] Request starting HTTP/1.1 GET http://172.16.16.66:5053/api/Participant/get_participants/1 - null null
2025-04-24 22:47:22.194 +07:00 [INF] Executing endpoint 'server.Controllers.ParticipantController.GetParticipants (Message_app)'
2025-04-24 22:47:22.194 +07:00 [INF] Route matched with {action = "GetParticipants", controller = "Participant"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetParticipants(Int32) on controller server.Controllers.ParticipantController (Message_app).
2025-04-24 22:47:22.201 +07:00 [INF] Executed DbCommand (5ms) [Parameters=[@__conversation_id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[id], [p].[adder], [p].[conversation_id], [p].[is_deleted], [p].[joined_at], [p].[name], [p].[role], [p].[user_id]
FROM [Participants] AS [p]
WHERE [p].[conversation_id] = @__conversation_id_0
2025-04-24 22:47:22.202 +07:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType17`1[[System.Collections.Generic.List`1[[server.Models.Participants, Message_app, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-04-24 22:47:22.202 +07:00 [INF] Executed action server.Controllers.ParticipantController.GetParticipants (Message_app) in 8.2009ms
2025-04-24 22:47:22.202 +07:00 [INF] Executed endpoint 'server.Controllers.ParticipantController.GetParticipants (Message_app)'
2025-04-24 22:47:22.202 +07:00 [INF] Request finished HTTP/1.1 GET http://172.16.16.66:5053/api/Participant/get_participants/1 - 200 null application/json; charset=utf-8 9.1334ms
2025-04-24 22:47:35.658 +07:00 [INF] Request starting HTTP/1.1 GET http://172.16.16.66:5053/ws/chat?userId=5 - null null
2025-04-24 22:47:35.659 +07:00 [INF] Executing endpoint '/ws/chat'
2025-04-24 22:47:35.696 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[@__client_UserId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[conversation_id]
FROM [Participants] AS [p]
WHERE [p].[user_id] = @__client_UserId_0 AND [p].[is_deleted] = CAST(0 AS bit)
2025-04-24 22:47:35.710 +07:00 [INF] Request starting HTTP/1.1 GET http://172.16.16.66:5053/api/Message/getMessages/1/5 - null null
2025-04-24 22:47:35.710 +07:00 [INF] Executing endpoint 'server.Controllers.MessageController.GetMessages (Message_app)'
2025-04-24 22:47:35.710 +07:00 [INF] Route matched with {action = "GetMessages", controller = "Message"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetMessages(Int32, Int32) on controller server.Controllers.MessageController (Message_app).
2025-04-24 22:47:35.713 +07:00 [INF] Retrieved 2 messages from Redis for conversation 1
2025-04-24 22:47:35.713 +07:00 [INF] Retrieved 2 messages from Redis for conversation 1 and user 5
2025-04-24 22:47:35.713 +07:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[server.DTO.MessageWithAttachment, Message_app, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-04-24 22:47:35.713 +07:00 [INF] Executed action server.Controllers.MessageController.GetMessages (Message_app) in 2.8348ms
2025-04-24 22:47:35.713 +07:00 [INF] Executed endpoint 'server.Controllers.MessageController.GetMessages (Message_app)'
2025-04-24 22:47:35.714 +07:00 [INF] Request finished HTTP/1.1 GET http://172.16.16.66:5053/api/Message/getMessages/1/5 - 200 null application/json; charset=utf-8 3.7323ms
2025-04-24 22:47:35.779 +07:00 [INF] Request starting HTTP/1.1 GET http://172.16.16.66:5053/api/Conversation/get_first_conversation/1 - null null
2025-04-24 22:47:35.779 +07:00 [INF] Executing endpoint 'server.Controllers.ConversationController.GetFirstConversation (Message_app)'
2025-04-24 22:47:35.779 +07:00 [INF] Route matched with {action = "GetFirstConversation", controller = "Conversation"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetFirstConversation(Int32) on controller server.Controllers.ConversationController (Message_app).
2025-04-24 22:47:35.782 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[id], [c].[created_at], [c].[is_group], [c].[lastMessage], [c].[lastMessageSender], [c].[lastMessageTime], [c].[name]
FROM [Conversations] AS [c]
WHERE [c].[id] = @__p_0
2025-04-24 22:47:35.783 +07:00 [INF] Executing OkObjectResult, writing value of type 'server.Models.Conversation'.
2025-04-24 22:47:35.783 +07:00 [INF] Executed action server.Controllers.ConversationController.GetFirstConversation (Message_app) in 3.3246ms
2025-04-24 22:47:35.783 +07:00 [INF] Executed endpoint 'server.Controllers.ConversationController.GetFirstConversation (Message_app)'
2025-04-24 22:47:35.783 +07:00 [INF] Request finished HTTP/1.1 GET http://172.16.16.66:5053/api/Conversation/get_first_conversation/1 - 200 null application/json; charset=utf-8 4.1975ms
2025-04-24 22:47:35.834 +07:00 [INF] Request starting HTTP/1.1 GET http://172.16.16.66:5053/api/Participant/get_participants/1 - null null
2025-04-24 22:47:35.834 +07:00 [INF] Executing endpoint 'server.Controllers.ParticipantController.GetParticipants (Message_app)'
2025-04-24 22:47:35.835 +07:00 [INF] Route matched with {action = "GetParticipants", controller = "Participant"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetParticipants(Int32) on controller server.Controllers.ParticipantController (Message_app).
2025-04-24 22:47:35.837 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__conversation_id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[id], [p].[adder], [p].[conversation_id], [p].[is_deleted], [p].[joined_at], [p].[name], [p].[role], [p].[user_id]
FROM [Participants] AS [p]
WHERE [p].[conversation_id] = @__conversation_id_0
2025-04-24 22:47:35.838 +07:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType17`1[[System.Collections.Generic.List`1[[server.Models.Participants, Message_app, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-04-24 22:47:35.838 +07:00 [INF] Executed action server.Controllers.ParticipantController.GetParticipants (Message_app) in 3.0795ms
2025-04-24 22:47:35.838 +07:00 [INF] Executed endpoint 'server.Controllers.ParticipantController.GetParticipants (Message_app)'
2025-04-24 22:47:35.838 +07:00 [INF] Request finished HTTP/1.1 GET http://172.16.16.66:5053/api/Participant/get_participants/1 - 200 null application/json; charset=utf-8 3.8301ms
2025-04-24 22:55:14.021 +07:00 [INF] Request starting HTTP/1.1 GET http://172.16.16.66:5053/ws/chat?userId=5 - null null
2025-04-24 22:55:14.022 +07:00 [INF] Executing endpoint '/ws/chat'
2025-04-24 22:55:14.094 +07:00 [INF] Request starting HTTP/1.1 GET http://172.16.16.66:5053/api/Message/getMessages/1/5 - null null
2025-04-24 22:55:14.095 +07:00 [INF] Executing endpoint 'server.Controllers.MessageController.GetMessages (Message_app)'
2025-04-24 22:55:14.095 +07:00 [INF] Route matched with {action = "GetMessages", controller = "Message"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetMessages(Int32, Int32) on controller server.Controllers.MessageController (Message_app).
2025-04-24 22:55:14.099 +07:00 [INF] Retrieved 2 messages from Redis for conversation 1
2025-04-24 22:55:14.099 +07:00 [INF] Retrieved 2 messages from Redis for conversation 1 and user 5
2025-04-24 22:55:14.100 +07:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[server.DTO.MessageWithAttachment, Message_app, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-04-24 22:55:14.100 +07:00 [INF] Executed action server.Controllers.MessageController.GetMessages (Message_app) in 5.4476ms
2025-04-24 22:55:14.101 +07:00 [INF] Executed endpoint 'server.Controllers.MessageController.GetMessages (Message_app)'
2025-04-24 22:55:14.101 +07:00 [INF] Request finished HTTP/1.1 GET http://172.16.16.66:5053/api/Message/getMessages/1/5 - 200 null application/json; charset=utf-8 6.7234ms
2025-04-24 22:55:14.150 +07:00 [INF] Executed DbCommand (14ms) [Parameters=[@__client_UserId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[conversation_id]
FROM [Participants] AS [p]
WHERE [p].[user_id] = @__client_UserId_0 AND [p].[is_deleted] = CAST(0 AS bit)
2025-04-24 22:55:14.198 +07:00 [INF] Request starting HTTP/1.1 GET http://172.16.16.66:5053/api/Conversation/get_first_conversation/1 - null null
2025-04-24 22:55:14.198 +07:00 [INF] Executing endpoint 'server.Controllers.ConversationController.GetFirstConversation (Message_app)'
2025-04-24 22:55:14.198 +07:00 [INF] Route matched with {action = "GetFirstConversation", controller = "Conversation"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetFirstConversation(Int32) on controller server.Controllers.ConversationController (Message_app).
2025-04-24 22:55:14.205 +07:00 [INF] Executed DbCommand (4ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[id], [c].[created_at], [c].[is_group], [c].[lastMessage], [c].[lastMessageSender], [c].[lastMessageTime], [c].[name]
FROM [Conversations] AS [c]
WHERE [c].[id] = @__p_0
2025-04-24 22:55:14.205 +07:00 [INF] Executing OkObjectResult, writing value of type 'server.Models.Conversation'.
2025-04-24 22:55:14.206 +07:00 [INF] Executed action server.Controllers.ConversationController.GetFirstConversation (Message_app) in 7.0172ms
2025-04-24 22:55:14.206 +07:00 [INF] Executed endpoint 'server.Controllers.ConversationController.GetFirstConversation (Message_app)'
2025-04-24 22:55:14.206 +07:00 [INF] Request finished HTTP/1.1 GET http://172.16.16.66:5053/api/Conversation/get_first_conversation/1 - 200 null application/json; charset=utf-8 7.8541ms
2025-04-24 22:55:14.282 +07:00 [INF] Request starting HTTP/1.1 GET http://172.16.16.66:5053/api/Participant/get_participants/1 - null null
2025-04-24 22:55:14.282 +07:00 [INF] Executing endpoint 'server.Controllers.ParticipantController.GetParticipants (Message_app)'
2025-04-24 22:55:14.283 +07:00 [INF] Route matched with {action = "GetParticipants", controller = "Participant"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetParticipants(Int32) on controller server.Controllers.ParticipantController (Message_app).
2025-04-24 22:55:14.287 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[@__conversation_id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[id], [p].[adder], [p].[conversation_id], [p].[is_deleted], [p].[joined_at], [p].[name], [p].[role], [p].[user_id]
FROM [Participants] AS [p]
WHERE [p].[conversation_id] = @__conversation_id_0
2025-04-24 22:55:14.288 +07:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType17`1[[System.Collections.Generic.List`1[[server.Models.Participants, Message_app, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-04-24 22:55:14.288 +07:00 [INF] Executed action server.Controllers.ParticipantController.GetParticipants (Message_app) in 5.7067ms
2025-04-24 22:55:14.288 +07:00 [INF] Executed endpoint 'server.Controllers.ParticipantController.GetParticipants (Message_app)'
2025-04-24 22:55:14.289 +07:00 [INF] Request finished HTTP/1.1 GET http://172.16.16.66:5053/api/Participant/get_participants/1 - 200 null application/json; charset=utf-8 6.2701ms
2025-04-24 22:56:22.404 +07:00 [INF] Request starting HTTP/1.1 GET http://172.16.16.66:5053/ws/chat?userId=5 - null null
2025-04-24 22:56:22.405 +07:00 [INF] Executing endpoint '/ws/chat'
2025-04-24 22:56:22.455 +07:00 [INF] Executed DbCommand (10ms) [Parameters=[@__client_UserId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[conversation_id]
FROM [Participants] AS [p]
WHERE [p].[user_id] = @__client_UserId_0 AND [p].[is_deleted] = CAST(0 AS bit)
2025-04-24 22:56:22.476 +07:00 [INF] Request starting HTTP/1.1 GET http://172.16.16.66:5053/api/Message/getMessages/1/5 - null null
2025-04-24 22:56:22.476 +07:00 [INF] Executing endpoint 'server.Controllers.MessageController.GetMessages (Message_app)'
2025-04-24 22:56:22.476 +07:00 [INF] Route matched with {action = "GetMessages", controller = "Message"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetMessages(Int32, Int32) on controller server.Controllers.MessageController (Message_app).
2025-04-24 22:56:22.478 +07:00 [INF] Retrieved 2 messages from Redis for conversation 1
2025-04-24 22:56:22.478 +07:00 [INF] Retrieved 2 messages from Redis for conversation 1 and user 5
2025-04-24 22:56:22.478 +07:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[server.DTO.MessageWithAttachment, Message_app, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-04-24 22:56:22.479 +07:00 [INF] Executed action server.Controllers.MessageController.GetMessages (Message_app) in 2.3403ms
2025-04-24 22:56:22.479 +07:00 [INF] Executed endpoint 'server.Controllers.MessageController.GetMessages (Message_app)'
2025-04-24 22:56:22.479 +07:00 [INF] Request finished HTTP/1.1 GET http://172.16.16.66:5053/api/Message/getMessages/1/5 - 200 null application/json; charset=utf-8 3.3888ms
2025-04-24 22:56:22.525 +07:00 [INF] Request starting HTTP/1.1 GET http://172.16.16.66:5053/api/Conversation/get_first_conversation/1 - null null
2025-04-24 22:56:22.525 +07:00 [INF] Executing endpoint 'server.Controllers.ConversationController.GetFirstConversation (Message_app)'
2025-04-24 22:56:22.525 +07:00 [INF] Route matched with {action = "GetFirstConversation", controller = "Conversation"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetFirstConversation(Int32) on controller server.Controllers.ConversationController (Message_app).
2025-04-24 22:56:22.530 +07:00 [INF] Executed DbCommand (4ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[id], [c].[created_at], [c].[is_group], [c].[lastMessage], [c].[lastMessageSender], [c].[lastMessageTime], [c].[name]
FROM [Conversations] AS [c]
WHERE [c].[id] = @__p_0
2025-04-24 22:56:22.531 +07:00 [INF] Executing OkObjectResult, writing value of type 'server.Models.Conversation'.
2025-04-24 22:56:22.532 +07:00 [INF] Executed action server.Controllers.ConversationController.GetFirstConversation (Message_app) in 6.4725ms
2025-04-24 22:56:22.532 +07:00 [INF] Executed endpoint 'server.Controllers.ConversationController.GetFirstConversation (Message_app)'
2025-04-24 22:56:22.532 +07:00 [INF] Request finished HTTP/1.1 GET http://172.16.16.66:5053/api/Conversation/get_first_conversation/1 - 200 null application/json; charset=utf-8 7.0855ms
2025-04-24 22:56:22.768 +07:00 [INF] Request starting HTTP/1.1 GET http://172.16.16.66:5053/api/Participant/get_participants/1 - null null
2025-04-24 22:56:22.768 +07:00 [INF] Executing endpoint 'server.Controllers.ParticipantController.GetParticipants (Message_app)'
2025-04-24 22:56:22.769 +07:00 [INF] Route matched with {action = "GetParticipants", controller = "Participant"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetParticipants(Int32) on controller server.Controllers.ParticipantController (Message_app).
2025-04-24 22:56:22.774 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[@__conversation_id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[id], [p].[adder], [p].[conversation_id], [p].[is_deleted], [p].[joined_at], [p].[name], [p].[role], [p].[user_id]
FROM [Participants] AS [p]
WHERE [p].[conversation_id] = @__conversation_id_0
2025-04-24 22:56:22.775 +07:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType17`1[[System.Collections.Generic.List`1[[server.Models.Participants, Message_app, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-04-24 22:56:22.775 +07:00 [INF] Executed action server.Controllers.ParticipantController.GetParticipants (Message_app) in 6.2569ms
2025-04-24 22:56:22.775 +07:00 [INF] Executed endpoint 'server.Controllers.ParticipantController.GetParticipants (Message_app)'
2025-04-24 22:56:22.775 +07:00 [INF] Request finished HTTP/1.1 GET http://172.16.16.66:5053/api/Participant/get_participants/1 - 200 null application/json; charset=utf-8 7.1821ms
2025-04-24 22:57:50.094 +07:00 [INF] Executed endpoint '/ws/chat'
2025-04-24 22:57:50.094 +07:00 [INF] Executed endpoint '/ws/chat'
2025-04-24 22:57:50.094 +07:00 [INF] Executed endpoint '/ws/chat'
2025-04-24 22:57:50.095 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5053/ws/chat?userId=2 - 101 null null 2501301.1453ms
2025-04-24 22:57:50.095 +07:00 [INF] Executed endpoint '/ws/chat'
2025-04-24 22:57:50.095 +07:00 [INF] Executed endpoint '/ws/chat'
2025-04-24 22:57:50.095 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5053/ws/chat?userId=2 - 101 null null 2513378.4037ms
2025-04-24 22:57:50.095 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5053/ws/chat?userId=2 - 101 null null 2501232.0376ms
2025-04-24 22:57:50.095 +07:00 [INF] Executed endpoint '/ws/chat'
2025-04-24 22:57:50.095 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5053/ws/chat?userId=2 - 101 null null 2508621.4654ms
2025-04-24 22:57:50.095 +07:00 [INF] Executed endpoint '/ws/chat'
2025-04-24 22:57:50.095 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5053/ws/chat?userId=2 - 101 null null 2501191.2517ms
2025-04-24 22:57:50.095 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5053/ws/chat?userId=2 - 101 null null 2495411.795ms
2025-04-24 22:57:50.095 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5053/ws/chat?userId=2 - 101 null null 2511883.4414ms
2025-04-24 23:05:19.405 +07:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5053/api/Auth/login - null null
2025-04-24 23:05:19.422 +07:00 [INF] CORS policy execution successful.
2025-04-24 23:05:19.435 +07:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5053/api/Auth/login - 204 null null 30.4939ms
2025-04-24 23:05:19.460 +07:00 [INF] Request starting HTTP/1.1 POST http://localhost:5053/api/Auth/login - application/json 57
2025-04-24 23:05:19.464 +07:00 [INF] CORS policy execution successful.
2025-04-24 23:05:19.478 +07:00 [INF] CORS policy execution successful.
2025-04-24 23:05:19.486 +07:00 [INF] Executing endpoint 'Message_app.Controllers.AuthController.Login (Message_app)'
2025-04-24 23:05:19.634 +07:00 [INF] Route matched with {action = "Login", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Login(server.DTO.AuthDTO.LoginDTO) on controller Message_app.Controllers.AuthController (Message_app).
2025-04-24 23:05:20.173 +07:00 [INF] Executed DbCommand (70ms) [Parameters=[@__email_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[id], [u].[avatar_url], [u].[bio], [u].[birthday], [u].[created_at], [u].[email], [u].[gender], [u].[interests], [u].[location], [u].[password], [u].[passwordSalt], [u].[username]
FROM [Users] AS [u]
WHERE [u].[email] = @__email_0
2025-04-24 23:05:20.367 +07:00 [INF] Executing OkObjectResult, writing value of type 'server.DTO.AuthDTO.LoginRespose'.
2025-04-24 23:05:20.390 +07:00 [INF] Executed action Message_app.Controllers.AuthController.Login (Message_app) in 755.1238ms
2025-04-24 23:05:20.390 +07:00 [INF] Executed endpoint 'Message_app.Controllers.AuthController.Login (Message_app)'
2025-04-24 23:05:20.391 +07:00 [INF] Request finished HTTP/1.1 POST http://localhost:5053/api/Auth/login - 200 null application/json; charset=utf-8 930.4039ms
2025-04-24 23:05:20.627 +07:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5053/api/Conversation/get_conversations/2 - null null
2025-04-24 23:05:20.627 +07:00 [INF] CORS policy execution successful.
2025-04-24 23:05:20.629 +07:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5053/api/Conversation/get_conversations/2 - null null
2025-04-24 23:05:20.629 +07:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5053/api/Conversation/get_conversations/2 - 204 null null 1.3813ms
2025-04-24 23:05:20.629 +07:00 [INF] CORS policy execution successful.
2025-04-24 23:05:20.629 +07:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5053/api/Conversation/get_conversations/2 - 204 null null 0.4903ms
2025-04-24 23:05:20.631 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/api/Conversation/get_conversations/2 - null null
2025-04-24 23:05:20.632 +07:00 [INF] CORS policy execution successful.
2025-04-24 23:05:20.632 +07:00 [INF] CORS policy execution successful.
2025-04-24 23:05:20.632 +07:00 [INF] Executing endpoint 'server.Controllers.ConversationController.GetConversations (Message_app)'
2025-04-24 23:05:20.637 +07:00 [INF] Route matched with {action = "GetConversations", controller = "Conversation"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetConversations(Int32) on controller server.Controllers.ConversationController (Message_app).
2025-04-24 23:05:20.674 +07:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[server.DTO.ConversationDto, Message_app, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-04-24 23:05:20.678 +07:00 [INF] Executed action server.Controllers.ConversationController.GetConversations (Message_app) in 41.6981ms
2025-04-24 23:05:20.679 +07:00 [INF] Executed endpoint 'server.Controllers.ConversationController.GetConversations (Message_app)'
2025-04-24 23:05:20.679 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5053/api/Conversation/get_conversations/2 - 200 null application/json; charset=utf-8 48.0774ms
2025-04-24 23:05:20.680 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/api/Conversation/get_conversations/2 - null null
2025-04-24 23:05:20.680 +07:00 [INF] CORS policy execution successful.
2025-04-24 23:05:20.680 +07:00 [INF] CORS policy execution successful.
2025-04-24 23:05:20.681 +07:00 [INF] Executing endpoint 'server.Controllers.ConversationController.GetConversations (Message_app)'
2025-04-24 23:05:20.682 +07:00 [INF] Route matched with {action = "GetConversations", controller = "Conversation"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetConversations(Int32) on controller server.Controllers.ConversationController (Message_app).
2025-04-24 23:05:20.684 +07:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[server.DTO.ConversationDto, Message_app, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-04-24 23:05:20.684 +07:00 [INF] Executed action server.Controllers.ConversationController.GetConversations (Message_app) in 2.3824ms
2025-04-24 23:05:20.684 +07:00 [INF] Executed endpoint 'server.Controllers.ConversationController.GetConversations (Message_app)'
2025-04-24 23:05:20.684 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5053/api/Conversation/get_conversations/2 - 200 null application/json; charset=utf-8 4.3527ms
2025-04-24 23:05:20.804 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/ws/chat?userId=2 - null null
2025-04-24 23:05:20.804 +07:00 [INF] CORS policy execution successful.
2025-04-24 23:05:20.804 +07:00 [INF] CORS policy execution successful.
2025-04-24 23:05:20.805 +07:00 [INF] Executing endpoint '/ws/chat'
2025-04-24 23:05:20.923 +07:00 [INF] Executed DbCommand (14ms) [Parameters=[@__client_UserId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[conversation_id]
FROM [Participants] AS [p]
WHERE [p].[user_id] = @__client_UserId_0 AND [p].[is_deleted] = CAST(0 AS bit)
2025-04-24 23:05:22.411 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/ws/chat?userId=2 - null null
2025-04-24 23:05:22.411 +07:00 [INF] CORS policy execution successful.
2025-04-24 23:05:22.411 +07:00 [INF] CORS policy execution successful.
2025-04-24 23:05:22.411 +07:00 [INF] Executing endpoint '/ws/chat'
2025-04-24 23:05:22.504 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__client_UserId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[conversation_id]
FROM [Participants] AS [p]
WHERE [p].[user_id] = @__client_UserId_0 AND [p].[is_deleted] = CAST(0 AS bit)
2025-04-24 23:05:22.505 +07:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5053/api/Message/getMessages/1/2 - null null
2025-04-24 23:05:22.507 +07:00 [INF] CORS policy execution successful.
2025-04-24 23:05:22.507 +07:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5053/api/Message/getMessages/1/2 - 204 null null 2.3911ms
2025-04-24 23:05:22.510 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/api/Message/getMessages/1/2 - null null
2025-04-24 23:05:22.510 +07:00 [INF] CORS policy execution successful.
2025-04-24 23:05:22.511 +07:00 [INF] CORS policy execution successful.
2025-04-24 23:05:22.511 +07:00 [INF] Executing endpoint 'server.Controllers.MessageController.GetMessages (Message_app)'
2025-04-24 23:05:22.511 +07:00 [INF] Route matched with {action = "GetMessages", controller = "Message"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetMessages(Int32, Int32) on controller server.Controllers.MessageController (Message_app).
2025-04-24 23:05:22.529 +07:00 [INF] Retrieved 29 messages from Redis for conversation 1
2025-04-24 23:05:22.530 +07:00 [INF] Retrieved 29 messages from Redis for conversation 1 and user 2
2025-04-24 23:05:22.530 +07:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[server.DTO.MessageWithAttachment, Message_app, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-04-24 23:05:22.531 +07:00 [INF] Executed action server.Controllers.MessageController.GetMessages (Message_app) in 20.0678ms
2025-04-24 23:05:22.531 +07:00 [INF] Executed endpoint 'server.Controllers.MessageController.GetMessages (Message_app)'
2025-04-24 23:05:22.531 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5053/api/Message/getMessages/1/2 - 200 null application/json; charset=utf-8 20.9329ms
2025-04-24 23:05:22.552 +07:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5053/api/Conversation/get_first_conversation/1 - null null
2025-04-24 23:05:22.552 +07:00 [INF] CORS policy execution successful.
2025-04-24 23:05:22.553 +07:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5053/api/Conversation/get_first_conversation/1 - 204 null null 0.4997ms
2025-04-24 23:05:22.554 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/api/Conversation/get_first_conversation/1 - null null
2025-04-24 23:05:22.554 +07:00 [INF] CORS policy execution successful.
2025-04-24 23:05:22.555 +07:00 [INF] CORS policy execution successful.
2025-04-24 23:05:22.555 +07:00 [INF] Executing endpoint 'server.Controllers.ConversationController.GetFirstConversation (Message_app)'
2025-04-24 23:05:22.555 +07:00 [INF] Route matched with {action = "GetFirstConversation", controller = "Conversation"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetFirstConversation(Int32) on controller server.Controllers.ConversationController (Message_app).
2025-04-24 23:05:22.568 +07:00 [INF] Executed DbCommand (8ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[id], [c].[created_at], [c].[is_group], [c].[lastMessage], [c].[lastMessageSender], [c].[lastMessageTime], [c].[name]
FROM [Conversations] AS [c]
WHERE [c].[id] = @__p_0
2025-04-24 23:05:22.570 +07:00 [INF] Executing OkObjectResult, writing value of type 'server.Models.Conversation'.
2025-04-24 23:05:22.570 +07:00 [INF] Executed action server.Controllers.ConversationController.GetFirstConversation (Message_app) in 14.6732ms
2025-04-24 23:05:22.570 +07:00 [INF] Executed endpoint 'server.Controllers.ConversationController.GetFirstConversation (Message_app)'
2025-04-24 23:05:22.570 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5053/api/Conversation/get_first_conversation/1 - 200 null application/json; charset=utf-8 16.1875ms
2025-04-24 23:05:22.589 +07:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5053/api/Participant/get_participants/1 - null null
2025-04-24 23:05:22.589 +07:00 [INF] CORS policy execution successful.
2025-04-24 23:05:22.590 +07:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5053/api/Participant/get_participants/1 - 204 null null 0.5707ms
2025-04-24 23:05:22.592 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/api/Participant/get_participants/1 - null null
2025-04-24 23:05:22.592 +07:00 [INF] CORS policy execution successful.
2025-04-24 23:05:22.592 +07:00 [INF] CORS policy execution successful.
2025-04-24 23:05:22.592 +07:00 [INF] Executing endpoint 'server.Controllers.ParticipantController.GetParticipants (Message_app)'
2025-04-24 23:05:22.592 +07:00 [INF] Route matched with {action = "GetParticipants", controller = "Participant"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetParticipants(Int32) on controller server.Controllers.ParticipantController (Message_app).
2025-04-24 23:05:22.598 +07:00 [INF] Executed DbCommand (4ms) [Parameters=[@__conversation_id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[id], [p].[adder], [p].[conversation_id], [p].[is_deleted], [p].[joined_at], [p].[name], [p].[role], [p].[user_id]
FROM [Participants] AS [p]
WHERE [p].[conversation_id] = @__conversation_id_0
2025-04-24 23:05:22.599 +07:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType17`1[[System.Collections.Generic.List`1[[server.Models.Participants, Message_app, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-04-24 23:05:22.599 +07:00 [INF] Executed action server.Controllers.ParticipantController.GetParticipants (Message_app) in 6.7392ms
2025-04-24 23:05:22.599 +07:00 [INF] Executed endpoint 'server.Controllers.ParticipantController.GetParticipants (Message_app)'
2025-04-24 23:05:22.599 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5053/api/Participant/get_participants/1 - 200 null application/json; charset=utf-8 7.7194ms
2025-04-24 23:10:16.256 +07:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5053/api/Auth/login - null null
2025-04-24 23:10:16.256 +07:00 [INF] CORS policy execution successful.
2025-04-24 23:10:16.256 +07:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5053/api/Auth/login - 204 null null 0.5156ms
2025-04-24 23:10:16.257 +07:00 [INF] Request starting HTTP/1.1 POST http://localhost:5053/api/Auth/login - application/json 57
2025-04-24 23:10:16.257 +07:00 [INF] CORS policy execution successful.
2025-04-24 23:10:16.258 +07:00 [INF] CORS policy execution successful.
2025-04-24 23:10:16.258 +07:00 [INF] Executing endpoint 'Message_app.Controllers.AuthController.Login (Message_app)'
2025-04-24 23:10:16.258 +07:00 [INF] Route matched with {action = "Login", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Login(server.DTO.AuthDTO.LoginDTO) on controller Message_app.Controllers.AuthController (Message_app).
2025-04-24 23:10:16.277 +07:00 [INF] Executed DbCommand (13ms) [Parameters=[@__email_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[id], [u].[avatar_url], [u].[bio], [u].[birthday], [u].[created_at], [u].[email], [u].[gender], [u].[interests], [u].[location], [u].[password], [u].[passwordSalt], [u].[username]
FROM [Users] AS [u]
WHERE [u].[email] = @__email_0
2025-04-24 23:10:16.278 +07:00 [INF] Executing OkObjectResult, writing value of type 'server.DTO.AuthDTO.LoginRespose'.
2025-04-24 23:10:16.278 +07:00 [INF] Executed action Message_app.Controllers.AuthController.Login (Message_app) in 19.5644ms
2025-04-24 23:10:16.278 +07:00 [INF] Executed endpoint 'Message_app.Controllers.AuthController.Login (Message_app)'
2025-04-24 23:10:16.278 +07:00 [INF] Request finished HTTP/1.1 POST http://localhost:5053/api/Auth/login - 200 null application/json; charset=utf-8 20.9504ms
2025-04-24 23:10:16.444 +07:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5053/api/Conversation/get_conversations/2 - null null
2025-04-24 23:10:16.445 +07:00 [INF] CORS policy execution successful.
2025-04-24 23:10:16.445 +07:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5053/api/Conversation/get_conversations/2 - 204 null null 0.5121ms
2025-04-24 23:10:16.446 +07:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5053/api/Conversation/get_conversations/2 - null null
2025-04-24 23:10:16.446 +07:00 [INF] CORS policy execution successful.
2025-04-24 23:10:16.446 +07:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5053/api/Conversation/get_conversations/2 - 204 null null 0.1942ms
2025-04-24 23:10:16.446 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/api/Conversation/get_conversations/2 - null null
2025-04-24 23:10:16.447 +07:00 [INF] CORS policy execution successful.
2025-04-24 23:10:16.447 +07:00 [INF] CORS policy execution successful.
2025-04-24 23:10:16.447 +07:00 [INF] Executing endpoint 'server.Controllers.ConversationController.GetConversations (Message_app)'
2025-04-24 23:10:16.447 +07:00 [INF] Route matched with {action = "GetConversations", controller = "Conversation"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetConversations(Int32) on controller server.Controllers.ConversationController (Message_app).
2025-04-24 23:10:16.448 +07:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[server.DTO.ConversationDto, Message_app, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-04-24 23:10:16.449 +07:00 [INF] Executed action server.Controllers.ConversationController.GetConversations (Message_app) in 1.5136ms
2025-04-24 23:10:16.449 +07:00 [INF] Executed endpoint 'server.Controllers.ConversationController.GetConversations (Message_app)'
2025-04-24 23:10:16.449 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5053/api/Conversation/get_conversations/2 - 200 null application/json; charset=utf-8 2.5903ms
2025-04-24 23:10:16.450 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/api/Conversation/get_conversations/2 - null null
2025-04-24 23:10:16.450 +07:00 [INF] CORS policy execution successful.
2025-04-24 23:10:16.450 +07:00 [INF] CORS policy execution successful.
2025-04-24 23:10:16.450 +07:00 [INF] Executing endpoint 'server.Controllers.ConversationController.GetConversations (Message_app)'
2025-04-24 23:10:16.450 +07:00 [INF] Route matched with {action = "GetConversations", controller = "Conversation"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetConversations(Int32) on controller server.Controllers.ConversationController (Message_app).
2025-04-24 23:10:16.451 +07:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[server.DTO.ConversationDto, Message_app, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-04-24 23:10:16.451 +07:00 [INF] Executed action server.Controllers.ConversationController.GetConversations (Message_app) in 1.2455ms
2025-04-24 23:10:16.452 +07:00 [INF] Executed endpoint 'server.Controllers.ConversationController.GetConversations (Message_app)'
2025-04-24 23:10:16.452 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5053/api/Conversation/get_conversations/2 - 200 null application/json; charset=utf-8 2.4369ms
2025-04-24 23:10:16.501 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/ws/chat?userId=2 - null null
2025-04-24 23:10:16.501 +07:00 [INF] CORS policy execution successful.
2025-04-24 23:10:16.501 +07:00 [INF] CORS policy execution successful.
2025-04-24 23:10:16.502 +07:00 [INF] Executing endpoint '/ws/chat'
2025-04-24 23:10:16.526 +07:00 [INF] Executed DbCommand (17ms) [Parameters=[@__client_UserId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[conversation_id]
FROM [Participants] AS [p]
WHERE [p].[user_id] = @__client_UserId_0 AND [p].[is_deleted] = CAST(0 AS bit)
2025-04-24 23:10:18.770 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/ws/chat?userId=2 - null null
2025-04-24 23:10:18.770 +07:00 [INF] CORS policy execution successful.
2025-04-24 23:10:18.771 +07:00 [INF] CORS policy execution successful.
2025-04-24 23:10:18.771 +07:00 [INF] Executing endpoint '/ws/chat'
2025-04-24 23:10:18.857 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__client_UserId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[conversation_id]
FROM [Participants] AS [p]
WHERE [p].[user_id] = @__client_UserId_0 AND [p].[is_deleted] = CAST(0 AS bit)
2025-04-24 23:10:18.860 +07:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5053/api/Message/getMessages/1/2 - null null
2025-04-24 23:10:18.860 +07:00 [INF] CORS policy execution successful.
2025-04-24 23:10:18.860 +07:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5053/api/Message/getMessages/1/2 - 204 null null 0.1893ms
2025-04-24 23:10:18.861 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/api/Message/getMessages/1/2 - null null
2025-04-24 23:10:18.861 +07:00 [INF] CORS policy execution successful.
2025-04-24 23:10:18.861 +07:00 [INF] CORS policy execution successful.
2025-04-24 23:10:18.862 +07:00 [INF] Executing endpoint 'server.Controllers.MessageController.GetMessages (Message_app)'
2025-04-24 23:10:18.862 +07:00 [INF] Route matched with {action = "GetMessages", controller = "Message"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetMessages(Int32, Int32) on controller server.Controllers.MessageController (Message_app).
2025-04-24 23:10:18.868 +07:00 [INF] Retrieved 29 messages from Redis for conversation 1
2025-04-24 23:10:18.868 +07:00 [INF] Retrieved 29 messages from Redis for conversation 1 and user 2
2025-04-24 23:10:18.868 +07:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[server.DTO.MessageWithAttachment, Message_app, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-04-24 23:10:18.869 +07:00 [INF] Executed action server.Controllers.MessageController.GetMessages (Message_app) in 7.01ms
2025-04-24 23:10:18.869 +07:00 [INF] Executed endpoint 'server.Controllers.MessageController.GetMessages (Message_app)'
2025-04-24 23:10:18.869 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5053/api/Message/getMessages/1/2 - 200 null application/json; charset=utf-8 7.6566ms
2025-04-24 23:10:18.890 +07:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5053/api/Conversation/get_first_conversation/1 - null null
2025-04-24 23:10:18.891 +07:00 [INF] CORS policy execution successful.
2025-04-24 23:10:18.891 +07:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5053/api/Conversation/get_first_conversation/1 - 204 null null 0.3208ms
2025-04-24 23:10:18.892 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/api/Conversation/get_first_conversation/1 - null null
2025-04-24 23:10:18.893 +07:00 [INF] CORS policy execution successful.
2025-04-24 23:10:18.893 +07:00 [INF] CORS policy execution successful.
2025-04-24 23:10:18.893 +07:00 [INF] Executing endpoint 'server.Controllers.ConversationController.GetFirstConversation (Message_app)'
2025-04-24 23:10:18.893 +07:00 [INF] Route matched with {action = "GetFirstConversation", controller = "Conversation"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetFirstConversation(Int32) on controller server.Controllers.ConversationController (Message_app).
2025-04-24 23:10:18.897 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[id], [c].[created_at], [c].[is_group], [c].[lastMessage], [c].[lastMessageSender], [c].[lastMessageTime], [c].[name]
FROM [Conversations] AS [c]
WHERE [c].[id] = @__p_0
2025-04-24 23:10:18.898 +07:00 [INF] Executing OkObjectResult, writing value of type 'server.Models.Conversation'.
2025-04-24 23:10:18.898 +07:00 [INF] Executed action server.Controllers.ConversationController.GetFirstConversation (Message_app) in 5.3451ms
2025-04-24 23:10:18.898 +07:00 [INF] Executed endpoint 'server.Controllers.ConversationController.GetFirstConversation (Message_app)'
2025-04-24 23:10:18.898 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5053/api/Conversation/get_first_conversation/1 - 200 null application/json; charset=utf-8 5.8577ms
2025-04-24 23:10:18.913 +07:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5053/api/Participant/get_participants/1 - null null
2025-04-24 23:10:18.913 +07:00 [INF] CORS policy execution successful.
2025-04-24 23:10:18.914 +07:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5053/api/Participant/get_participants/1 - 204 null null 0.24ms
2025-04-24 23:10:18.915 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/api/Participant/get_participants/1 - null null
2025-04-24 23:10:18.915 +07:00 [INF] CORS policy execution successful.
2025-04-24 23:10:18.915 +07:00 [INF] CORS policy execution successful.
2025-04-24 23:10:18.915 +07:00 [INF] Executing endpoint 'server.Controllers.ParticipantController.GetParticipants (Message_app)'
2025-04-24 23:10:18.915 +07:00 [INF] Route matched with {action = "GetParticipants", controller = "Participant"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetParticipants(Int32) on controller server.Controllers.ParticipantController (Message_app).
2025-04-24 23:10:18.920 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[@__conversation_id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[id], [p].[adder], [p].[conversation_id], [p].[is_deleted], [p].[joined_at], [p].[name], [p].[role], [p].[user_id]
FROM [Participants] AS [p]
WHERE [p].[conversation_id] = @__conversation_id_0
2025-04-24 23:10:18.920 +07:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType17`1[[System.Collections.Generic.List`1[[server.Models.Participants, Message_app, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-04-24 23:10:18.920 +07:00 [INF] Executed action server.Controllers.ParticipantController.GetParticipants (Message_app) in 4.776ms
2025-04-24 23:10:18.920 +07:00 [INF] Executed endpoint 'server.Controllers.ParticipantController.GetParticipants (Message_app)'
2025-04-24 23:10:18.920 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5053/api/Participant/get_participants/1 - 200 null application/json; charset=utf-8 5.1939ms
2025-04-24 23:10:46.528 +07:00 [INF] Handling message from user 5: sadasd
2025-04-24 23:10:46.546 +07:00 [INF] Executed DbCommand (15ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[id], [c].[created_at], [c].[is_group], [c].[lastMessage], [c].[lastMessageSender], [c].[lastMessageTime], [c].[name]
FROM [Conversations] AS [c]
WHERE [c].[id] = @__p_0
2025-04-24 23:10:46.568 +07:00 [WRN] Savepoints are disabled because Multiple Active Result Sets (MARS) is enabled. If 'SaveChanges' fails, then the transaction cannot be automatically rolled back to a known clean state. Instead, the transaction should be rolled back by the application before retrying 'SaveChanges'. See https://go.microsoft.com/fwlink/?linkid=2149338 for more information and examples. To identify the code which triggers this warning, call 'ConfigureWarnings(w => w.Throw(SqlServerEventId.SavepointsDisabledBecauseOfMARS))'.
2025-04-24 23:10:46.633 +07:00 [INF] Executed DbCommand (64ms) [Parameters=[@p0='?' (Size = 500), @p1='?' (DbType = Int32), @p2='?' (DbType = DateTime2), @p3='?' (DbType = Boolean), @p4='?' (DbType = Boolean), @p5='?' (DbType = Boolean), @p6='?' (DbType = Int32), @p7='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Messages] ([content], [conversation_id], [created_at], [isFile], [isRecalled], [is_read], [sender_id], [type])
OUTPUT INSERTED.[id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7);
2025-04-24 23:10:46.635 +07:00 [INF] Message saved to DB with ID: 84
2025-04-24 23:10:46.635 +07:00 [WRN] Savepoints are disabled because Multiple Active Result Sets (MARS) is enabled. If 'SaveChanges' fails, then the transaction cannot be automatically rolled back to a known clean state. Instead, the transaction should be rolled back by the application before retrying 'SaveChanges'. See https://go.microsoft.com/fwlink/?linkid=2149338 for more information and examples. To identify the code which triggers this warning, call 'ConfigureWarnings(w => w.Throw(SqlServerEventId.SavepointsDisabledBecauseOfMARS))'.
2025-04-24 23:10:46.646 +07:00 [INF] Executed DbCommand (11ms) [Parameters=[@p6='?' (DbType = Int32), @p0='?' (DbType = DateTime2), @p1='?' (DbType = Boolean), @p2='?' (Size = 4000), @p3='?' (Size = 4000), @p4='?' (DbType = DateTime2), @p5='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
UPDATE [Conversations] SET [created_at] = @p0, [is_group] = @p1, [lastMessage] = @p2, [lastMessageSender] = @p3, [lastMessageTime] = @p4, [name] = @p5
OUTPUT 1
WHERE [id] = @p6;
2025-04-24 23:10:46.648 +07:00 [INF] Transaction committed for message: 84
2025-04-24 23:10:46.651 +07:00 [INF] Saved message 84 to Redis
2025-04-24 23:10:46.652 +07:00 [INF] Added message 84 to conversation 1
2025-04-24 23:10:46.653 +07:00 [INF] Published message to channel conversation:1
2025-04-24 23:45:07.938 +07:00 [INF] Request starting HTTP/1.1 GET http://172.16.16.66:5053/ws/chat?userId=5 - null null
2025-04-24 23:45:07.944 +07:00 [INF] Executing endpoint '/ws/chat'
2025-04-24 23:45:08.202 +07:00 [INF] Executed DbCommand (32ms) [Parameters=[@__client_UserId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[conversation_id]
FROM [Participants] AS [p]
WHERE [p].[user_id] = @__client_UserId_0 AND [p].[is_deleted] = CAST(0 AS bit)
2025-04-24 23:45:18.105 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/ws/chat?userId=2 - null null
2025-04-24 23:45:18.106 +07:00 [INF] CORS policy execution successful.
2025-04-24 23:45:18.107 +07:00 [INF] CORS policy execution successful.
2025-04-24 23:45:18.107 +07:00 [INF] Executing endpoint '/ws/chat'
2025-04-24 23:45:18.223 +07:00 [INF] Executed DbCommand (8ms) [Parameters=[@__client_UserId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[conversation_id]
FROM [Participants] AS [p]
WHERE [p].[user_id] = @__client_UserId_0 AND [p].[is_deleted] = CAST(0 AS bit)
2025-04-24 23:45:18.225 +07:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5053/api/Message/getMessages/1/2 - null null
2025-04-24 23:45:18.226 +07:00 [INF] CORS policy execution successful.
2025-04-24 23:45:18.235 +07:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5053/api/Message/getMessages/1/2 - 204 null null 6.6766ms
2025-04-24 23:45:18.238 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/api/Message/getMessages/1/2 - null null
2025-04-24 23:45:18.238 +07:00 [INF] CORS policy execution successful.
2025-04-24 23:45:18.242 +07:00 [INF] CORS policy execution successful.
2025-04-24 23:45:18.242 +07:00 [INF] Executing endpoint 'server.Controllers.MessageController.GetMessages (Message_app)'
2025-04-24 23:45:18.248 +07:00 [INF] Route matched with {action = "GetMessages", controller = "Message"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetMessages(Int32, Int32) on controller server.Controllers.MessageController (Message_app).
2025-04-24 23:45:18.273 +07:00 [INF] Retrieved 30 messages from Redis for conversation 1
2025-04-24 23:45:18.274 +07:00 [INF] Retrieved 30 messages from Redis for conversation 1 and user 2
2025-04-24 23:45:18.276 +07:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[server.DTO.MessageWithAttachment, Message_app, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-04-24 23:45:18.285 +07:00 [INF] Executed action server.Controllers.MessageController.GetMessages (Message_app) in 35.4815ms
2025-04-24 23:45:18.285 +07:00 [INF] Executed endpoint 'server.Controllers.MessageController.GetMessages (Message_app)'
2025-04-24 23:45:18.285 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5053/api/Message/getMessages/1/2 - 200 null application/json; charset=utf-8 46.8527ms
2025-04-24 23:45:18.322 +07:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5053/api/Conversation/get_first_conversation/1 - null null
2025-04-24 23:45:18.322 +07:00 [INF] CORS policy execution successful.
2025-04-24 23:45:18.323 +07:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5053/api/Conversation/get_first_conversation/1 - 204 null null 0.2546ms
2025-04-24 23:45:18.324 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/api/Conversation/get_first_conversation/1 - null null
2025-04-24 23:45:18.324 +07:00 [INF] CORS policy execution successful.
2025-04-24 23:45:18.324 +07:00 [INF] CORS policy execution successful.
2025-04-24 23:45:18.324 +07:00 [INF] Executing endpoint 'server.Controllers.ConversationController.GetFirstConversation (Message_app)'
2025-04-24 23:45:18.324 +07:00 [INF] Route matched with {action = "GetFirstConversation", controller = "Conversation"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetFirstConversation(Int32) on controller server.Controllers.ConversationController (Message_app).
2025-04-24 23:45:18.334 +07:00 [INF] Executed DbCommand (7ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[id], [c].[created_at], [c].[is_group], [c].[lastMessage], [c].[lastMessageSender], [c].[lastMessageTime], [c].[name]
FROM [Conversations] AS [c]
WHERE [c].[id] = @__p_0
2025-04-24 23:45:18.335 +07:00 [INF] Executing OkObjectResult, writing value of type 'server.Models.Conversation'.
2025-04-24 23:45:18.335 +07:00 [INF] Executed action server.Controllers.ConversationController.GetFirstConversation (Message_app) in 10.6154ms
2025-04-24 23:45:18.335 +07:00 [INF] Executed endpoint 'server.Controllers.ConversationController.GetFirstConversation (Message_app)'
2025-04-24 23:45:18.335 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5053/api/Conversation/get_first_conversation/1 - 200 null application/json; charset=utf-8 11.6872ms
2025-04-24 23:45:18.352 +07:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5053/api/Participant/get_participants/1 - null null
2025-04-24 23:45:18.352 +07:00 [INF] CORS policy execution successful.
2025-04-24 23:45:18.352 +07:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5053/api/Participant/get_participants/1 - 204 null null 0.1596ms
2025-04-24 23:45:18.353 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/api/Participant/get_participants/1 - null null
2025-04-24 23:45:18.353 +07:00 [INF] CORS policy execution successful.
2025-04-24 23:45:18.353 +07:00 [INF] CORS policy execution successful.
2025-04-24 23:45:18.353 +07:00 [INF] Executing endpoint 'server.Controllers.ParticipantController.GetParticipants (Message_app)'
2025-04-24 23:45:18.353 +07:00 [INF] Route matched with {action = "GetParticipants", controller = "Participant"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetParticipants(Int32) on controller server.Controllers.ParticipantController (Message_app).
2025-04-24 23:45:18.361 +07:00 [INF] Executed DbCommand (5ms) [Parameters=[@__conversation_id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[id], [p].[adder], [p].[conversation_id], [p].[is_deleted], [p].[joined_at], [p].[name], [p].[role], [p].[user_id]
FROM [Participants] AS [p]
WHERE [p].[conversation_id] = @__conversation_id_0
2025-04-24 23:45:18.362 +07:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType17`1[[System.Collections.Generic.List`1[[server.Models.Participants, Message_app, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-04-24 23:45:18.362 +07:00 [INF] Executed action server.Controllers.ParticipantController.GetParticipants (Message_app) in 8.9197ms
2025-04-24 23:45:18.363 +07:00 [INF] Executed endpoint 'server.Controllers.ParticipantController.GetParticipants (Message_app)'
2025-04-24 23:45:18.363 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5053/api/Participant/get_participants/1 - 200 null application/json; charset=utf-8 9.7272ms
2025-04-24 23:47:14.029 +07:00 [INF] Executed endpoint '/ws/chat'
2025-04-24 23:47:14.029 +07:00 [INF] Executed endpoint '/ws/chat'
2025-04-24 23:47:14.029 +07:00 [INF] Executed endpoint '/ws/chat'
2025-04-24 23:47:14.029 +07:00 [INF] Executed endpoint '/ws/chat'
2025-04-24 23:47:14.029 +07:00 [INF] Executed endpoint '/ws/chat'
