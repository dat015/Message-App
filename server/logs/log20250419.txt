2025-04-19 09:29:09.843 +07:00 [INF] Executed DbCommand (53ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [u].[id], [u].[username], [u].[avatar_url]
FROM [Users] AS [u]
2025-04-19 09:29:09.982 +07:00 [INF] User profile is available. Using 'C:\Users\Thao\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-04-19 09:29:10.062 +07:00 [WRN] Overriding address(es) 'http://localhost:5053'. Binding to endpoints defined via IConfiguration and/or UseKestrel() instead.
2025-04-19 09:29:10.069 +07:00 [INF] Now listening on: http://[::]:5053
2025-04-19 09:29:10.069 +07:00 [INF] Application started. Press Ctrl+C to shut down.
2025-04-19 09:29:10.069 +07:00 [INF] Hosting environment: Development
2025-04-19 09:29:10.070 +07:00 [INF] Content root path: C:\Users\Thao\source\Flutter\Message_app\server
2025-04-19 09:29:32.926 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/swagger - null null
2025-04-19 09:29:32.984 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5053/swagger - 301 0 null 60.1435ms
2025-04-19 09:29:32.989 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/swagger/index.html - null null
2025-04-19 09:29:33.145 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5053/swagger/index.html - 200 null text/html;charset=utf-8 156.8925ms
2025-04-19 09:29:33.150 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/swagger/index.css - null null
2025-04-19 09:29:33.151 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/swagger/swagger-ui.css - null null
2025-04-19 09:29:33.150 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/swagger/swagger-ui-bundle.js - null null
2025-04-19 09:29:33.155 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/swagger/swagger-ui-standalone-preset.js - null null
2025-04-19 09:29:33.164 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/_framework/aspnetcore-browser-refresh.js - null null
2025-04-19 09:29:33.166 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5053/_framework/aspnetcore-browser-refresh.js - 200 13732 application/javascript; charset=utf-8 1.9383ms
2025-04-19 09:29:33.170 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/swagger/index.js - null null
2025-04-19 09:29:33.175 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5053/swagger/index.js - 200 null application/javascript;charset=utf-8 4.8615ms
2025-04-19 09:29:33.175 +07:00 [INF] Sending file. Request path: '/index.css'. Physical path: 'N/A'
2025-04-19 09:29:33.175 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5053/swagger/index.css - 200 202 text/css 24.8112ms
2025-04-19 09:29:33.181 +07:00 [INF] Sending file. Request path: '/swagger-ui.css'. Physical path: 'N/A'
2025-04-19 09:29:33.182 +07:00 [INF] Sending file. Request path: '/swagger-ui-standalone-preset.js'. Physical path: 'N/A'
2025-04-19 09:29:33.183 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5053/swagger/swagger-ui.css - 200 152035 text/css 32.5269ms
2025-04-19 09:29:33.183 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5053/swagger/swagger-ui-standalone-preset.js - 200 230007 text/javascript 28.0975ms
2025-04-19 09:29:33.206 +07:00 [INF] Sending file. Request path: '/swagger-ui-bundle.js'. Physical path: 'N/A'
2025-04-19 09:29:33.206 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5053/swagger/swagger-ui-bundle.js - 200 1457477 text/javascript 55.8847ms
2025-04-19 09:29:33.975 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/swagger/v1/swagger.json - null null
2025-04-19 09:29:34.052 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/swagger/favicon-32x32.png - null null
2025-04-19 09:29:34.053 +07:00 [INF] Sending file. Request path: '/favicon-32x32.png'. Physical path: 'N/A'
2025-04-19 09:29:34.053 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5053/swagger/favicon-32x32.png - 200 628 image/png 0.6982ms
2025-04-19 09:29:34.100 +07:00 [ERR] An unhandled exception has occurred while executing the request.
Swashbuckle.AspNetCore.SwaggerGen.SwaggerGeneratorException: Failed to generate Operation for action - server.Controllers.MessageController.UploadFile (Message_app). See inner exception
 ---> Swashbuckle.AspNetCore.SwaggerGen.SwaggerGeneratorException: Error reading parameter(s) for action server.Controllers.MessageController.UploadFile (Message_app) as [FromForm] attribute used with IFormFile. Please refer to https://github.com/domaindrivendev/Swashbuckle.AspNetCore#handle-forms-and-file-uploads for more information
   at Swashbuckle.AspNetCore.SwaggerGen.SwaggerGenerator.GenerateParametersAsync(ApiDescription apiDescription, SchemaRepository schemaRespository, Func`3 parameterGenerator)
   at Swashbuckle.AspNetCore.SwaggerGen.SwaggerGenerator.GenerateParametersAsync(ApiDescription apiDescription, SchemaRepository schemaRespository)
   at Swashbuckle.AspNetCore.SwaggerGen.SwaggerGenerator.GenerateOperationAsync(ApiDescription apiDescription, SchemaRepository schemaRepository, Func`3 parametersGenerator, Func`3 bodyGenerator, Func`3 applyFilters)
   --- End of inner exception stack trace ---
   at Swashbuckle.AspNetCore.SwaggerGen.SwaggerGenerator.GenerateOperationAsync(ApiDescription apiDescription, SchemaRepository schemaRepository, Func`3 parametersGenerator, Func`3 bodyGenerator, Func`3 applyFilters)
   at Swashbuckle.AspNetCore.SwaggerGen.SwaggerGenerator.GenerateOperationAsync(ApiDescription apiDescription, SchemaRepository schemaRepository)
   at Swashbuckle.AspNetCore.SwaggerGen.SwaggerGenerator.GenerateOperationsAsync(IEnumerable`1 apiDescriptions, SchemaRepository schemaRepository)
   at Swashbuckle.AspNetCore.SwaggerGen.SwaggerGenerator.GeneratePathsAsync(IEnumerable`1 apiDescriptions, SchemaRepository schemaRepository, Func`3 operationsGenerator)
   at Swashbuckle.AspNetCore.SwaggerGen.SwaggerGenerator.GeneratePathsAsync(IEnumerable`1 apiDescriptions, SchemaRepository schemaRepository)
   at Swashbuckle.AspNetCore.SwaggerGen.SwaggerGenerator.GetSwaggerAsync(String documentName, String host, String basePath)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
2025-04-19 09:29:34.117 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5053/swagger/v1/swagger.json - 500 null text/plain; charset=utf-8 142.0109ms
2025-04-19 09:30:22.465 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/api/message/GetMessages/3 - null null
2025-04-19 09:30:22.505 +07:00 [WRN] Failed to determine the https port for redirect.
2025-04-19 09:30:22.547 +07:00 [INF] Executing endpoint 'server.Controllers.MessageController.GetMessages (Message_app)'
2025-04-19 09:30:22.562 +07:00 [INF] Route matched with {action = "GetMessages", controller = "Message"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetMessages(Int32) on controller server.Controllers.MessageController (Message_app).
2025-04-19 09:30:22.578 +07:00 [INF] Retrieved 0 messages from Redis for conversation 3
2025-04-19 09:30:22.711 +07:00 [INF] Executed DbCommand (45ms) [Parameters=[@__p_1='?' (DbType = Int32), @__conversation_id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [t].[id], [t].[content], [t].[conversation_id], [t].[created_at], [t].[isFile], [t].[isRecalled], [t].[is_read], [t].[sender_id], [t].[type], [a].[id], [a].[FileSize], [a].[file_type], [a].[file_url], [a].[is_temporary], [a].[message_id], [a].[uploaded_at]
FROM (
    SELECT TOP(@__p_1) [m].[id], [m].[content], [m].[conversation_id], [m].[created_at], [m].[isFile], [m].[isRecalled], [m].[is_read], [m].[sender_id], [m].[type]
    FROM [Messages] AS [m]
    WHERE [m].[conversation_id] = @__conversation_id_0
    ORDER BY [m].[created_at] DESC
) AS [t]
LEFT JOIN [Attachments] AS [a] ON [t].[id] = [a].[message_id]
ORDER BY [t].[created_at] DESC, [t].[id]
2025-04-19 09:30:22.759 +07:00 [INF] Saved message 70 to Redis
2025-04-19 09:30:22.761 +07:00 [INF] Added message 70 to conversation 3
2025-04-19 09:30:22.762 +07:00 [INF] Saved message 65 to Redis
2025-04-19 09:30:22.763 +07:00 [INF] Added message 65 to conversation 3
2025-04-19 09:30:22.763 +07:00 [INF] Saved message 48 to Redis
2025-04-19 09:30:22.764 +07:00 [INF] Added message 48 to conversation 3
2025-04-19 09:30:22.764 +07:00 [INF] Cached 3 messages to Redis for conversation 3
2025-04-19 09:30:22.773 +07:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[server.DTO.MessageWithAttachment, Message_app, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-04-19 09:30:22.802 +07:00 [INF] Executed action server.Controllers.MessageController.GetMessages (Message_app) in 237.5511ms
2025-04-19 09:30:22.802 +07:00 [INF] Executed endpoint 'server.Controllers.MessageController.GetMessages (Message_app)'
2025-04-19 09:30:22.810 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5053/api/message/GetMessages/3 - 200 null application/json; charset=utf-8 344.8124ms
2025-04-19 09:30:23.712 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/favicon.ico - null null
2025-04-19 09:30:23.715 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5053/favicon.ico - 404 0 null 2.9816ms
2025-04-19 09:30:23.715 +07:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET http://localhost:5053/favicon.ico, Response status code: 404
2025-04-19 09:37:37.915 +07:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5053/api/Auth/login - null null
2025-04-19 09:37:37.917 +07:00 [INF] CORS policy execution successful.
2025-04-19 09:37:37.919 +07:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5053/api/Auth/login - 204 null null 3.0304ms
2025-04-19 09:37:37.920 +07:00 [INF] Request starting HTTP/1.1 POST http://localhost:5053/api/Auth/login - application/json 57
2025-04-19 09:37:37.921 +07:00 [INF] CORS policy execution successful.
2025-04-19 09:37:37.923 +07:00 [INF] CORS policy execution successful.
2025-04-19 09:37:37.925 +07:00 [INF] Executing endpoint 'Message_app.Controllers.AuthController.Login (Message_app)'
2025-04-19 09:37:37.934 +07:00 [INF] Route matched with {action = "Login", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Login(server.DTO.AuthDTO.LoginDTO) on controller Message_app.Controllers.AuthController (Message_app).
2025-04-19 09:37:38.217 +07:00 [INF] Executed DbCommand (16ms) [Parameters=[@__email_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[id], [u].[avatar_url], [u].[bio], [u].[birthday], [u].[created_at], [u].[email], [u].[gender], [u].[interests], [u].[location], [u].[password], [u].[passwordSalt], [u].[username]
FROM [Users] AS [u]
WHERE [u].[email] = @__email_0
2025-04-19 09:37:38.349 +07:00 [INF] Executing OkObjectResult, writing value of type 'server.DTO.AuthDTO.LoginRespose'.
2025-04-19 09:37:38.406 +07:00 [INF] Executed action Message_app.Controllers.AuthController.Login (Message_app) in 471.55ms
2025-04-19 09:37:38.406 +07:00 [INF] Executed endpoint 'Message_app.Controllers.AuthController.Login (Message_app)'
2025-04-19 09:37:38.406 +07:00 [INF] Request finished HTTP/1.1 POST http://localhost:5053/api/Auth/login - 200 null application/json; charset=utf-8 485.9807ms
2025-04-19 09:37:38.621 +07:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5053/api/Conversation/get_conversations/2 - null null
2025-04-19 09:37:38.621 +07:00 [INF] CORS policy execution successful.
2025-04-19 09:37:38.621 +07:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5053/api/Conversation/get_conversations/2 - 204 null null 0.603ms
2025-04-19 09:37:38.622 +07:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5053/api/Conversation/get_conversations/2 - null null
2025-04-19 09:37:38.622 +07:00 [INF] CORS policy execution successful.
2025-04-19 09:37:38.623 +07:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5053/api/Conversation/get_conversations/2 - 204 null null 0.4302ms
2025-04-19 09:37:38.623 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/api/Conversation/get_conversations/2 - null null
2025-04-19 09:37:38.623 +07:00 [INF] CORS policy execution successful.
2025-04-19 09:37:38.624 +07:00 [INF] CORS policy execution successful.
2025-04-19 09:37:38.624 +07:00 [INF] Executing endpoint 'server.Controllers.ConversationController.GetConversations (Message_app)'
2025-04-19 09:37:38.628 +07:00 [INF] Route matched with {action = "GetConversations", controller = "Conversation"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetConversations(Int32) on controller server.Controllers.ConversationController (Message_app).
2025-04-19 09:37:38.737 +07:00 [INF] Executed DbCommand (25ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[id], [c].[name], [c].[is_group], [c].[created_at], [c].[lastMessage], [c].[lastMessageTime], [t].[Id], [t].[UserId], [t].[ConversationId], [t].[Name], [t].[IsDeleted]
FROM [Conversations] AS [c]
LEFT JOIN (
    SELECT [p0].[id] AS [Id], [p0].[user_id] AS [UserId], [p0].[conversation_id] AS [ConversationId], [p0].[name] AS [Name], [p0].[is_deleted] AS [IsDeleted]
    FROM [Participants] AS [p0]
    WHERE [p0].[is_deleted] = CAST(0 AS bit)
) AS [t] ON [c].[id] = [t].[ConversationId]
WHERE EXISTS (
    SELECT 1
    FROM [Participants] AS [p]
    WHERE [c].[id] = [p].[conversation_id] AND [p].[user_id] = @__userId_0 AND [p].[is_deleted] = CAST(0 AS bit))
ORDER BY [c].[id]
2025-04-19 09:37:38.755 +07:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[server.DTO.ConversationDto, Message_app, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-04-19 09:37:38.759 +07:00 [INF] Executed action server.Controllers.ConversationController.GetConversations (Message_app) in 129.9036ms
2025-04-19 09:37:38.759 +07:00 [INF] Executed endpoint 'server.Controllers.ConversationController.GetConversations (Message_app)'
2025-04-19 09:37:38.760 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5053/api/Conversation/get_conversations/2 - 200 null application/json; charset=utf-8 136.4453ms
2025-04-19 09:37:38.763 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/api/Conversation/get_conversations/2 - null null
2025-04-19 09:37:38.765 +07:00 [INF] CORS policy execution successful.
2025-04-19 09:37:38.771 +07:00 [INF] CORS policy execution successful.
2025-04-19 09:37:38.773 +07:00 [INF] Executing endpoint 'server.Controllers.ConversationController.GetConversations (Message_app)'
2025-04-19 09:37:38.774 +07:00 [INF] Route matched with {action = "GetConversations", controller = "Conversation"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetConversations(Int32) on controller server.Controllers.ConversationController (Message_app).
2025-04-19 09:37:38.817 +07:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[server.DTO.ConversationDto, Message_app, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-04-19 09:37:38.818 +07:00 [INF] Executed action server.Controllers.ConversationController.GetConversations (Message_app) in 43.0703ms
2025-04-19 09:37:38.818 +07:00 [INF] Executed endpoint 'server.Controllers.ConversationController.GetConversations (Message_app)'
2025-04-19 09:37:38.818 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5053/api/Conversation/get_conversations/2 - 200 null application/json; charset=utf-8 55.5309ms
2025-04-19 09:37:38.942 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/ws/chat - null null
2025-04-19 09:37:38.942 +07:00 [INF] CORS policy execution successful.
2025-04-19 09:37:38.942 +07:00 [INF] CORS policy execution successful.
2025-04-19 09:37:38.942 +07:00 [INF] Executing endpoint '/ws/chat'
2025-04-19 09:37:38.994 +07:00 [INF] Executed DbCommand (5ms) [Parameters=[@__client_UserId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[conversation_id]
FROM [Participants] AS [p]
WHERE [p].[user_id] = @__client_UserId_0 AND [p].[is_deleted] = CAST(0 AS bit)
2025-04-19 09:37:39.016 +07:00 [INF] Executed DbCommand (6ms) [Parameters=[@__p_1='?' (DbType = Int32), @__conversationId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(@__p_1) [m].[id], [m].[conversation_id], [m].[sender_id], [m].[content], [m].[created_at], [m].[isFile], [m].[type], [m].[isRecalled]
FROM [Messages] AS [m]
WHERE [m].[conversation_id] = @__conversationId_0
ORDER BY [m].[created_at] DESC
2025-04-19 09:37:39.019 +07:00 [INF] Saved message 73 to Redis
2025-04-19 09:37:39.019 +07:00 [INF] Added message 73 to conversation 1
2025-04-19 09:37:39.023 +07:00 [INF] Saved message 72 to Redis
2025-04-19 09:37:39.023 +07:00 [INF] Added message 72 to conversation 1
2025-04-19 09:37:39.025 +07:00 [INF] Saved message 71 to Redis
2025-04-19 09:37:39.025 +07:00 [INF] Added message 71 to conversation 1
2025-04-19 09:37:39.026 +07:00 [INF] Saved message 68 to Redis
2025-04-19 09:37:39.027 +07:00 [INF] Added message 68 to conversation 1
2025-04-19 09:37:39.028 +07:00 [INF] Saved message 64 to Redis
2025-04-19 09:37:39.028 +07:00 [INF] Added message 64 to conversation 1
2025-04-19 09:37:39.029 +07:00 [INF] Saved message 62 to Redis
2025-04-19 09:37:39.029 +07:00 [INF] Added message 62 to conversation 1
2025-04-19 09:37:39.030 +07:00 [INF] Saved message 61 to Redis
2025-04-19 09:37:39.030 +07:00 [INF] Added message 61 to conversation 1
2025-04-19 09:37:39.031 +07:00 [INF] Saved message 60 to Redis
2025-04-19 09:37:39.032 +07:00 [INF] Added message 60 to conversation 1
2025-04-19 09:37:39.033 +07:00 [INF] Saved message 59 to Redis
2025-04-19 09:37:39.033 +07:00 [INF] Added message 59 to conversation 1
2025-04-19 09:37:39.034 +07:00 [INF] Saved message 57 to Redis
2025-04-19 09:37:39.034 +07:00 [INF] Added message 57 to conversation 1
2025-04-19 09:37:39.035 +07:00 [INF] Saved message 55 to Redis
2025-04-19 09:37:39.036 +07:00 [INF] Added message 55 to conversation 1
2025-04-19 09:37:39.038 +07:00 [INF] Saved message 54 to Redis
2025-04-19 09:37:39.039 +07:00 [INF] Added message 54 to conversation 1
2025-04-19 09:37:39.040 +07:00 [INF] Saved message 51 to Redis
2025-04-19 09:37:39.040 +07:00 [INF] Added message 51 to conversation 1
2025-04-19 09:37:39.041 +07:00 [INF] Saved message 49 to Redis
2025-04-19 09:37:39.041 +07:00 [INF] Added message 49 to conversation 1
2025-04-19 09:37:39.042 +07:00 [INF] Saved message 11 to Redis
2025-04-19 09:37:39.043 +07:00 [INF] Added message 11 to conversation 1
2025-04-19 09:37:39.044 +07:00 [INF] Saved message 8 to Redis
2025-04-19 09:37:39.044 +07:00 [INF] Added message 8 to conversation 1
2025-04-19 09:37:39.045 +07:00 [INF] Saved message 3 to Redis
2025-04-19 09:37:39.045 +07:00 [INF] Added message 3 to conversation 1
2025-04-19 09:37:39.046 +07:00 [INF] Saved message 2 to Redis
2025-04-19 09:37:39.047 +07:00 [INF] Added message 2 to conversation 1
2025-04-19 09:37:39.049 +07:00 [INF] Saved message 1 to Redis
2025-04-19 09:37:39.049 +07:00 [INF] Added message 1 to conversation 1
2025-04-19 09:37:39.064 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_1='?' (DbType = Int32), @__conversationId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(@__p_1) [m].[id], [m].[conversation_id], [m].[sender_id], [m].[content], [m].[created_at], [m].[isFile], [m].[type], [m].[isRecalled]
FROM [Messages] AS [m]
WHERE [m].[conversation_id] = @__conversationId_0
ORDER BY [m].[created_at] DESC
2025-04-19 09:37:39.067 +07:00 [INF] Saved message 69 to Redis
2025-04-19 09:37:39.076 +07:00 [INF] Added message 69 to conversation 4
2025-04-19 09:37:39.078 +07:00 [INF] Saved message 67 to Redis
2025-04-19 09:37:39.079 +07:00 [INF] Added message 67 to conversation 4
2025-04-19 09:37:39.081 +07:00 [INF] Saved message 66 to Redis
2025-04-19 09:37:39.082 +07:00 [INF] Added message 66 to conversation 4
2025-04-19 09:37:39.085 +07:00 [INF] Saved message 63 to Redis
2025-04-19 09:37:39.087 +07:00 [INF] Added message 63 to conversation 4
2025-04-19 09:37:39.091 +07:00 [INF] Saved message 58 to Redis
2025-04-19 09:37:39.093 +07:00 [INF] Added message 58 to conversation 4
2025-04-19 09:37:39.101 +07:00 [INF] Saved message 56 to Redis
2025-04-19 09:37:39.103 +07:00 [INF] Added message 56 to conversation 4
2025-04-19 09:37:39.105 +07:00 [INF] Saved message 53 to Redis
2025-04-19 09:37:39.106 +07:00 [INF] Added message 53 to conversation 4
2025-04-19 09:37:39.113 +07:00 [INF] Saved message 52 to Redis
2025-04-19 09:37:39.115 +07:00 [INF] Added message 52 to conversation 4
2025-04-19 09:37:39.119 +07:00 [INF] Saved message 50 to Redis
2025-04-19 09:37:39.120 +07:00 [INF] Added message 50 to conversation 4
2025-04-19 09:37:39.122 +07:00 [INF] Saved message 47 to Redis
2025-04-19 09:37:39.123 +07:00 [INF] Added message 47 to conversation 4
2025-04-19 09:37:39.128 +07:00 [INF] Saved message 46 to Redis
2025-04-19 09:37:39.129 +07:00 [INF] Added message 46 to conversation 4
2025-04-19 09:37:39.130 +07:00 [INF] Saved message 45 to Redis
2025-04-19 09:37:39.130 +07:00 [INF] Added message 45 to conversation 4
2025-04-19 09:37:39.131 +07:00 [INF] Saved message 44 to Redis
2025-04-19 09:37:39.132 +07:00 [INF] Added message 44 to conversation 4
2025-04-19 09:37:39.133 +07:00 [INF] Saved message 43 to Redis
2025-04-19 09:37:39.133 +07:00 [INF] Added message 43 to conversation 4
2025-04-19 09:37:39.135 +07:00 [INF] Saved message 42 to Redis
2025-04-19 09:37:39.135 +07:00 [INF] Added message 42 to conversation 4
2025-04-19 09:37:39.137 +07:00 [INF] Saved message 41 to Redis
2025-04-19 09:37:39.138 +07:00 [INF] Added message 41 to conversation 4
2025-04-19 09:37:39.144 +07:00 [INF] Saved message 40 to Redis
2025-04-19 09:37:39.145 +07:00 [INF] Added message 40 to conversation 4
2025-04-19 09:37:39.147 +07:00 [INF] Saved message 39 to Redis
2025-04-19 09:37:39.147 +07:00 [INF] Added message 39 to conversation 4
2025-04-19 09:37:39.149 +07:00 [INF] Saved message 38 to Redis
2025-04-19 09:37:39.149 +07:00 [INF] Added message 38 to conversation 4
2025-04-19 09:37:39.150 +07:00 [INF] Saved message 37 to Redis
2025-04-19 09:37:39.150 +07:00 [INF] Added message 37 to conversation 4
2025-04-19 09:37:39.151 +07:00 [INF] Saved message 36 to Redis
2025-04-19 09:37:39.152 +07:00 [INF] Added message 36 to conversation 4
2025-04-19 09:37:39.153 +07:00 [INF] Saved message 35 to Redis
2025-04-19 09:37:39.154 +07:00 [INF] Added message 35 to conversation 4
2025-04-19 09:37:39.156 +07:00 [INF] Saved message 34 to Redis
2025-04-19 09:37:39.157 +07:00 [INF] Added message 34 to conversation 4
2025-04-19 09:37:39.158 +07:00 [INF] Saved message 33 to Redis
2025-04-19 09:37:39.158 +07:00 [INF] Added message 33 to conversation 4
2025-04-19 09:37:39.159 +07:00 [INF] Saved message 32 to Redis
2025-04-19 09:37:39.159 +07:00 [INF] Added message 32 to conversation 4
2025-04-19 09:37:39.160 +07:00 [INF] Saved message 31 to Redis
2025-04-19 09:37:39.160 +07:00 [INF] Added message 31 to conversation 4
2025-04-19 09:37:39.161 +07:00 [INF] Saved message 30 to Redis
2025-04-19 09:37:39.162 +07:00 [INF] Added message 30 to conversation 4
2025-04-19 09:37:39.163 +07:00 [INF] Saved message 29 to Redis
2025-04-19 09:37:39.163 +07:00 [INF] Added message 29 to conversation 4
2025-04-19 09:37:39.164 +07:00 [INF] Saved message 28 to Redis
2025-04-19 09:37:39.164 +07:00 [INF] Added message 28 to conversation 4
2025-04-19 09:37:39.165 +07:00 [INF] Saved message 27 to Redis
2025-04-19 09:37:39.166 +07:00 [INF] Added message 27 to conversation 4
2025-04-19 09:37:39.166 +07:00 [INF] Saved message 26 to Redis
2025-04-19 09:37:39.167 +07:00 [INF] Added message 26 to conversation 4
2025-04-19 09:37:39.168 +07:00 [INF] Saved message 25 to Redis
2025-04-19 09:37:39.168 +07:00 [INF] Added message 25 to conversation 4
2025-04-19 09:37:39.169 +07:00 [INF] Saved message 24 to Redis
2025-04-19 09:37:39.169 +07:00 [INF] Added message 24 to conversation 4
2025-04-19 09:37:39.171 +07:00 [INF] Saved message 23 to Redis
2025-04-19 09:37:39.172 +07:00 [INF] Added message 23 to conversation 4
2025-04-19 09:37:39.173 +07:00 [INF] Saved message 22 to Redis
2025-04-19 09:37:39.174 +07:00 [INF] Added message 22 to conversation 4
2025-04-19 09:37:39.174 +07:00 [INF] Saved message 21 to Redis
2025-04-19 09:37:39.175 +07:00 [INF] Added message 21 to conversation 4
2025-04-19 09:37:39.176 +07:00 [INF] Saved message 20 to Redis
2025-04-19 09:37:39.176 +07:00 [INF] Added message 20 to conversation 4
2025-04-19 09:37:39.177 +07:00 [INF] Saved message 19 to Redis
2025-04-19 09:37:39.177 +07:00 [INF] Added message 19 to conversation 4
2025-04-19 09:37:39.178 +07:00 [INF] Saved message 18 to Redis
2025-04-19 09:37:39.178 +07:00 [INF] Added message 18 to conversation 4
2025-04-19 09:37:39.179 +07:00 [INF] Saved message 17 to Redis
2025-04-19 09:37:39.180 +07:00 [INF] Added message 17 to conversation 4
2025-04-19 09:37:39.181 +07:00 [INF] Saved message 16 to Redis
2025-04-19 09:37:39.181 +07:00 [INF] Added message 16 to conversation 4
2025-04-19 09:37:39.182 +07:00 [INF] Saved message 15 to Redis
2025-04-19 09:37:39.182 +07:00 [INF] Added message 15 to conversation 4
2025-04-19 09:37:39.184 +07:00 [INF] Saved message 14 to Redis
2025-04-19 09:37:39.184 +07:00 [INF] Added message 14 to conversation 4
2025-04-19 09:37:39.185 +07:00 [INF] Saved message 13 to Redis
2025-04-19 09:37:39.185 +07:00 [INF] Added message 13 to conversation 4
2025-04-19 09:37:39.186 +07:00 [INF] Saved message 12 to Redis
2025-04-19 09:37:39.199 +07:00 [INF] Added message 12 to conversation 4
2025-04-19 09:37:39.217 +07:00 [INF] Saved message 10 to Redis
2025-04-19 09:37:39.239 +07:00 [INF] Added message 10 to conversation 4
2025-04-19 09:37:39.255 +07:00 [INF] Saved message 7 to Redis
2025-04-19 09:37:39.261 +07:00 [INF] Added message 7 to conversation 4
2025-04-19 09:37:39.268 +07:00 [INF] Saved message 6 to Redis
2025-04-19 09:37:39.269 +07:00 [INF] Added message 6 to conversation 4
2025-04-19 09:37:39.278 +07:00 [INF] Saved message 5 to Redis
2025-04-19 09:37:39.283 +07:00 [INF] Added message 5 to conversation 4
2025-04-19 09:37:41.291 +07:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5053/api/Participant/get_participants/3 - null null
2025-04-19 09:37:41.292 +07:00 [INF] CORS policy execution successful.
2025-04-19 09:37:41.292 +07:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5053/api/Participant/get_participants/3 - 204 null null 0.9888ms
2025-04-19 09:37:41.295 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/api/Participant/get_participants/3 - null null
2025-04-19 09:37:41.295 +07:00 [INF] CORS policy execution successful.
2025-04-19 09:37:41.295 +07:00 [INF] CORS policy execution successful.
2025-04-19 09:37:41.295 +07:00 [INF] Executing endpoint 'server.Controllers.ParticipantController.GetParticipants (Message_app)'
2025-04-19 09:37:41.303 +07:00 [INF] Route matched with {action = "GetParticipants", controller = "Participant"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetParticipants(Int32) on controller server.Controllers.ParticipantController (Message_app).
2025-04-19 09:37:41.334 +07:00 [INF] Executed DbCommand (4ms) [Parameters=[@__conversation_id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[id], [p].[conversation_id], [p].[is_deleted], [p].[joined_at], [p].[name], [p].[role], [p].[user_id]
FROM [Participants] AS [p]
WHERE [p].[conversation_id] = @__conversation_id_0
2025-04-19 09:37:41.354 +07:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType15`1[[System.Collections.Generic.List`1[[server.Models.Participants, Message_app, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-04-19 09:37:41.369 +07:00 [INF] Executed action server.Controllers.ParticipantController.GetParticipants (Message_app) in 65.6497ms
2025-04-19 09:37:41.369 +07:00 [INF] Executed endpoint 'server.Controllers.ParticipantController.GetParticipants (Message_app)'
2025-04-19 09:37:41.369 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5053/api/Participant/get_participants/3 - 200 null application/json; charset=utf-8 74.554ms
2025-04-19 09:37:41.400 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/ws/chat - null null
2025-04-19 09:37:41.400 +07:00 [INF] CORS policy execution successful.
2025-04-19 09:37:41.402 +07:00 [INF] CORS policy execution successful.
2025-04-19 09:37:41.402 +07:00 [INF] Executing endpoint '/ws/chat'
2025-04-19 09:37:41.477 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__client_UserId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[conversation_id]
FROM [Participants] AS [p]
WHERE [p].[user_id] = @__client_UserId_0 AND [p].[is_deleted] = CAST(0 AS bit)
2025-04-19 09:37:41.509 +07:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5053/api/Message/getMessages/3 - null null
2025-04-19 09:37:41.509 +07:00 [INF] CORS policy execution successful.
2025-04-19 09:37:41.509 +07:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5053/api/Message/getMessages/3 - 204 null null 0.3942ms
2025-04-19 09:37:41.511 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/api/Message/getMessages/3 - null null
2025-04-19 09:37:41.511 +07:00 [INF] CORS policy execution successful.
2025-04-19 09:37:41.512 +07:00 [INF] CORS policy execution successful.
2025-04-19 09:37:41.513 +07:00 [INF] Executing endpoint 'server.Controllers.MessageController.GetMessages (Message_app)'
2025-04-19 09:37:41.513 +07:00 [INF] Route matched with {action = "GetMessages", controller = "Message"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetMessages(Int32) on controller server.Controllers.MessageController (Message_app).
2025-04-19 09:37:41.554 +07:00 [INF] Retrieved 3 messages from Redis for conversation 3
2025-04-19 09:37:41.554 +07:00 [INF] Retrieved 3 messages from Redis for conversation 3
2025-04-19 09:37:41.554 +07:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[server.DTO.MessageWithAttachment, Message_app, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-04-19 09:37:41.554 +07:00 [INF] Executed action server.Controllers.MessageController.GetMessages (Message_app) in 41.6971ms
2025-04-19 09:37:41.555 +07:00 [INF] Executed endpoint 'server.Controllers.MessageController.GetMessages (Message_app)'
2025-04-19 09:37:41.555 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5053/api/Message/getMessages/3 - 200 null application/json; charset=utf-8 44.1044ms
2025-04-19 09:37:41.571 +07:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5053/api/Conversation/get_first_conversation/3 - null null
2025-04-19 09:37:41.571 +07:00 [INF] CORS policy execution successful.
2025-04-19 09:37:41.571 +07:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5053/api/Conversation/get_first_conversation/3 - 204 null null 0.3702ms
2025-04-19 09:37:41.573 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/api/Conversation/get_first_conversation/3 - null null
2025-04-19 09:37:41.574 +07:00 [INF] CORS policy execution successful.
2025-04-19 09:37:41.574 +07:00 [INF] CORS policy execution successful.
2025-04-19 09:37:41.574 +07:00 [INF] Executing endpoint 'server.Controllers.ConversationController.GetFirstConversation (Message_app)'
2025-04-19 09:37:41.579 +07:00 [INF] Route matched with {action = "GetFirstConversation", controller = "Conversation"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetFirstConversation(Int32) on controller server.Controllers.ConversationController (Message_app).
2025-04-19 09:37:41.619 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[id], [c].[created_at], [c].[is_group], [c].[lastMessage], [c].[lastMessageSender], [c].[lastMessageTime], [c].[name]
FROM [Conversations] AS [c]
WHERE [c].[id] = @__p_0
2025-04-19 09:37:41.646 +07:00 [INF] Executing OkObjectResult, writing value of type 'server.Models.Conversation'.
2025-04-19 09:37:41.651 +07:00 [INF] Executed action server.Controllers.ConversationController.GetFirstConversation (Message_app) in 71.8937ms
2025-04-19 09:37:41.651 +07:00 [INF] Executed endpoint 'server.Controllers.ConversationController.GetFirstConversation (Message_app)'
2025-04-19 09:37:41.652 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5053/api/Conversation/get_first_conversation/3 - 200 null application/json; charset=utf-8 78.1309ms
2025-04-19 09:37:41.667 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/api/Participant/get_participants/3 - null null
2025-04-19 09:37:41.668 +07:00 [INF] CORS policy execution successful.
2025-04-19 09:37:41.669 +07:00 [INF] CORS policy execution successful.
2025-04-19 09:37:41.669 +07:00 [INF] Executing endpoint 'server.Controllers.ParticipantController.GetParticipants (Message_app)'
2025-04-19 09:37:41.670 +07:00 [INF] Route matched with {action = "GetParticipants", controller = "Participant"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetParticipants(Int32) on controller server.Controllers.ParticipantController (Message_app).
2025-04-19 09:37:41.675 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__conversation_id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[id], [p].[conversation_id], [p].[is_deleted], [p].[joined_at], [p].[name], [p].[role], [p].[user_id]
FROM [Participants] AS [p]
WHERE [p].[conversation_id] = @__conversation_id_0
2025-04-19 09:37:41.678 +07:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType15`1[[System.Collections.Generic.List`1[[server.Models.Participants, Message_app, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-04-19 09:37:41.679 +07:00 [INF] Executed action server.Controllers.ParticipantController.GetParticipants (Message_app) in 8.7147ms
2025-04-19 09:37:41.679 +07:00 [INF] Executed endpoint 'server.Controllers.ParticipantController.GetParticipants (Message_app)'
2025-04-19 09:37:41.679 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5053/api/Participant/get_participants/3 - 200 null application/json; charset=utf-8 11.6228ms
2025-04-19 09:37:45.257 +07:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5053/api/Participant/get_participants/4 - null null
2025-04-19 09:37:45.257 +07:00 [INF] CORS policy execution successful.
2025-04-19 09:37:45.258 +07:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5053/api/Participant/get_participants/4 - 204 null null 0.5525ms
2025-04-19 09:37:45.260 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/api/Participant/get_participants/4 - null null
2025-04-19 09:37:45.260 +07:00 [INF] CORS policy execution successful.
2025-04-19 09:37:45.261 +07:00 [INF] CORS policy execution successful.
2025-04-19 09:37:45.261 +07:00 [INF] Executing endpoint 'server.Controllers.ParticipantController.GetParticipants (Message_app)'
2025-04-19 09:37:45.261 +07:00 [INF] Route matched with {action = "GetParticipants", controller = "Participant"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetParticipants(Int32) on controller server.Controllers.ParticipantController (Message_app).
2025-04-19 09:37:45.264 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__conversation_id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[id], [p].[conversation_id], [p].[is_deleted], [p].[joined_at], [p].[name], [p].[role], [p].[user_id]
FROM [Participants] AS [p]
WHERE [p].[conversation_id] = @__conversation_id_0
2025-04-19 09:37:45.264 +07:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType15`1[[System.Collections.Generic.List`1[[server.Models.Participants, Message_app, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-04-19 09:37:45.265 +07:00 [INF] Executed action server.Controllers.ParticipantController.GetParticipants (Message_app) in 3.946ms
2025-04-19 09:37:45.265 +07:00 [INF] Executed endpoint 'server.Controllers.ParticipantController.GetParticipants (Message_app)'
2025-04-19 09:37:45.265 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5053/api/Participant/get_participants/4 - 200 null application/json; charset=utf-8 5.4268ms
2025-04-19 09:37:45.303 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/ws/chat - null null
2025-04-19 09:37:45.303 +07:00 [INF] CORS policy execution successful.
2025-04-19 09:37:45.304 +07:00 [INF] CORS policy execution successful.
2025-04-19 09:37:45.304 +07:00 [INF] Executing endpoint '/ws/chat'
2025-04-19 09:37:45.373 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__client_UserId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[conversation_id]
FROM [Participants] AS [p]
WHERE [p].[user_id] = @__client_UserId_0 AND [p].[is_deleted] = CAST(0 AS bit)
2025-04-19 09:37:45.375 +07:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5053/api/Message/getMessages/4 - null null
2025-04-19 09:37:45.375 +07:00 [INF] CORS policy execution successful.
2025-04-19 09:37:45.375 +07:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5053/api/Message/getMessages/4 - 204 null null 0.3028ms
2025-04-19 09:37:45.378 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/api/Message/getMessages/4 - null null
2025-04-19 09:37:45.378 +07:00 [INF] CORS policy execution successful.
2025-04-19 09:37:45.378 +07:00 [INF] CORS policy execution successful.
2025-04-19 09:37:45.378 +07:00 [INF] Executing endpoint 'server.Controllers.MessageController.GetMessages (Message_app)'
2025-04-19 09:37:45.378 +07:00 [INF] Route matched with {action = "GetMessages", controller = "Message"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetMessages(Int32) on controller server.Controllers.MessageController (Message_app).
2025-04-19 09:37:45.412 +07:00 [INF] Retrieved 49 messages from Redis for conversation 4
2025-04-19 09:37:45.412 +07:00 [INF] Retrieved 49 messages from Redis for conversation 4
2025-04-19 09:37:45.412 +07:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[server.DTO.MessageWithAttachment, Message_app, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-04-19 09:37:45.413 +07:00 [INF] Executed action server.Controllers.MessageController.GetMessages (Message_app) in 34.9556ms
2025-04-19 09:37:45.414 +07:00 [INF] Executed endpoint 'server.Controllers.MessageController.GetMessages (Message_app)'
2025-04-19 09:37:45.414 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5053/api/Message/getMessages/4 - 200 null application/json; charset=utf-8 35.8025ms
2025-04-19 09:37:45.434 +07:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5053/api/Conversation/get_first_conversation/4 - null null
2025-04-19 09:37:45.434 +07:00 [INF] CORS policy execution successful.
2025-04-19 09:37:45.435 +07:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5053/api/Conversation/get_first_conversation/4 - 204 null null 1.0532ms
2025-04-19 09:37:45.439 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/api/Conversation/get_first_conversation/4 - null null
2025-04-19 09:37:45.439 +07:00 [INF] CORS policy execution successful.
2025-04-19 09:37:45.439 +07:00 [INF] CORS policy execution successful.
2025-04-19 09:37:45.439 +07:00 [INF] Executing endpoint 'server.Controllers.ConversationController.GetFirstConversation (Message_app)'
2025-04-19 09:37:45.439 +07:00 [INF] Route matched with {action = "GetFirstConversation", controller = "Conversation"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetFirstConversation(Int32) on controller server.Controllers.ConversationController (Message_app).
2025-04-19 09:37:45.444 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[id], [c].[created_at], [c].[is_group], [c].[lastMessage], [c].[lastMessageSender], [c].[lastMessageTime], [c].[name]
FROM [Conversations] AS [c]
WHERE [c].[id] = @__p_0
2025-04-19 09:37:45.445 +07:00 [INF] Executing OkObjectResult, writing value of type 'server.Models.Conversation'.
2025-04-19 09:37:45.445 +07:00 [INF] Executed action server.Controllers.ConversationController.GetFirstConversation (Message_app) in 6.0744ms
2025-04-19 09:37:45.446 +07:00 [INF] Executed endpoint 'server.Controllers.ConversationController.GetFirstConversation (Message_app)'
2025-04-19 09:37:45.449 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5053/api/Conversation/get_first_conversation/4 - 200 null application/json; charset=utf-8 10.3276ms
2025-04-19 09:37:45.467 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/api/Participant/get_participants/4 - null null
2025-04-19 09:37:45.468 +07:00 [INF] CORS policy execution successful.
2025-04-19 09:37:45.468 +07:00 [INF] CORS policy execution successful.
2025-04-19 09:37:45.468 +07:00 [INF] Executing endpoint 'server.Controllers.ParticipantController.GetParticipants (Message_app)'
2025-04-19 09:37:45.468 +07:00 [INF] Route matched with {action = "GetParticipants", controller = "Participant"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetParticipants(Int32) on controller server.Controllers.ParticipantController (Message_app).
2025-04-19 09:37:45.472 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__conversation_id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[id], [p].[conversation_id], [p].[is_deleted], [p].[joined_at], [p].[name], [p].[role], [p].[user_id]
FROM [Participants] AS [p]
WHERE [p].[conversation_id] = @__conversation_id_0
2025-04-19 09:37:45.473 +07:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType15`1[[System.Collections.Generic.List`1[[server.Models.Participants, Message_app, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-04-19 09:37:45.473 +07:00 [INF] Executed action server.Controllers.ParticipantController.GetParticipants (Message_app) in 4.5141ms
2025-04-19 09:37:45.473 +07:00 [INF] Executed endpoint 'server.Controllers.ParticipantController.GetParticipants (Message_app)'
2025-04-19 09:37:45.473 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5053/api/Participant/get_participants/4 - 200 null application/json; charset=utf-8 6.0492ms
2025-04-19 09:38:34.804 +07:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5053/api/Auth/login - null null
2025-04-19 09:38:34.804 +07:00 [INF] CORS policy execution successful.
2025-04-19 09:38:34.805 +07:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5053/api/Auth/login - 204 null null 0.4711ms
2025-04-19 09:38:34.806 +07:00 [INF] Request starting HTTP/1.1 POST http://localhost:5053/api/Auth/login - application/json 53
2025-04-19 09:38:34.806 +07:00 [INF] CORS policy execution successful.
2025-04-19 09:38:34.808 +07:00 [INF] CORS policy execution successful.
2025-04-19 09:38:34.808 +07:00 [INF] Executing endpoint 'Message_app.Controllers.AuthController.Login (Message_app)'
2025-04-19 09:38:34.809 +07:00 [INF] Route matched with {action = "Login", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Login(server.DTO.AuthDTO.LoginDTO) on controller Message_app.Controllers.AuthController (Message_app).
2025-04-19 09:38:34.827 +07:00 [INF] Executed DbCommand (11ms) [Parameters=[@__email_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[id], [u].[avatar_url], [u].[bio], [u].[birthday], [u].[created_at], [u].[email], [u].[gender], [u].[interests], [u].[location], [u].[password], [u].[passwordSalt], [u].[username]
FROM [Users] AS [u]
WHERE [u].[email] = @__email_0
2025-04-19 09:38:34.828 +07:00 [INF] Executing OkObjectResult, writing value of type 'server.DTO.AuthDTO.LoginRespose'.
2025-04-19 09:38:34.828 +07:00 [INF] Executed action Message_app.Controllers.AuthController.Login (Message_app) in 19.2188ms
2025-04-19 09:38:34.828 +07:00 [INF] Executed endpoint 'Message_app.Controllers.AuthController.Login (Message_app)'
2025-04-19 09:38:34.828 +07:00 [INF] Request finished HTTP/1.1 POST http://localhost:5053/api/Auth/login - 200 null application/json; charset=utf-8 22.2643ms
2025-04-19 09:38:35.043 +07:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5053/api/Conversation/get_conversations/5 - null null
2025-04-19 09:38:35.043 +07:00 [INF] CORS policy execution successful.
2025-04-19 09:38:35.043 +07:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5053/api/Conversation/get_conversations/5 - 204 null null 0.288ms
2025-04-19 09:38:35.043 +07:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5053/api/Conversation/get_conversations/5 - null null
2025-04-19 09:38:35.043 +07:00 [INF] CORS policy execution successful.
2025-04-19 09:38:35.043 +07:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5053/api/Conversation/get_conversations/5 - 204 null null 0.1698ms
2025-04-19 09:38:35.051 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/api/Conversation/get_conversations/5 - null null
2025-04-19 09:38:35.051 +07:00 [INF] CORS policy execution successful.
2025-04-19 09:38:35.051 +07:00 [INF] CORS policy execution successful.
2025-04-19 09:38:35.051 +07:00 [INF] Executing endpoint 'server.Controllers.ConversationController.GetConversations (Message_app)'
2025-04-19 09:38:35.052 +07:00 [INF] Route matched with {action = "GetConversations", controller = "Conversation"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetConversations(Int32) on controller server.Controllers.ConversationController (Message_app).
2025-04-19 09:38:35.081 +07:00 [INF] Executed DbCommand (19ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[id], [c].[name], [c].[is_group], [c].[created_at], [c].[lastMessage], [c].[lastMessageTime], [t].[Id], [t].[UserId], [t].[ConversationId], [t].[Name], [t].[IsDeleted]
FROM [Conversations] AS [c]
LEFT JOIN (
    SELECT [p0].[id] AS [Id], [p0].[user_id] AS [UserId], [p0].[conversation_id] AS [ConversationId], [p0].[name] AS [Name], [p0].[is_deleted] AS [IsDeleted]
    FROM [Participants] AS [p0]
    WHERE [p0].[is_deleted] = CAST(0 AS bit)
) AS [t] ON [c].[id] = [t].[ConversationId]
WHERE EXISTS (
    SELECT 1
    FROM [Participants] AS [p]
    WHERE [c].[id] = [p].[conversation_id] AND [p].[user_id] = @__userId_0 AND [p].[is_deleted] = CAST(0 AS bit))
ORDER BY [c].[id]
2025-04-19 09:38:35.082 +07:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[server.DTO.ConversationDto, Message_app, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-04-19 09:38:35.083 +07:00 [INF] Executed action server.Controllers.ConversationController.GetConversations (Message_app) in 31.5792ms
2025-04-19 09:38:35.083 +07:00 [INF] Executed endpoint 'server.Controllers.ConversationController.GetConversations (Message_app)'
2025-04-19 09:38:35.084 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5053/api/Conversation/get_conversations/5 - 200 null application/json; charset=utf-8 32.6422ms
2025-04-19 09:38:35.085 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/api/Conversation/get_conversations/5 - null null
2025-04-19 09:38:35.085 +07:00 [INF] CORS policy execution successful.
2025-04-19 09:38:35.085 +07:00 [INF] CORS policy execution successful.
2025-04-19 09:38:35.085 +07:00 [INF] Executing endpoint 'server.Controllers.ConversationController.GetConversations (Message_app)'
2025-04-19 09:38:35.086 +07:00 [INF] Route matched with {action = "GetConversations", controller = "Conversation"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetConversations(Int32) on controller server.Controllers.ConversationController (Message_app).
2025-04-19 09:38:35.087 +07:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[server.DTO.ConversationDto, Message_app, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-04-19 09:38:35.089 +07:00 [INF] Executed action server.Controllers.ConversationController.GetConversations (Message_app) in 3.607ms
2025-04-19 09:38:35.089 +07:00 [INF] Executed endpoint 'server.Controllers.ConversationController.GetConversations (Message_app)'
2025-04-19 09:38:35.090 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5053/api/Conversation/get_conversations/5 - 200 null application/json; charset=utf-8 4.4064ms
2025-04-19 09:38:35.187 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/ws/chat - null null
2025-04-19 09:38:35.187 +07:00 [INF] CORS policy execution successful.
2025-04-19 09:38:35.188 +07:00 [INF] CORS policy execution successful.
2025-04-19 09:38:35.188 +07:00 [INF] Executing endpoint '/ws/chat'
2025-04-19 09:38:35.199 +07:00 [INF] Executed DbCommand (4ms) [Parameters=[@__client_UserId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[conversation_id]
FROM [Participants] AS [p]
WHERE [p].[user_id] = @__client_UserId_0 AND [p].[is_deleted] = CAST(0 AS bit)
2025-04-19 09:38:42.629 +07:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5053/api/Participant/get_participants/1 - null null
2025-04-19 09:38:42.629 +07:00 [INF] CORS policy execution successful.
2025-04-19 09:38:42.629 +07:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5053/api/Participant/get_participants/1 - 204 null null 0.4605ms
2025-04-19 09:38:42.632 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/api/Participant/get_participants/1 - null null
2025-04-19 09:38:42.633 +07:00 [INF] CORS policy execution successful.
2025-04-19 09:38:42.633 +07:00 [INF] CORS policy execution successful.
2025-04-19 09:38:42.634 +07:00 [INF] Executing endpoint 'server.Controllers.ParticipantController.GetParticipants (Message_app)'
2025-04-19 09:38:42.634 +07:00 [INF] Route matched with {action = "GetParticipants", controller = "Participant"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetParticipants(Int32) on controller server.Controllers.ParticipantController (Message_app).
2025-04-19 09:38:42.649 +07:00 [INF] Executed DbCommand (13ms) [Parameters=[@__conversation_id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[id], [p].[conversation_id], [p].[is_deleted], [p].[joined_at], [p].[name], [p].[role], [p].[user_id]
FROM [Participants] AS [p]
WHERE [p].[conversation_id] = @__conversation_id_0
2025-04-19 09:38:42.660 +07:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType15`1[[System.Collections.Generic.List`1[[server.Models.Participants, Message_app, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-04-19 09:38:42.661 +07:00 [INF] Executed action server.Controllers.ParticipantController.GetParticipants (Message_app) in 27.4975ms
2025-04-19 09:38:42.662 +07:00 [INF] Executed endpoint 'server.Controllers.ParticipantController.GetParticipants (Message_app)'
2025-04-19 09:38:42.662 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5053/api/Participant/get_participants/1 - 200 null application/json; charset=utf-8 29.3438ms
2025-04-19 09:38:42.693 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/ws/chat - null null
2025-04-19 09:38:42.693 +07:00 [INF] CORS policy execution successful.
2025-04-19 09:38:42.694 +07:00 [INF] CORS policy execution successful.
2025-04-19 09:38:42.694 +07:00 [INF] Executing endpoint '/ws/chat'
2025-04-19 09:38:42.774 +07:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5053/api/Message/getMessages/1 - null null
2025-04-19 09:38:42.774 +07:00 [INF] CORS policy execution successful.
2025-04-19 09:38:42.774 +07:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5053/api/Message/getMessages/1 - 204 null null 0.2716ms
2025-04-19 09:38:42.790 +07:00 [INF] Executed DbCommand (18ms) [Parameters=[@__client_UserId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[conversation_id]
FROM [Participants] AS [p]
WHERE [p].[user_id] = @__client_UserId_0 AND [p].[is_deleted] = CAST(0 AS bit)
2025-04-19 09:38:42.795 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/api/Message/getMessages/1 - null null
2025-04-19 09:38:42.795 +07:00 [INF] CORS policy execution successful.
2025-04-19 09:38:42.796 +07:00 [INF] CORS policy execution successful.
2025-04-19 09:38:42.796 +07:00 [INF] Executing endpoint 'server.Controllers.MessageController.GetMessages (Message_app)'
2025-04-19 09:38:42.796 +07:00 [INF] Route matched with {action = "GetMessages", controller = "Message"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetMessages(Int32) on controller server.Controllers.MessageController (Message_app).
2025-04-19 09:38:42.821 +07:00 [INF] Retrieved 19 messages from Redis for conversation 1
2025-04-19 09:38:42.821 +07:00 [INF] Retrieved 19 messages from Redis for conversation 1
2025-04-19 09:38:42.822 +07:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[server.DTO.MessageWithAttachment, Message_app, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-04-19 09:38:42.822 +07:00 [INF] Executed action server.Controllers.MessageController.GetMessages (Message_app) in 26.2982ms
2025-04-19 09:38:42.822 +07:00 [INF] Executed endpoint 'server.Controllers.MessageController.GetMessages (Message_app)'
2025-04-19 09:38:42.823 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5053/api/Message/getMessages/1 - 200 null application/json; charset=utf-8 27.0866ms
2025-04-19 09:38:42.841 +07:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5053/api/Conversation/get_first_conversation/1 - null null
2025-04-19 09:38:42.841 +07:00 [INF] CORS policy execution successful.
2025-04-19 09:38:42.841 +07:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5053/api/Conversation/get_first_conversation/1 - 204 null null 0.3114ms
2025-04-19 09:38:42.844 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/api/Conversation/get_first_conversation/1 - null null
2025-04-19 09:38:42.844 +07:00 [INF] CORS policy execution successful.
2025-04-19 09:38:42.844 +07:00 [INF] CORS policy execution successful.
2025-04-19 09:38:42.844 +07:00 [INF] Executing endpoint 'server.Controllers.ConversationController.GetFirstConversation (Message_app)'
2025-04-19 09:38:42.844 +07:00 [INF] Route matched with {action = "GetFirstConversation", controller = "Conversation"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetFirstConversation(Int32) on controller server.Controllers.ConversationController (Message_app).
2025-04-19 09:38:42.857 +07:00 [INF] Executed DbCommand (10ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[id], [c].[created_at], [c].[is_group], [c].[lastMessage], [c].[lastMessageSender], [c].[lastMessageTime], [c].[name]
FROM [Conversations] AS [c]
WHERE [c].[id] = @__p_0
2025-04-19 09:38:42.857 +07:00 [INF] Executing OkObjectResult, writing value of type 'server.Models.Conversation'.
2025-04-19 09:38:42.857 +07:00 [INF] Executed action server.Controllers.ConversationController.GetFirstConversation (Message_app) in 13.0644ms
2025-04-19 09:38:42.857 +07:00 [INF] Executed endpoint 'server.Controllers.ConversationController.GetFirstConversation (Message_app)'
2025-04-19 09:38:42.857 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5053/api/Conversation/get_first_conversation/1 - 200 null application/json; charset=utf-8 13.7466ms
2025-04-19 09:38:42.874 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/api/Participant/get_participants/1 - null null
2025-04-19 09:38:42.874 +07:00 [INF] CORS policy execution successful.
2025-04-19 09:38:42.874 +07:00 [INF] CORS policy execution successful.
2025-04-19 09:38:42.874 +07:00 [INF] Executing endpoint 'server.Controllers.ParticipantController.GetParticipants (Message_app)'
2025-04-19 09:38:42.875 +07:00 [INF] Route matched with {action = "GetParticipants", controller = "Participant"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetParticipants(Int32) on controller server.Controllers.ParticipantController (Message_app).
2025-04-19 09:38:42.886 +07:00 [INF] Executed DbCommand (10ms) [Parameters=[@__conversation_id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[id], [p].[conversation_id], [p].[is_deleted], [p].[joined_at], [p].[name], [p].[role], [p].[user_id]
FROM [Participants] AS [p]
WHERE [p].[conversation_id] = @__conversation_id_0
2025-04-19 09:38:42.887 +07:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType15`1[[System.Collections.Generic.List`1[[server.Models.Participants, Message_app, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-04-19 09:38:42.888 +07:00 [INF] Executed action server.Controllers.ParticipantController.GetParticipants (Message_app) in 13.0573ms
2025-04-19 09:38:42.888 +07:00 [INF] Executed endpoint 'server.Controllers.ParticipantController.GetParticipants (Message_app)'
2025-04-19 09:38:42.888 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5053/api/Participant/get_participants/1 - 200 null application/json; charset=utf-8 14.3543ms
2025-04-19 09:38:43.232 +07:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5053/api/Participant/get_participants/1 - null null
2025-04-19 09:38:43.232 +07:00 [INF] CORS policy execution successful.
2025-04-19 09:38:43.232 +07:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5053/api/Participant/get_participants/1 - 204 null null 0.3108ms
2025-04-19 09:38:43.234 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/api/Participant/get_participants/1 - null null
2025-04-19 09:38:43.235 +07:00 [INF] CORS policy execution successful.
2025-04-19 09:38:43.235 +07:00 [INF] CORS policy execution successful.
2025-04-19 09:38:43.235 +07:00 [INF] Executing endpoint 'server.Controllers.ParticipantController.GetParticipants (Message_app)'
2025-04-19 09:38:43.236 +07:00 [INF] Route matched with {action = "GetParticipants", controller = "Participant"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetParticipants(Int32) on controller server.Controllers.ParticipantController (Message_app).
2025-04-19 09:38:43.249 +07:00 [INF] Executed DbCommand (12ms) [Parameters=[@__conversation_id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[id], [p].[conversation_id], [p].[is_deleted], [p].[joined_at], [p].[name], [p].[role], [p].[user_id]
FROM [Participants] AS [p]
WHERE [p].[conversation_id] = @__conversation_id_0
2025-04-19 09:38:43.249 +07:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType15`1[[System.Collections.Generic.List`1[[server.Models.Participants, Message_app, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-04-19 09:38:43.250 +07:00 [INF] Executed action server.Controllers.ParticipantController.GetParticipants (Message_app) in 14.2643ms
2025-04-19 09:38:43.250 +07:00 [INF] Executed endpoint 'server.Controllers.ParticipantController.GetParticipants (Message_app)'
2025-04-19 09:38:43.250 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5053/api/Participant/get_participants/1 - 200 null application/json; charset=utf-8 15.819ms
2025-04-19 09:38:43.287 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/ws/chat - null null
2025-04-19 09:38:43.288 +07:00 [INF] CORS policy execution successful.
2025-04-19 09:38:43.288 +07:00 [INF] CORS policy execution successful.
2025-04-19 09:38:43.288 +07:00 [INF] Executing endpoint '/ws/chat'
2025-04-19 09:38:43.401 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[@__client_UserId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[conversation_id]
FROM [Participants] AS [p]
WHERE [p].[user_id] = @__client_UserId_0 AND [p].[is_deleted] = CAST(0 AS bit)
2025-04-19 09:38:43.402 +07:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5053/api/Message/getMessages/1 - null null
2025-04-19 09:38:43.402 +07:00 [INF] CORS policy execution successful.
2025-04-19 09:38:43.402 +07:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5053/api/Message/getMessages/1 - 204 null null 0.3209ms
2025-04-19 09:38:43.404 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/api/Message/getMessages/1 - null null
2025-04-19 09:38:43.404 +07:00 [INF] CORS policy execution successful.
2025-04-19 09:38:43.404 +07:00 [INF] CORS policy execution successful.
2025-04-19 09:38:43.404 +07:00 [INF] Executing endpoint 'server.Controllers.MessageController.GetMessages (Message_app)'
2025-04-19 09:38:43.405 +07:00 [INF] Route matched with {action = "GetMessages", controller = "Message"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetMessages(Int32) on controller server.Controllers.MessageController (Message_app).
2025-04-19 09:38:43.416 +07:00 [INF] Retrieved 19 messages from Redis for conversation 1
2025-04-19 09:38:43.416 +07:00 [INF] Retrieved 19 messages from Redis for conversation 1
2025-04-19 09:38:43.416 +07:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[server.DTO.MessageWithAttachment, Message_app, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-04-19 09:38:43.417 +07:00 [INF] Executed action server.Controllers.MessageController.GetMessages (Message_app) in 12.201ms
2025-04-19 09:38:43.417 +07:00 [INF] Executed endpoint 'server.Controllers.MessageController.GetMessages (Message_app)'
2025-04-19 09:38:43.417 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5053/api/Message/getMessages/1 - 200 null application/json; charset=utf-8 13.2644ms
2025-04-19 09:38:43.435 +07:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5053/api/Conversation/get_first_conversation/1 - null null
2025-04-19 09:38:43.435 +07:00 [INF] CORS policy execution successful.
2025-04-19 09:38:43.435 +07:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5053/api/Conversation/get_first_conversation/1 - 204 null null 0.2775ms
2025-04-19 09:38:43.436 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/api/Conversation/get_first_conversation/1 - null null
2025-04-19 09:38:43.437 +07:00 [INF] CORS policy execution successful.
2025-04-19 09:38:43.437 +07:00 [INF] CORS policy execution successful.
2025-04-19 09:38:43.437 +07:00 [INF] Executing endpoint 'server.Controllers.ConversationController.GetFirstConversation (Message_app)'
2025-04-19 09:38:43.437 +07:00 [INF] Route matched with {action = "GetFirstConversation", controller = "Conversation"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetFirstConversation(Int32) on controller server.Controllers.ConversationController (Message_app).
2025-04-19 09:38:43.451 +07:00 [INF] Executed DbCommand (11ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[id], [c].[created_at], [c].[is_group], [c].[lastMessage], [c].[lastMessageSender], [c].[lastMessageTime], [c].[name]
FROM [Conversations] AS [c]
WHERE [c].[id] = @__p_0
2025-04-19 09:38:43.452 +07:00 [INF] Executing OkObjectResult, writing value of type 'server.Models.Conversation'.
2025-04-19 09:38:43.453 +07:00 [INF] Executed action server.Controllers.ConversationController.GetFirstConversation (Message_app) in 15.6236ms
2025-04-19 09:38:43.453 +07:00 [INF] Executed endpoint 'server.Controllers.ConversationController.GetFirstConversation (Message_app)'
2025-04-19 09:38:43.453 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5053/api/Conversation/get_first_conversation/1 - 200 null application/json; charset=utf-8 16.4617ms
2025-04-19 09:38:43.469 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/api/Participant/get_participants/1 - null null
2025-04-19 09:38:43.469 +07:00 [INF] CORS policy execution successful.
2025-04-19 09:38:43.469 +07:00 [INF] CORS policy execution successful.
2025-04-19 09:38:43.469 +07:00 [INF] Executing endpoint 'server.Controllers.ParticipantController.GetParticipants (Message_app)'
2025-04-19 09:38:43.470 +07:00 [INF] Route matched with {action = "GetParticipants", controller = "Participant"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetParticipants(Int32) on controller server.Controllers.ParticipantController (Message_app).
2025-04-19 09:38:43.483 +07:00 [INF] Executed DbCommand (11ms) [Parameters=[@__conversation_id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[id], [p].[conversation_id], [p].[is_deleted], [p].[joined_at], [p].[name], [p].[role], [p].[user_id]
FROM [Participants] AS [p]
WHERE [p].[conversation_id] = @__conversation_id_0
2025-04-19 09:38:43.484 +07:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType15`1[[System.Collections.Generic.List`1[[server.Models.Participants, Message_app, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-04-19 09:38:43.485 +07:00 [INF] Executed action server.Controllers.ParticipantController.GetParticipants (Message_app) in 14.6519ms
2025-04-19 09:38:43.485 +07:00 [INF] Executed endpoint 'server.Controllers.ParticipantController.GetParticipants (Message_app)'
2025-04-19 09:38:43.485 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5053/api/Participant/get_participants/1 - 200 null application/json; charset=utf-8 15.7216ms
2025-04-19 09:38:46.324 +07:00 [INF] Handling message from user 5: asdads
2025-04-19 09:38:46.336 +07:00 [INF] Executed DbCommand (10ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[id], [c].[created_at], [c].[is_group], [c].[lastMessage], [c].[lastMessageSender], [c].[lastMessageTime], [c].[name]
FROM [Conversations] AS [c]
WHERE [c].[id] = @__p_0
2025-04-19 09:38:46.560 +07:00 [WRN] Savepoints are disabled because Multiple Active Result Sets (MARS) is enabled. If 'SaveChanges' fails, then the transaction cannot be automatically rolled back to a known clean state. Instead, the transaction should be rolled back by the application before retrying 'SaveChanges'. See https://go.microsoft.com/fwlink/?linkid=2149338 for more information and examples. To identify the code which triggers this warning, call 'ConfigureWarnings(w => w.Throw(SqlServerEventId.SavepointsDisabledBecauseOfMARS))'.
2025-04-19 09:38:46.596 +07:00 [INF] Executed DbCommand (32ms) [Parameters=[@p0='?' (Size = 500), @p1='?' (DbType = Int32), @p2='?' (DbType = DateTime2), @p3='?' (DbType = Boolean), @p4='?' (DbType = Boolean), @p5='?' (DbType = Boolean), @p6='?' (DbType = Int32), @p7='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Messages] ([content], [conversation_id], [created_at], [isFile], [isRecalled], [is_read], [sender_id], [type])
OUTPUT INSERTED.[id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7);
2025-04-19 09:38:46.624 +07:00 [INF] Message saved to DB with ID: 74
2025-04-19 09:38:46.629 +07:00 [WRN] Savepoints are disabled because Multiple Active Result Sets (MARS) is enabled. If 'SaveChanges' fails, then the transaction cannot be automatically rolled back to a known clean state. Instead, the transaction should be rolled back by the application before retrying 'SaveChanges'. See https://go.microsoft.com/fwlink/?linkid=2149338 for more information and examples. To identify the code which triggers this warning, call 'ConfigureWarnings(w => w.Throw(SqlServerEventId.SavepointsDisabledBecauseOfMARS))'.
2025-04-19 09:38:46.638 +07:00 [INF] Executed DbCommand (9ms) [Parameters=[@p6='?' (DbType = Int32), @p0='?' (DbType = DateTime2), @p1='?' (DbType = Boolean), @p2='?' (Size = 4000), @p3='?' (Size = 4000), @p4='?' (DbType = DateTime2), @p5='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
UPDATE [Conversations] SET [created_at] = @p0, [is_group] = @p1, [lastMessage] = @p2, [lastMessageSender] = @p3, [lastMessageTime] = @p4, [name] = @p5
OUTPUT 1
WHERE [id] = @p6;
2025-04-19 09:38:46.653 +07:00 [INF] Transaction committed for message: 74
2025-04-19 09:38:46.655 +07:00 [INF] Saved message 74 to Redis
2025-04-19 09:38:46.655 +07:00 [INF] Added message 74 to conversation 1
2025-04-19 09:38:46.664 +07:00 [INF] Published message to channel conversation:1
2025-04-19 09:39:10.287 +07:00 [INF] Executed endpoint '/ws/chat'
2025-04-19 09:39:10.287 +07:00 [INF] Executed endpoint '/ws/chat'
2025-04-19 09:39:10.287 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5053/ws/chat - 101 null null 26999.8769ms
2025-04-19 09:39:10.287 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5053/ws/chat - 101 null null 35099.9117ms
2025-04-19 10:09:23.075 +07:00 [INF] Application is shutting down...
2025-04-19 10:09:53.098 +07:00 [INF] Executed endpoint '/ws/chat'
2025-04-19 10:09:53.098 +07:00 [INF] Executed endpoint '/ws/chat'
2025-04-19 10:09:53.098 +07:00 [INF] Executed endpoint '/ws/chat'
2025-04-19 10:09:53.098 +07:00 [INF] Executed endpoint '/ws/chat'
2025-04-19 10:09:53.100 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5053/ws/chat - 101 null null 1934157.8315ms
2025-04-19 10:09:53.100 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5053/ws/chat - 101 null null 1931699.9267ms
2025-04-19 10:09:53.100 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5053/ws/chat - 101 null null 1927797.9209ms
2025-04-19 10:09:53.101 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5053/ws/chat - 101 null null 1870407.4142ms
