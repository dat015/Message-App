2025-05-01 23:31:30.941 +07:00 [INF] Executed DbCommand (28ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [u].[id], [u].[username], [u].[avatar_url]
FROM [Users] AS [u]
2025-05-01 23:31:31.071 +07:00 [INF] User profile is available. Using 'C:\Users\Thao\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-05-01 23:31:31.255 +07:00 [WRN] Overriding address(es) 'http://localhost:5053'. Binding to endpoints defined via IConfiguration and/or UseKestrel() instead.
2025-05-01 23:31:31.265 +07:00 [INF] Now listening on: http://[::]:5053
2025-05-01 23:31:31.265 +07:00 [INF] Now listening on: http://0.0.0.0:5053
2025-05-01 23:31:31.265 +07:00 [INF] Application started. Press Ctrl+C to shut down.
2025-05-01 23:31:31.265 +07:00 [INF] Hosting environment: Development
2025-05-01 23:31:31.265 +07:00 [INF] Content root path: C:\Users\Thao\source\Flutter\Message_app\server
2025-05-01 23:31:31.409 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/ws/chat?userId=5 - null null
2025-05-01 23:31:31.433 +07:00 [INF] CORS policy execution successful.
2025-05-01 23:31:31.452 +07:00 [INF] CORS policy execution successful.
2025-05-01 23:31:31.453 +07:00 [WRN] Failed to determine the https port for redirect.
2025-05-01 23:31:31.484 +07:00 [INF] Executing endpoint '/ws/chat'
2025-05-01 23:31:31.525 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/ws/chat?userId=5 - null null
2025-05-01 23:31:31.527 +07:00 [INF] CORS policy execution successful.
2025-05-01 23:31:31.531 +07:00 [INF] CORS policy execution successful.
2025-05-01 23:31:31.534 +07:00 [INF] Executing endpoint '/ws/chat'
2025-05-01 23:31:31.537 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/ws/chat?userId=5 - null null
2025-05-01 23:31:31.539 +07:00 [INF] CORS policy execution successful.
2025-05-01 23:31:31.539 +07:00 [INF] CORS policy execution successful.
2025-05-01 23:31:31.541 +07:00 [INF] Executing endpoint '/ws/chat'
2025-05-01 23:31:31.684 +07:00 [INF] Executed DbCommand (12ms) [Parameters=[@__client_UserId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[conversation_id]
FROM [Participants] AS [p]
WHERE [p].[user_id] = @__client_UserId_0 AND [p].[is_deleted] = CAST(0 AS bit)
2025-05-01 23:31:31.684 +07:00 [INF] Executed DbCommand (22ms) [Parameters=[@__client_UserId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[conversation_id]
FROM [Participants] AS [p]
WHERE [p].[user_id] = @__client_UserId_0 AND [p].[is_deleted] = CAST(0 AS bit)
2025-05-01 23:31:31.684 +07:00 [INF] Executed DbCommand (4ms) [Parameters=[@__client_UserId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[conversation_id]
FROM [Participants] AS [p]
WHERE [p].[user_id] = @__client_UserId_0 AND [p].[is_deleted] = CAST(0 AS bit)
2025-05-01 23:31:32.389 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/ws/chat?userId=5 - null null
2025-05-01 23:31:32.389 +07:00 [INF] CORS policy execution successful.
2025-05-01 23:31:32.389 +07:00 [INF] CORS policy execution successful.
2025-05-01 23:31:32.390 +07:00 [INF] Executing endpoint '/ws/chat'
2025-05-01 23:31:32.390 +07:00 [INF] Executed endpoint '/ws/chat'
2025-05-01 23:31:32.393 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5053/ws/chat?userId=5 - 409 null null 2.8937ms
2025-05-01 23:31:34.458 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/ws/chat?userId=5 - null null
2025-05-01 23:31:34.459 +07:00 [INF] CORS policy execution successful.
2025-05-01 23:31:34.459 +07:00 [INF] CORS policy execution successful.
2025-05-01 23:31:34.459 +07:00 [INF] Executing endpoint '/ws/chat'
2025-05-01 23:31:34.460 +07:00 [INF] Executed endpoint '/ws/chat'
2025-05-01 23:31:34.460 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5053/ws/chat?userId=5 - 409 null null 1.6122ms
2025-05-01 23:31:37.682 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/ws/chat?userId=5 - null null
2025-05-01 23:31:37.683 +07:00 [INF] CORS policy execution successful.
2025-05-01 23:31:37.683 +07:00 [INF] CORS policy execution successful.
2025-05-01 23:31:37.683 +07:00 [INF] Executing endpoint '/ws/chat'
2025-05-01 23:31:37.684 +07:00 [INF] Executed endpoint '/ws/chat'
2025-05-01 23:31:37.684 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5053/ws/chat?userId=5 - 409 null null 1.7275ms
2025-05-01 23:31:38.005 +07:00 [INF] Request starting HTTP/1.1 GET http://192.168.1.9:5053/ws/chat?userId=2 - null null
2025-05-01 23:31:38.006 +07:00 [INF] Executing endpoint '/ws/chat'
2025-05-01 23:31:38.007 +07:00 [INF] Request starting HTTP/1.1 GET http://192.168.1.9:5053/ws/chat?userId=2 - null null
2025-05-01 23:31:38.008 +07:00 [INF] Executing endpoint '/ws/chat'
2025-05-01 23:31:38.098 +07:00 [INF] Executed DbCommand (12ms) [Parameters=[@__client_UserId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[conversation_id]
FROM [Participants] AS [p]
WHERE [p].[user_id] = @__client_UserId_0 AND [p].[is_deleted] = CAST(0 AS bit)
2025-05-01 23:31:38.099 +07:00 [INF] Executed DbCommand (13ms) [Parameters=[@__client_UserId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[conversation_id]
FROM [Participants] AS [p]
WHERE [p].[user_id] = @__client_UserId_0 AND [p].[is_deleted] = CAST(0 AS bit)
2025-05-01 23:31:38.902 +07:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5053/api/Message/getMessages/4/5 - null null
2025-05-01 23:31:38.902 +07:00 [INF] CORS policy execution successful.
2025-05-01 23:31:38.903 +07:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5053/api/Message/getMessages/4/5 - 204 null null 1.1942ms
2025-05-01 23:31:38.905 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/api/Message/getMessages/4/5 - null null
2025-05-01 23:31:38.905 +07:00 [INF] CORS policy execution successful.
2025-05-01 23:31:38.905 +07:00 [INF] CORS policy execution successful.
2025-05-01 23:31:38.906 +07:00 [INF] Executing endpoint 'server.Controllers.MessageController.GetMessages (Message_app)'
2025-05-01 23:31:38.924 +07:00 [INF] Route matched with {action = "GetMessages", controller = "Message"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetMessages(Int32, Int32) on controller server.Controllers.MessageController (Message_app).
2025-05-01 23:31:38.975 +07:00 [INF] Retrieved 52 messages from Redis for conversation 4
2025-05-01 23:31:38.977 +07:00 [INF] Retrieved 50 messages from Redis for conversation 4 and user 5
2025-05-01 23:31:38.981 +07:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[server.DTO.MessageWithAttachment, Message_app, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-05-01 23:31:39.007 +07:00 [INF] Executed action server.Controllers.MessageController.GetMessages (Message_app) in 80.532ms
2025-05-01 23:31:39.007 +07:00 [INF] Executed endpoint 'server.Controllers.MessageController.GetMessages (Message_app)'
2025-05-01 23:31:39.009 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5053/api/Message/getMessages/4/5 - 200 null application/json; charset=utf-8 104.2092ms
2025-05-01 23:31:39.037 +07:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5053/api/Conversation/get_first_conversation/4 - null null
2025-05-01 23:31:39.037 +07:00 [INF] CORS policy execution successful.
2025-05-01 23:31:39.037 +07:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5053/api/Conversation/get_first_conversation/4 - 204 null null 0.4112ms
2025-05-01 23:31:39.038 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/api/Conversation/get_first_conversation/4 - null null
2025-05-01 23:31:39.039 +07:00 [INF] CORS policy execution successful.
2025-05-01 23:31:39.040 +07:00 [INF] CORS policy execution successful.
2025-05-01 23:31:39.040 +07:00 [INF] Executing endpoint 'server.Controllers.ConversationController.GetFirstConversation (Message_app)'
2025-05-01 23:31:39.045 +07:00 [INF] Route matched with {action = "GetFirstConversation", controller = "Conversation"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetFirstConversation(Int32) on controller server.Controllers.ConversationController (Message_app).
2025-05-01 23:31:39.052 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/ws/chat?userId=5 - null null
2025-05-01 23:31:39.053 +07:00 [INF] CORS policy execution successful.
2025-05-01 23:31:39.053 +07:00 [INF] CORS policy execution successful.
2025-05-01 23:31:39.053 +07:00 [INF] Executing endpoint '/ws/chat'
2025-05-01 23:31:39.053 +07:00 [INF] Executed endpoint '/ws/chat'
2025-05-01 23:31:39.053 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5053/ws/chat?userId=5 - 409 null null 0.973ms
2025-05-01 23:31:39.098 +07:00 [INF] Request starting HTTP/1.1 GET http://192.168.1.9:5053/ws/chat?userId=2 - null null
2025-05-01 23:31:39.099 +07:00 [INF] Executing endpoint '/ws/chat'
2025-05-01 23:31:39.099 +07:00 [INF] Executed endpoint '/ws/chat'
2025-05-01 23:31:39.099 +07:00 [INF] Request finished HTTP/1.1 GET http://192.168.1.9:5053/ws/chat?userId=2 - 409 null null 0.8259ms
2025-05-01 23:31:39.113 +07:00 [INF] Executed DbCommand (5ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[id], [c].[created_at], [c].[is_group], [c].[lastMessage], [c].[lastMessageSender], [c].[lastMessageTime], [c].[name]
FROM [Conversations] AS [c]
WHERE [c].[id] = @__p_0
2025-05-01 23:31:39.165 +07:00 [INF] Executing OkObjectResult, writing value of type 'server.Models.Conversation'.
2025-05-01 23:31:39.180 +07:00 [INF] Executed action server.Controllers.ConversationController.GetFirstConversation (Message_app) in 134.1665ms
2025-05-01 23:31:39.180 +07:00 [INF] Executed endpoint 'server.Controllers.ConversationController.GetFirstConversation (Message_app)'
2025-05-01 23:31:39.182 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5053/api/Conversation/get_first_conversation/4 - 200 null application/json; charset=utf-8 143.2127ms
2025-05-01 23:31:39.195 +07:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5053/api/Participant/get_participants/4 - null null
2025-05-01 23:31:39.196 +07:00 [INF] CORS policy execution successful.
2025-05-01 23:31:39.196 +07:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5053/api/Participant/get_participants/4 - 204 null null 1.1199ms
2025-05-01 23:31:39.198 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/api/Participant/get_participants/4 - null null
2025-05-01 23:31:39.198 +07:00 [INF] CORS policy execution successful.
2025-05-01 23:31:39.198 +07:00 [INF] CORS policy execution successful.
2025-05-01 23:31:39.198 +07:00 [INF] Executing endpoint 'server.Controllers.ParticipantController.GetParticipants (Message_app)'
2025-05-01 23:31:39.201 +07:00 [INF] Route matched with {action = "GetParticipants", controller = "Participant"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetParticipants(Int32) on controller server.Controllers.ParticipantController (Message_app).
2025-05-01 23:31:39.216 +07:00 [INF] Executed DbCommand (5ms) [Parameters=[@__conversation_id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[id], [p].[adder], [p].[conversation_id], [p].[is_deleted], [p].[joined_at], [p].[name], [p].[role], [p].[user_id]
FROM [Participants] AS [p]
WHERE [p].[conversation_id] = @__conversation_id_0
2025-05-01 23:31:39.232 +07:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType17`1[[System.Collections.Generic.List`1[[server.Models.Participants, Message_app, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-05-01 23:31:39.241 +07:00 [INF] Executed action server.Controllers.ParticipantController.GetParticipants (Message_app) in 39.1253ms
2025-05-01 23:31:39.241 +07:00 [INF] Executed endpoint 'server.Controllers.ParticipantController.GetParticipants (Message_app)'
2025-05-01 23:31:39.241 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5053/api/Participant/get_participants/4 - 200 null application/json; charset=utf-8 43.1905ms
2025-05-01 23:31:39.878 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/ws/chat?userId=5 - null null
2025-05-01 23:31:39.878 +07:00 [INF] CORS policy execution successful.
2025-05-01 23:31:39.878 +07:00 [INF] CORS policy execution successful.
2025-05-01 23:31:39.879 +07:00 [INF] Executing endpoint '/ws/chat'
2025-05-01 23:31:39.879 +07:00 [INF] Executed endpoint '/ws/chat'
2025-05-01 23:31:39.879 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5053/ws/chat?userId=5 - 409 null null 1.0691ms
2025-05-01 23:31:42.780 +07:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5053/api/Message/getMessages/1/5 - null null
2025-05-01 23:31:42.780 +07:00 [INF] CORS policy execution successful.
2025-05-01 23:31:42.782 +07:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5053/api/Message/getMessages/1/5 - 204 null null 1.2782ms
2025-05-01 23:31:42.783 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/api/Message/getMessages/1/5 - null null
2025-05-01 23:31:42.784 +07:00 [INF] CORS policy execution successful.
2025-05-01 23:31:42.785 +07:00 [INF] CORS policy execution successful.
2025-05-01 23:31:42.785 +07:00 [INF] Executing endpoint 'server.Controllers.MessageController.GetMessages (Message_app)'
2025-05-01 23:31:42.786 +07:00 [INF] Route matched with {action = "GetMessages", controller = "Message"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetMessages(Int32, Int32) on controller server.Controllers.MessageController (Message_app).
2025-05-01 23:31:42.791 +07:00 [WRN] Message 84 not found in Redis
2025-05-01 23:31:42.792 +07:00 [WRN] Message 83 not found in Redis
2025-05-01 23:31:42.792 +07:00 [WRN] Message 82 not found in Redis
2025-05-01 23:31:42.793 +07:00 [WRN] Message 81 not found in Redis
2025-05-01 23:31:42.793 +07:00 [WRN] Message 80 not found in Redis
2025-05-01 23:31:42.794 +07:00 [WRN] Message 79 not found in Redis
2025-05-01 23:31:42.794 +07:00 [WRN] Message 78 not found in Redis
2025-05-01 23:31:42.795 +07:00 [WRN] Message 77 not found in Redis
2025-05-01 23:31:42.795 +07:00 [WRN] Message 76 not found in Redis
2025-05-01 23:31:42.795 +07:00 [WRN] Message 75 not found in Redis
2025-05-01 23:31:42.796 +07:00 [WRN] Message 74 not found in Redis
2025-05-01 23:31:42.796 +07:00 [WRN] Message 73 not found in Redis
2025-05-01 23:31:42.796 +07:00 [WRN] Message 72 not found in Redis
2025-05-01 23:31:42.797 +07:00 [WRN] Message 71 not found in Redis
2025-05-01 23:31:42.797 +07:00 [WRN] Message 68 not found in Redis
2025-05-01 23:31:42.797 +07:00 [WRN] Message 64 not found in Redis
2025-05-01 23:31:42.797 +07:00 [WRN] Message 62 not found in Redis
2025-05-01 23:31:42.798 +07:00 [WRN] Message 61 not found in Redis
2025-05-01 23:31:42.798 +07:00 [WRN] Message 60 not found in Redis
2025-05-01 23:31:42.798 +07:00 [WRN] Message 59 not found in Redis
2025-05-01 23:31:42.798 +07:00 [WRN] Message 57 not found in Redis
2025-05-01 23:31:42.799 +07:00 [WRN] Message 55 not found in Redis
2025-05-01 23:31:42.799 +07:00 [WRN] Message 54 not found in Redis
2025-05-01 23:31:42.799 +07:00 [WRN] Message 51 not found in Redis
2025-05-01 23:31:42.800 +07:00 [WRN] Message 49 not found in Redis
2025-05-01 23:31:42.800 +07:00 [WRN] Message 11 not found in Redis
2025-05-01 23:31:42.800 +07:00 [WRN] Message 8 not found in Redis
2025-05-01 23:31:42.800 +07:00 [WRN] Message 3 not found in Redis
2025-05-01 23:31:42.801 +07:00 [WRN] Message 2 not found in Redis
2025-05-01 23:31:42.801 +07:00 [WRN] Message 1 not found in Redis
2025-05-01 23:31:42.801 +07:00 [INF] Retrieved 9 messages from Redis for conversation 1
2025-05-01 23:31:42.801 +07:00 [INF] Retrieved 9 messages from Redis for conversation 1 and user 5
2025-05-01 23:31:42.802 +07:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[server.DTO.MessageWithAttachment, Message_app, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-05-01 23:31:42.802 +07:00 [INF] Executed action server.Controllers.MessageController.GetMessages (Message_app) in 16.1414ms
2025-05-01 23:31:42.802 +07:00 [INF] Executed endpoint 'server.Controllers.MessageController.GetMessages (Message_app)'
2025-05-01 23:31:42.802 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5053/api/Message/getMessages/1/5 - 200 null application/json; charset=utf-8 19.5198ms
2025-05-01 23:31:42.822 +07:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5053/api/Conversation/get_first_conversation/1 - null null
2025-05-01 23:31:42.823 +07:00 [INF] CORS policy execution successful.
2025-05-01 23:31:42.823 +07:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5053/api/Conversation/get_first_conversation/1 - 204 null null 0.2835ms
2025-05-01 23:31:42.824 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/api/Conversation/get_first_conversation/1 - null null
2025-05-01 23:31:42.824 +07:00 [INF] CORS policy execution successful.
2025-05-01 23:31:42.825 +07:00 [INF] CORS policy execution successful.
2025-05-01 23:31:42.825 +07:00 [INF] Executing endpoint 'server.Controllers.ConversationController.GetFirstConversation (Message_app)'
2025-05-01 23:31:42.825 +07:00 [INF] Route matched with {action = "GetFirstConversation", controller = "Conversation"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetFirstConversation(Int32) on controller server.Controllers.ConversationController (Message_app).
2025-05-01 23:31:42.832 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[id], [c].[created_at], [c].[is_group], [c].[lastMessage], [c].[lastMessageSender], [c].[lastMessageTime], [c].[name]
FROM [Conversations] AS [c]
WHERE [c].[id] = @__p_0
2025-05-01 23:31:42.832 +07:00 [INF] Executing OkObjectResult, writing value of type 'server.Models.Conversation'.
2025-05-01 23:31:42.832 +07:00 [INF] Executed action server.Controllers.ConversationController.GetFirstConversation (Message_app) in 7.1465ms
2025-05-01 23:31:42.832 +07:00 [INF] Executed endpoint 'server.Controllers.ConversationController.GetFirstConversation (Message_app)'
2025-05-01 23:31:42.833 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5053/api/Conversation/get_first_conversation/1 - 200 null application/json; charset=utf-8 8.6783ms
2025-05-01 23:31:42.848 +07:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5053/api/Participant/get_participants/1 - null null
2025-05-01 23:31:42.848 +07:00 [INF] CORS policy execution successful.
2025-05-01 23:31:42.848 +07:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5053/api/Participant/get_participants/1 - 204 null null 0.2832ms
2025-05-01 23:31:42.849 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/api/Participant/get_participants/1 - null null
2025-05-01 23:31:42.849 +07:00 [INF] CORS policy execution successful.
2025-05-01 23:31:42.850 +07:00 [INF] CORS policy execution successful.
2025-05-01 23:31:42.850 +07:00 [INF] Executing endpoint 'server.Controllers.ParticipantController.GetParticipants (Message_app)'
2025-05-01 23:31:42.850 +07:00 [INF] Route matched with {action = "GetParticipants", controller = "Participant"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetParticipants(Int32) on controller server.Controllers.ParticipantController (Message_app).
2025-05-01 23:31:42.855 +07:00 [INF] Executed DbCommand (4ms) [Parameters=[@__conversation_id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[id], [p].[adder], [p].[conversation_id], [p].[is_deleted], [p].[joined_at], [p].[name], [p].[role], [p].[user_id]
FROM [Participants] AS [p]
WHERE [p].[conversation_id] = @__conversation_id_0
2025-05-01 23:31:42.856 +07:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType17`1[[System.Collections.Generic.List`1[[server.Models.Participants, Message_app, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-05-01 23:31:42.856 +07:00 [INF] Executed action server.Controllers.ParticipantController.GetParticipants (Message_app) in 5.7558ms
2025-05-01 23:31:42.856 +07:00 [INF] Executed endpoint 'server.Controllers.ParticipantController.GetParticipants (Message_app)'
2025-05-01 23:31:42.856 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5053/api/Participant/get_participants/1 - 200 null application/json; charset=utf-8 7.2577ms
2025-05-01 23:31:43.131 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/ws/chat?userId=5 - null null
2025-05-01 23:31:43.132 +07:00 [INF] CORS policy execution successful.
2025-05-01 23:31:43.132 +07:00 [INF] CORS policy execution successful.
2025-05-01 23:31:43.132 +07:00 [INF] Executing endpoint '/ws/chat'
2025-05-01 23:31:43.132 +07:00 [INF] Executed endpoint '/ws/chat'
2025-05-01 23:31:43.132 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5053/ws/chat?userId=5 - 409 null null 0.7397ms
2025-05-01 23:31:43.456 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/ws/chat?userId=5 - null null
2025-05-01 23:31:43.456 +07:00 [INF] CORS policy execution successful.
2025-05-01 23:31:43.457 +07:00 [INF] CORS policy execution successful.
2025-05-01 23:31:43.457 +07:00 [INF] Executing endpoint '/ws/chat'
2025-05-01 23:31:43.457 +07:00 [INF] Executed endpoint '/ws/chat'
2025-05-01 23:31:43.457 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5053/ws/chat?userId=5 - 409 null null 0.3914ms
2025-05-01 23:31:44.131 +07:00 [INF] Request starting HTTP/1.1 GET http://192.168.1.9:5053/ws/chat?userId=2 - null null
2025-05-01 23:31:44.131 +07:00 [INF] Executing endpoint '/ws/chat'
2025-05-01 23:31:44.132 +07:00 [INF] Executed endpoint '/ws/chat'
2025-05-01 23:31:44.132 +07:00 [INF] Request finished HTTP/1.1 GET http://192.168.1.9:5053/ws/chat?userId=2 - 409 null null 0.9915ms
2025-05-01 23:31:44.457 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/ws/chat?userId=5 - null null
2025-05-01 23:31:44.458 +07:00 [INF] CORS policy execution successful.
2025-05-01 23:31:44.458 +07:00 [INF] CORS policy execution successful.
2025-05-01 23:31:44.458 +07:00 [INF] Executing endpoint '/ws/chat'
2025-05-01 23:31:44.458 +07:00 [INF] Executed endpoint '/ws/chat'
2025-05-01 23:31:44.458 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5053/ws/chat?userId=5 - 409 null null 0.6927ms
2025-05-01 23:31:45.474 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/ws/chat?userId=5 - null null
2025-05-01 23:31:45.474 +07:00 [INF] CORS policy execution successful.
2025-05-01 23:31:45.474 +07:00 [INF] CORS policy execution successful.
2025-05-01 23:31:45.475 +07:00 [INF] Executing endpoint '/ws/chat'
2025-05-01 23:31:45.475 +07:00 [INF] Executed endpoint '/ws/chat'
2025-05-01 23:31:45.475 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5053/ws/chat?userId=5 - 409 null null 0.5964ms
2025-05-01 23:31:48.378 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/ws/chat?userId=5 - null null
2025-05-01 23:31:48.379 +07:00 [INF] CORS policy execution successful.
2025-05-01 23:31:48.379 +07:00 [INF] CORS policy execution successful.
2025-05-01 23:31:48.380 +07:00 [INF] Executing endpoint '/ws/chat'
2025-05-01 23:31:48.380 +07:00 [INF] Executed endpoint '/ws/chat'
2025-05-01 23:31:48.381 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5053/ws/chat?userId=5 - 409 null null 2.6892ms
2025-05-01 23:31:49.158 +07:00 [INF] Request starting HTTP/1.1 GET http://192.168.1.9:5053/ws/chat?userId=2 - null null
2025-05-01 23:31:49.159 +07:00 [INF] Executing endpoint '/ws/chat'
2025-05-01 23:31:49.159 +07:00 [INF] Executed endpoint '/ws/chat'
2025-05-01 23:31:49.159 +07:00 [INF] Request finished HTTP/1.1 GET http://192.168.1.9:5053/ws/chat?userId=2 - 409 null null 0.4754ms
2025-05-01 23:31:49.413 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/ws/chat?userId=5 - null null
2025-05-01 23:31:49.414 +07:00 [INF] CORS policy execution successful.
2025-05-01 23:31:49.414 +07:00 [INF] CORS policy execution successful.
2025-05-01 23:31:49.414 +07:00 [INF] Executing endpoint '/ws/chat'
2025-05-01 23:31:49.414 +07:00 [INF] Executed endpoint '/ws/chat'
2025-05-01 23:31:49.414 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5053/ws/chat?userId=5 - 409 null null 0.5493ms
2025-05-01 23:31:49.957 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/ws/chat?userId=5 - null null
2025-05-01 23:31:49.958 +07:00 [INF] CORS policy execution successful.
2025-05-01 23:31:49.958 +07:00 [INF] CORS policy execution successful.
2025-05-01 23:31:49.958 +07:00 [INF] Executing endpoint '/ws/chat'
2025-05-01 23:31:49.958 +07:00 [INF] Executed endpoint '/ws/chat'
2025-05-01 23:31:49.958 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5053/ws/chat?userId=5 - 409 null null 0.4555ms
2025-05-01 23:31:51.392 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/ws/chat?userId=5 - null null
2025-05-01 23:31:51.392 +07:00 [INF] CORS policy execution successful.
2025-05-01 23:31:51.393 +07:00 [INF] CORS policy execution successful.
2025-05-01 23:31:51.393 +07:00 [INF] Executing endpoint '/ws/chat'
2025-05-01 23:31:51.393 +07:00 [INF] Executed endpoint '/ws/chat'
2025-05-01 23:31:51.393 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5053/ws/chat?userId=5 - 409 null null 0.5422ms
2025-05-01 23:31:53.734 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/ws/chat?userId=5 - null null
2025-05-01 23:31:53.734 +07:00 [INF] CORS policy execution successful.
2025-05-01 23:31:53.734 +07:00 [INF] CORS policy execution successful.
2025-05-01 23:31:53.734 +07:00 [INF] Executing endpoint '/ws/chat'
2025-05-01 23:31:53.735 +07:00 [INF] Executed endpoint '/ws/chat'
2025-05-01 23:31:53.735 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5053/ws/chat?userId=5 - 409 null null 0.8568ms
2025-05-01 23:31:54.187 +07:00 [INF] Request starting HTTP/1.1 GET http://192.168.1.9:5053/ws/chat?userId=2 - null null
2025-05-01 23:31:54.187 +07:00 [INF] Executing endpoint '/ws/chat'
2025-05-01 23:31:54.188 +07:00 [INF] Executed endpoint '/ws/chat'
2025-05-01 23:31:54.188 +07:00 [INF] Request finished HTTP/1.1 GET http://192.168.1.9:5053/ws/chat?userId=2 - 409 null null 0.511ms
2025-05-01 23:31:55.456 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/ws/chat?userId=5 - null null
2025-05-01 23:31:55.456 +07:00 [INF] CORS policy execution successful.
2025-05-01 23:31:55.456 +07:00 [INF] CORS policy execution successful.
2025-05-01 23:31:55.456 +07:00 [INF] Executing endpoint '/ws/chat'
2025-05-01 23:31:55.456 +07:00 [INF] Executed endpoint '/ws/chat'
2025-05-01 23:31:55.456 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5053/ws/chat?userId=5 - 409 null null 0.4547ms
2025-05-01 23:31:55.518 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/ws/chat?userId=5 - null null
2025-05-01 23:31:55.518 +07:00 [INF] CORS policy execution successful.
2025-05-01 23:31:55.518 +07:00 [INF] CORS policy execution successful.
2025-05-01 23:31:55.518 +07:00 [INF] Executing endpoint '/ws/chat'
2025-05-01 23:31:55.518 +07:00 [INF] Executed endpoint '/ws/chat'
2025-05-01 23:31:55.518 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5053/ws/chat?userId=5 - 409 null null 0.3551ms
2025-05-01 23:31:56.674 +07:00 [INF] Request starting HTTP/1.1 GET http://192.168.1.9:5053/ws/chat?userId=2 - null null
2025-05-01 23:31:56.674 +07:00 [INF] Executing endpoint '/ws/chat'
2025-05-01 23:31:56.674 +07:00 [INF] Executed endpoint '/ws/chat'
2025-05-01 23:31:56.674 +07:00 [INF] Request finished HTTP/1.1 GET http://192.168.1.9:5053/ws/chat?userId=2 - 409 null null 0.476ms
2025-05-01 23:31:58.309 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/ws/chat?userId=5 - null null
2025-05-01 23:31:58.309 +07:00 [INF] CORS policy execution successful.
2025-05-01 23:31:58.309 +07:00 [INF] CORS policy execution successful.
2025-05-01 23:31:58.309 +07:00 [INF] Executing endpoint '/ws/chat'
2025-05-01 23:31:58.310 +07:00 [INF] Executed endpoint '/ws/chat'
2025-05-01 23:31:58.310 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5053/ws/chat?userId=5 - 409 null null 1.025ms
2025-05-01 23:31:59.315 +07:00 [INF] Request starting HTTP/1.1 GET http://192.168.1.9:5053/ws/chat?userId=2 - null null
2025-05-01 23:31:59.315 +07:00 [INF] Executing endpoint '/ws/chat'
2025-05-01 23:31:59.315 +07:00 [INF] Executed endpoint '/ws/chat'
2025-05-01 23:31:59.316 +07:00 [INF] Request finished HTTP/1.1 GET http://192.168.1.9:5053/ws/chat?userId=2 - 409 null null 0.5655ms
2025-05-01 23:32:01.082 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/ws/chat?userId=5 - null null
2025-05-01 23:32:01.082 +07:00 [INF] CORS policy execution successful.
2025-05-01 23:32:01.082 +07:00 [INF] CORS policy execution successful.
2025-05-01 23:32:01.082 +07:00 [INF] Executing endpoint '/ws/chat'
2025-05-01 23:32:01.082 +07:00 [INF] Executed endpoint '/ws/chat'
2025-05-01 23:32:01.082 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5053/ws/chat?userId=5 - 409 null null 0.3366ms
2025-05-01 23:32:01.701 +07:00 [INF] Request starting HTTP/1.1 GET http://192.168.1.9:5053/ws/chat?userId=2 - null null
2025-05-01 23:32:01.701 +07:00 [INF] Executing endpoint '/ws/chat'
2025-05-01 23:32:01.701 +07:00 [INF] Executed endpoint '/ws/chat'
2025-05-01 23:32:01.701 +07:00 [INF] Request finished HTTP/1.1 GET http://192.168.1.9:5053/ws/chat?userId=2 - 409 null null 0.2775ms
2025-05-01 23:32:02.609 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/ws/chat?userId=5 - null null
2025-05-01 23:32:02.610 +07:00 [INF] CORS policy execution successful.
2025-05-01 23:32:02.610 +07:00 [INF] CORS policy execution successful.
2025-05-01 23:32:02.610 +07:00 [INF] Executing endpoint '/ws/chat'
2025-05-01 23:32:02.610 +07:00 [INF] Executed endpoint '/ws/chat'
2025-05-01 23:32:02.610 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5053/ws/chat?userId=5 - 409 null null 0.501ms
2025-05-01 23:32:03.234 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/ws/chat?userId=5 - null null
2025-05-01 23:32:03.234 +07:00 [INF] CORS policy execution successful.
2025-05-01 23:32:03.234 +07:00 [INF] CORS policy execution successful.
2025-05-01 23:32:03.234 +07:00 [INF] Executing endpoint '/ws/chat'
2025-05-01 23:32:03.234 +07:00 [INF] Executed endpoint '/ws/chat'
2025-05-01 23:32:03.234 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5053/ws/chat?userId=5 - 409 null null 0.3285ms
2025-05-01 23:32:04.348 +07:00 [INF] Request starting HTTP/1.1 GET http://192.168.1.9:5053/ws/chat?userId=2 - null null
2025-05-01 23:32:04.349 +07:00 [INF] Executing endpoint '/ws/chat'
2025-05-01 23:32:04.349 +07:00 [INF] Executed endpoint '/ws/chat'
2025-05-01 23:32:04.349 +07:00 [INF] Request finished HTTP/1.1 GET http://192.168.1.9:5053/ws/chat?userId=2 - 409 null null 0.2754ms
2025-05-01 23:32:04.968 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/ws/chat?userId=5 - null null
2025-05-01 23:32:04.969 +07:00 [INF] CORS policy execution successful.
2025-05-01 23:32:04.969 +07:00 [INF] CORS policy execution successful.
2025-05-01 23:32:04.969 +07:00 [INF] Executing endpoint '/ws/chat'
2025-05-01 23:32:04.969 +07:00 [INF] Executed endpoint '/ws/chat'
2025-05-01 23:32:04.969 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5053/ws/chat?userId=5 - 409 null null 0.2908ms
2025-05-01 23:32:07.806 +07:00 [INF] Request starting HTTP/1.1 GET http://192.168.1.9:5053/ws/chat?userId=2 - null null
2025-05-01 23:32:07.807 +07:00 [INF] Executing endpoint '/ws/chat'
2025-05-01 23:32:07.807 +07:00 [INF] Executed endpoint '/ws/chat'
2025-05-01 23:32:07.807 +07:00 [INF] Request finished HTTP/1.1 GET http://192.168.1.9:5053/ws/chat?userId=2 - 409 null null 0.9327ms
2025-05-01 23:32:07.893 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/ws/chat?userId=5 - null null
2025-05-01 23:32:07.893 +07:00 [INF] CORS policy execution successful.
2025-05-01 23:32:07.893 +07:00 [INF] CORS policy execution successful.
2025-05-01 23:32:07.894 +07:00 [INF] Executing endpoint '/ws/chat'
2025-05-01 23:32:07.894 +07:00 [INF] Executed endpoint '/ws/chat'
2025-05-01 23:32:07.894 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5053/ws/chat?userId=5 - 409 null null 0.5503ms
2025-05-01 23:32:08.131 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/ws/chat?userId=5 - null null
2025-05-01 23:32:08.131 +07:00 [INF] CORS policy execution successful.
2025-05-01 23:32:08.131 +07:00 [INF] CORS policy execution successful.
2025-05-01 23:32:08.131 +07:00 [INF] Executing endpoint '/ws/chat'
2025-05-01 23:32:08.132 +07:00 [INF] Executed endpoint '/ws/chat'
2025-05-01 23:32:08.132 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5053/ws/chat?userId=5 - 409 null null 0.9316ms
2025-05-01 23:32:09.440 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/ws/chat?userId=5 - null null
2025-05-01 23:32:09.440 +07:00 [INF] CORS policy execution successful.
2025-05-01 23:32:09.440 +07:00 [INF] CORS policy execution successful.
2025-05-01 23:32:09.440 +07:00 [INF] Executing endpoint '/ws/chat'
2025-05-01 23:32:09.441 +07:00 [INF] Executed endpoint '/ws/chat'
2025-05-01 23:32:09.441 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5053/ws/chat?userId=5 - 409 null null 0.3284ms
2025-05-01 23:32:09.502 +07:00 [INF] Request starting HTTP/1.1 GET http://192.168.1.9:5053/ws/chat?userId=2 - null null
2025-05-01 23:32:09.502 +07:00 [INF] Executing endpoint '/ws/chat'
2025-05-01 23:32:09.503 +07:00 [INF] Executed endpoint '/ws/chat'
2025-05-01 23:32:09.503 +07:00 [INF] Request finished HTTP/1.1 GET http://192.168.1.9:5053/ws/chat?userId=2 - 409 null null 1.1548ms
2025-05-01 23:32:12.918 +07:00 [INF] Request starting HTTP/1.1 GET http://192.168.1.9:5053/ws/chat?userId=2 - null null
2025-05-01 23:32:12.919 +07:00 [INF] Executing endpoint '/ws/chat'
2025-05-01 23:32:12.919 +07:00 [INF] Executed endpoint '/ws/chat'
2025-05-01 23:32:12.919 +07:00 [INF] Request finished HTTP/1.1 GET http://192.168.1.9:5053/ws/chat?userId=2 - 409 null null 0.6474ms
2025-05-01 23:32:13.101 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/ws/chat?userId=5 - null null
2025-05-01 23:32:13.101 +07:00 [INF] CORS policy execution successful.
2025-05-01 23:32:13.101 +07:00 [INF] CORS policy execution successful.
2025-05-01 23:32:13.101 +07:00 [INF] Executing endpoint '/ws/chat'
2025-05-01 23:32:13.101 +07:00 [INF] Executed endpoint '/ws/chat'
2025-05-01 23:32:13.101 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5053/ws/chat?userId=5 - 409 null null 0.3063ms
2025-05-01 23:32:14.268 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/ws/chat?userId=5 - null null
2025-05-01 23:32:14.268 +07:00 [INF] CORS policy execution successful.
2025-05-01 23:32:14.268 +07:00 [INF] CORS policy execution successful.
2025-05-01 23:32:14.268 +07:00 [INF] Executing endpoint '/ws/chat'
2025-05-01 23:32:14.268 +07:00 [INF] Executed endpoint '/ws/chat'
2025-05-01 23:32:14.269 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5053/ws/chat?userId=5 - 409 null null 0.7227ms
2025-05-01 23:32:14.530 +07:00 [INF] Request starting HTTP/1.1 GET http://192.168.1.9:5053/ws/chat?userId=2 - null null
2025-05-01 23:32:14.531 +07:00 [INF] Executing endpoint '/ws/chat'
2025-05-01 23:32:14.531 +07:00 [INF] Executed endpoint '/ws/chat'
2025-05-01 23:32:14.531 +07:00 [INF] Request finished HTTP/1.1 GET http://192.168.1.9:5053/ws/chat?userId=2 - 409 null null 0.9533ms
2025-05-01 23:32:15.267 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/ws/chat?userId=5 - null null
2025-05-01 23:32:15.267 +07:00 [INF] CORS policy execution successful.
2025-05-01 23:32:15.268 +07:00 [INF] CORS policy execution successful.
2025-05-01 23:32:15.268 +07:00 [INF] Executing endpoint '/ws/chat'
2025-05-01 23:32:15.268 +07:00 [INF] Executed endpoint '/ws/chat'
2025-05-01 23:32:15.268 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5053/ws/chat?userId=5 - 409 null null 0.8627ms
2025-05-01 23:32:16.620 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/ws/chat?userId=5 - null null
2025-05-01 23:32:16.621 +07:00 [INF] CORS policy execution successful.
2025-05-01 23:32:16.621 +07:00 [INF] CORS policy execution successful.
2025-05-01 23:32:16.621 +07:00 [INF] Executing endpoint '/ws/chat'
2025-05-01 23:32:16.621 +07:00 [INF] Executed endpoint '/ws/chat'
2025-05-01 23:32:16.621 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5053/ws/chat?userId=5 - 409 null null 0.3327ms
2025-05-01 23:32:17.371 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/ws/chat?userId=5 - null null
2025-05-01 23:32:17.371 +07:00 [INF] CORS policy execution successful.
2025-05-01 23:32:17.371 +07:00 [INF] CORS policy execution successful.
2025-05-01 23:32:17.371 +07:00 [INF] Executing endpoint '/ws/chat'
2025-05-01 23:32:17.371 +07:00 [INF] Executed endpoint '/ws/chat'
2025-05-01 23:32:17.371 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5053/ws/chat?userId=5 - 409 null null 0.6923ms
2025-05-01 23:32:17.950 +07:00 [INF] Request starting HTTP/1.1 GET http://192.168.1.9:5053/ws/chat?userId=2 - null null
2025-05-01 23:32:17.950 +07:00 [INF] Executing endpoint '/ws/chat'
2025-05-01 23:32:17.950 +07:00 [INF] Executed endpoint '/ws/chat'
2025-05-01 23:32:17.950 +07:00 [INF] Request finished HTTP/1.1 GET http://192.168.1.9:5053/ws/chat?userId=2 - 409 null null 0.489ms
2025-05-01 23:32:19.558 +07:00 [INF] Request starting HTTP/1.1 GET http://192.168.1.9:5053/ws/chat?userId=2 - null null
2025-05-01 23:32:19.558 +07:00 [INF] Executing endpoint '/ws/chat'
2025-05-01 23:32:19.558 +07:00 [INF] Executed endpoint '/ws/chat'
2025-05-01 23:32:19.559 +07:00 [INF] Request finished HTTP/1.1 GET http://192.168.1.9:5053/ws/chat?userId=2 - 409 null null 0.3383ms
2025-05-01 23:32:21.061 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/ws/chat?userId=5 - null null
2025-05-01 23:32:21.061 +07:00 [INF] CORS policy execution successful.
2025-05-01 23:32:21.061 +07:00 [INF] CORS policy execution successful.
2025-05-01 23:32:21.061 +07:00 [INF] Executing endpoint '/ws/chat'
2025-05-01 23:32:21.061 +07:00 [INF] Executed endpoint '/ws/chat'
2025-05-01 23:32:21.061 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5053/ws/chat?userId=5 - 409 null null 0.2221ms
2025-05-01 23:32:22.441 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/ws/chat?userId=5 - null null
2025-05-01 23:32:22.441 +07:00 [INF] CORS policy execution successful.
2025-05-01 23:32:22.441 +07:00 [INF] CORS policy execution successful.
2025-05-01 23:32:22.441 +07:00 [INF] Executing endpoint '/ws/chat'
2025-05-01 23:32:22.441 +07:00 [INF] Executed endpoint '/ws/chat'
2025-05-01 23:32:22.441 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5053/ws/chat?userId=5 - 409 null null 0.3168ms
2025-05-01 23:32:22.989 +07:00 [INF] Request starting HTTP/1.1 GET http://192.168.1.9:5053/ws/chat?userId=2 - null null
2025-05-01 23:32:22.989 +07:00 [INF] Executing endpoint '/ws/chat'
2025-05-01 23:32:22.989 +07:00 [INF] Executed endpoint '/ws/chat'
2025-05-01 23:32:22.989 +07:00 [INF] Request finished HTTP/1.1 GET http://192.168.1.9:5053/ws/chat?userId=2 - 409 null null 0.3038ms
2025-05-01 23:32:24.046 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/ws/chat?userId=5 - null null
2025-05-01 23:32:24.046 +07:00 [INF] CORS policy execution successful.
2025-05-01 23:32:24.046 +07:00 [INF] CORS policy execution successful.
2025-05-01 23:32:24.046 +07:00 [INF] Executing endpoint '/ws/chat'
2025-05-01 23:32:24.046 +07:00 [INF] Executed endpoint '/ws/chat'
2025-05-01 23:32:24.046 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5053/ws/chat?userId=5 - 409 null null 0.2528ms
2025-05-01 23:32:24.268 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/ws/chat?userId=5 - null null
2025-05-01 23:32:24.268 +07:00 [INF] CORS policy execution successful.
2025-05-01 23:32:24.268 +07:00 [INF] CORS policy execution successful.
2025-05-01 23:32:24.268 +07:00 [INF] Executing endpoint '/ws/chat'
2025-05-01 23:32:24.268 +07:00 [INF] Executed endpoint '/ws/chat'
2025-05-01 23:32:24.268 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5053/ws/chat?userId=5 - 409 null null 0.5161ms
2025-05-01 23:32:24.585 +07:00 [INF] Request starting HTTP/1.1 GET http://192.168.1.9:5053/ws/chat?userId=2 - null null
2025-05-01 23:32:24.586 +07:00 [INF] Executing endpoint '/ws/chat'
2025-05-01 23:32:24.586 +07:00 [INF] Executed endpoint '/ws/chat'
2025-05-01 23:32:24.586 +07:00 [INF] Request finished HTTP/1.1 GET http://192.168.1.9:5053/ws/chat?userId=2 - 409 null null 0.2527ms
2025-05-01 23:32:26.537 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/ws/chat?userId=5 - null null
2025-05-01 23:32:26.537 +07:00 [INF] CORS policy execution successful.
2025-05-01 23:32:26.537 +07:00 [INF] CORS policy execution successful.
2025-05-01 23:32:26.537 +07:00 [INF] Executing endpoint '/ws/chat'
2025-05-01 23:32:26.537 +07:00 [INF] Executed endpoint '/ws/chat'
2025-05-01 23:32:26.537 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5053/ws/chat?userId=5 - 409 null null 0.3159ms
2025-05-01 23:32:28.114 +07:00 [INF] Request starting HTTP/1.1 GET http://192.168.1.9:5053/ws/chat?userId=2 - null null
2025-05-01 23:32:28.114 +07:00 [INF] Executing endpoint '/ws/chat'
2025-05-01 23:32:28.114 +07:00 [INF] Executed endpoint '/ws/chat'
2025-05-01 23:32:28.114 +07:00 [INF] Request finished HTTP/1.1 GET http://192.168.1.9:5053/ws/chat?userId=2 - 409 null null 0.5024ms
2025-05-01 23:32:29.515 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/ws/chat?userId=5 - null null
2025-05-01 23:32:29.515 +07:00 [INF] CORS policy execution successful.
2025-05-01 23:32:29.515 +07:00 [INF] CORS policy execution successful.
2025-05-01 23:32:29.515 +07:00 [INF] Executing endpoint '/ws/chat'
2025-05-01 23:32:29.515 +07:00 [INF] Executed endpoint '/ws/chat'
2025-05-01 23:32:29.515 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5053/ws/chat?userId=5 - 409 null null 0.2462ms
2025-05-01 23:32:29.712 +07:00 [INF] Request starting HTTP/1.1 GET http://192.168.1.9:5053/ws/chat?userId=2 - null null
2025-05-01 23:32:29.712 +07:00 [INF] Executing endpoint '/ws/chat'
2025-05-01 23:32:29.712 +07:00 [INF] Executed endpoint '/ws/chat'
2025-05-01 23:32:29.713 +07:00 [INF] Request finished HTTP/1.1 GET http://192.168.1.9:5053/ws/chat?userId=2 - 409 null null 0.5922ms
2025-05-01 23:32:30.183 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/ws/chat?userId=5 - null null
2025-05-01 23:32:30.183 +07:00 [INF] CORS policy execution successful.
2025-05-01 23:32:30.184 +07:00 [INF] CORS policy execution successful.
2025-05-01 23:32:30.184 +07:00 [INF] Executing endpoint '/ws/chat'
2025-05-01 23:32:30.184 +07:00 [INF] Executed endpoint '/ws/chat'
2025-05-01 23:32:30.184 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5053/ws/chat?userId=5 - 409 null null 0.3835ms
2025-05-01 23:32:33.141 +07:00 [INF] Request starting HTTP/1.1 GET http://192.168.1.9:5053/ws/chat?userId=2 - null null
2025-05-01 23:32:33.142 +07:00 [INF] Executing endpoint '/ws/chat'
2025-05-01 23:32:33.142 +07:00 [INF] Executed endpoint '/ws/chat'
2025-05-01 23:32:33.142 +07:00 [INF] Request finished HTTP/1.1 GET http://192.168.1.9:5053/ws/chat?userId=2 - 409 null null 0.4669ms
2025-05-01 23:32:33.866 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/ws/chat?userId=5 - null null
2025-05-01 23:32:33.867 +07:00 [INF] CORS policy execution successful.
2025-05-01 23:32:33.867 +07:00 [INF] CORS policy execution successful.
2025-05-01 23:32:33.867 +07:00 [INF] Executing endpoint '/ws/chat'
2025-05-01 23:32:33.867 +07:00 [INF] Executed endpoint '/ws/chat'
2025-05-01 23:32:33.867 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5053/ws/chat?userId=5 - 409 null null 0.6344ms
2025-05-01 23:32:34.007 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/ws/chat?userId=5 - null null
2025-05-01 23:32:34.007 +07:00 [INF] CORS policy execution successful.
2025-05-01 23:32:34.007 +07:00 [INF] CORS policy execution successful.
2025-05-01 23:32:34.007 +07:00 [INF] Executing endpoint '/ws/chat'
2025-05-01 23:32:34.007 +07:00 [INF] Executed endpoint '/ws/chat'
2025-05-01 23:32:34.007 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5053/ws/chat?userId=5 - 409 null null 0.5676ms
2025-05-01 23:32:34.742 +07:00 [INF] Request starting HTTP/1.1 GET http://192.168.1.9:5053/ws/chat?userId=2 - null null
2025-05-01 23:32:34.743 +07:00 [INF] Executing endpoint '/ws/chat'
2025-05-01 23:32:34.743 +07:00 [INF] Executed endpoint '/ws/chat'
2025-05-01 23:32:34.743 +07:00 [INF] Request finished HTTP/1.1 GET http://192.168.1.9:5053/ws/chat?userId=2 - 409 null null 0.4364ms
2025-05-01 23:32:35.500 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/ws/chat?userId=5 - null null
2025-05-01 23:32:35.501 +07:00 [INF] CORS policy execution successful.
2025-05-01 23:32:35.501 +07:00 [INF] CORS policy execution successful.
2025-05-01 23:32:35.501 +07:00 [INF] Executing endpoint '/ws/chat'
2025-05-01 23:32:35.501 +07:00 [INF] Executed endpoint '/ws/chat'
2025-05-01 23:32:35.501 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5053/ws/chat?userId=5 - 409 null null 0.569ms
2025-05-01 23:32:37.980 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/ws/chat?userId=5 - null null
2025-05-01 23:32:37.980 +07:00 [INF] CORS policy execution successful.
2025-05-01 23:32:37.980 +07:00 [INF] CORS policy execution successful.
2025-05-01 23:32:37.980 +07:00 [INF] Executing endpoint '/ws/chat'
2025-05-01 23:32:37.980 +07:00 [INF] Executed endpoint '/ws/chat'
2025-05-01 23:32:37.980 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5053/ws/chat?userId=5 - 409 null null 0.2678ms
2025-05-01 23:32:38.170 +07:00 [INF] Request starting HTTP/1.1 GET http://192.168.1.9:5053/ws/chat?userId=2 - null null
2025-05-01 23:32:38.170 +07:00 [INF] Executing endpoint '/ws/chat'
2025-05-01 23:32:38.171 +07:00 [INF] Executed endpoint '/ws/chat'
2025-05-01 23:32:38.171 +07:00 [INF] Request finished HTTP/1.1 GET http://192.168.1.9:5053/ws/chat?userId=2 - 409 null null 0.5171ms
2025-05-01 23:32:39.416 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/ws/chat?userId=5 - null null
2025-05-01 23:32:39.416 +07:00 [INF] CORS policy execution successful.
2025-05-01 23:32:39.416 +07:00 [INF] CORS policy execution successful.
2025-05-01 23:32:39.417 +07:00 [INF] Executing endpoint '/ws/chat'
2025-05-01 23:32:39.417 +07:00 [INF] Executed endpoint '/ws/chat'
2025-05-01 23:32:39.417 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5053/ws/chat?userId=5 - 409 null null 1.0545ms
2025-05-01 23:32:39.772 +07:00 [INF] Request starting HTTP/1.1 GET http://192.168.1.9:5053/ws/chat?userId=2 - null null
2025-05-01 23:32:39.773 +07:00 [INF] Executing endpoint '/ws/chat'
2025-05-01 23:32:39.773 +07:00 [INF] Executed endpoint '/ws/chat'
2025-05-01 23:32:39.773 +07:00 [INF] Request finished HTTP/1.1 GET http://192.168.1.9:5053/ws/chat?userId=2 - 409 null null 0.2573ms
2025-05-01 23:32:41.009 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/ws/chat?userId=5 - null null
2025-05-01 23:32:41.009 +07:00 [INF] CORS policy execution successful.
2025-05-01 23:32:41.009 +07:00 [INF] CORS policy execution successful.
2025-05-01 23:32:41.010 +07:00 [INF] Executing endpoint '/ws/chat'
2025-05-01 23:32:41.010 +07:00 [INF] Executed endpoint '/ws/chat'
2025-05-01 23:32:41.010 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5053/ws/chat?userId=5 - 409 null null 0.6814ms
2025-05-01 23:32:41.526 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/ws/chat?userId=5 - null null
2025-05-01 23:32:41.526 +07:00 [INF] CORS policy execution successful.
2025-05-01 23:32:41.526 +07:00 [INF] CORS policy execution successful.
2025-05-01 23:32:41.526 +07:00 [INF] Executing endpoint '/ws/chat'
2025-05-01 23:32:41.526 +07:00 [INF] Executed endpoint '/ws/chat'
2025-05-01 23:32:41.526 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5053/ws/chat?userId=5 - 409 null null 0.7465ms
2025-05-01 23:32:43.195 +07:00 [INF] Request starting HTTP/1.1 GET http://192.168.1.9:5053/ws/chat?userId=2 - null null
2025-05-01 23:32:43.196 +07:00 [INF] Executing endpoint '/ws/chat'
2025-05-01 23:32:43.197 +07:00 [INF] Executed endpoint '/ws/chat'
2025-05-01 23:32:43.197 +07:00 [INF] Request finished HTTP/1.1 GET http://192.168.1.9:5053/ws/chat?userId=2 - 409 null null 1.5383ms
2025-05-01 23:32:44.389 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/ws/chat?userId=5 - null null
2025-05-01 23:32:44.389 +07:00 [INF] CORS policy execution successful.
2025-05-01 23:32:44.390 +07:00 [INF] CORS policy execution successful.
2025-05-01 23:32:44.390 +07:00 [INF] Executing endpoint '/ws/chat'
2025-05-01 23:32:44.390 +07:00 [INF] Executed endpoint '/ws/chat'
2025-05-01 23:32:44.390 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5053/ws/chat?userId=5 - 409 null null 0.3098ms
2025-05-01 23:32:44.837 +07:00 [INF] Request starting HTTP/1.1 GET http://192.168.1.9:5053/ws/chat?userId=2 - null null
2025-05-01 23:32:44.837 +07:00 [INF] Executing endpoint '/ws/chat'
2025-05-01 23:32:44.837 +07:00 [INF] Executed endpoint '/ws/chat'
2025-05-01 23:32:44.837 +07:00 [INF] Request finished HTTP/1.1 GET http://192.168.1.9:5053/ws/chat?userId=2 - 409 null null 0.3171ms
2025-05-01 23:32:45.543 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/ws/chat?userId=5 - null null
2025-05-01 23:32:45.543 +07:00 [INF] CORS policy execution successful.
2025-05-01 23:32:45.544 +07:00 [INF] CORS policy execution successful.
2025-05-01 23:32:45.544 +07:00 [INF] Executing endpoint '/ws/chat'
2025-05-01 23:32:45.544 +07:00 [INF] Executed endpoint '/ws/chat'
2025-05-01 23:32:45.544 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5053/ws/chat?userId=5 - 409 null null 0.5943ms
2025-05-01 23:32:47.041 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/ws/chat?userId=5 - null null
2025-05-01 23:32:47.041 +07:00 [INF] CORS policy execution successful.
2025-05-01 23:32:47.041 +07:00 [INF] CORS policy execution successful.
2025-05-01 23:32:47.041 +07:00 [INF] Executing endpoint '/ws/chat'
2025-05-01 23:32:47.041 +07:00 [INF] Executed endpoint '/ws/chat'
2025-05-01 23:32:47.041 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5053/ws/chat?userId=5 - 409 null null 0.6031ms
2025-05-01 23:32:47.943 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/ws/chat?userId=5 - null null
2025-05-01 23:32:47.944 +07:00 [INF] CORS policy execution successful.
2025-05-01 23:32:47.944 +07:00 [INF] CORS policy execution successful.
2025-05-01 23:32:47.944 +07:00 [INF] Executing endpoint '/ws/chat'
2025-05-01 23:32:47.944 +07:00 [INF] Executed endpoint '/ws/chat'
2025-05-01 23:32:47.944 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5053/ws/chat?userId=5 - 409 null null 0.6842ms
2025-05-01 23:32:48.259 +07:00 [INF] Request starting HTTP/1.1 GET http://192.168.1.9:5053/ws/chat?userId=2 - null null
2025-05-01 23:32:48.259 +07:00 [INF] Executing endpoint '/ws/chat'
2025-05-01 23:32:48.259 +07:00 [INF] Executed endpoint '/ws/chat'
2025-05-01 23:32:48.259 +07:00 [INF] Request finished HTTP/1.1 GET http://192.168.1.9:5053/ws/chat?userId=2 - 409 null null 0.6122ms
2025-05-01 23:32:49.873 +07:00 [INF] Request starting HTTP/1.1 GET http://192.168.1.9:5053/ws/chat?userId=2 - null null
2025-05-01 23:32:49.873 +07:00 [INF] Executing endpoint '/ws/chat'
2025-05-01 23:32:49.873 +07:00 [INF] Executed endpoint '/ws/chat'
2025-05-01 23:32:49.873 +07:00 [INF] Request finished HTTP/1.1 GET http://192.168.1.9:5053/ws/chat?userId=2 - 409 null null 0.4425ms
2025-05-01 23:32:50.321 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/ws/chat?userId=5 - null null
2025-05-01 23:32:50.321 +07:00 [INF] CORS policy execution successful.
2025-05-01 23:32:50.322 +07:00 [INF] CORS policy execution successful.
2025-05-01 23:32:50.322 +07:00 [INF] Executing endpoint '/ws/chat'
2025-05-01 23:32:50.322 +07:00 [INF] Executed endpoint '/ws/chat'
2025-05-01 23:32:50.322 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5053/ws/chat?userId=5 - 409 null null 0.7885ms
2025-05-01 23:32:53.302 +07:00 [INF] Request starting HTTP/1.1 GET http://192.168.1.9:5053/ws/chat?userId=2 - null null
2025-05-01 23:32:53.302 +07:00 [INF] Executing endpoint '/ws/chat'
2025-05-01 23:32:53.302 +07:00 [INF] Executed endpoint '/ws/chat'
2025-05-01 23:32:53.302 +07:00 [INF] Request finished HTTP/1.1 GET http://192.168.1.9:5053/ws/chat?userId=2 - 409 null null 0.7607ms
2025-05-01 23:32:54.344 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/ws/chat?userId=5 - null null
2025-05-01 23:32:54.344 +07:00 [INF] CORS policy execution successful.
2025-05-01 23:32:54.344 +07:00 [INF] CORS policy execution successful.
2025-05-01 23:32:54.345 +07:00 [INF] Executing endpoint '/ws/chat'
2025-05-01 23:32:54.345 +07:00 [INF] Executed endpoint '/ws/chat'
2025-05-01 23:32:54.345 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5053/ws/chat?userId=5 - 409 null null 0.6611ms
2025-05-01 23:32:54.610 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/ws/chat?userId=5 - null null
2025-05-01 23:32:54.610 +07:00 [INF] CORS policy execution successful.
2025-05-01 23:32:54.610 +07:00 [INF] CORS policy execution successful.
2025-05-01 23:32:54.611 +07:00 [INF] Executing endpoint '/ws/chat'
2025-05-01 23:32:54.611 +07:00 [INF] Executed endpoint '/ws/chat'
2025-05-01 23:32:54.611 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5053/ws/chat?userId=5 - 409 null null 0.5765ms
2025-05-01 23:32:54.750 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/ws/chat?userId=5 - null null
2025-05-01 23:32:54.750 +07:00 [INF] CORS policy execution successful.
2025-05-01 23:32:54.750 +07:00 [INF] CORS policy execution successful.
2025-05-01 23:32:54.750 +07:00 [INF] Executing endpoint '/ws/chat'
2025-05-01 23:32:54.750 +07:00 [INF] Executed endpoint '/ws/chat'
2025-05-01 23:32:54.750 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5053/ws/chat?userId=5 - 409 null null 0.5835ms
2025-05-01 23:32:54.930 +07:00 [INF] Request starting HTTP/1.1 GET http://192.168.1.9:5053/ws/chat?userId=2 - null null
2025-05-01 23:32:54.930 +07:00 [INF] Executing endpoint '/ws/chat'
2025-05-01 23:32:54.930 +07:00 [INF] Executed endpoint '/ws/chat'
2025-05-01 23:32:54.930 +07:00 [INF] Request finished HTTP/1.1 GET http://192.168.1.9:5053/ws/chat?userId=2 - 409 null null 0.4202ms
2025-05-01 23:32:57.784 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/ws/chat?userId=5 - null null
2025-05-01 23:32:57.784 +07:00 [INF] CORS policy execution successful.
2025-05-01 23:32:57.784 +07:00 [INF] CORS policy execution successful.
2025-05-01 23:32:57.784 +07:00 [INF] Executing endpoint '/ws/chat'
2025-05-01 23:32:57.784 +07:00 [INF] Executed endpoint '/ws/chat'
2025-05-01 23:32:57.784 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5053/ws/chat?userId=5 - 409 null null 0.5298ms
2025-05-01 23:32:57.803 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/ws/chat?userId=5 - null null
2025-05-01 23:32:57.804 +07:00 [INF] CORS policy execution successful.
2025-05-01 23:32:57.808 +07:00 [INF] CORS policy execution successful.
2025-05-01 23:32:57.808 +07:00 [INF] Executing endpoint '/ws/chat'
2025-05-01 23:32:57.808 +07:00 [INF] Executed endpoint '/ws/chat'
2025-05-01 23:32:57.808 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5053/ws/chat?userId=5 - 409 null null 4.9636ms
2025-05-01 23:32:58.367 +07:00 [INF] Request starting HTTP/1.1 GET http://192.168.1.9:5053/ws/chat?userId=2 - null null
2025-05-01 23:32:58.368 +07:00 [INF] Executing endpoint '/ws/chat'
2025-05-01 23:32:58.368 +07:00 [INF] Executed endpoint '/ws/chat'
2025-05-01 23:32:58.368 +07:00 [INF] Request finished HTTP/1.1 GET http://192.168.1.9:5053/ws/chat?userId=2 - 409 null null 0.3106ms
2025-05-01 23:33:00.049 +07:00 [INF] Request starting HTTP/1.1 GET http://192.168.1.9:5053/ws/chat?userId=2 - null null
2025-05-01 23:33:00.049 +07:00 [INF] Executing endpoint '/ws/chat'
2025-05-01 23:33:00.049 +07:00 [INF] Executed endpoint '/ws/chat'
2025-05-01 23:33:00.049 +07:00 [INF] Request finished HTTP/1.1 GET http://192.168.1.9:5053/ws/chat?userId=2 - 409 null null 0.2745ms
2025-05-01 23:33:00.771 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/ws/chat?userId=5 - null null
2025-05-01 23:33:00.771 +07:00 [INF] CORS policy execution successful.
2025-05-01 23:33:00.771 +07:00 [INF] CORS policy execution successful.
2025-05-01 23:33:00.771 +07:00 [INF] Executing endpoint '/ws/chat'
2025-05-01 23:33:00.772 +07:00 [INF] Executed endpoint '/ws/chat'
2025-05-01 23:33:00.772 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5053/ws/chat?userId=5 - 409 null null 0.8003ms
2025-05-01 23:33:02.985 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/ws/chat?userId=5 - null null
2025-05-01 23:33:02.985 +07:00 [INF] CORS policy execution successful.
2025-05-01 23:33:02.985 +07:00 [INF] CORS policy execution successful.
2025-05-01 23:33:02.985 +07:00 [INF] Executing endpoint '/ws/chat'
2025-05-01 23:33:02.985 +07:00 [INF] Executed endpoint '/ws/chat'
2025-05-01 23:33:02.985 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5053/ws/chat?userId=5 - 409 null null 0.3821ms
2025-05-01 23:33:03.418 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/ws/chat?userId=5 - null null
2025-05-01 23:33:03.418 +07:00 [INF] CORS policy execution successful.
2025-05-01 23:33:03.418 +07:00 [INF] CORS policy execution successful.
2025-05-01 23:33:03.419 +07:00 [INF] Executing endpoint '/ws/chat'
2025-05-01 23:33:03.419 +07:00 [INF] Executed endpoint '/ws/chat'
2025-05-01 23:33:03.419 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5053/ws/chat?userId=5 - 409 null null 0.411ms
2025-05-01 23:33:03.839 +07:00 [INF] Request starting HTTP/1.1 GET http://192.168.1.9:5053/ws/chat?userId=2 - null null
2025-05-01 23:33:03.839 +07:00 [INF] Executing endpoint '/ws/chat'
2025-05-01 23:33:03.839 +07:00 [INF] Executed endpoint '/ws/chat'
2025-05-01 23:33:03.839 +07:00 [INF] Request finished HTTP/1.1 GET http://192.168.1.9:5053/ws/chat?userId=2 - 409 null null 0.381ms
2025-05-01 23:33:05.075 +07:00 [INF] Request starting HTTP/1.1 GET http://192.168.1.9:5053/ws/chat?userId=2 - null null
2025-05-01 23:33:05.076 +07:00 [INF] Executing endpoint '/ws/chat'
2025-05-01 23:33:05.076 +07:00 [INF] Executed endpoint '/ws/chat'
2025-05-01 23:33:05.076 +07:00 [INF] Request finished HTTP/1.1 GET http://192.168.1.9:5053/ws/chat?userId=2 - 409 null null 0.3956ms
2025-05-01 23:33:06.891 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/ws/chat?userId=5 - null null
2025-05-01 23:33:06.891 +07:00 [INF] CORS policy execution successful.
2025-05-01 23:33:06.891 +07:00 [INF] CORS policy execution successful.
2025-05-01 23:33:06.891 +07:00 [INF] Executing endpoint '/ws/chat'
2025-05-01 23:33:06.892 +07:00 [INF] Executed endpoint '/ws/chat'
2025-05-01 23:33:06.892 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5053/ws/chat?userId=5 - 409 null null 0.6723ms
2025-05-01 23:33:07.312 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/ws/chat?userId=5 - null null
2025-05-01 23:33:07.312 +07:00 [INF] CORS policy execution successful.
2025-05-01 23:33:07.312 +07:00 [INF] CORS policy execution successful.
2025-05-01 23:33:07.312 +07:00 [INF] Executing endpoint '/ws/chat'
2025-05-01 23:33:07.312 +07:00 [INF] Executed endpoint '/ws/chat'
2025-05-01 23:33:07.312 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5053/ws/chat?userId=5 - 409 null null 0.6019ms
2025-05-01 23:33:08.878 +07:00 [INF] Request starting HTTP/1.1 GET http://192.168.1.9:5053/ws/chat?userId=2 - null null
2025-05-01 23:33:08.878 +07:00 [INF] Executing endpoint '/ws/chat'
2025-05-01 23:33:08.878 +07:00 [INF] Executed endpoint '/ws/chat'
2025-05-01 23:33:08.878 +07:00 [INF] Request finished HTTP/1.1 GET http://192.168.1.9:5053/ws/chat?userId=2 - 409 null null 0.5305ms
2025-05-01 23:33:09.902 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/ws/chat?userId=5 - null null
2025-05-01 23:33:09.903 +07:00 [INF] CORS policy execution successful.
2025-05-01 23:33:09.903 +07:00 [INF] CORS policy execution successful.
2025-05-01 23:33:09.903 +07:00 [INF] Executing endpoint '/ws/chat'
2025-05-01 23:33:09.903 +07:00 [INF] Executed endpoint '/ws/chat'
2025-05-01 23:33:09.903 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5053/ws/chat?userId=5 - 409 null null 0.6642ms
2025-05-01 23:33:10.103 +07:00 [INF] Request starting HTTP/1.1 GET http://192.168.1.9:5053/ws/chat?userId=2 - null null
2025-05-01 23:33:10.103 +07:00 [INF] Executing endpoint '/ws/chat'
2025-05-01 23:33:10.103 +07:00 [INF] Executed endpoint '/ws/chat'
2025-05-01 23:33:10.103 +07:00 [INF] Request finished HTTP/1.1 GET http://192.168.1.9:5053/ws/chat?userId=2 - 409 null null 0.5531ms
2025-05-01 23:33:12.207 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/ws/chat?userId=5 - null null
2025-05-01 23:33:12.207 +07:00 [INF] CORS policy execution successful.
2025-05-01 23:33:12.207 +07:00 [INF] CORS policy execution successful.
2025-05-01 23:33:12.208 +07:00 [INF] Executing endpoint '/ws/chat'
2025-05-01 23:33:12.208 +07:00 [INF] Executed endpoint '/ws/chat'
2025-05-01 23:33:12.208 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5053/ws/chat?userId=5 - 409 null null 0.6259ms
2025-05-01 23:33:13.228 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/ws/chat?userId=5 - null null
2025-05-01 23:33:13.228 +07:00 [INF] CORS policy execution successful.
2025-05-01 23:33:13.228 +07:00 [INF] CORS policy execution successful.
2025-05-01 23:33:13.228 +07:00 [INF] Executing endpoint '/ws/chat'
2025-05-01 23:33:13.228 +07:00 [INF] Executed endpoint '/ws/chat'
2025-05-01 23:33:13.228 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5053/ws/chat?userId=5 - 409 null null 0.67ms
2025-05-01 23:33:13.371 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/ws/chat?userId=5 - null null
2025-05-01 23:33:13.371 +07:00 [INF] CORS policy execution successful.
2025-05-01 23:33:13.371 +07:00 [INF] CORS policy execution successful.
2025-05-01 23:33:13.371 +07:00 [INF] Executing endpoint '/ws/chat'
2025-05-01 23:33:13.371 +07:00 [INF] Executed endpoint '/ws/chat'
2025-05-01 23:33:13.371 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5053/ws/chat?userId=5 - 409 null null 0.6355ms
2025-05-01 23:33:14.929 +07:00 [INF] Request starting HTTP/1.1 GET http://192.168.1.9:5053/ws/chat?userId=2 - null null
2025-05-01 23:33:14.929 +07:00 [INF] Executing endpoint '/ws/chat'
2025-05-01 23:33:14.930 +07:00 [INF] Executed endpoint '/ws/chat'
2025-05-01 23:33:14.930 +07:00 [INF] Request finished HTTP/1.1 GET http://192.168.1.9:5053/ws/chat?userId=2 - 409 null null 0.5281ms
2025-05-01 23:33:15.133 +07:00 [INF] Request starting HTTP/1.1 GET http://192.168.1.9:5053/ws/chat?userId=2 - null null
2025-05-01 23:33:15.133 +07:00 [INF] Executing endpoint '/ws/chat'
2025-05-01 23:33:15.133 +07:00 [INF] Executed endpoint '/ws/chat'
2025-05-01 23:33:15.133 +07:00 [INF] Request finished HTTP/1.1 GET http://192.168.1.9:5053/ws/chat?userId=2 - 409 null null 0.4222ms
2025-05-01 23:33:16.877 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/ws/chat?userId=5 - null null
2025-05-01 23:33:16.877 +07:00 [INF] CORS policy execution successful.
2025-05-01 23:33:16.877 +07:00 [INF] CORS policy execution successful.
2025-05-01 23:33:16.877 +07:00 [INF] Executing endpoint '/ws/chat'
2025-05-01 23:33:16.878 +07:00 [INF] Executed endpoint '/ws/chat'
2025-05-01 23:33:16.878 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5053/ws/chat?userId=5 - 409 null null 0.7267ms
2025-05-01 23:33:17.269 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/ws/chat?userId=5 - null null
2025-05-01 23:33:17.269 +07:00 [INF] CORS policy execution successful.
2025-05-01 23:33:17.270 +07:00 [INF] CORS policy execution successful.
2025-05-01 23:33:17.270 +07:00 [INF] Executing endpoint '/ws/chat'
2025-05-01 23:33:17.270 +07:00 [INF] Executed endpoint '/ws/chat'
2025-05-01 23:33:17.270 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5053/ws/chat?userId=5 - 409 null null 0.9744ms
2025-05-01 23:33:19.176 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/ws/chat?userId=5 - null null
2025-05-01 23:33:19.176 +07:00 [INF] CORS policy execution successful.
2025-05-01 23:33:19.177 +07:00 [INF] CORS policy execution successful.
2025-05-01 23:33:19.177 +07:00 [INF] Executing endpoint '/ws/chat'
2025-05-01 23:33:19.177 +07:00 [INF] Executed endpoint '/ws/chat'
2025-05-01 23:33:19.177 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5053/ws/chat?userId=5 - 409 null null 1.0069ms
2025-05-01 23:33:19.381 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/ws/chat?userId=5 - null null
2025-05-01 23:33:19.382 +07:00 [INF] CORS policy execution successful.
2025-05-01 23:33:19.383 +07:00 [INF] CORS policy execution successful.
2025-05-01 23:33:19.383 +07:00 [INF] Executing endpoint '/ws/chat'
2025-05-01 23:33:19.383 +07:00 [INF] Executed endpoint '/ws/chat'
2025-05-01 23:33:19.383 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5053/ws/chat?userId=5 - 409 null null 1.6063ms
2025-05-01 23:33:19.959 +07:00 [INF] Request starting HTTP/1.1 GET http://192.168.1.9:5053/ws/chat?userId=2 - null null
2025-05-01 23:33:19.959 +07:00 [INF] Executing endpoint '/ws/chat'
2025-05-01 23:33:19.959 +07:00 [INF] Executed endpoint '/ws/chat'
2025-05-01 23:33:19.959 +07:00 [INF] Request finished HTTP/1.1 GET http://192.168.1.9:5053/ws/chat?userId=2 - 409 null null 0.2769ms
2025-05-01 23:33:20.258 +07:00 [INF] Request starting HTTP/1.1 GET http://192.168.1.9:5053/ws/chat?userId=2 - null null
2025-05-01 23:33:20.258 +07:00 [INF] Executing endpoint '/ws/chat'
2025-05-01 23:33:20.258 +07:00 [INF] Executed endpoint '/ws/chat'
2025-05-01 23:33:20.258 +07:00 [INF] Request finished HTTP/1.1 GET http://192.168.1.9:5053/ws/chat?userId=2 - 409 null null 0.4924ms
2025-05-01 23:33:20.724 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/ws/chat?userId=5 - null null
2025-05-01 23:33:20.724 +07:00 [INF] CORS policy execution successful.
2025-05-01 23:33:20.724 +07:00 [INF] CORS policy execution successful.
2025-05-01 23:33:20.724 +07:00 [INF] Executing endpoint '/ws/chat'
2025-05-01 23:33:20.724 +07:00 [INF] Executed endpoint '/ws/chat'
2025-05-01 23:33:20.724 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5053/ws/chat?userId=5 - 409 null null 0.7052ms
2025-05-01 23:33:23.421 +07:00 [INF] Application is shutting down...
2025-05-01 23:33:28.911 +07:00 [INF] Executed endpoint '/ws/chat'
2025-05-01 23:33:28.911 +07:00 [INF] Executed endpoint '/ws/chat'
2025-05-01 23:33:28.912 +07:00 [ERR] An unhandled exception has occurred while executing the request.
System.Net.WebSockets.WebSocketException (0x80004005): The remote party closed the WebSocket connection without completing the close handshake.
   at System.Net.WebSockets.ManagedWebSocket.ThrowEOFUnexpected()
   at System.Net.WebSockets.ManagedWebSocket.EnsureBufferContainsAsync(Int32 minimumRequiredBytes, CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.WebSockets.ManagedWebSocket.ReceiveAsyncPrivate[TResult](Memory`1 payloadBuffer, CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at System.Threading.Tasks.ValueTask`1.ValueTaskSourceAsTask.<>c.<.cctor>b__4_0(Object state)
--- End of stack trace from previous location ---
   at server.Services.WebSocketService.webSocket.Receiver(Client client) in C:\Users\Thao\source\Flutter\Message_app\server\Services\WebSocketService\websocket.cs:line 124
   at server.Services.WebSocketService.webSocket.HandleWebSocket(HttpContext context) in C:\Users\Thao\source\Flutter\Message_app\server\Services\WebSocketService\websocket.cs:line 107
   at Program.<>c.<<<Main>$>b__0_4>d.MoveNext() in C:\Users\Thao\source\Flutter\Message_app\server\Program.cs:line 89
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
2025-05-01 23:33:28.912 +07:00 [ERR] An unhandled exception has occurred while executing the request.
System.Net.WebSockets.WebSocketException (0x80004005): The remote party closed the WebSocket connection without completing the close handshake.
   at System.Net.WebSockets.ManagedWebSocket.ThrowEOFUnexpected()
   at System.Net.WebSockets.ManagedWebSocket.EnsureBufferContainsAsync(Int32 minimumRequiredBytes, CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.WebSockets.ManagedWebSocket.ReceiveAsyncPrivate[TResult](Memory`1 payloadBuffer, CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at System.Threading.Tasks.ValueTask`1.ValueTaskSourceAsTask.<>c.<.cctor>b__4_0(Object state)
--- End of stack trace from previous location ---
   at server.Services.WebSocketService.webSocket.Receiver(Client client) in C:\Users\Thao\source\Flutter\Message_app\server\Services\WebSocketService\websocket.cs:line 124
   at server.Services.WebSocketService.webSocket.HandleWebSocket(HttpContext context) in C:\Users\Thao\source\Flutter\Message_app\server\Services\WebSocketService\websocket.cs:line 107
   at Program.<>c.<<<Main>$>b__0_4>d.MoveNext() in C:\Users\Thao\source\Flutter\Message_app\server\Program.cs:line 89
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
2025-05-01 23:33:28.944 +07:00 [WRN] The response has already started, the error page middleware will not be executed.
2025-05-01 23:33:28.944 +07:00 [WRN] The response has already started, the error page middleware will not be executed.
2025-05-01 23:33:28.946 +07:00 [ERR] Connection id "0HNC8PMGM87UL", Request id "0HNC8PMGM87UL:00000001": An unhandled exception was thrown by the application.
System.Net.WebSockets.WebSocketException (0x80004005): The remote party closed the WebSocket connection without completing the close handshake.
   at System.Net.WebSockets.ManagedWebSocket.ThrowEOFUnexpected()
   at System.Net.WebSockets.ManagedWebSocket.EnsureBufferContainsAsync(Int32 minimumRequiredBytes, CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.WebSockets.ManagedWebSocket.ReceiveAsyncPrivate[TResult](Memory`1 payloadBuffer, CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at System.Threading.Tasks.ValueTask`1.ValueTaskSourceAsTask.<>c.<.cctor>b__4_0(Object state)
--- End of stack trace from previous location ---
   at server.Services.WebSocketService.webSocket.Receiver(Client client) in C:\Users\Thao\source\Flutter\Message_app\server\Services\WebSocketService\websocket.cs:line 124
   at server.Services.WebSocketService.webSocket.HandleWebSocket(HttpContext context) in C:\Users\Thao\source\Flutter\Message_app\server\Services\WebSocketService\websocket.cs:line 107
   at Program.<>c.<<<Main>$>b__0_4>d.MoveNext() in C:\Users\Thao\source\Flutter\Message_app\server\Program.cs:line 89
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Watch.BrowserRefresh.BrowserRefreshMiddleware.InvokeAsync(HttpContext context)
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.Http.HttpProtocol.ProcessRequests[TContext](IHttpApplication`1 application)
2025-05-01 23:33:28.946 +07:00 [ERR] Connection id "0HNC8PMGM87UM", Request id "0HNC8PMGM87UM:00000001": An unhandled exception was thrown by the application.
System.Net.WebSockets.WebSocketException (0x80004005): The remote party closed the WebSocket connection without completing the close handshake.
   at System.Net.WebSockets.ManagedWebSocket.ThrowEOFUnexpected()
   at System.Net.WebSockets.ManagedWebSocket.EnsureBufferContainsAsync(Int32 minimumRequiredBytes, CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.WebSockets.ManagedWebSocket.ReceiveAsyncPrivate[TResult](Memory`1 payloadBuffer, CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at System.Threading.Tasks.ValueTask`1.ValueTaskSourceAsTask.<>c.<.cctor>b__4_0(Object state)
--- End of stack trace from previous location ---
   at server.Services.WebSocketService.webSocket.Receiver(Client client) in C:\Users\Thao\source\Flutter\Message_app\server\Services\WebSocketService\websocket.cs:line 124
   at server.Services.WebSocketService.webSocket.HandleWebSocket(HttpContext context) in C:\Users\Thao\source\Flutter\Message_app\server\Services\WebSocketService\websocket.cs:line 107
   at Program.<>c.<<<Main>$>b__0_4>d.MoveNext() in C:\Users\Thao\source\Flutter\Message_app\server\Program.cs:line 89
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Watch.BrowserRefresh.BrowserRefreshMiddleware.InvokeAsync(HttpContext context)
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.Http.HttpProtocol.ProcessRequests[TContext](IHttpApplication`1 application)
2025-05-01 23:33:28.950 +07:00 [INF] Request finished HTTP/1.1 GET http://192.168.1.9:5053/ws/chat?userId=2 - 101 null null 110942.7256ms
2025-05-01 23:33:28.949 +07:00 [INF] Request finished HTTP/1.1 GET http://192.168.1.9:5053/ws/chat?userId=2 - 101 null null 110943.84ms
2025-05-01 23:33:32.480 +07:00 [INF] Executed endpoint '/ws/chat'
2025-05-01 23:33:32.482 +07:00 [INF] Executed endpoint '/ws/chat'
2025-05-01 23:33:32.481 +07:00 [ERR] An unhandled exception has occurred while executing the request.
StackExchange.Redis.RedisServerException: WRONGTYPE Operation against a key holding the wrong kind of value
   at server.Services.WebSocketService.webSocket.CleanupClient(Client client) in C:\Users\Thao\source\Flutter\Message_app\server\Services\WebSocketService\websocket.cs:line 471
   at server.Services.WebSocketService.webSocket.HandleWebSocket(HttpContext context) in C:\Users\Thao\source\Flutter\Message_app\server\Services\WebSocketService\websocket.cs:line 109
   at Program.<>c.<<<Main>$>b__0_4>d.MoveNext() in C:\Users\Thao\source\Flutter\Message_app\server\Program.cs:line 89
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
2025-05-01 23:33:32.482 +07:00 [INF] Executed endpoint '/ws/chat'
2025-05-01 23:33:32.482 +07:00 [WRN] The response has already started, the error page middleware will not be executed.
2025-05-01 23:33:32.482 +07:00 [ERR] An unhandled exception has occurred while executing the request.
StackExchange.Redis.RedisServerException: WRONGTYPE Operation against a key holding the wrong kind of value
   at server.Services.WebSocketService.webSocket.CleanupClient(Client client) in C:\Users\Thao\source\Flutter\Message_app\server\Services\WebSocketService\websocket.cs:line 471
   at server.Services.WebSocketService.webSocket.HandleWebSocket(HttpContext context) in C:\Users\Thao\source\Flutter\Message_app\server\Services\WebSocketService\websocket.cs:line 109
   at Program.<>c.<<<Main>$>b__0_4>d.MoveNext() in C:\Users\Thao\source\Flutter\Message_app\server\Program.cs:line 89
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
2025-05-01 23:33:32.482 +07:00 [ERR] An unhandled exception has occurred while executing the request.
StackExchange.Redis.RedisServerException: WRONGTYPE Operation against a key holding the wrong kind of value
   at server.Services.WebSocketService.webSocket.CleanupClient(Client client) in C:\Users\Thao\source\Flutter\Message_app\server\Services\WebSocketService\websocket.cs:line 471
   at server.Services.WebSocketService.webSocket.HandleWebSocket(HttpContext context) in C:\Users\Thao\source\Flutter\Message_app\server\Services\WebSocketService\websocket.cs:line 109
   at Program.<>c.<<<Main>$>b__0_4>d.MoveNext() in C:\Users\Thao\source\Flutter\Message_app\server\Program.cs:line 89
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
2025-05-01 23:33:32.483 +07:00 [WRN] The response has already started, the error page middleware will not be executed.
2025-05-01 23:33:32.483 +07:00 [WRN] The response has already started, the error page middleware will not be executed.
2025-05-01 23:33:32.482 +07:00 [ERR] Connection id "0HNC8PMGM87UG", Request id "0HNC8PMGM87UG:00000001": An unhandled exception was thrown by the application.
StackExchange.Redis.RedisServerException: WRONGTYPE Operation against a key holding the wrong kind of value
   at server.Services.WebSocketService.webSocket.CleanupClient(Client client) in C:\Users\Thao\source\Flutter\Message_app\server\Services\WebSocketService\websocket.cs:line 471
   at server.Services.WebSocketService.webSocket.HandleWebSocket(HttpContext context) in C:\Users\Thao\source\Flutter\Message_app\server\Services\WebSocketService\websocket.cs:line 109
   at Program.<>c.<<<Main>$>b__0_4>d.MoveNext() in C:\Users\Thao\source\Flutter\Message_app\server\Program.cs:line 89
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Watch.BrowserRefresh.BrowserRefreshMiddleware.InvokeAsync(HttpContext context)
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.Http.HttpProtocol.ProcessRequests[TContext](IHttpApplication`1 application)
2025-05-01 23:33:32.484 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5053/ws/chat?userId=5 - 101 null null 120958.3685ms
2025-05-01 23:33:32.483 +07:00 [ERR] Connection id "0HNC8PMGM87UF", Request id "0HNC8PMGM87UF:00000001": An unhandled exception was thrown by the application.
StackExchange.Redis.RedisServerException: WRONGTYPE Operation against a key holding the wrong kind of value
   at server.Services.WebSocketService.webSocket.CleanupClient(Client client) in C:\Users\Thao\source\Flutter\Message_app\server\Services\WebSocketService\websocket.cs:line 471
   at server.Services.WebSocketService.webSocket.HandleWebSocket(HttpContext context) in C:\Users\Thao\source\Flutter\Message_app\server\Services\WebSocketService\websocket.cs:line 109
   at Program.<>c.<<<Main>$>b__0_4>d.MoveNext() in C:\Users\Thao\source\Flutter\Message_app\server\Program.cs:line 89
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Watch.BrowserRefresh.BrowserRefreshMiddleware.InvokeAsync(HttpContext context)
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.Http.HttpProtocol.ProcessRequests[TContext](IHttpApplication`1 application)
2025-05-01 23:33:32.483 +07:00 [ERR] Connection id "0HNC8PMGM87UH", Request id "0HNC8PMGM87UH:00000001": An unhandled exception was thrown by the application.
StackExchange.Redis.RedisServerException: WRONGTYPE Operation against a key holding the wrong kind of value
   at server.Services.WebSocketService.webSocket.CleanupClient(Client client) in C:\Users\Thao\source\Flutter\Message_app\server\Services\WebSocketService\websocket.cs:line 471
   at server.Services.WebSocketService.webSocket.HandleWebSocket(HttpContext context) in C:\Users\Thao\source\Flutter\Message_app\server\Services\WebSocketService\websocket.cs:line 109
   at Program.<>c.<<<Main>$>b__0_4>d.MoveNext() in C:\Users\Thao\source\Flutter\Message_app\server\Program.cs:line 89
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Watch.BrowserRefresh.BrowserRefreshMiddleware.InvokeAsync(HttpContext context)
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.Http.HttpProtocol.ProcessRequests[TContext](IHttpApplication`1 application)
2025-05-01 23:33:32.485 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5053/ws/chat?userId=5 - 101 null null 120947.2519ms
2025-05-01 23:33:32.484 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5053/ws/chat?userId=5 - 101 null null 121076.9662ms
2025-05-01 23:41:07.751 +07:00 [INF] Executed DbCommand (37ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [u].[id], [u].[username], [u].[avatar_url]
FROM [Users] AS [u]
2025-05-01 23:41:07.900 +07:00 [INF] User profile is available. Using 'C:\Users\Thao\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-05-01 23:41:07.955 +07:00 [WRN] Overriding address(es) 'http://localhost:5053'. Binding to endpoints defined via IConfiguration and/or UseKestrel() instead.
2025-05-01 23:41:07.966 +07:00 [INF] Now listening on: http://[::]:5053
2025-05-01 23:41:07.966 +07:00 [INF] Now listening on: http://0.0.0.0:5053
2025-05-01 23:41:07.966 +07:00 [INF] Application started. Press Ctrl+C to shut down.
2025-05-01 23:41:07.966 +07:00 [INF] Hosting environment: Development
2025-05-01 23:41:07.966 +07:00 [INF] Content root path: C:\Users\Thao\source\Flutter\Message_app\server
2025-05-01 23:42:57.208 +07:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5053/api/Auth/login - null null
2025-05-01 23:42:57.318 +07:00 [INF] CORS policy execution successful.
2025-05-01 23:42:57.340 +07:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5053/api/Auth/login - 204 null null 137.3462ms
2025-05-01 23:42:57.360 +07:00 [INF] Request starting HTTP/1.1 POST http://localhost:5053/api/Auth/login - application/json 53
2025-05-01 23:42:57.366 +07:00 [INF] CORS policy execution successful.
2025-05-01 23:42:57.426 +07:00 [INF] CORS policy execution successful.
2025-05-01 23:42:57.428 +07:00 [WRN] Failed to determine the https port for redirect.
2025-05-01 23:42:57.515 +07:00 [INF] Executing endpoint 'Message_app.Controllers.AuthController.Login (Message_app)'
2025-05-01 23:42:57.574 +07:00 [INF] Route matched with {action = "Login", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Login(server.DTO.AuthDTO.LoginDTO) on controller Message_app.Controllers.AuthController (Message_app).
2025-05-01 23:42:58.063 +07:00 [INF] Executed DbCommand (100ms) [Parameters=[@__email_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[id], [u].[avatar_url], [u].[bio], [u].[birthday], [u].[created_at], [u].[email], [u].[gender], [u].[interests], [u].[location], [u].[password], [u].[passwordSalt], [u].[username]
FROM [Users] AS [u]
WHERE [u].[email] = @__email_0
2025-05-01 23:42:58.294 +07:00 [INF] Executing OkObjectResult, writing value of type 'server.DTO.AuthDTO.LoginRespose'.
2025-05-01 23:42:58.450 +07:00 [INF] Executed action Message_app.Controllers.AuthController.Login (Message_app) in 868.7781ms
2025-05-01 23:42:58.452 +07:00 [INF] Executed endpoint 'Message_app.Controllers.AuthController.Login (Message_app)'
2025-05-01 23:42:58.469 +07:00 [INF] Request finished HTTP/1.1 POST http://localhost:5053/api/Auth/login - 200 null application/json; charset=utf-8 1109.0357ms
2025-05-01 23:42:58.675 +07:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5053/api/Conversation/get_conversations/5 - null null
2025-05-01 23:42:58.677 +07:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5053/api/Conversation/get_conversations/5 - null null
2025-05-01 23:42:58.677 +07:00 [INF] CORS policy execution successful.
2025-05-01 23:42:58.677 +07:00 [INF] CORS policy execution successful.
2025-05-01 23:42:58.677 +07:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5053/api/Conversation/get_conversations/5 - 204 null null 1.8165ms
2025-05-01 23:42:58.677 +07:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5053/api/Conversation/get_conversations/5 - 204 null null 0.5182ms
2025-05-01 23:42:58.679 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/api/Conversation/get_conversations/5 - null null
2025-05-01 23:42:58.685 +07:00 [INF] CORS policy execution successful.
2025-05-01 23:42:58.690 +07:00 [INF] CORS policy execution successful.
2025-05-01 23:42:58.694 +07:00 [INF] Executing endpoint 'server.Controllers.ConversationController.GetConversations (Message_app)'
2025-05-01 23:42:58.705 +07:00 [INF] Route matched with {action = "GetConversations", controller = "Conversation"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetConversations(Int32) on controller server.Controllers.ConversationController (Message_app).
2025-05-01 23:42:58.758 +07:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[server.DTO.ConversationDto, Message_app, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-05-01 23:42:58.767 +07:00 [INF] Executed action server.Controllers.ConversationController.GetConversations (Message_app) in 61.8988ms
2025-05-01 23:42:58.768 +07:00 [INF] Executed endpoint 'server.Controllers.ConversationController.GetConversations (Message_app)'
2025-05-01 23:42:58.768 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5053/api/Conversation/get_conversations/5 - 200 null application/json; charset=utf-8 88.7273ms
2025-05-01 23:42:58.769 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/api/Conversation/get_conversations/5 - null null
2025-05-01 23:42:58.771 +07:00 [INF] CORS policy execution successful.
2025-05-01 23:42:58.774 +07:00 [INF] CORS policy execution successful.
2025-05-01 23:42:58.777 +07:00 [INF] Executing endpoint 'server.Controllers.ConversationController.GetConversations (Message_app)'
2025-05-01 23:42:58.777 +07:00 [INF] Route matched with {action = "GetConversations", controller = "Conversation"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetConversations(Int32) on controller server.Controllers.ConversationController (Message_app).
2025-05-01 23:42:58.779 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/ws/chat?userId=5 - null null
2025-05-01 23:42:58.783 +07:00 [INF] CORS policy execution successful.
2025-05-01 23:42:58.784 +07:00 [INF] CORS policy execution successful.
2025-05-01 23:42:58.784 +07:00 [INF] Executing endpoint '/ws/chat'
2025-05-01 23:42:58.788 +07:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[server.DTO.ConversationDto, Message_app, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-05-01 23:42:58.788 +07:00 [INF] Executed action server.Controllers.ConversationController.GetConversations (Message_app) in 10.3491ms
2025-05-01 23:42:58.789 +07:00 [INF] Executed endpoint 'server.Controllers.ConversationController.GetConversations (Message_app)'
2025-05-01 23:42:58.789 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5053/api/Conversation/get_conversations/5 - 200 null application/json; charset=utf-8 20.3235ms
2025-05-01 23:42:59.036 +07:00 [INF] Executed DbCommand (23ms) [Parameters=[@__client_UserId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[conversation_id]
FROM [Participants] AS [p]
WHERE [p].[user_id] = @__client_UserId_0 AND [p].[is_deleted] = CAST(0 AS bit)
2025-05-01 23:43:01.410 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/ws/chat?userId=5 - null null
2025-05-01 23:43:01.411 +07:00 [INF] CORS policy execution successful.
2025-05-01 23:43:01.412 +07:00 [INF] CORS policy execution successful.
2025-05-01 23:43:01.412 +07:00 [INF] Executing endpoint '/ws/chat'
2025-05-01 23:43:01.415 +07:00 [INF] Executed endpoint '/ws/chat'
2025-05-01 23:43:01.417 +07:00 [ERR] An unhandled exception has occurred while executing the request.
System.InvalidOperationException: StatusCode cannot be set because the response has already started.
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.Http.HttpProtocol.ThrowResponseAlreadyStartedException(String value)
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.Http.HttpProtocol.set_StatusCode(Int32 value)
   at server.Services.WebSocketService.webSocket.HandleWebSocket(HttpContext context) in C:\Users\Thao\source\Flutter\Message_app\server\Services\WebSocketService\websocket.cs:line 91
   at Program.<>c.<<<Main>$>b__0_4>d.MoveNext() in C:\Users\Thao\source\Flutter\Message_app\server\Program.cs:line 89
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
2025-05-01 23:43:01.461 +07:00 [WRN] The response has already started, the error page middleware will not be executed.
2025-05-01 23:43:01.464 +07:00 [ERR] Connection id "0HNC8PST1OJON", Request id "0HNC8PST1OJON:00000001": An unhandled exception was thrown by the application.
System.InvalidOperationException: StatusCode cannot be set because the response has already started.
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.Http.HttpProtocol.ThrowResponseAlreadyStartedException(String value)
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.Http.HttpProtocol.set_StatusCode(Int32 value)
   at server.Services.WebSocketService.webSocket.HandleWebSocket(HttpContext context) in C:\Users\Thao\source\Flutter\Message_app\server\Services\WebSocketService\websocket.cs:line 91
   at Program.<>c.<<<Main>$>b__0_4>d.MoveNext() in C:\Users\Thao\source\Flutter\Message_app\server\Program.cs:line 89
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Watch.BrowserRefresh.BrowserRefreshMiddleware.InvokeAsync(HttpContext context)
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.Http.HttpProtocol.ProcessRequests[TContext](IHttpApplication`1 application)
2025-05-01 23:43:01.469 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5053/ws/chat?userId=5 - 101 null null 59.2141ms
2025-05-01 23:43:01.523 +07:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5053/api/Message/getMessages/1/5 - null null
2025-05-01 23:43:01.524 +07:00 [INF] CORS policy execution successful.
2025-05-01 23:43:01.537 +07:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5053/api/Message/getMessages/1/5 - 204 null null 0.8793ms
2025-05-01 23:43:01.540 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/api/Message/getMessages/1/5 - null null
2025-05-01 23:43:01.541 +07:00 [INF] CORS policy execution successful.
2025-05-01 23:43:01.541 +07:00 [INF] CORS policy execution successful.
2025-05-01 23:43:01.541 +07:00 [INF] Executing endpoint 'server.Controllers.MessageController.GetMessages (Message_app)'
2025-05-01 23:43:01.564 +07:00 [INF] Route matched with {action = "GetMessages", controller = "Message"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetMessages(Int32, Int32) on controller server.Controllers.MessageController (Message_app).
2025-05-01 23:43:01.682 +07:00 [WRN] Message 84 not found in Redis
2025-05-01 23:43:01.683 +07:00 [WRN] Message 83 not found in Redis
2025-05-01 23:43:01.683 +07:00 [WRN] Message 82 not found in Redis
2025-05-01 23:43:01.684 +07:00 [WRN] Message 81 not found in Redis
2025-05-01 23:43:01.684 +07:00 [WRN] Message 80 not found in Redis
2025-05-01 23:43:01.685 +07:00 [WRN] Message 79 not found in Redis
2025-05-01 23:43:01.686 +07:00 [WRN] Message 78 not found in Redis
2025-05-01 23:43:01.686 +07:00 [WRN] Message 77 not found in Redis
2025-05-01 23:43:01.687 +07:00 [WRN] Message 76 not found in Redis
2025-05-01 23:43:01.688 +07:00 [WRN] Message 75 not found in Redis
2025-05-01 23:43:01.689 +07:00 [WRN] Message 74 not found in Redis
2025-05-01 23:43:01.690 +07:00 [WRN] Message 73 not found in Redis
2025-05-01 23:43:01.690 +07:00 [WRN] Message 72 not found in Redis
2025-05-01 23:43:01.691 +07:00 [WRN] Message 71 not found in Redis
2025-05-01 23:43:01.692 +07:00 [WRN] Message 68 not found in Redis
2025-05-01 23:43:01.693 +07:00 [WRN] Message 64 not found in Redis
2025-05-01 23:43:01.694 +07:00 [WRN] Message 62 not found in Redis
2025-05-01 23:43:01.697 +07:00 [WRN] Message 61 not found in Redis
2025-05-01 23:43:01.697 +07:00 [WRN] Message 60 not found in Redis
2025-05-01 23:43:01.698 +07:00 [WRN] Message 59 not found in Redis
2025-05-01 23:43:01.698 +07:00 [WRN] Message 57 not found in Redis
2025-05-01 23:43:01.699 +07:00 [WRN] Message 55 not found in Redis
2025-05-01 23:43:01.700 +07:00 [WRN] Message 54 not found in Redis
2025-05-01 23:43:01.702 +07:00 [WRN] Message 51 not found in Redis
2025-05-01 23:43:01.703 +07:00 [WRN] Message 49 not found in Redis
2025-05-01 23:43:01.704 +07:00 [WRN] Message 11 not found in Redis
2025-05-01 23:43:01.705 +07:00 [WRN] Message 8 not found in Redis
2025-05-01 23:43:01.706 +07:00 [WRN] Message 3 not found in Redis
2025-05-01 23:43:01.707 +07:00 [WRN] Message 2 not found in Redis
2025-05-01 23:43:01.707 +07:00 [WRN] Message 1 not found in Redis
2025-05-01 23:43:01.707 +07:00 [INF] Retrieved 9 messages from Redis for conversation 1
2025-05-01 23:43:01.711 +07:00 [INF] Retrieved 9 messages from Redis for conversation 1 and user 5
2025-05-01 23:43:01.711 +07:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[server.DTO.MessageWithAttachment, Message_app, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-05-01 23:43:01.720 +07:00 [INF] Executed action server.Controllers.MessageController.GetMessages (Message_app) in 155.8596ms
2025-05-01 23:43:01.720 +07:00 [INF] Executed endpoint 'server.Controllers.MessageController.GetMessages (Message_app)'
2025-05-01 23:43:01.721 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5053/api/Message/getMessages/1/5 - 200 null application/json; charset=utf-8 180.4342ms
2025-05-01 23:43:01.739 +07:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5053/api/Conversation/get_first_conversation/1 - null null
2025-05-01 23:43:01.739 +07:00 [INF] CORS policy execution successful.
2025-05-01 23:43:01.740 +07:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5053/api/Conversation/get_first_conversation/1 - 204 null null 0.8891ms
2025-05-01 23:43:01.742 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/api/Conversation/get_first_conversation/1 - null null
2025-05-01 23:43:01.742 +07:00 [INF] CORS policy execution successful.
2025-05-01 23:43:01.743 +07:00 [INF] CORS policy execution successful.
2025-05-01 23:43:01.743 +07:00 [INF] Executing endpoint 'server.Controllers.ConversationController.GetFirstConversation (Message_app)'
2025-05-01 23:43:01.752 +07:00 [INF] Route matched with {action = "GetFirstConversation", controller = "Conversation"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetFirstConversation(Int32) on controller server.Controllers.ConversationController (Message_app).
2025-05-01 23:43:01.822 +07:00 [INF] Executed DbCommand (7ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[id], [c].[created_at], [c].[is_group], [c].[lastMessage], [c].[lastMessageSender], [c].[lastMessageTime], [c].[name]
FROM [Conversations] AS [c]
WHERE [c].[id] = @__p_0
2025-05-01 23:43:01.876 +07:00 [INF] Executing OkObjectResult, writing value of type 'server.Models.Conversation'.
2025-05-01 23:43:01.883 +07:00 [INF] Executed action server.Controllers.ConversationController.GetFirstConversation (Message_app) in 130.7689ms
2025-05-01 23:43:01.884 +07:00 [INF] Executed endpoint 'server.Controllers.ConversationController.GetFirstConversation (Message_app)'
2025-05-01 23:43:01.886 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5053/api/Conversation/get_first_conversation/1 - 200 null application/json; charset=utf-8 143.7648ms
2025-05-01 23:43:01.903 +07:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5053/api/Participant/get_participants/1 - null null
2025-05-01 23:43:01.904 +07:00 [INF] CORS policy execution successful.
2025-05-01 23:43:01.905 +07:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5053/api/Participant/get_participants/1 - 204 null null 1.7211ms
2025-05-01 23:43:01.908 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/api/Participant/get_participants/1 - null null
2025-05-01 23:43:01.908 +07:00 [INF] CORS policy execution successful.
2025-05-01 23:43:01.908 +07:00 [INF] CORS policy execution successful.
2025-05-01 23:43:01.909 +07:00 [INF] Executing endpoint 'server.Controllers.ParticipantController.GetParticipants (Message_app)'
2025-05-01 23:43:01.925 +07:00 [INF] Route matched with {action = "GetParticipants", controller = "Participant"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetParticipants(Int32) on controller server.Controllers.ParticipantController (Message_app).
2025-05-01 23:43:01.949 +07:00 [INF] Executed DbCommand (6ms) [Parameters=[@__conversation_id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[id], [p].[adder], [p].[conversation_id], [p].[is_deleted], [p].[joined_at], [p].[name], [p].[role], [p].[user_id]
FROM [Participants] AS [p]
WHERE [p].[conversation_id] = @__conversation_id_0
2025-05-01 23:43:01.979 +07:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType17`1[[System.Collections.Generic.List`1[[server.Models.Participants, Message_app, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-05-01 23:43:02.005 +07:00 [INF] Executed action server.Controllers.ParticipantController.GetParticipants (Message_app) in 80.0324ms
2025-05-01 23:43:02.005 +07:00 [INF] Executed endpoint 'server.Controllers.ParticipantController.GetParticipants (Message_app)'
2025-05-01 23:43:02.006 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5053/api/Participant/get_participants/1 - 200 null application/json; charset=utf-8 98.0346ms
2025-05-01 23:43:06.526 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/ws/chat?userId=5 - null null
2025-05-01 23:43:06.527 +07:00 [INF] CORS policy execution successful.
2025-05-01 23:43:06.527 +07:00 [INF] CORS policy execution successful.
2025-05-01 23:43:06.528 +07:00 [INF] Executing endpoint '/ws/chat'
2025-05-01 23:43:06.529 +07:00 [INF] Executed endpoint '/ws/chat'
2025-05-01 23:43:06.530 +07:00 [ERR] An unhandled exception has occurred while executing the request.
System.InvalidOperationException: StatusCode cannot be set because the response has already started.
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.Http.HttpProtocol.ThrowResponseAlreadyStartedException(String value)
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.Http.HttpProtocol.set_StatusCode(Int32 value)
   at server.Services.WebSocketService.webSocket.HandleWebSocket(HttpContext context) in C:\Users\Thao\source\Flutter\Message_app\server\Services\WebSocketService\websocket.cs:line 91
   at Program.<>c.<<<Main>$>b__0_4>d.MoveNext() in C:\Users\Thao\source\Flutter\Message_app\server\Program.cs:line 89
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
2025-05-01 23:43:06.532 +07:00 [WRN] The response has already started, the error page middleware will not be executed.
2025-05-01 23:43:06.532 +07:00 [ERR] Connection id "0HNC8PST1OJOO", Request id "0HNC8PST1OJOO:00000001": An unhandled exception was thrown by the application.
System.InvalidOperationException: StatusCode cannot be set because the response has already started.
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.Http.HttpProtocol.ThrowResponseAlreadyStartedException(String value)
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.Http.HttpProtocol.set_StatusCode(Int32 value)
   at server.Services.WebSocketService.webSocket.HandleWebSocket(HttpContext context) in C:\Users\Thao\source\Flutter\Message_app\server\Services\WebSocketService\websocket.cs:line 91
   at Program.<>c.<<<Main>$>b__0_4>d.MoveNext() in C:\Users\Thao\source\Flutter\Message_app\server\Program.cs:line 89
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Watch.BrowserRefresh.BrowserRefreshMiddleware.InvokeAsync(HttpContext context)
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.Http.HttpProtocol.ProcessRequests[TContext](IHttpApplication`1 application)
2025-05-01 23:43:06.535 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5053/ws/chat?userId=5 - 101 null null 8.5771ms
2025-05-01 23:43:11.543 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/ws/chat?userId=5 - null null
2025-05-01 23:43:11.543 +07:00 [INF] CORS policy execution successful.
2025-05-01 23:43:11.544 +07:00 [INF] CORS policy execution successful.
2025-05-01 23:43:11.546 +07:00 [INF] Executing endpoint '/ws/chat'
2025-05-01 23:43:11.548 +07:00 [INF] Executed endpoint '/ws/chat'
2025-05-01 23:43:11.551 +07:00 [ERR] An unhandled exception has occurred while executing the request.
System.InvalidOperationException: StatusCode cannot be set because the response has already started.
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.Http.HttpProtocol.ThrowResponseAlreadyStartedException(String value)
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.Http.HttpProtocol.set_StatusCode(Int32 value)
   at server.Services.WebSocketService.webSocket.HandleWebSocket(HttpContext context) in C:\Users\Thao\source\Flutter\Message_app\server\Services\WebSocketService\websocket.cs:line 91
   at Program.<>c.<<<Main>$>b__0_4>d.MoveNext() in C:\Users\Thao\source\Flutter\Message_app\server\Program.cs:line 89
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
2025-05-01 23:43:11.555 +07:00 [WRN] The response has already started, the error page middleware will not be executed.
2025-05-01 23:43:11.557 +07:00 [ERR] Connection id "0HNC8PST1OJOP", Request id "0HNC8PST1OJOP:00000001": An unhandled exception was thrown by the application.
System.InvalidOperationException: StatusCode cannot be set because the response has already started.
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.Http.HttpProtocol.ThrowResponseAlreadyStartedException(String value)
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.Http.HttpProtocol.set_StatusCode(Int32 value)
   at server.Services.WebSocketService.webSocket.HandleWebSocket(HttpContext context) in C:\Users\Thao\source\Flutter\Message_app\server\Services\WebSocketService\websocket.cs:line 91
   at Program.<>c.<<<Main>$>b__0_4>d.MoveNext() in C:\Users\Thao\source\Flutter\Message_app\server\Program.cs:line 89
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Watch.BrowserRefresh.BrowserRefreshMiddleware.InvokeAsync(HttpContext context)
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.Http.HttpProtocol.ProcessRequests[TContext](IHttpApplication`1 application)
2025-05-01 23:43:11.564 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5053/ws/chat?userId=5 - 101 null null 21.6621ms
2025-05-01 23:43:16.612 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/ws/chat?userId=5 - null null
2025-05-01 23:43:16.612 +07:00 [INF] CORS policy execution successful.
2025-05-01 23:43:16.612 +07:00 [INF] CORS policy execution successful.
2025-05-01 23:43:16.613 +07:00 [INF] Executing endpoint '/ws/chat'
2025-05-01 23:43:16.614 +07:00 [INF] Executed endpoint '/ws/chat'
2025-05-01 23:43:16.614 +07:00 [ERR] An unhandled exception has occurred while executing the request.
System.InvalidOperationException: StatusCode cannot be set because the response has already started.
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.Http.HttpProtocol.ThrowResponseAlreadyStartedException(String value)
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.Http.HttpProtocol.set_StatusCode(Int32 value)
   at server.Services.WebSocketService.webSocket.HandleWebSocket(HttpContext context) in C:\Users\Thao\source\Flutter\Message_app\server\Services\WebSocketService\websocket.cs:line 91
   at Program.<>c.<<<Main>$>b__0_4>d.MoveNext() in C:\Users\Thao\source\Flutter\Message_app\server\Program.cs:line 89
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
2025-05-01 23:43:16.617 +07:00 [WRN] The response has already started, the error page middleware will not be executed.
2025-05-01 23:43:16.618 +07:00 [ERR] Connection id "0HNC8PST1OJOQ", Request id "0HNC8PST1OJOQ:00000001": An unhandled exception was thrown by the application.
System.InvalidOperationException: StatusCode cannot be set because the response has already started.
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.Http.HttpProtocol.ThrowResponseAlreadyStartedException(String value)
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.Http.HttpProtocol.set_StatusCode(Int32 value)
   at server.Services.WebSocketService.webSocket.HandleWebSocket(HttpContext context) in C:\Users\Thao\source\Flutter\Message_app\server\Services\WebSocketService\websocket.cs:line 91
   at Program.<>c.<<<Main>$>b__0_4>d.MoveNext() in C:\Users\Thao\source\Flutter\Message_app\server\Program.cs:line 89
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Watch.BrowserRefresh.BrowserRefreshMiddleware.InvokeAsync(HttpContext context)
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.Http.HttpProtocol.ProcessRequests[TContext](IHttpApplication`1 application)
2025-05-01 23:43:16.623 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5053/ws/chat?userId=5 - 101 null null 10.6518ms
2025-05-01 23:43:21.656 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/ws/chat?userId=5 - null null
2025-05-01 23:43:21.656 +07:00 [INF] CORS policy execution successful.
2025-05-01 23:43:21.656 +07:00 [INF] CORS policy execution successful.
2025-05-01 23:43:21.656 +07:00 [INF] Executing endpoint '/ws/chat'
2025-05-01 23:43:21.656 +07:00 [INF] Executed endpoint '/ws/chat'
2025-05-01 23:43:21.657 +07:00 [ERR] An unhandled exception has occurred while executing the request.
System.InvalidOperationException: StatusCode cannot be set because the response has already started.
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.Http.HttpProtocol.ThrowResponseAlreadyStartedException(String value)
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.Http.HttpProtocol.set_StatusCode(Int32 value)
   at server.Services.WebSocketService.webSocket.HandleWebSocket(HttpContext context) in C:\Users\Thao\source\Flutter\Message_app\server\Services\WebSocketService\websocket.cs:line 91
   at Program.<>c.<<<Main>$>b__0_4>d.MoveNext() in C:\Users\Thao\source\Flutter\Message_app\server\Program.cs:line 89
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
2025-05-01 23:43:21.657 +07:00 [WRN] The response has already started, the error page middleware will not be executed.
2025-05-01 23:43:21.657 +07:00 [ERR] Connection id "0HNC8PST1OJOR", Request id "0HNC8PST1OJOR:00000001": An unhandled exception was thrown by the application.
System.InvalidOperationException: StatusCode cannot be set because the response has already started.
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.Http.HttpProtocol.ThrowResponseAlreadyStartedException(String value)
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.Http.HttpProtocol.set_StatusCode(Int32 value)
   at server.Services.WebSocketService.webSocket.HandleWebSocket(HttpContext context) in C:\Users\Thao\source\Flutter\Message_app\server\Services\WebSocketService\websocket.cs:line 91
   at Program.<>c.<<<Main>$>b__0_4>d.MoveNext() in C:\Users\Thao\source\Flutter\Message_app\server\Program.cs:line 89
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Watch.BrowserRefresh.BrowserRefreshMiddleware.InvokeAsync(HttpContext context)
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.Http.HttpProtocol.ProcessRequests[TContext](IHttpApplication`1 application)
2025-05-01 23:43:21.658 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5053/ws/chat?userId=5 - 101 null null 2.3145ms
2025-05-01 23:43:26.672 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/ws/chat?userId=5 - null null
2025-05-01 23:43:26.672 +07:00 [INF] CORS policy execution successful.
2025-05-01 23:43:26.672 +07:00 [INF] CORS policy execution successful.
2025-05-01 23:43:26.673 +07:00 [INF] Executing endpoint '/ws/chat'
2025-05-01 23:43:26.719 +07:00 [INF] Executed DbCommand (16ms) [Parameters=[@__client_UserId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[conversation_id]
FROM [Participants] AS [p]
WHERE [p].[user_id] = @__client_UserId_0 AND [p].[is_deleted] = CAST(0 AS bit)
2025-05-01 23:43:28.113 +07:00 [INF] Handling message from user 5: as
2025-05-01 23:43:28.125 +07:00 [INF] Executed DbCommand (9ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[id], [c].[created_at], [c].[is_group], [c].[lastMessage], [c].[lastMessageSender], [c].[lastMessageTime], [c].[name]
FROM [Conversations] AS [c]
WHERE [c].[id] = @__p_0
2025-05-01 23:43:28.254 +07:00 [WRN] Savepoints are disabled because Multiple Active Result Sets (MARS) is enabled. If 'SaveChanges' fails, then the transaction cannot be automatically rolled back to a known clean state. Instead, the transaction should be rolled back by the application before retrying 'SaveChanges'. See https://go.microsoft.com/fwlink/?linkid=2149338 for more information and examples. To identify the code which triggers this warning, call 'ConfigureWarnings(w => w.Throw(SqlServerEventId.SavepointsDisabledBecauseOfMARS))'.
2025-05-01 23:43:28.348 +07:00 [INF] Executed DbCommand (92ms) [Parameters=[@p0='?' (Size = 500), @p1='?' (DbType = Int32), @p2='?' (DbType = DateTime2), @p3='?' (DbType = Boolean), @p4='?' (DbType = Boolean), @p5='?' (DbType = Boolean), @p6='?' (DbType = Int32), @p7='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Messages] ([content], [conversation_id], [created_at], [isFile], [isRecalled], [is_read], [sender_id], [type])
OUTPUT INSERTED.[id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7);
2025-05-01 23:43:28.363 +07:00 [INF] Message saved to DB with ID: 98
2025-05-01 23:43:28.366 +07:00 [WRN] Savepoints are disabled because Multiple Active Result Sets (MARS) is enabled. If 'SaveChanges' fails, then the transaction cannot be automatically rolled back to a known clean state. Instead, the transaction should be rolled back by the application before retrying 'SaveChanges'. See https://go.microsoft.com/fwlink/?linkid=2149338 for more information and examples. To identify the code which triggers this warning, call 'ConfigureWarnings(w => w.Throw(SqlServerEventId.SavepointsDisabledBecauseOfMARS))'.
2025-05-01 23:43:28.390 +07:00 [INF] Executed DbCommand (23ms) [Parameters=[@p6='?' (DbType = Int32), @p0='?' (DbType = DateTime2), @p1='?' (DbType = Boolean), @p2='?' (Size = 4000), @p3='?' (Size = 4000), @p4='?' (DbType = DateTime2), @p5='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
UPDATE [Conversations] SET [created_at] = @p0, [is_group] = @p1, [lastMessage] = @p2, [lastMessageSender] = @p3, [lastMessageTime] = @p4, [name] = @p5
OUTPUT 1
WHERE [id] = @p6;
2025-05-01 23:43:28.396 +07:00 [INF] Transaction committed for message: 98
2025-05-01 23:43:28.403 +07:00 [INF] Saved message 98 to Redis
2025-05-01 23:43:28.405 +07:00 [INF] Added message 98 to conversation 1
2025-05-01 23:43:28.410 +07:00 [INF] Published message to channel conversation:1
2025-05-01 23:45:37.671 +07:00 [INF] Request starting HTTP/1.1 POST http://192.168.1.9:5053/api/Auth/login - application/json 57
2025-05-01 23:45:37.676 +07:00 [INF] Executing endpoint 'Message_app.Controllers.AuthController.Login (Message_app)'
2025-05-01 23:45:37.682 +07:00 [INF] Route matched with {action = "Login", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Login(server.DTO.AuthDTO.LoginDTO) on controller Message_app.Controllers.AuthController (Message_app).
2025-05-01 23:45:37.704 +07:00 [INF] Executed DbCommand (15ms) [Parameters=[@__email_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[id], [u].[avatar_url], [u].[bio], [u].[birthday], [u].[created_at], [u].[email], [u].[gender], [u].[interests], [u].[location], [u].[password], [u].[passwordSalt], [u].[username]
FROM [Users] AS [u]
WHERE [u].[email] = @__email_0
2025-05-01 23:45:37.705 +07:00 [INF] Executing OkObjectResult, writing value of type 'server.DTO.AuthDTO.LoginRespose'.
2025-05-01 23:45:37.711 +07:00 [INF] Executed action Message_app.Controllers.AuthController.Login (Message_app) in 27.9176ms
2025-05-01 23:45:37.711 +07:00 [INF] Executed endpoint 'Message_app.Controllers.AuthController.Login (Message_app)'
2025-05-01 23:45:37.711 +07:00 [INF] Request finished HTTP/1.1 POST http://192.168.1.9:5053/api/Auth/login - 200 null application/json; charset=utf-8 39.9388ms
2025-05-01 23:45:39.203 +07:00 [INF] Request starting HTTP/1.1 GET http://192.168.1.9:5053/api/Conversation/get_conversations/2 - null null
2025-05-01 23:45:39.205 +07:00 [INF] Executing endpoint 'server.Controllers.ConversationController.GetConversations (Message_app)'
2025-05-01 23:45:39.208 +07:00 [INF] Route matched with {action = "GetConversations", controller = "Conversation"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetConversations(Int32) on controller server.Controllers.ConversationController (Message_app).
2025-05-01 23:45:39.211 +07:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[server.DTO.ConversationDto, Message_app, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-05-01 23:45:39.212 +07:00 [INF] Executed action server.Controllers.ConversationController.GetConversations (Message_app) in 4.1454ms
2025-05-01 23:45:39.212 +07:00 [INF] Executed endpoint 'server.Controllers.ConversationController.GetConversations (Message_app)'
2025-05-01 23:45:39.212 +07:00 [INF] Request finished HTTP/1.1 GET http://192.168.1.9:5053/api/Conversation/get_conversations/2 - 200 null application/json; charset=utf-8 8.4538ms
2025-05-01 23:45:39.323 +07:00 [INF] Request starting HTTP/1.1 GET http://192.168.1.9:5053/ws/chat?userId=2 - null null
2025-05-01 23:45:39.324 +07:00 [INF] Executing endpoint '/ws/chat'
2025-05-01 23:45:39.704 +07:00 [INF] Executed DbCommand (15ms) [Parameters=[@__client_UserId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[conversation_id]
FROM [Participants] AS [p]
WHERE [p].[user_id] = @__client_UserId_0 AND [p].[is_deleted] = CAST(0 AS bit)
2025-05-01 23:45:42.243 +07:00 [INF] Request starting HTTP/1.1 GET http://192.168.1.9:5053/api/Conversation/get_conversations/2 - null null
2025-05-01 23:45:42.244 +07:00 [INF] Executing endpoint 'server.Controllers.ConversationController.GetConversations (Message_app)'
2025-05-01 23:45:42.244 +07:00 [INF] Route matched with {action = "GetConversations", controller = "Conversation"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetConversations(Int32) on controller server.Controllers.ConversationController (Message_app).
2025-05-01 23:45:42.245 +07:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[server.DTO.ConversationDto, Message_app, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-05-01 23:45:42.245 +07:00 [INF] Executed action server.Controllers.ConversationController.GetConversations (Message_app) in 0.8404ms
2025-05-01 23:45:42.245 +07:00 [INF] Executed endpoint 'server.Controllers.ConversationController.GetConversations (Message_app)'
2025-05-01 23:45:42.245 +07:00 [INF] Request finished HTTP/1.1 GET http://192.168.1.9:5053/api/Conversation/get_conversations/2 - 200 null application/json; charset=utf-8 2.2101ms
2025-05-01 23:45:45.122 +07:00 [INF] Request starting HTTP/1.1 GET http://192.168.1.9:5053/ws/chat?userId=2 - null null
2025-05-01 23:45:45.123 +07:00 [INF] Executing endpoint '/ws/chat'
2025-05-01 23:45:45.128 +07:00 [INF] Request starting HTTP/1.1 GET http://192.168.1.9:5053/api/Message/getMessages/1/2 - null null
2025-05-01 23:45:45.128 +07:00 [INF] Executing endpoint 'server.Controllers.MessageController.GetMessages (Message_app)'
2025-05-01 23:45:45.131 +07:00 [INF] Route matched with {action = "GetMessages", controller = "Message"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetMessages(Int32, Int32) on controller server.Controllers.MessageController (Message_app).
2025-05-01 23:45:45.137 +07:00 [WRN] Message 84 not found in Redis
2025-05-01 23:45:45.137 +07:00 [WRN] Message 83 not found in Redis
2025-05-01 23:45:45.138 +07:00 [WRN] Message 82 not found in Redis
2025-05-01 23:45:45.139 +07:00 [WRN] Message 81 not found in Redis
2025-05-01 23:45:45.139 +07:00 [WRN] Message 80 not found in Redis
2025-05-01 23:45:45.139 +07:00 [WRN] Message 79 not found in Redis
2025-05-01 23:45:45.140 +07:00 [WRN] Message 78 not found in Redis
2025-05-01 23:45:45.140 +07:00 [WRN] Message 77 not found in Redis
2025-05-01 23:45:45.140 +07:00 [WRN] Message 76 not found in Redis
2025-05-01 23:45:45.141 +07:00 [WRN] Message 75 not found in Redis
2025-05-01 23:45:45.141 +07:00 [WRN] Message 74 not found in Redis
2025-05-01 23:45:45.141 +07:00 [WRN] Message 73 not found in Redis
2025-05-01 23:45:45.141 +07:00 [WRN] Message 72 not found in Redis
2025-05-01 23:45:45.142 +07:00 [WRN] Message 71 not found in Redis
2025-05-01 23:45:45.142 +07:00 [WRN] Message 68 not found in Redis
2025-05-01 23:45:45.142 +07:00 [WRN] Message 64 not found in Redis
2025-05-01 23:45:45.143 +07:00 [WRN] Message 62 not found in Redis
2025-05-01 23:45:45.143 +07:00 [INF] Executed DbCommand (5ms) [Parameters=[@__client_UserId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[conversation_id]
FROM [Participants] AS [p]
WHERE [p].[user_id] = @__client_UserId_0 AND [p].[is_deleted] = CAST(0 AS bit)
2025-05-01 23:45:45.143 +07:00 [WRN] Message 61 not found in Redis
2025-05-01 23:45:45.143 +07:00 [WRN] Message 60 not found in Redis
2025-05-01 23:45:45.144 +07:00 [WRN] Message 59 not found in Redis
2025-05-01 23:45:45.144 +07:00 [WRN] Message 57 not found in Redis
2025-05-01 23:45:45.144 +07:00 [WRN] Message 55 not found in Redis
2025-05-01 23:45:45.144 +07:00 [WRN] Message 54 not found in Redis
2025-05-01 23:45:45.144 +07:00 [WRN] Message 51 not found in Redis
2025-05-01 23:45:45.145 +07:00 [WRN] Message 49 not found in Redis
2025-05-01 23:45:45.145 +07:00 [WRN] Message 11 not found in Redis
2025-05-01 23:45:45.145 +07:00 [WRN] Message 8 not found in Redis
2025-05-01 23:45:45.145 +07:00 [WRN] Message 3 not found in Redis
2025-05-01 23:45:45.146 +07:00 [WRN] Message 2 not found in Redis
2025-05-01 23:45:45.146 +07:00 [WRN] Message 1 not found in Redis
2025-05-01 23:45:45.146 +07:00 [INF] Retrieved 10 messages from Redis for conversation 1
2025-05-01 23:45:45.146 +07:00 [INF] Retrieved 10 messages from Redis for conversation 1 and user 2
2025-05-01 23:45:45.146 +07:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[server.DTO.MessageWithAttachment, Message_app, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-05-01 23:45:45.148 +07:00 [INF] Executed action server.Controllers.MessageController.GetMessages (Message_app) in 16.9895ms
2025-05-01 23:45:45.148 +07:00 [INF] Executed endpoint 'server.Controllers.MessageController.GetMessages (Message_app)'
2025-05-01 23:45:45.148 +07:00 [INF] Request finished HTTP/1.1 GET http://192.168.1.9:5053/api/Message/getMessages/1/2 - 200 null application/json; charset=utf-8 20.6014ms
2025-05-01 23:45:45.287 +07:00 [INF] Request starting HTTP/1.1 GET http://192.168.1.9:5053/api/Conversation/get_first_conversation/1 - null null
2025-05-01 23:45:45.287 +07:00 [INF] Executing endpoint 'server.Controllers.ConversationController.GetFirstConversation (Message_app)'
2025-05-01 23:45:45.290 +07:00 [INF] Route matched with {action = "GetFirstConversation", controller = "Conversation"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetFirstConversation(Int32) on controller server.Controllers.ConversationController (Message_app).
2025-05-01 23:45:45.296 +07:00 [INF] Executed DbCommand (5ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[id], [c].[created_at], [c].[is_group], [c].[lastMessage], [c].[lastMessageSender], [c].[lastMessageTime], [c].[name]
FROM [Conversations] AS [c]
WHERE [c].[id] = @__p_0
2025-05-01 23:45:45.297 +07:00 [INF] Executing OkObjectResult, writing value of type 'server.Models.Conversation'.
2025-05-01 23:45:45.298 +07:00 [INF] Executed action server.Controllers.ConversationController.GetFirstConversation (Message_app) in 7.8715ms
2025-05-01 23:45:45.298 +07:00 [INF] Executed endpoint 'server.Controllers.ConversationController.GetFirstConversation (Message_app)'
2025-05-01 23:45:45.298 +07:00 [INF] Request finished HTTP/1.1 GET http://192.168.1.9:5053/api/Conversation/get_first_conversation/1 - 200 null application/json; charset=utf-8 11.2935ms
2025-05-01 23:45:45.367 +07:00 [INF] Request starting HTTP/1.1 GET http://192.168.1.9:5053/api/Participant/get_participants/1 - null null
2025-05-01 23:45:45.367 +07:00 [INF] Executing endpoint 'server.Controllers.ParticipantController.GetParticipants (Message_app)'
2025-05-01 23:45:45.370 +07:00 [INF] Route matched with {action = "GetParticipants", controller = "Participant"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetParticipants(Int32) on controller server.Controllers.ParticipantController (Message_app).
2025-05-01 23:45:45.376 +07:00 [INF] Executed DbCommand (4ms) [Parameters=[@__conversation_id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[id], [p].[adder], [p].[conversation_id], [p].[is_deleted], [p].[joined_at], [p].[name], [p].[role], [p].[user_id]
FROM [Participants] AS [p]
WHERE [p].[conversation_id] = @__conversation_id_0
2025-05-01 23:45:45.376 +07:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType17`1[[System.Collections.Generic.List`1[[server.Models.Participants, Message_app, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-05-01 23:45:45.378 +07:00 [INF] Executed action server.Controllers.ParticipantController.GetParticipants (Message_app) in 7.7049ms
2025-05-01 23:45:45.378 +07:00 [INF] Executed endpoint 'server.Controllers.ParticipantController.GetParticipants (Message_app)'
2025-05-01 23:45:45.378 +07:00 [INF] Request finished HTTP/1.1 GET http://192.168.1.9:5053/api/Participant/get_participants/1 - 200 null application/json; charset=utf-8 10.9658ms
2025-05-01 23:45:49.080 +07:00 [INF] Request starting HTTP/1.1 GET http://192.168.1.9:5053/ws/chat?userId=2 - null null
2025-05-01 23:45:49.081 +07:00 [INF] Executing endpoint '/ws/chat'
2025-05-01 23:45:49.082 +07:00 [INF] Request starting HTTP/1.1 GET http://192.168.1.9:5053/api/Message/getMessages/1/2 - null null
2025-05-01 23:45:49.084 +07:00 [INF] Executing endpoint 'server.Controllers.MessageController.GetMessages (Message_app)'
2025-05-01 23:45:49.084 +07:00 [INF] Route matched with {action = "GetMessages", controller = "Message"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetMessages(Int32, Int32) on controller server.Controllers.MessageController (Message_app).
2025-05-01 23:45:49.090 +07:00 [WRN] Message 84 not found in Redis
2025-05-01 23:45:49.090 +07:00 [WRN] Message 83 not found in Redis
2025-05-01 23:45:49.090 +07:00 [WRN] Message 82 not found in Redis
2025-05-01 23:45:49.091 +07:00 [WRN] Message 81 not found in Redis
2025-05-01 23:45:49.091 +07:00 [WRN] Message 80 not found in Redis
2025-05-01 23:45:49.091 +07:00 [WRN] Message 79 not found in Redis
2025-05-01 23:45:49.092 +07:00 [WRN] Message 78 not found in Redis
2025-05-01 23:45:49.092 +07:00 [WRN] Message 77 not found in Redis
2025-05-01 23:45:49.092 +07:00 [WRN] Message 76 not found in Redis
2025-05-01 23:45:49.093 +07:00 [WRN] Message 75 not found in Redis
2025-05-01 23:45:49.093 +07:00 [WRN] Message 74 not found in Redis
2025-05-01 23:45:49.093 +07:00 [WRN] Message 73 not found in Redis
2025-05-01 23:45:49.093 +07:00 [WRN] Message 72 not found in Redis
2025-05-01 23:45:49.094 +07:00 [WRN] Message 71 not found in Redis
2025-05-01 23:45:49.094 +07:00 [WRN] Message 68 not found in Redis
2025-05-01 23:45:49.094 +07:00 [WRN] Message 64 not found in Redis
2025-05-01 23:45:49.095 +07:00 [WRN] Message 62 not found in Redis
2025-05-01 23:45:49.095 +07:00 [WRN] Message 61 not found in Redis
2025-05-01 23:45:49.095 +07:00 [WRN] Message 60 not found in Redis
2025-05-01 23:45:49.095 +07:00 [WRN] Message 59 not found in Redis
2025-05-01 23:45:49.096 +07:00 [WRN] Message 57 not found in Redis
2025-05-01 23:45:49.096 +07:00 [WRN] Message 55 not found in Redis
2025-05-01 23:45:49.096 +07:00 [WRN] Message 54 not found in Redis
2025-05-01 23:45:49.097 +07:00 [WRN] Message 51 not found in Redis
2025-05-01 23:45:49.097 +07:00 [WRN] Message 49 not found in Redis
2025-05-01 23:45:49.097 +07:00 [WRN] Message 11 not found in Redis
2025-05-01 23:45:49.097 +07:00 [INF] Executed DbCommand (5ms) [Parameters=[@__client_UserId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[conversation_id]
FROM [Participants] AS [p]
WHERE [p].[user_id] = @__client_UserId_0 AND [p].[is_deleted] = CAST(0 AS bit)
2025-05-01 23:45:49.097 +07:00 [WRN] Message 8 not found in Redis
2025-05-01 23:45:49.098 +07:00 [WRN] Message 3 not found in Redis
2025-05-01 23:45:49.099 +07:00 [WRN] Message 2 not found in Redis
2025-05-01 23:45:49.100 +07:00 [WRN] Message 1 not found in Redis
2025-05-01 23:45:49.100 +07:00 [INF] Retrieved 10 messages from Redis for conversation 1
2025-05-01 23:45:49.100 +07:00 [INF] Retrieved 10 messages from Redis for conversation 1 and user 2
2025-05-01 23:45:49.100 +07:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[server.DTO.MessageWithAttachment, Message_app, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-05-01 23:45:49.100 +07:00 [INF] Executed action server.Controllers.MessageController.GetMessages (Message_app) in 16.4952ms
2025-05-01 23:45:49.100 +07:00 [INF] Executed endpoint 'server.Controllers.MessageController.GetMessages (Message_app)'
2025-05-01 23:45:49.101 +07:00 [INF] Request finished HTTP/1.1 GET http://192.168.1.9:5053/api/Message/getMessages/1/2 - 200 null application/json; charset=utf-8 18.7126ms
2025-05-01 23:45:49.139 +07:00 [INF] Request starting HTTP/1.1 GET http://192.168.1.9:5053/api/Conversation/get_first_conversation/1 - null null
2025-05-01 23:45:49.139 +07:00 [INF] Executing endpoint 'server.Controllers.ConversationController.GetFirstConversation (Message_app)'
2025-05-01 23:45:49.139 +07:00 [INF] Route matched with {action = "GetFirstConversation", controller = "Conversation"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetFirstConversation(Int32) on controller server.Controllers.ConversationController (Message_app).
2025-05-01 23:45:49.145 +07:00 [INF] Executed DbCommand (4ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[id], [c].[created_at], [c].[is_group], [c].[lastMessage], [c].[lastMessageSender], [c].[lastMessageTime], [c].[name]
FROM [Conversations] AS [c]
WHERE [c].[id] = @__p_0
2025-05-01 23:45:49.145 +07:00 [INF] Executing OkObjectResult, writing value of type 'server.Models.Conversation'.
2025-05-01 23:45:49.145 +07:00 [INF] Executed action server.Controllers.ConversationController.GetFirstConversation (Message_app) in 6.2402ms
2025-05-01 23:45:49.146 +07:00 [INF] Executed endpoint 'server.Controllers.ConversationController.GetFirstConversation (Message_app)'
2025-05-01 23:45:49.146 +07:00 [INF] Request finished HTTP/1.1 GET http://192.168.1.9:5053/api/Conversation/get_first_conversation/1 - 200 null application/json; charset=utf-8 6.9349ms
2025-05-01 23:45:49.172 +07:00 [INF] Request starting HTTP/1.1 GET http://192.168.1.9:5053/api/Participant/get_participants/1 - null null
2025-05-01 23:45:49.173 +07:00 [INF] Executing endpoint 'server.Controllers.ParticipantController.GetParticipants (Message_app)'
2025-05-01 23:45:49.173 +07:00 [INF] Route matched with {action = "GetParticipants", controller = "Participant"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetParticipants(Int32) on controller server.Controllers.ParticipantController (Message_app).
2025-05-01 23:45:49.178 +07:00 [INF] Executed DbCommand (4ms) [Parameters=[@__conversation_id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[id], [p].[adder], [p].[conversation_id], [p].[is_deleted], [p].[joined_at], [p].[name], [p].[role], [p].[user_id]
FROM [Participants] AS [p]
WHERE [p].[conversation_id] = @__conversation_id_0
2025-05-01 23:45:49.178 +07:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType17`1[[System.Collections.Generic.List`1[[server.Models.Participants, Message_app, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-05-01 23:45:49.179 +07:00 [INF] Executed action server.Controllers.ParticipantController.GetParticipants (Message_app) in 5.6666ms
2025-05-01 23:45:49.179 +07:00 [INF] Executed endpoint 'server.Controllers.ParticipantController.GetParticipants (Message_app)'
2025-05-01 23:45:49.179 +07:00 [INF] Request finished HTTP/1.1 GET http://192.168.1.9:5053/api/Participant/get_participants/1 - 200 null application/json; charset=utf-8 7.232ms
2025-05-01 23:45:52.255 +07:00 [INF] Handling message from user 2: vv
2025-05-01 23:45:52.261 +07:00 [INF] Executed DbCommand (4ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[id], [c].[created_at], [c].[is_group], [c].[lastMessage], [c].[lastMessageSender], [c].[lastMessageTime], [c].[name]
FROM [Conversations] AS [c]
WHERE [c].[id] = @__p_0
2025-05-01 23:45:52.264 +07:00 [WRN] Savepoints are disabled because Multiple Active Result Sets (MARS) is enabled. If 'SaveChanges' fails, then the transaction cannot be automatically rolled back to a known clean state. Instead, the transaction should be rolled back by the application before retrying 'SaveChanges'. See https://go.microsoft.com/fwlink/?linkid=2149338 for more information and examples. To identify the code which triggers this warning, call 'ConfigureWarnings(w => w.Throw(SqlServerEventId.SavepointsDisabledBecauseOfMARS))'.
2025-05-01 23:45:52.273 +07:00 [INF] Executed DbCommand (8ms) [Parameters=[@p0='?' (Size = 500), @p1='?' (DbType = Int32), @p2='?' (DbType = DateTime2), @p3='?' (DbType = Boolean), @p4='?' (DbType = Boolean), @p5='?' (DbType = Boolean), @p6='?' (DbType = Int32), @p7='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Messages] ([content], [conversation_id], [created_at], [isFile], [isRecalled], [is_read], [sender_id], [type])
OUTPUT INSERTED.[id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7);
2025-05-01 23:45:52.273 +07:00 [INF] Message saved to DB with ID: 99
2025-05-01 23:45:52.274 +07:00 [WRN] Savepoints are disabled because Multiple Active Result Sets (MARS) is enabled. If 'SaveChanges' fails, then the transaction cannot be automatically rolled back to a known clean state. Instead, the transaction should be rolled back by the application before retrying 'SaveChanges'. See https://go.microsoft.com/fwlink/?linkid=2149338 for more information and examples. To identify the code which triggers this warning, call 'ConfigureWarnings(w => w.Throw(SqlServerEventId.SavepointsDisabledBecauseOfMARS))'.
2025-05-01 23:45:52.281 +07:00 [INF] Executed DbCommand (7ms) [Parameters=[@p6='?' (DbType = Int32), @p0='?' (DbType = DateTime2), @p1='?' (DbType = Boolean), @p2='?' (Size = 4000), @p3='?' (Size = 4000), @p4='?' (DbType = DateTime2), @p5='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
UPDATE [Conversations] SET [created_at] = @p0, [is_group] = @p1, [lastMessage] = @p2, [lastMessageSender] = @p3, [lastMessageTime] = @p4, [name] = @p5
OUTPUT 1
WHERE [id] = @p6;
2025-05-01 23:45:52.282 +07:00 [INF] Transaction committed for message: 99
2025-05-01 23:45:52.284 +07:00 [INF] Saved message 99 to Redis
2025-05-01 23:45:52.284 +07:00 [INF] Added message 99 to conversation 1
2025-05-01 23:45:52.285 +07:00 [INF] Published message to channel conversation:1
2025-05-01 23:45:58.753 +07:00 [INF] Handling message from user 2: ss
2025-05-01 23:45:58.769 +07:00 [INF] Executed DbCommand (14ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[id], [c].[created_at], [c].[is_group], [c].[lastMessage], [c].[lastMessageSender], [c].[lastMessageTime], [c].[name]
FROM [Conversations] AS [c]
WHERE [c].[id] = @__p_0
2025-05-01 23:45:58.777 +07:00 [WRN] Savepoints are disabled because Multiple Active Result Sets (MARS) is enabled. If 'SaveChanges' fails, then the transaction cannot be automatically rolled back to a known clean state. Instead, the transaction should be rolled back by the application before retrying 'SaveChanges'. See https://go.microsoft.com/fwlink/?linkid=2149338 for more information and examples. To identify the code which triggers this warning, call 'ConfigureWarnings(w => w.Throw(SqlServerEventId.SavepointsDisabledBecauseOfMARS))'.
2025-05-01 23:45:58.785 +07:00 [INF] Executed DbCommand (8ms) [Parameters=[@p0='?' (Size = 500), @p1='?' (DbType = Int32), @p2='?' (DbType = DateTime2), @p3='?' (DbType = Boolean), @p4='?' (DbType = Boolean), @p5='?' (DbType = Boolean), @p6='?' (DbType = Int32), @p7='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Messages] ([content], [conversation_id], [created_at], [isFile], [isRecalled], [is_read], [sender_id], [type])
OUTPUT INSERTED.[id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7);
2025-05-01 23:45:58.786 +07:00 [INF] Message saved to DB with ID: 100
2025-05-01 23:45:58.786 +07:00 [WRN] Savepoints are disabled because Multiple Active Result Sets (MARS) is enabled. If 'SaveChanges' fails, then the transaction cannot be automatically rolled back to a known clean state. Instead, the transaction should be rolled back by the application before retrying 'SaveChanges'. See https://go.microsoft.com/fwlink/?linkid=2149338 for more information and examples. To identify the code which triggers this warning, call 'ConfigureWarnings(w => w.Throw(SqlServerEventId.SavepointsDisabledBecauseOfMARS))'.
2025-05-01 23:45:58.791 +07:00 [INF] Executed DbCommand (5ms) [Parameters=[@p6='?' (DbType = Int32), @p0='?' (DbType = DateTime2), @p1='?' (DbType = Boolean), @p2='?' (Size = 4000), @p3='?' (Size = 4000), @p4='?' (DbType = DateTime2), @p5='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
UPDATE [Conversations] SET [created_at] = @p0, [is_group] = @p1, [lastMessage] = @p2, [lastMessageSender] = @p3, [lastMessageTime] = @p4, [name] = @p5
OUTPUT 1
WHERE [id] = @p6;
2025-05-01 23:45:58.792 +07:00 [INF] Transaction committed for message: 100
2025-05-01 23:45:58.794 +07:00 [INF] Saved message 100 to Redis
2025-05-01 23:45:58.794 +07:00 [INF] Added message 100 to conversation 1
2025-05-01 23:45:58.795 +07:00 [INF] Published message to channel conversation:1
2025-05-01 23:46:01.804 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/ws/chat?userId=5 - null null
2025-05-01 23:46:01.804 +07:00 [INF] CORS policy execution successful.
2025-05-01 23:46:01.804 +07:00 [INF] CORS policy execution successful.
2025-05-01 23:46:01.805 +07:00 [INF] Executing endpoint '/ws/chat'
2025-05-01 23:46:01.908 +07:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5053/api/Message/getMessages/1/5 - null null
2025-05-01 23:46:01.908 +07:00 [INF] CORS policy execution successful.
2025-05-01 23:46:01.908 +07:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5053/api/Message/getMessages/1/5 - 204 null null 0.293ms
2025-05-01 23:46:01.909 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/api/Message/getMessages/1/5 - null null
2025-05-01 23:46:01.909 +07:00 [INF] CORS policy execution successful.
2025-05-01 23:46:01.910 +07:00 [INF] CORS policy execution successful.
2025-05-01 23:46:01.910 +07:00 [INF] Executing endpoint 'server.Controllers.MessageController.GetMessages (Message_app)'
2025-05-01 23:46:01.910 +07:00 [INF] Route matched with {action = "GetMessages", controller = "Message"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetMessages(Int32, Int32) on controller server.Controllers.MessageController (Message_app).
2025-05-01 23:46:01.912 +07:00 [INF] Executed DbCommand (10ms) [Parameters=[@__client_UserId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[conversation_id]
FROM [Participants] AS [p]
WHERE [p].[user_id] = @__client_UserId_0 AND [p].[is_deleted] = CAST(0 AS bit)
2025-05-01 23:46:01.912 +07:00 [WRN] Message 84 not found in Redis
2025-05-01 23:46:01.913 +07:00 [WRN] Message 83 not found in Redis
2025-05-01 23:46:01.913 +07:00 [WRN] Message 82 not found in Redis
2025-05-01 23:46:01.913 +07:00 [WRN] Message 81 not found in Redis
2025-05-01 23:46:01.913 +07:00 [WRN] Message 80 not found in Redis
2025-05-01 23:46:01.913 +07:00 [WRN] Message 79 not found in Redis
2025-05-01 23:46:01.913 +07:00 [WRN] Message 78 not found in Redis
2025-05-01 23:46:01.913 +07:00 [WRN] Message 77 not found in Redis
2025-05-01 23:46:01.914 +07:00 [WRN] Message 76 not found in Redis
2025-05-01 23:46:01.914 +07:00 [WRN] Message 75 not found in Redis
2025-05-01 23:46:01.914 +07:00 [WRN] Message 74 not found in Redis
2025-05-01 23:46:01.914 +07:00 [WRN] Message 73 not found in Redis
2025-05-01 23:46:01.914 +07:00 [WRN] Message 72 not found in Redis
2025-05-01 23:46:01.914 +07:00 [WRN] Message 71 not found in Redis
2025-05-01 23:46:01.914 +07:00 [WRN] Message 68 not found in Redis
2025-05-01 23:46:01.915 +07:00 [WRN] Message 64 not found in Redis
2025-05-01 23:46:01.915 +07:00 [WRN] Message 62 not found in Redis
2025-05-01 23:46:01.915 +07:00 [WRN] Message 61 not found in Redis
2025-05-01 23:46:01.915 +07:00 [WRN] Message 60 not found in Redis
2025-05-01 23:46:01.915 +07:00 [WRN] Message 59 not found in Redis
2025-05-01 23:46:01.915 +07:00 [WRN] Message 57 not found in Redis
2025-05-01 23:46:01.915 +07:00 [WRN] Message 55 not found in Redis
2025-05-01 23:46:01.915 +07:00 [WRN] Message 54 not found in Redis
2025-05-01 23:46:01.916 +07:00 [WRN] Message 51 not found in Redis
2025-05-01 23:46:01.916 +07:00 [WRN] Message 49 not found in Redis
2025-05-01 23:46:01.916 +07:00 [WRN] Message 11 not found in Redis
2025-05-01 23:46:01.916 +07:00 [WRN] Message 8 not found in Redis
2025-05-01 23:46:01.917 +07:00 [WRN] Message 3 not found in Redis
2025-05-01 23:46:01.918 +07:00 [WRN] Message 2 not found in Redis
2025-05-01 23:46:01.918 +07:00 [WRN] Message 1 not found in Redis
2025-05-01 23:46:01.918 +07:00 [INF] Retrieved 12 messages from Redis for conversation 1
2025-05-01 23:46:01.918 +07:00 [INF] Retrieved 12 messages from Redis for conversation 1 and user 5
2025-05-01 23:46:01.918 +07:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[server.DTO.MessageWithAttachment, Message_app, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-05-01 23:46:01.919 +07:00 [INF] Executed action server.Controllers.MessageController.GetMessages (Message_app) in 8.8039ms
2025-05-01 23:46:01.919 +07:00 [INF] Executed endpoint 'server.Controllers.MessageController.GetMessages (Message_app)'
2025-05-01 23:46:01.919 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5053/api/Message/getMessages/1/5 - 200 null application/json; charset=utf-8 9.3753ms
2025-05-01 23:46:01.938 +07:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5053/api/Conversation/get_first_conversation/1 - null null
2025-05-01 23:46:01.938 +07:00 [INF] CORS policy execution successful.
2025-05-01 23:46:01.938 +07:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5053/api/Conversation/get_first_conversation/1 - 204 null null 0.2975ms
2025-05-01 23:46:01.940 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/api/Conversation/get_first_conversation/1 - null null
2025-05-01 23:46:01.940 +07:00 [INF] CORS policy execution successful.
2025-05-01 23:46:01.940 +07:00 [INF] CORS policy execution successful.
2025-05-01 23:46:01.940 +07:00 [INF] Executing endpoint 'server.Controllers.ConversationController.GetFirstConversation (Message_app)'
2025-05-01 23:46:01.940 +07:00 [INF] Route matched with {action = "GetFirstConversation", controller = "Conversation"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetFirstConversation(Int32) on controller server.Controllers.ConversationController (Message_app).
2025-05-01 23:46:01.945 +07:00 [INF] Executed DbCommand (4ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[id], [c].[created_at], [c].[is_group], [c].[lastMessage], [c].[lastMessageSender], [c].[lastMessageTime], [c].[name]
FROM [Conversations] AS [c]
WHERE [c].[id] = @__p_0
2025-05-01 23:46:01.946 +07:00 [INF] Executing OkObjectResult, writing value of type 'server.Models.Conversation'.
2025-05-01 23:46:01.946 +07:00 [INF] Executed action server.Controllers.ConversationController.GetFirstConversation (Message_app) in 6.0615ms
2025-05-01 23:46:01.946 +07:00 [INF] Executed endpoint 'server.Controllers.ConversationController.GetFirstConversation (Message_app)'
2025-05-01 23:46:01.947 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5053/api/Conversation/get_first_conversation/1 - 200 null application/json; charset=utf-8 7.0587ms
2025-05-01 23:46:01.965 +07:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5053/api/Participant/get_participants/1 - null null
2025-05-01 23:46:01.965 +07:00 [INF] CORS policy execution successful.
2025-05-01 23:46:01.965 +07:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5053/api/Participant/get_participants/1 - 204 null null 0.2078ms
2025-05-01 23:46:01.967 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/api/Participant/get_participants/1 - null null
2025-05-01 23:46:01.967 +07:00 [INF] CORS policy execution successful.
2025-05-01 23:46:01.967 +07:00 [INF] CORS policy execution successful.
2025-05-01 23:46:01.967 +07:00 [INF] Executing endpoint 'server.Controllers.ParticipantController.GetParticipants (Message_app)'
2025-05-01 23:46:01.968 +07:00 [INF] Route matched with {action = "GetParticipants", controller = "Participant"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetParticipants(Int32) on controller server.Controllers.ParticipantController (Message_app).
2025-05-01 23:46:01.978 +07:00 [INF] Executed DbCommand (9ms) [Parameters=[@__conversation_id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[id], [p].[adder], [p].[conversation_id], [p].[is_deleted], [p].[joined_at], [p].[name], [p].[role], [p].[user_id]
FROM [Participants] AS [p]
WHERE [p].[conversation_id] = @__conversation_id_0
2025-05-01 23:46:01.978 +07:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType17`1[[System.Collections.Generic.List`1[[server.Models.Participants, Message_app, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-05-01 23:46:01.979 +07:00 [INF] Executed action server.Controllers.ParticipantController.GetParticipants (Message_app) in 10.9626ms
2025-05-01 23:46:01.979 +07:00 [INF] Executed endpoint 'server.Controllers.ParticipantController.GetParticipants (Message_app)'
2025-05-01 23:46:01.979 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5053/api/Participant/get_participants/1 - 200 null application/json; charset=utf-8 11.9312ms
2025-05-01 23:46:07.595 +07:00 [INF] Handling message from user 5: kbj
2025-05-01 23:46:07.608 +07:00 [INF] Executed DbCommand (11ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[id], [c].[created_at], [c].[is_group], [c].[lastMessage], [c].[lastMessageSender], [c].[lastMessageTime], [c].[name]
FROM [Conversations] AS [c]
WHERE [c].[id] = @__p_0
2025-05-01 23:46:07.610 +07:00 [WRN] Savepoints are disabled because Multiple Active Result Sets (MARS) is enabled. If 'SaveChanges' fails, then the transaction cannot be automatically rolled back to a known clean state. Instead, the transaction should be rolled back by the application before retrying 'SaveChanges'. See https://go.microsoft.com/fwlink/?linkid=2149338 for more information and examples. To identify the code which triggers this warning, call 'ConfigureWarnings(w => w.Throw(SqlServerEventId.SavepointsDisabledBecauseOfMARS))'.
2025-05-01 23:46:07.616 +07:00 [INF] Executed DbCommand (6ms) [Parameters=[@p0='?' (Size = 500), @p1='?' (DbType = Int32), @p2='?' (DbType = DateTime2), @p3='?' (DbType = Boolean), @p4='?' (DbType = Boolean), @p5='?' (DbType = Boolean), @p6='?' (DbType = Int32), @p7='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Messages] ([content], [conversation_id], [created_at], [isFile], [isRecalled], [is_read], [sender_id], [type])
OUTPUT INSERTED.[id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7);
2025-05-01 23:46:07.617 +07:00 [INF] Message saved to DB with ID: 101
2025-05-01 23:46:07.618 +07:00 [WRN] Savepoints are disabled because Multiple Active Result Sets (MARS) is enabled. If 'SaveChanges' fails, then the transaction cannot be automatically rolled back to a known clean state. Instead, the transaction should be rolled back by the application before retrying 'SaveChanges'. See https://go.microsoft.com/fwlink/?linkid=2149338 for more information and examples. To identify the code which triggers this warning, call 'ConfigureWarnings(w => w.Throw(SqlServerEventId.SavepointsDisabledBecauseOfMARS))'.
2025-05-01 23:46:07.624 +07:00 [INF] Executed DbCommand (6ms) [Parameters=[@p6='?' (DbType = Int32), @p0='?' (DbType = DateTime2), @p1='?' (DbType = Boolean), @p2='?' (Size = 4000), @p3='?' (Size = 4000), @p4='?' (DbType = DateTime2), @p5='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
UPDATE [Conversations] SET [created_at] = @p0, [is_group] = @p1, [lastMessage] = @p2, [lastMessageSender] = @p3, [lastMessageTime] = @p4, [name] = @p5
OUTPUT 1
WHERE [id] = @p6;
2025-05-01 23:46:07.626 +07:00 [INF] Transaction committed for message: 101
2025-05-01 23:46:07.627 +07:00 [INF] Saved message 101 to Redis
2025-05-01 23:46:07.628 +07:00 [INF] Added message 101 to conversation 1
2025-05-01 23:46:07.629 +07:00 [INF] Published message to channel conversation:1
2025-05-01 23:46:10.760 +07:00 [INF] Request starting HTTP/1.1 GET http://192.168.1.9:5053/api/Message/getMessages/1/2 - null null
2025-05-01 23:46:10.760 +07:00 [INF] Executing endpoint 'server.Controllers.MessageController.GetMessages (Message_app)'
2025-05-01 23:46:10.760 +07:00 [INF] Route matched with {action = "GetMessages", controller = "Message"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetMessages(Int32, Int32) on controller server.Controllers.MessageController (Message_app).
2025-05-01 23:46:10.761 +07:00 [INF] Request starting HTTP/1.1 GET http://192.168.1.9:5053/ws/chat?userId=2 - null null
2025-05-01 23:46:10.761 +07:00 [INF] Executing endpoint '/ws/chat'
2025-05-01 23:46:10.764 +07:00 [WRN] Message 84 not found in Redis
2025-05-01 23:46:10.765 +07:00 [WRN] Message 83 not found in Redis
2025-05-01 23:46:10.765 +07:00 [WRN] Message 82 not found in Redis
2025-05-01 23:46:10.765 +07:00 [WRN] Message 81 not found in Redis
2025-05-01 23:46:10.765 +07:00 [WRN] Message 80 not found in Redis
2025-05-01 23:46:10.766 +07:00 [WRN] Message 79 not found in Redis
2025-05-01 23:46:10.767 +07:00 [WRN] Message 78 not found in Redis
2025-05-01 23:46:10.768 +07:00 [WRN] Message 77 not found in Redis
2025-05-01 23:46:10.768 +07:00 [WRN] Message 76 not found in Redis
2025-05-01 23:46:10.769 +07:00 [WRN] Message 75 not found in Redis
2025-05-01 23:46:10.770 +07:00 [WRN] Message 74 not found in Redis
2025-05-01 23:46:10.770 +07:00 [WRN] Message 73 not found in Redis
2025-05-01 23:46:10.771 +07:00 [WRN] Message 72 not found in Redis
2025-05-01 23:46:10.771 +07:00 [WRN] Message 71 not found in Redis
2025-05-01 23:46:10.772 +07:00 [WRN] Message 68 not found in Redis
2025-05-01 23:46:10.773 +07:00 [WRN] Message 64 not found in Redis
2025-05-01 23:46:10.773 +07:00 [WRN] Message 62 not found in Redis
2025-05-01 23:46:10.773 +07:00 [WRN] Message 61 not found in Redis
2025-05-01 23:46:10.774 +07:00 [WRN] Message 60 not found in Redis
2025-05-01 23:46:10.774 +07:00 [WRN] Message 59 not found in Redis
2025-05-01 23:46:10.774 +07:00 [WRN] Message 57 not found in Redis
2025-05-01 23:46:10.775 +07:00 [WRN] Message 55 not found in Redis
2025-05-01 23:46:10.775 +07:00 [WRN] Message 54 not found in Redis
2025-05-01 23:46:10.777 +07:00 [WRN] Message 51 not found in Redis
2025-05-01 23:46:10.778 +07:00 [WRN] Message 49 not found in Redis
2025-05-01 23:46:10.778 +07:00 [WRN] Message 11 not found in Redis
2025-05-01 23:46:10.779 +07:00 [WRN] Message 8 not found in Redis
2025-05-01 23:46:10.779 +07:00 [WRN] Message 3 not found in Redis
2025-05-01 23:46:10.780 +07:00 [WRN] Message 2 not found in Redis
2025-05-01 23:46:10.780 +07:00 [WRN] Message 1 not found in Redis
2025-05-01 23:46:10.780 +07:00 [INF] Retrieved 13 messages from Redis for conversation 1
2025-05-01 23:46:10.780 +07:00 [INF] Retrieved 13 messages from Redis for conversation 1 and user 2
2025-05-01 23:46:10.780 +07:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[server.DTO.MessageWithAttachment, Message_app, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-05-01 23:46:10.781 +07:00 [INF] Executed action server.Controllers.MessageController.GetMessages (Message_app) in 20.7282ms
2025-05-01 23:46:10.781 +07:00 [INF] Executed endpoint 'server.Controllers.MessageController.GetMessages (Message_app)'
2025-05-01 23:46:10.782 +07:00 [INF] Request finished HTTP/1.1 GET http://192.168.1.9:5053/api/Message/getMessages/1/2 - 200 null application/json; charset=utf-8 21.8565ms
2025-05-01 23:46:10.792 +07:00 [INF] Executed DbCommand (13ms) [Parameters=[@__client_UserId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[conversation_id]
FROM [Participants] AS [p]
WHERE [p].[user_id] = @__client_UserId_0 AND [p].[is_deleted] = CAST(0 AS bit)
2025-05-01 23:46:10.831 +07:00 [INF] Request starting HTTP/1.1 GET http://192.168.1.9:5053/api/Conversation/get_first_conversation/1 - null null
2025-05-01 23:46:10.832 +07:00 [INF] Executing endpoint 'server.Controllers.ConversationController.GetFirstConversation (Message_app)'
2025-05-01 23:46:10.832 +07:00 [INF] Route matched with {action = "GetFirstConversation", controller = "Conversation"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetFirstConversation(Int32) on controller server.Controllers.ConversationController (Message_app).
2025-05-01 23:46:10.838 +07:00 [INF] Executed DbCommand (5ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[id], [c].[created_at], [c].[is_group], [c].[lastMessage], [c].[lastMessageSender], [c].[lastMessageTime], [c].[name]
FROM [Conversations] AS [c]
WHERE [c].[id] = @__p_0
2025-05-01 23:46:10.838 +07:00 [INF] Executing OkObjectResult, writing value of type 'server.Models.Conversation'.
2025-05-01 23:46:10.839 +07:00 [INF] Executed action server.Controllers.ConversationController.GetFirstConversation (Message_app) in 6.5788ms
2025-05-01 23:46:10.839 +07:00 [INF] Executed endpoint 'server.Controllers.ConversationController.GetFirstConversation (Message_app)'
2025-05-01 23:46:10.839 +07:00 [INF] Request finished HTTP/1.1 GET http://192.168.1.9:5053/api/Conversation/get_first_conversation/1 - 200 null application/json; charset=utf-8 7.2013ms
2025-05-01 23:46:10.862 +07:00 [INF] Request starting HTTP/1.1 GET http://192.168.1.9:5053/api/Participant/get_participants/1 - null null
2025-05-01 23:46:10.862 +07:00 [INF] Executing endpoint 'server.Controllers.ParticipantController.GetParticipants (Message_app)'
2025-05-01 23:46:10.862 +07:00 [INF] Route matched with {action = "GetParticipants", controller = "Participant"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetParticipants(Int32) on controller server.Controllers.ParticipantController (Message_app).
2025-05-01 23:46:10.865 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[@__conversation_id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[id], [p].[adder], [p].[conversation_id], [p].[is_deleted], [p].[joined_at], [p].[name], [p].[role], [p].[user_id]
FROM [Participants] AS [p]
WHERE [p].[conversation_id] = @__conversation_id_0
2025-05-01 23:46:10.866 +07:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType17`1[[System.Collections.Generic.List`1[[server.Models.Participants, Message_app, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-05-01 23:46:10.866 +07:00 [INF] Executed action server.Controllers.ParticipantController.GetParticipants (Message_app) in 3.7971ms
2025-05-01 23:46:10.866 +07:00 [INF] Executed endpoint 'server.Controllers.ParticipantController.GetParticipants (Message_app)'
2025-05-01 23:46:10.866 +07:00 [INF] Request finished HTTP/1.1 GET http://192.168.1.9:5053/api/Participant/get_participants/1 - 200 null application/json; charset=utf-8 4.2802ms
2025-05-01 23:46:15.906 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/ws/chat?userId=5 - null null
2025-05-01 23:46:15.907 +07:00 [INF] CORS policy execution successful.
2025-05-01 23:46:15.907 +07:00 [INF] CORS policy execution successful.
2025-05-01 23:46:15.907 +07:00 [INF] Executing endpoint '/ws/chat'
2025-05-01 23:46:15.939 +07:00 [INF] Executed DbCommand (12ms) [Parameters=[@__client_UserId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[conversation_id]
FROM [Participants] AS [p]
WHERE [p].[user_id] = @__client_UserId_0 AND [p].[is_deleted] = CAST(0 AS bit)
2025-05-01 23:46:35.257 +07:00 [INF] Executed endpoint '/ws/chat'
2025-05-01 23:46:35.257 +07:00 [INF] Executed endpoint '/ws/chat'
2025-05-01 23:46:35.257 +07:00 [INF] Executed endpoint '/ws/chat'
2025-05-01 23:46:35.257 +07:00 [INF] Executed endpoint '/ws/chat'
2025-05-01 23:46:35.257 +07:00 [ERR] An unhandled exception has occurred while executing the request.
System.Net.WebSockets.WebSocketException (0x80004005): The remote party closed the WebSocket connection without completing the close handshake.
   at System.Net.WebSockets.ManagedWebSocket.ThrowEOFUnexpected()
   at System.Net.WebSockets.ManagedWebSocket.EnsureBufferContainsAsync(Int32 minimumRequiredBytes, CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.WebSockets.ManagedWebSocket.ReceiveAsyncPrivate[TResult](Memory`1 payloadBuffer, CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at System.Threading.Tasks.ValueTask`1.ValueTaskSourceAsTask.<>c.<.cctor>b__4_0(Object state)
--- End of stack trace from previous location ---
   at server.Services.WebSocketService.webSocket.Receiver(Client client)
   at server.Services.WebSocketService.webSocket.HandleWebSocket(HttpContext context)
   at Program.<>c.<<<Main>$>b__0_4>d.MoveNext()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
2025-05-01 23:46:35.257 +07:00 [ERR] An unhandled exception has occurred while executing the request.
System.Net.WebSockets.WebSocketException (0x80004005): The remote party closed the WebSocket connection without completing the close handshake.
   at System.Net.WebSockets.ManagedWebSocket.ThrowEOFUnexpected()
   at System.Net.WebSockets.ManagedWebSocket.EnsureBufferContainsAsync(Int32 minimumRequiredBytes, CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.WebSockets.ManagedWebSocket.ReceiveAsyncPrivate[TResult](Memory`1 payloadBuffer, CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at System.Threading.Tasks.ValueTask`1.ValueTaskSourceAsTask.<>c.<.cctor>b__4_0(Object state)
--- End of stack trace from previous location ---
   at server.Services.WebSocketService.webSocket.Receiver(Client client)
   at server.Services.WebSocketService.webSocket.HandleWebSocket(HttpContext context)
   at Program.<>c.<<<Main>$>b__0_4>d.MoveNext()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
2025-05-01 23:46:35.257 +07:00 [ERR] An unhandled exception has occurred while executing the request.
System.Net.WebSockets.WebSocketException (0x80004005): The remote party closed the WebSocket connection without completing the close handshake.
   at System.Net.WebSockets.ManagedWebSocket.ThrowEOFUnexpected()
   at System.Net.WebSockets.ManagedWebSocket.EnsureBufferContainsAsync(Int32 minimumRequiredBytes, CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.WebSockets.ManagedWebSocket.ReceiveAsyncPrivate[TResult](Memory`1 payloadBuffer, CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at System.Threading.Tasks.ValueTask`1.ValueTaskSourceAsTask.<>c.<.cctor>b__4_0(Object state)
--- End of stack trace from previous location ---
   at server.Services.WebSocketService.webSocket.Receiver(Client client)
   at server.Services.WebSocketService.webSocket.HandleWebSocket(HttpContext context)
   at Program.<>c.<<<Main>$>b__0_4>d.MoveNext()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
2025-05-01 23:46:35.257 +07:00 [ERR] An unhandled exception has occurred while executing the request.
System.Net.WebSockets.WebSocketException (0x80004005): The remote party closed the WebSocket connection without completing the close handshake.
   at System.Net.WebSockets.ManagedWebSocket.ThrowEOFUnexpected()
   at System.Net.WebSockets.ManagedWebSocket.EnsureBufferContainsAsync(Int32 minimumRequiredBytes, CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.WebSockets.ManagedWebSocket.ReceiveAsyncPrivate[TResult](Memory`1 payloadBuffer, CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at System.Threading.Tasks.ValueTask`1.ValueTaskSourceAsTask.<>c.<.cctor>b__4_0(Object state)
--- End of stack trace from previous location ---
   at server.Services.WebSocketService.webSocket.Receiver(Client client)
   at server.Services.WebSocketService.webSocket.HandleWebSocket(HttpContext context)
   at Program.<>c.<<<Main>$>b__0_4>d.MoveNext()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
2025-05-01 23:46:35.260 +07:00 [WRN] The response has already started, the error page middleware will not be executed.
2025-05-01 23:46:35.262 +07:00 [WRN] The response has already started, the error page middleware will not be executed.
2025-05-01 23:46:35.261 +07:00 [WRN] The response has already started, the error page middleware will not be executed.
2025-05-01 23:46:35.261 +07:00 [WRN] The response has already started, the error page middleware will not be executed.
2025-05-01 23:46:35.262 +07:00 [ERR] Connection id "0HNC8PST1OJP1", Request id "0HNC8PST1OJP1:00000001": An unhandled exception was thrown by the application.
System.Net.WebSockets.WebSocketException (0x80004005): The remote party closed the WebSocket connection without completing the close handshake.
   at System.Net.WebSockets.ManagedWebSocket.ThrowEOFUnexpected()
   at System.Net.WebSockets.ManagedWebSocket.EnsureBufferContainsAsync(Int32 minimumRequiredBytes, CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.WebSockets.ManagedWebSocket.ReceiveAsyncPrivate[TResult](Memory`1 payloadBuffer, CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at System.Threading.Tasks.ValueTask`1.ValueTaskSourceAsTask.<>c.<.cctor>b__4_0(Object state)
--- End of stack trace from previous location ---
   at server.Services.WebSocketService.webSocket.Receiver(Client client)
   at server.Services.WebSocketService.webSocket.HandleWebSocket(HttpContext context)
   at Program.<>c.<<<Main>$>b__0_4>d.MoveNext()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Watch.BrowserRefresh.BrowserRefreshMiddleware.InvokeAsync(HttpContext context)
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.Http.HttpProtocol.ProcessRequests[TContext](IHttpApplication`1 application)
2025-05-01 23:46:35.262 +07:00 [ERR] Connection id "0HNC8PST1OJP5", Request id "0HNC8PST1OJP5:00000001": An unhandled exception was thrown by the application.
System.Net.WebSockets.WebSocketException (0x80004005): The remote party closed the WebSocket connection without completing the close handshake.
   at System.Net.WebSockets.ManagedWebSocket.ThrowEOFUnexpected()
   at System.Net.WebSockets.ManagedWebSocket.EnsureBufferContainsAsync(Int32 minimumRequiredBytes, CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.WebSockets.ManagedWebSocket.ReceiveAsyncPrivate[TResult](Memory`1 payloadBuffer, CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at System.Threading.Tasks.ValueTask`1.ValueTaskSourceAsTask.<>c.<.cctor>b__4_0(Object state)
--- End of stack trace from previous location ---
   at server.Services.WebSocketService.webSocket.Receiver(Client client)
   at server.Services.WebSocketService.webSocket.HandleWebSocket(HttpContext context)
   at Program.<>c.<<<Main>$>b__0_4>d.MoveNext()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Watch.BrowserRefresh.BrowserRefreshMiddleware.InvokeAsync(HttpContext context)
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.Http.HttpProtocol.ProcessRequests[TContext](IHttpApplication`1 application)
2025-05-01 23:46:35.262 +07:00 [ERR] Connection id "0HNC8PST1OJOV", Request id "0HNC8PST1OJOV:00000001": An unhandled exception was thrown by the application.
System.Net.WebSockets.WebSocketException (0x80004005): The remote party closed the WebSocket connection without completing the close handshake.
   at System.Net.WebSockets.ManagedWebSocket.ThrowEOFUnexpected()
   at System.Net.WebSockets.ManagedWebSocket.EnsureBufferContainsAsync(Int32 minimumRequiredBytes, CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.WebSockets.ManagedWebSocket.ReceiveAsyncPrivate[TResult](Memory`1 payloadBuffer, CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at System.Threading.Tasks.ValueTask`1.ValueTaskSourceAsTask.<>c.<.cctor>b__4_0(Object state)
--- End of stack trace from previous location ---
   at server.Services.WebSocketService.webSocket.Receiver(Client client)
   at server.Services.WebSocketService.webSocket.HandleWebSocket(HttpContext context)
   at Program.<>c.<<<Main>$>b__0_4>d.MoveNext()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Watch.BrowserRefresh.BrowserRefreshMiddleware.InvokeAsync(HttpContext context)
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.Http.HttpProtocol.ProcessRequests[TContext](IHttpApplication`1 application)
2025-05-01 23:46:35.262 +07:00 [ERR] Connection id "0HNC8PST1OJPC", Request id "0HNC8PST1OJPC:00000001": An unhandled exception was thrown by the application.
System.Net.WebSockets.WebSocketException (0x80004005): The remote party closed the WebSocket connection without completing the close handshake.
   at System.Net.WebSockets.ManagedWebSocket.ThrowEOFUnexpected()
   at System.Net.WebSockets.ManagedWebSocket.EnsureBufferContainsAsync(Int32 minimumRequiredBytes, CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.WebSockets.ManagedWebSocket.ReceiveAsyncPrivate[TResult](Memory`1 payloadBuffer, CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at System.Threading.Tasks.ValueTask`1.ValueTaskSourceAsTask.<>c.<.cctor>b__4_0(Object state)
--- End of stack trace from previous location ---
   at server.Services.WebSocketService.webSocket.Receiver(Client client)
   at server.Services.WebSocketService.webSocket.HandleWebSocket(HttpContext context)
   at Program.<>c.<<<Main>$>b__0_4>d.MoveNext()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Watch.BrowserRefresh.BrowserRefreshMiddleware.InvokeAsync(HttpContext context)
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.Http.HttpProtocol.ProcessRequests[TContext](IHttpApplication`1 application)
2025-05-01 23:46:35.264 +07:00 [INF] Request finished HTTP/1.1 GET http://192.168.1.9:5053/ws/chat?userId=2 - 101 null null 50141.5111ms
2025-05-01 23:46:35.264 +07:00 [INF] Request finished HTTP/1.1 GET http://192.168.1.9:5053/ws/chat?userId=2 - 101 null null 46183.9202ms
2025-05-01 23:46:35.266 +07:00 [INF] Request finished HTTP/1.1 GET http://192.168.1.9:5053/ws/chat?userId=2 - 101 null null 55942.4412ms
2025-05-01 23:46:35.271 +07:00 [INF] Request finished HTTP/1.1 GET http://192.168.1.9:5053/ws/chat?userId=2 - 101 null null 24509.301ms
2025-05-01 23:46:43.563 +07:00 [INF] Executed endpoint '/ws/chat'
2025-05-01 23:46:43.563 +07:00 [ERR] An unhandled exception has occurred while executing the request.
StackExchange.Redis.RedisServerException: WRONGTYPE Operation against a key holding the wrong kind of value
   at server.Services.WebSocketService.webSocket.CleanupClient(Client client)
   at server.Services.WebSocketService.webSocket.HandleWebSocket(HttpContext context)
   at Program.<>c.<<<Main>$>b__0_4>d.MoveNext()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
2025-05-01 23:46:43.568 +07:00 [INF] Executed endpoint '/ws/chat'
2025-05-01 23:46:43.569 +07:00 [WRN] The response has already started, the error page middleware will not be executed.
2025-05-01 23:46:43.570 +07:00 [ERR] An unhandled exception has occurred while executing the request.
StackExchange.Redis.RedisServerException: WRONGTYPE Operation against a key holding the wrong kind of value
   at server.Services.WebSocketService.webSocket.CleanupClient(Client client)
   at server.Services.WebSocketService.webSocket.HandleWebSocket(HttpContext context)
   at Program.<>c.<<<Main>$>b__0_4>d.MoveNext()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
2025-05-01 23:46:43.570 +07:00 [WRN] The response has already started, the error page middleware will not be executed.
2025-05-01 23:46:43.570 +07:00 [ERR] Connection id "0HNC8PST1OJPF", Request id "0HNC8PST1OJPF:00000001": An unhandled exception was thrown by the application.
StackExchange.Redis.RedisServerException: WRONGTYPE Operation against a key holding the wrong kind of value
   at server.Services.WebSocketService.webSocket.CleanupClient(Client client)
   at server.Services.WebSocketService.webSocket.HandleWebSocket(HttpContext context)
   at Program.<>c.<<<Main>$>b__0_4>d.MoveNext()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Watch.BrowserRefresh.BrowserRefreshMiddleware.InvokeAsync(HttpContext context)
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.Http.HttpProtocol.ProcessRequests[TContext](IHttpApplication`1 application)
2025-05-01 23:46:43.570 +07:00 [ERR] Connection id "0HNC8PST1OJOM", Request id "0HNC8PST1OJOM:00000001": An unhandled exception was thrown by the application.
StackExchange.Redis.RedisServerException: WRONGTYPE Operation against a key holding the wrong kind of value
   at server.Services.WebSocketService.webSocket.CleanupClient(Client client)
   at server.Services.WebSocketService.webSocket.HandleWebSocket(HttpContext context)
   at Program.<>c.<<<Main>$>b__0_4>d.MoveNext()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Watch.BrowserRefresh.BrowserRefreshMiddleware.InvokeAsync(HttpContext context)
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.Http.HttpProtocol.ProcessRequests[TContext](IHttpApplication`1 application)
2025-05-01 23:46:43.571 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5053/ws/chat?userId=5 - 101 null null 27664.4652ms
2025-05-01 23:46:43.571 +07:00 [INF] Executed endpoint '/ws/chat'
2025-05-01 23:46:43.571 +07:00 [INF] Executed endpoint '/ws/chat'
2025-05-01 23:46:43.578 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5053/ws/chat?userId=5 - 101 null null 224799.0043ms
2025-05-01 23:46:43.579 +07:00 [ERR] An unhandled exception has occurred while executing the request.
StackExchange.Redis.RedisServerException: WRONGTYPE Operation against a key holding the wrong kind of value
   at server.Services.WebSocketService.webSocket.CleanupClient(Client client)
   at server.Services.WebSocketService.webSocket.HandleWebSocket(HttpContext context)
   at Program.<>c.<<<Main>$>b__0_4>d.MoveNext()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
2025-05-01 23:46:43.579 +07:00 [ERR] An unhandled exception has occurred while executing the request.
StackExchange.Redis.RedisServerException: WRONGTYPE Operation against a key holding the wrong kind of value
   at server.Services.WebSocketService.webSocket.CleanupClient(Client client)
   at server.Services.WebSocketService.webSocket.HandleWebSocket(HttpContext context)
   at Program.<>c.<<<Main>$>b__0_4>d.MoveNext()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
2025-05-01 23:46:43.582 +07:00 [WRN] The response has already started, the error page middleware will not be executed.
2025-05-01 23:46:43.584 +07:00 [WRN] The response has already started, the error page middleware will not be executed.
2025-05-01 23:46:43.584 +07:00 [ERR] Connection id "0HNC8PST1OJP9", Request id "0HNC8PST1OJP9:00000001": An unhandled exception was thrown by the application.
StackExchange.Redis.RedisServerException: WRONGTYPE Operation against a key holding the wrong kind of value
   at server.Services.WebSocketService.webSocket.CleanupClient(Client client)
   at server.Services.WebSocketService.webSocket.HandleWebSocket(HttpContext context)
   at Program.<>c.<<<Main>$>b__0_4>d.MoveNext()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Watch.BrowserRefresh.BrowserRefreshMiddleware.InvokeAsync(HttpContext context)
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.Http.HttpProtocol.ProcessRequests[TContext](IHttpApplication`1 application)
2025-05-01 23:46:43.584 +07:00 [ERR] Connection id "0HNC8PST1OJOS", Request id "0HNC8PST1OJOS:00000001": An unhandled exception was thrown by the application.
StackExchange.Redis.RedisServerException: WRONGTYPE Operation against a key holding the wrong kind of value
   at server.Services.WebSocketService.webSocket.CleanupClient(Client client)
   at server.Services.WebSocketService.webSocket.HandleWebSocket(HttpContext context)
   at Program.<>c.<<<Main>$>b__0_4>d.MoveNext()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Watch.BrowserRefresh.BrowserRefreshMiddleware.InvokeAsync(HttpContext context)
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.Http.HttpProtocol.ProcessRequests[TContext](IHttpApplication`1 application)
2025-05-01 23:46:43.596 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5053/ws/chat?userId=5 - 101 null null 41792.3827ms
2025-05-01 23:46:43.598 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5053/ws/chat?userId=5 - 101 null null 196925.8675ms
2025-05-01 23:47:58.820 +07:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5053/api/Auth/login - null null
2025-05-01 23:47:58.820 +07:00 [INF] CORS policy execution successful.
2025-05-01 23:47:58.820 +07:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5053/api/Auth/login - 204 null null 0.3802ms
2025-05-01 23:47:58.822 +07:00 [INF] Request starting HTTP/1.1 POST http://localhost:5053/api/Auth/login - application/json 53
2025-05-01 23:47:58.822 +07:00 [INF] CORS policy execution successful.
2025-05-01 23:47:58.823 +07:00 [INF] CORS policy execution successful.
2025-05-01 23:47:58.823 +07:00 [INF] Executing endpoint 'Message_app.Controllers.AuthController.Login (Message_app)'
2025-05-01 23:47:58.823 +07:00 [INF] Route matched with {action = "Login", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Login(server.DTO.AuthDTO.LoginDTO) on controller Message_app.Controllers.AuthController (Message_app).
2025-05-01 23:47:58.832 +07:00 [INF] Executed DbCommand (6ms) [Parameters=[@__email_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[id], [u].[avatar_url], [u].[bio], [u].[birthday], [u].[created_at], [u].[email], [u].[gender], [u].[interests], [u].[location], [u].[password], [u].[passwordSalt], [u].[username]
FROM [Users] AS [u]
WHERE [u].[email] = @__email_0
2025-05-01 23:47:58.833 +07:00 [INF] Executing OkObjectResult, writing value of type 'server.DTO.AuthDTO.LoginRespose'.
2025-05-01 23:47:58.834 +07:00 [INF] Executed action Message_app.Controllers.AuthController.Login (Message_app) in 10.7997ms
2025-05-01 23:47:58.834 +07:00 [INF] Executed endpoint 'Message_app.Controllers.AuthController.Login (Message_app)'
2025-05-01 23:47:58.834 +07:00 [INF] Request finished HTTP/1.1 POST http://localhost:5053/api/Auth/login - 200 null application/json; charset=utf-8 12.4977ms
2025-05-01 23:47:59.049 +07:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5053/api/Conversation/get_conversations/5 - null null
2025-05-01 23:47:59.050 +07:00 [INF] CORS policy execution successful.
2025-05-01 23:47:59.050 +07:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5053/api/Conversation/get_conversations/5 - 204 null null 0.3316ms
2025-05-01 23:47:59.051 +07:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5053/api/Conversation/get_conversations/5 - null null
2025-05-01 23:47:59.051 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/api/Conversation/get_conversations/5 - null null
2025-05-01 23:47:59.051 +07:00 [INF] CORS policy execution successful.
2025-05-01 23:47:59.051 +07:00 [INF] CORS policy execution successful.
2025-05-01 23:47:59.051 +07:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5053/api/Conversation/get_conversations/5 - 204 null null 0.1781ms
2025-05-01 23:47:59.052 +07:00 [INF] CORS policy execution successful.
2025-05-01 23:47:59.052 +07:00 [INF] Executing endpoint 'server.Controllers.ConversationController.GetConversations (Message_app)'
2025-05-01 23:47:59.052 +07:00 [INF] Route matched with {action = "GetConversations", controller = "Conversation"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetConversations(Int32) on controller server.Controllers.ConversationController (Message_app).
2025-05-01 23:47:59.053 +07:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[server.DTO.ConversationDto, Message_app, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-05-01 23:47:59.053 +07:00 [INF] Executed action server.Controllers.ConversationController.GetConversations (Message_app) in 1.6466ms
2025-05-01 23:47:59.054 +07:00 [INF] Executed endpoint 'server.Controllers.ConversationController.GetConversations (Message_app)'
2025-05-01 23:47:59.054 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5053/api/Conversation/get_conversations/5 - 200 null application/json; charset=utf-8 2.2755ms
2025-05-01 23:47:59.055 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/api/Conversation/get_conversations/5 - null null
2025-05-01 23:47:59.055 +07:00 [INF] CORS policy execution successful.
2025-05-01 23:47:59.055 +07:00 [INF] CORS policy execution successful.
2025-05-01 23:47:59.055 +07:00 [INF] Executing endpoint 'server.Controllers.ConversationController.GetConversations (Message_app)'
2025-05-01 23:47:59.055 +07:00 [INF] Route matched with {action = "GetConversations", controller = "Conversation"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetConversations(Int32) on controller server.Controllers.ConversationController (Message_app).
2025-05-01 23:47:59.058 +07:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[server.DTO.ConversationDto, Message_app, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-05-01 23:47:59.058 +07:00 [INF] Executed action server.Controllers.ConversationController.GetConversations (Message_app) in 2.3368ms
2025-05-01 23:47:59.058 +07:00 [INF] Executed endpoint 'server.Controllers.ConversationController.GetConversations (Message_app)'
2025-05-01 23:47:59.058 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5053/api/Conversation/get_conversations/5 - 200 null application/json; charset=utf-8 3.3718ms
2025-05-01 23:47:59.168 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/ws/chat?userId=5 - null null
2025-05-01 23:47:59.168 +07:00 [INF] CORS policy execution successful.
2025-05-01 23:47:59.168 +07:00 [INF] CORS policy execution successful.
2025-05-01 23:47:59.168 +07:00 [INF] Executing endpoint '/ws/chat'
2025-05-01 23:47:59.218 +07:00 [INF] Executed DbCommand (5ms) [Parameters=[@__client_UserId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[conversation_id]
FROM [Participants] AS [p]
WHERE [p].[user_id] = @__client_UserId_0 AND [p].[is_deleted] = CAST(0 AS bit)
2025-05-01 23:48:16.315 +07:00 [INF] Request starting HTTP/1.1 POST http://192.168.1.9:5053/api/Auth/login - application/json 57
2025-05-01 23:48:16.316 +07:00 [INF] Executing endpoint 'Message_app.Controllers.AuthController.Login (Message_app)'
2025-05-01 23:48:16.316 +07:00 [INF] Route matched with {action = "Login", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Login(server.DTO.AuthDTO.LoginDTO) on controller Message_app.Controllers.AuthController (Message_app).
2025-05-01 23:48:16.346 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__email_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[id], [u].[avatar_url], [u].[bio], [u].[birthday], [u].[created_at], [u].[email], [u].[gender], [u].[interests], [u].[location], [u].[password], [u].[passwordSalt], [u].[username]
FROM [Users] AS [u]
WHERE [u].[email] = @__email_0
2025-05-01 23:48:16.347 +07:00 [INF] Executing OkObjectResult, writing value of type 'server.DTO.AuthDTO.LoginRespose'.
2025-05-01 23:48:16.347 +07:00 [INF] Executed action Message_app.Controllers.AuthController.Login (Message_app) in 30.7097ms
2025-05-01 23:48:16.347 +07:00 [INF] Executed endpoint 'Message_app.Controllers.AuthController.Login (Message_app)'
2025-05-01 23:48:16.347 +07:00 [INF] Request finished HTTP/1.1 POST http://192.168.1.9:5053/api/Auth/login - 200 null application/json; charset=utf-8 32.1394ms
2025-05-01 23:48:17.457 +07:00 [INF] Request starting HTTP/1.1 GET http://192.168.1.9:5053/api/Conversation/get_conversations/2 - null null
2025-05-01 23:48:17.458 +07:00 [INF] Request starting HTTP/1.1 GET http://192.168.1.9:5053/api/Conversation/get_conversations/2 - null null
2025-05-01 23:48:17.458 +07:00 [INF] Executing endpoint 'server.Controllers.ConversationController.GetConversations (Message_app)'
2025-05-01 23:48:17.458 +07:00 [INF] Executing endpoint 'server.Controllers.ConversationController.GetConversations (Message_app)'
2025-05-01 23:48:17.458 +07:00 [INF] Route matched with {action = "GetConversations", controller = "Conversation"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetConversations(Int32) on controller server.Controllers.ConversationController (Message_app).
2025-05-01 23:48:17.458 +07:00 [INF] Route matched with {action = "GetConversations", controller = "Conversation"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetConversations(Int32) on controller server.Controllers.ConversationController (Message_app).
2025-05-01 23:48:17.461 +07:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[server.DTO.ConversationDto, Message_app, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-05-01 23:48:17.461 +07:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[server.DTO.ConversationDto, Message_app, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-05-01 23:48:17.461 +07:00 [INF] Executed action server.Controllers.ConversationController.GetConversations (Message_app) in 2.786ms
2025-05-01 23:48:17.461 +07:00 [INF] Executed action server.Controllers.ConversationController.GetConversations (Message_app) in 2.7517ms
2025-05-01 23:48:17.461 +07:00 [INF] Executed endpoint 'server.Controllers.ConversationController.GetConversations (Message_app)'
2025-05-01 23:48:17.461 +07:00 [INF] Executed endpoint 'server.Controllers.ConversationController.GetConversations (Message_app)'
2025-05-01 23:48:17.461 +07:00 [INF] Request finished HTTP/1.1 GET http://192.168.1.9:5053/api/Conversation/get_conversations/2 - 200 null application/json; charset=utf-8 3.6062ms
2025-05-01 23:48:17.461 +07:00 [INF] Request finished HTTP/1.1 GET http://192.168.1.9:5053/api/Conversation/get_conversations/2 - 200 null application/json; charset=utf-8 4.1438ms
2025-05-01 23:48:17.897 +07:00 [INF] Request starting HTTP/1.1 GET http://192.168.1.9:5053/ws/chat?userId=2 - null null
2025-05-01 23:48:17.898 +07:00 [INF] Executing endpoint '/ws/chat'
2025-05-01 23:48:18.038 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[@__client_UserId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[conversation_id]
FROM [Participants] AS [p]
WHERE [p].[user_id] = @__client_UserId_0 AND [p].[is_deleted] = CAST(0 AS bit)
2025-05-01 23:48:18.798 +07:00 [INF] Request starting HTTP/1.1 GET http://192.168.1.9:5053/ws/chat?userId=2 - null null
2025-05-01 23:48:18.799 +07:00 [INF] Executing endpoint '/ws/chat'
2025-05-01 23:48:18.804 +07:00 [INF] Request starting HTTP/1.1 GET http://192.168.1.9:5053/api/Message/getMessages/1/2 - null null
2025-05-01 23:48:18.805 +07:00 [INF] Executing endpoint 'server.Controllers.MessageController.GetMessages (Message_app)'
2025-05-01 23:48:18.806 +07:00 [INF] Route matched with {action = "GetMessages", controller = "Message"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetMessages(Int32, Int32) on controller server.Controllers.MessageController (Message_app).
2025-05-01 23:48:18.819 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__client_UserId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[conversation_id]
FROM [Participants] AS [p]
WHERE [p].[user_id] = @__client_UserId_0 AND [p].[is_deleted] = CAST(0 AS bit)
2025-05-01 23:48:18.820 +07:00 [WRN] Message 84 not found in Redis
2025-05-01 23:48:18.821 +07:00 [WRN] Message 83 not found in Redis
2025-05-01 23:48:18.823 +07:00 [WRN] Message 82 not found in Redis
2025-05-01 23:48:18.825 +07:00 [WRN] Message 81 not found in Redis
2025-05-01 23:48:18.826 +07:00 [WRN] Message 80 not found in Redis
2025-05-01 23:48:18.827 +07:00 [WRN] Message 79 not found in Redis
2025-05-01 23:48:18.827 +07:00 [WRN] Message 78 not found in Redis
2025-05-01 23:48:18.828 +07:00 [WRN] Message 77 not found in Redis
2025-05-01 23:48:18.828 +07:00 [WRN] Message 76 not found in Redis
2025-05-01 23:48:18.828 +07:00 [WRN] Message 75 not found in Redis
2025-05-01 23:48:18.828 +07:00 [WRN] Message 74 not found in Redis
2025-05-01 23:48:18.829 +07:00 [WRN] Message 73 not found in Redis
2025-05-01 23:48:18.829 +07:00 [WRN] Message 72 not found in Redis
2025-05-01 23:48:18.830 +07:00 [WRN] Message 71 not found in Redis
2025-05-01 23:48:18.830 +07:00 [WRN] Message 68 not found in Redis
2025-05-01 23:48:18.831 +07:00 [WRN] Message 64 not found in Redis
2025-05-01 23:48:18.831 +07:00 [WRN] Message 62 not found in Redis
2025-05-01 23:48:18.832 +07:00 [WRN] Message 61 not found in Redis
2025-05-01 23:48:18.832 +07:00 [WRN] Message 60 not found in Redis
2025-05-01 23:48:18.832 +07:00 [WRN] Message 59 not found in Redis
2025-05-01 23:48:18.833 +07:00 [WRN] Message 57 not found in Redis
2025-05-01 23:48:18.833 +07:00 [WRN] Message 55 not found in Redis
2025-05-01 23:48:18.833 +07:00 [WRN] Message 54 not found in Redis
2025-05-01 23:48:18.833 +07:00 [WRN] Message 51 not found in Redis
2025-05-01 23:48:18.834 +07:00 [WRN] Message 49 not found in Redis
2025-05-01 23:48:18.834 +07:00 [WRN] Message 11 not found in Redis
2025-05-01 23:48:18.834 +07:00 [WRN] Message 8 not found in Redis
2025-05-01 23:48:18.835 +07:00 [WRN] Message 3 not found in Redis
2025-05-01 23:48:18.835 +07:00 [WRN] Message 2 not found in Redis
2025-05-01 23:48:18.835 +07:00 [WRN] Message 1 not found in Redis
2025-05-01 23:48:18.835 +07:00 [INF] Retrieved 13 messages from Redis for conversation 1
2025-05-01 23:48:18.835 +07:00 [INF] Retrieved 13 messages from Redis for conversation 1 and user 2
2025-05-01 23:48:18.836 +07:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[server.DTO.MessageWithAttachment, Message_app, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-05-01 23:48:18.836 +07:00 [INF] Executed action server.Controllers.MessageController.GetMessages (Message_app) in 30.0328ms
2025-05-01 23:48:18.836 +07:00 [INF] Executed endpoint 'server.Controllers.MessageController.GetMessages (Message_app)'
2025-05-01 23:48:18.836 +07:00 [INF] Request finished HTTP/1.1 GET http://192.168.1.9:5053/api/Message/getMessages/1/2 - 200 null application/json; charset=utf-8 32.4469ms
2025-05-01 23:48:18.889 +07:00 [INF] Request starting HTTP/1.1 GET http://192.168.1.9:5053/api/Conversation/get_first_conversation/1 - null null
2025-05-01 23:48:18.889 +07:00 [INF] Executing endpoint 'server.Controllers.ConversationController.GetFirstConversation (Message_app)'
2025-05-01 23:48:18.890 +07:00 [INF] Route matched with {action = "GetFirstConversation", controller = "Conversation"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetFirstConversation(Int32) on controller server.Controllers.ConversationController (Message_app).
2025-05-01 23:48:18.897 +07:00 [INF] Executed DbCommand (4ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[id], [c].[created_at], [c].[is_group], [c].[lastMessage], [c].[lastMessageSender], [c].[lastMessageTime], [c].[name]
FROM [Conversations] AS [c]
WHERE [c].[id] = @__p_0
2025-05-01 23:48:18.897 +07:00 [INF] Executing OkObjectResult, writing value of type 'server.Models.Conversation'.
2025-05-01 23:48:18.897 +07:00 [INF] Executed action server.Controllers.ConversationController.GetFirstConversation (Message_app) in 6.868ms
2025-05-01 23:48:18.897 +07:00 [INF] Executed endpoint 'server.Controllers.ConversationController.GetFirstConversation (Message_app)'
2025-05-01 23:48:18.897 +07:00 [INF] Request finished HTTP/1.1 GET http://192.168.1.9:5053/api/Conversation/get_first_conversation/1 - 200 null application/json; charset=utf-8 8.5388ms
2025-05-01 23:48:18.997 +07:00 [INF] Request starting HTTP/1.1 GET http://192.168.1.9:5053/api/Participant/get_participants/1 - null null
2025-05-01 23:48:18.998 +07:00 [INF] Executing endpoint 'server.Controllers.ParticipantController.GetParticipants (Message_app)'
2025-05-01 23:48:18.998 +07:00 [INF] Route matched with {action = "GetParticipants", controller = "Participant"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetParticipants(Int32) on controller server.Controllers.ParticipantController (Message_app).
2025-05-01 23:48:19.004 +07:00 [INF] Executed DbCommand (4ms) [Parameters=[@__conversation_id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[id], [p].[adder], [p].[conversation_id], [p].[is_deleted], [p].[joined_at], [p].[name], [p].[role], [p].[user_id]
FROM [Participants] AS [p]
WHERE [p].[conversation_id] = @__conversation_id_0
2025-05-01 23:48:19.006 +07:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType17`1[[System.Collections.Generic.List`1[[server.Models.Participants, Message_app, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-05-01 23:48:19.006 +07:00 [INF] Executed action server.Controllers.ParticipantController.GetParticipants (Message_app) in 7.9773ms
2025-05-01 23:48:19.007 +07:00 [INF] Executed endpoint 'server.Controllers.ParticipantController.GetParticipants (Message_app)'
2025-05-01 23:48:19.007 +07:00 [INF] Request finished HTTP/1.1 GET http://192.168.1.9:5053/api/Participant/get_participants/1 - 200 null application/json; charset=utf-8 9.3985ms
2025-05-01 23:48:21.809 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/ws/chat?userId=5 - null null
2025-05-01 23:48:21.810 +07:00 [INF] CORS policy execution successful.
2025-05-01 23:48:21.810 +07:00 [INF] CORS policy execution successful.
2025-05-01 23:48:21.810 +07:00 [INF] Executing endpoint '/ws/chat'
2025-05-01 23:48:21.925 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__client_UserId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[conversation_id]
FROM [Participants] AS [p]
WHERE [p].[user_id] = @__client_UserId_0 AND [p].[is_deleted] = CAST(0 AS bit)
2025-05-01 23:48:21.928 +07:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5053/api/Message/getMessages/1/5 - null null
2025-05-01 23:48:21.929 +07:00 [INF] CORS policy execution successful.
2025-05-01 23:48:21.929 +07:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5053/api/Message/getMessages/1/5 - 204 null null 0.378ms
2025-05-01 23:48:21.930 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/api/Message/getMessages/1/5 - null null
2025-05-01 23:48:21.931 +07:00 [INF] CORS policy execution successful.
2025-05-01 23:48:21.931 +07:00 [INF] CORS policy execution successful.
2025-05-01 23:48:21.931 +07:00 [INF] Executing endpoint 'server.Controllers.MessageController.GetMessages (Message_app)'
2025-05-01 23:48:21.931 +07:00 [INF] Route matched with {action = "GetMessages", controller = "Message"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetMessages(Int32, Int32) on controller server.Controllers.MessageController (Message_app).
2025-05-01 23:48:21.943 +07:00 [WRN] Message 84 not found in Redis
2025-05-01 23:48:21.943 +07:00 [WRN] Message 83 not found in Redis
2025-05-01 23:48:21.944 +07:00 [WRN] Message 82 not found in Redis
2025-05-01 23:48:21.945 +07:00 [WRN] Message 81 not found in Redis
2025-05-01 23:48:21.946 +07:00 [WRN] Message 80 not found in Redis
2025-05-01 23:48:21.947 +07:00 [WRN] Message 79 not found in Redis
2025-05-01 23:48:21.948 +07:00 [WRN] Message 78 not found in Redis
2025-05-01 23:48:21.948 +07:00 [WRN] Message 77 not found in Redis
2025-05-01 23:48:21.949 +07:00 [WRN] Message 76 not found in Redis
2025-05-01 23:48:21.949 +07:00 [WRN] Message 75 not found in Redis
2025-05-01 23:48:21.950 +07:00 [WRN] Message 74 not found in Redis
2025-05-01 23:48:21.951 +07:00 [WRN] Message 73 not found in Redis
2025-05-01 23:48:21.951 +07:00 [WRN] Message 72 not found in Redis
2025-05-01 23:48:21.952 +07:00 [WRN] Message 71 not found in Redis
2025-05-01 23:48:21.953 +07:00 [WRN] Message 68 not found in Redis
2025-05-01 23:48:21.954 +07:00 [WRN] Message 64 not found in Redis
2025-05-01 23:48:21.957 +07:00 [WRN] Message 62 not found in Redis
2025-05-01 23:48:21.958 +07:00 [WRN] Message 61 not found in Redis
2025-05-01 23:48:21.959 +07:00 [WRN] Message 60 not found in Redis
2025-05-01 23:48:21.960 +07:00 [WRN] Message 59 not found in Redis
2025-05-01 23:48:21.963 +07:00 [WRN] Message 57 not found in Redis
2025-05-01 23:48:21.964 +07:00 [WRN] Message 55 not found in Redis
2025-05-01 23:48:21.965 +07:00 [WRN] Message 54 not found in Redis
2025-05-01 23:48:21.966 +07:00 [WRN] Message 51 not found in Redis
2025-05-01 23:48:21.967 +07:00 [WRN] Message 49 not found in Redis
2025-05-01 23:48:21.968 +07:00 [WRN] Message 11 not found in Redis
2025-05-01 23:48:21.969 +07:00 [WRN] Message 8 not found in Redis
2025-05-01 23:48:21.970 +07:00 [WRN] Message 3 not found in Redis
2025-05-01 23:48:21.972 +07:00 [WRN] Message 2 not found in Redis
2025-05-01 23:48:21.973 +07:00 [WRN] Message 1 not found in Redis
2025-05-01 23:48:21.973 +07:00 [INF] Retrieved 13 messages from Redis for conversation 1
2025-05-01 23:48:21.973 +07:00 [INF] Retrieved 13 messages from Redis for conversation 1 and user 5
2025-05-01 23:48:21.974 +07:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[server.DTO.MessageWithAttachment, Message_app, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-05-01 23:48:21.974 +07:00 [INF] Executed action server.Controllers.MessageController.GetMessages (Message_app) in 43.028ms
2025-05-01 23:48:21.974 +07:00 [INF] Executed endpoint 'server.Controllers.MessageController.GetMessages (Message_app)'
2025-05-01 23:48:21.974 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5053/api/Message/getMessages/1/5 - 200 null application/json; charset=utf-8 44.0701ms
2025-05-01 23:48:21.995 +07:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5053/api/Conversation/get_first_conversation/1 - null null
2025-05-01 23:48:21.995 +07:00 [INF] CORS policy execution successful.
2025-05-01 23:48:21.996 +07:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5053/api/Conversation/get_first_conversation/1 - 204 null null 0.3202ms
2025-05-01 23:48:21.997 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/api/Conversation/get_first_conversation/1 - null null
2025-05-01 23:48:21.997 +07:00 [INF] CORS policy execution successful.
2025-05-01 23:48:21.997 +07:00 [INF] CORS policy execution successful.
2025-05-01 23:48:21.997 +07:00 [INF] Executing endpoint 'server.Controllers.ConversationController.GetFirstConversation (Message_app)'
2025-05-01 23:48:21.997 +07:00 [INF] Route matched with {action = "GetFirstConversation", controller = "Conversation"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetFirstConversation(Int32) on controller server.Controllers.ConversationController (Message_app).
2025-05-01 23:48:21.999 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[id], [c].[created_at], [c].[is_group], [c].[lastMessage], [c].[lastMessageSender], [c].[lastMessageTime], [c].[name]
FROM [Conversations] AS [c]
WHERE [c].[id] = @__p_0
2025-05-01 23:48:21.999 +07:00 [INF] Executing OkObjectResult, writing value of type 'server.Models.Conversation'.
2025-05-01 23:48:22.000 +07:00 [INF] Executed action server.Controllers.ConversationController.GetFirstConversation (Message_app) in 2.3621ms
2025-05-01 23:48:22.000 +07:00 [INF] Executed endpoint 'server.Controllers.ConversationController.GetFirstConversation (Message_app)'
2025-05-01 23:48:22.000 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5053/api/Conversation/get_first_conversation/1 - 200 null application/json; charset=utf-8 3.3482ms
2025-05-01 23:48:22.017 +07:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5053/api/Participant/get_participants/1 - null null
2025-05-01 23:48:22.017 +07:00 [INF] CORS policy execution successful.
2025-05-01 23:48:22.017 +07:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5053/api/Participant/get_participants/1 - 204 null null 0.2082ms
2025-05-01 23:48:22.018 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/api/Participant/get_participants/1 - null null
2025-05-01 23:48:22.018 +07:00 [INF] CORS policy execution successful.
2025-05-01 23:48:22.018 +07:00 [INF] CORS policy execution successful.
2025-05-01 23:48:22.018 +07:00 [INF] Executing endpoint 'server.Controllers.ParticipantController.GetParticipants (Message_app)'
2025-05-01 23:48:22.019 +07:00 [INF] Route matched with {action = "GetParticipants", controller = "Participant"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetParticipants(Int32) on controller server.Controllers.ParticipantController (Message_app).
2025-05-01 23:48:22.020 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__conversation_id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[id], [p].[adder], [p].[conversation_id], [p].[is_deleted], [p].[joined_at], [p].[name], [p].[role], [p].[user_id]
FROM [Participants] AS [p]
WHERE [p].[conversation_id] = @__conversation_id_0
2025-05-01 23:48:22.021 +07:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType17`1[[System.Collections.Generic.List`1[[server.Models.Participants, Message_app, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-05-01 23:48:22.022 +07:00 [INF] Executed action server.Controllers.ParticipantController.GetParticipants (Message_app) in 3.1651ms
2025-05-01 23:48:22.022 +07:00 [INF] Executed endpoint 'server.Controllers.ParticipantController.GetParticipants (Message_app)'
2025-05-01 23:48:22.022 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5053/api/Participant/get_participants/1 - 200 null application/json; charset=utf-8 4.1819ms
2025-05-01 23:48:31.177 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/ws/chat?userId=5 - null null
2025-05-01 23:48:31.177 +07:00 [INF] CORS policy execution successful.
2025-05-01 23:48:31.178 +07:00 [INF] CORS policy execution successful.
2025-05-01 23:48:31.178 +07:00 [INF] Executing endpoint '/ws/chat'
2025-05-01 23:48:31.195 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[@__client_UserId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[conversation_id]
FROM [Participants] AS [p]
WHERE [p].[user_id] = @__client_UserId_0 AND [p].[is_deleted] = CAST(0 AS bit)
2025-05-01 23:48:43.526 +07:00 [INF] Application is shutting down...
2025-05-01 23:49:37.053 +07:00 [INF] Executed DbCommand (55ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [u].[id], [u].[username], [u].[avatar_url]
FROM [Users] AS [u]
2025-05-01 23:49:37.323 +07:00 [INF] User profile is available. Using 'C:\Users\Thao\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-05-01 23:49:37.420 +07:00 [WRN] Overriding address(es) 'http://localhost:5053'. Binding to endpoints defined via IConfiguration and/or UseKestrel() instead.
2025-05-01 23:49:37.443 +07:00 [INF] Now listening on: http://[::]:5053
2025-05-01 23:49:37.443 +07:00 [INF] Now listening on: http://0.0.0.0:5053
2025-05-01 23:49:37.444 +07:00 [INF] Application started. Press Ctrl+C to shut down.
2025-05-01 23:49:37.444 +07:00 [INF] Hosting environment: Development
2025-05-01 23:49:37.444 +07:00 [INF] Content root path: C:\Users\Thao\source\Flutter\Message_app\server
2025-05-01 23:49:37.632 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/ws/chat?userId=5 - null null
2025-05-01 23:49:37.683 +07:00 [INF] CORS policy execution successful.
2025-05-01 23:49:37.720 +07:00 [INF] CORS policy execution successful.
2025-05-01 23:49:37.722 +07:00 [WRN] Failed to determine the https port for redirect.
2025-05-01 23:49:37.810 +07:00 [INF] Executing endpoint '/ws/chat'
2025-05-01 23:49:38.191 +07:00 [INF] Executed DbCommand (55ms) [Parameters=[@__client_UserId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[conversation_id]
FROM [Participants] AS [p]
WHERE [p].[user_id] = @__client_UserId_0 AND [p].[is_deleted] = CAST(0 AS bit)
2025-05-01 23:49:38.844 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/ws/chat?userId=5 - null null
2025-05-01 23:49:38.846 +07:00 [INF] CORS policy execution successful.
2025-05-01 23:49:38.848 +07:00 [INF] CORS policy execution successful.
2025-05-01 23:49:38.850 +07:00 [INF] Executing endpoint '/ws/chat'
2025-05-01 23:49:38.969 +07:00 [INF] Executed DbCommand (6ms) [Parameters=[@__client_UserId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[conversation_id]
FROM [Participants] AS [p]
WHERE [p].[user_id] = @__client_UserId_0 AND [p].[is_deleted] = CAST(0 AS bit)
2025-05-01 23:49:43.126 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/ws/chat?userId=5 - null null
2025-05-01 23:49:43.128 +07:00 [INF] CORS policy execution successful.
2025-05-01 23:49:43.129 +07:00 [INF] CORS policy execution successful.
2025-05-01 23:49:43.132 +07:00 [INF] Executing endpoint '/ws/chat'
2025-05-01 23:49:43.159 +07:00 [INF] Executed DbCommand (8ms) [Parameters=[@__client_UserId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[conversation_id]
FROM [Participants] AS [p]
WHERE [p].[user_id] = @__client_UserId_0 AND [p].[is_deleted] = CAST(0 AS bit)
2025-05-01 23:49:49.262 +07:00 [INF] Request starting HTTP/1.1 GET http://192.168.1.9:5053/ws/chat?userId=2 - null null
2025-05-01 23:49:49.263 +07:00 [INF] Executing endpoint '/ws/chat'
2025-05-01 23:49:49.278 +07:00 [INF] Request starting HTTP/1.1 GET http://192.168.1.9:5053/ws/chat?userId=2 - null null
2025-05-01 23:49:49.278 +07:00 [INF] Executing endpoint '/ws/chat'
2025-05-01 23:49:49.299 +07:00 [INF] Executed DbCommand (10ms) [Parameters=[@__client_UserId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[conversation_id]
FROM [Participants] AS [p]
WHERE [p].[user_id] = @__client_UserId_0 AND [p].[is_deleted] = CAST(0 AS bit)
2025-05-01 23:49:49.303 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__client_UserId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[conversation_id]
FROM [Participants] AS [p]
WHERE [p].[user_id] = @__client_UserId_0 AND [p].[is_deleted] = CAST(0 AS bit)
