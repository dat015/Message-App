2025-04-30 00:46:23.914 +07:00 [INF] Executed endpoint '/ws/chat'
2025-04-30 00:46:24.179 +07:00 [ERR] An unhandled exception has occurred while executing the request.
System.Net.WebSockets.WebSocketException (0x80004005): The remote party closed the WebSocket connection without completing the close handshake.
   at System.Net.WebSockets.ManagedWebSocket.ThrowEOFUnexpected()
   at System.Net.WebSockets.ManagedWebSocket.EnsureBufferContainsAsync(Int32 minimumRequiredBytes, CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.WebSockets.ManagedWebSocket.ReceiveAsyncPrivate[TResult](Memory`1 payloadBuffer, CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at System.Threading.Tasks.ValueTask`1.ValueTaskSourceAsTask.<>c.<.cctor>b__4_0(Object state)
--- End of stack trace from previous location ---
   at server.Services.WebSocketService.webSocket.Receiver(Client client) in C:\Users\Thao\source\Flutter\Message_app\server\Services\WebSocketService\websocket.cs:line 108
   at server.Services.WebSocketService.webSocket.HandleWebSocket(HttpContext context) in C:\Users\Thao\source\Flutter\Message_app\server\Services\WebSocketService\websocket.cs:line 91
   at Program.<>c.<<<Main>$>b__0_4>d.MoveNext() in C:\Users\Thao\source\Flutter\Message_app\server\Program.cs:line 89
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
2025-04-30 00:46:24.679 +07:00 [WRN] The response has already started, the error page middleware will not be executed.
2025-04-30 00:46:24.687 +07:00 [ERR] Connection id "0HNC76IAKB39R", Request id "0HNC76IAKB39R:00000001": An unhandled exception was thrown by the application.
System.Net.WebSockets.WebSocketException (0x80004005): The remote party closed the WebSocket connection without completing the close handshake.
   at System.Net.WebSockets.ManagedWebSocket.ThrowEOFUnexpected()
   at System.Net.WebSockets.ManagedWebSocket.EnsureBufferContainsAsync(Int32 minimumRequiredBytes, CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.WebSockets.ManagedWebSocket.ReceiveAsyncPrivate[TResult](Memory`1 payloadBuffer, CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at System.Threading.Tasks.ValueTask`1.ValueTaskSourceAsTask.<>c.<.cctor>b__4_0(Object state)
--- End of stack trace from previous location ---
   at server.Services.WebSocketService.webSocket.Receiver(Client client) in C:\Users\Thao\source\Flutter\Message_app\server\Services\WebSocketService\websocket.cs:line 108
   at server.Services.WebSocketService.webSocket.HandleWebSocket(HttpContext context) in C:\Users\Thao\source\Flutter\Message_app\server\Services\WebSocketService\websocket.cs:line 91
   at Program.<>c.<<<Main>$>b__0_4>d.MoveNext() in C:\Users\Thao\source\Flutter\Message_app\server\Program.cs:line 89
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Watch.BrowserRefresh.BrowserRefreshMiddleware.InvokeAsync(HttpContext context)
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.Http.HttpProtocol.ProcessRequests[TContext](IHttpApplication`1 application)
2025-04-30 00:46:24.707 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5053/ws/chat?userId=5 - 101 null null 7376246.3674ms
2025-04-30 06:41:33.426 +07:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5053/api/Auth/login - null null
2025-04-30 06:41:33.430 +07:00 [INF] CORS policy execution successful.
2025-04-30 06:41:33.431 +07:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5053/api/Auth/login - 204 null null 5.1273ms
2025-04-30 06:41:33.434 +07:00 [INF] Request starting HTTP/1.1 POST http://localhost:5053/api/Auth/login - application/json 53
2025-04-30 06:41:33.435 +07:00 [INF] CORS policy execution successful.
2025-04-30 06:41:33.441 +07:00 [INF] CORS policy execution successful.
2025-04-30 06:41:33.449 +07:00 [INF] Executing endpoint 'Message_app.Controllers.AuthController.Login (Message_app)'
2025-04-30 06:41:33.458 +07:00 [INF] Route matched with {action = "Login", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Login(server.DTO.AuthDTO.LoginDTO) on controller Message_app.Controllers.AuthController (Message_app).
2025-04-30 06:41:33.788 +07:00 [INF] Executed DbCommand (39ms) [Parameters=[@__email_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[id], [u].[avatar_url], [u].[bio], [u].[birthday], [u].[created_at], [u].[email], [u].[gender], [u].[interests], [u].[location], [u].[password], [u].[passwordSalt], [u].[username]
FROM [Users] AS [u]
WHERE [u].[email] = @__email_0
2025-04-30 06:41:33.822 +07:00 [INF] Executing OkObjectResult, writing value of type 'server.DTO.AuthDTO.LoginRespose'.
2025-04-30 06:41:33.828 +07:00 [INF] Executed action Message_app.Controllers.AuthController.Login (Message_app) in 369.4107ms
2025-04-30 06:41:33.829 +07:00 [INF] Executed endpoint 'Message_app.Controllers.AuthController.Login (Message_app)'
2025-04-30 06:41:33.831 +07:00 [INF] Request finished HTTP/1.1 POST http://localhost:5053/api/Auth/login - 200 null application/json; charset=utf-8 397.0922ms
2025-04-30 06:41:33.872 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/ws/chat?userId=5 - null null
2025-04-30 06:41:33.878 +07:00 [INF] CORS policy execution successful.
2025-04-30 06:41:33.879 +07:00 [INF] CORS policy execution successful.
2025-04-30 06:41:33.879 +07:00 [INF] Executing endpoint '/ws/chat'
2025-04-30 06:41:34.045 +07:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5053/api/Conversation/get_conversations/5 - null null
2025-04-30 06:41:34.045 +07:00 [INF] CORS policy execution successful.
2025-04-30 06:41:34.046 +07:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5053/api/Conversation/get_conversations/5 - 204 null null 0.9084ms
2025-04-30 06:41:34.046 +07:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5053/api/Conversation/get_conversations/5 - null null
2025-04-30 06:41:34.046 +07:00 [INF] CORS policy execution successful.
2025-04-30 06:41:34.046 +07:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5053/api/Conversation/get_conversations/5 - 204 null null 0.4362ms
2025-04-30 06:41:34.048 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/api/Conversation/get_conversations/5 - null null
2025-04-30 06:41:34.048 +07:00 [INF] CORS policy execution successful.
2025-04-30 06:41:34.049 +07:00 [INF] CORS policy execution successful.
2025-04-30 06:41:34.049 +07:00 [INF] Executing endpoint 'server.Controllers.ConversationController.GetConversations (Message_app)'
2025-04-30 06:41:34.050 +07:00 [INF] Route matched with {action = "GetConversations", controller = "Conversation"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetConversations(Int32) on controller server.Controllers.ConversationController (Message_app).
2025-04-30 06:41:34.068 +07:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[server.DTO.ConversationDto, Message_app, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-04-30 06:41:34.070 +07:00 [INF] Executed action server.Controllers.ConversationController.GetConversations (Message_app) in 20.748ms
2025-04-30 06:41:34.071 +07:00 [INF] Executed endpoint 'server.Controllers.ConversationController.GetConversations (Message_app)'
2025-04-30 06:41:34.071 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5053/api/Conversation/get_conversations/5 - 200 null application/json; charset=utf-8 23.2366ms
2025-04-30 06:41:34.072 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/api/Conversation/get_conversations/5 - null null
2025-04-30 06:41:34.072 +07:00 [INF] CORS policy execution successful.
2025-04-30 06:41:34.073 +07:00 [INF] CORS policy execution successful.
2025-04-30 06:41:34.073 +07:00 [INF] Executing endpoint 'server.Controllers.ConversationController.GetConversations (Message_app)'
2025-04-30 06:41:34.074 +07:00 [INF] Route matched with {action = "GetConversations", controller = "Conversation"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetConversations(Int32) on controller server.Controllers.ConversationController (Message_app).
2025-04-30 06:41:34.076 +07:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[server.DTO.ConversationDto, Message_app, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-04-30 06:41:34.080 +07:00 [INF] Executed action server.Controllers.ConversationController.GetConversations (Message_app) in 6.7664ms
2025-04-30 06:41:34.081 +07:00 [INF] Executed endpoint 'server.Controllers.ConversationController.GetConversations (Message_app)'
2025-04-30 06:41:34.081 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5053/api/Conversation/get_conversations/5 - 200 null application/json; charset=utf-8 8.6839ms
2025-04-30 07:36:09.376 +07:00 [INF] Executed endpoint '/ws/chat'
2025-04-30 07:36:09.377 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5053/ws/chat?userId=5 - 101 null null 3275504.9108ms
2025-04-30 07:36:20.513 +07:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5053/api/Auth/login - null null
2025-04-30 07:36:20.514 +07:00 [INF] CORS policy execution successful.
2025-04-30 07:36:20.514 +07:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5053/api/Auth/login - 204 null null 0.8821ms
2025-04-30 07:36:20.515 +07:00 [INF] Request starting HTTP/1.1 POST http://localhost:5053/api/Auth/login - application/json 53
2025-04-30 07:36:20.516 +07:00 [INF] CORS policy execution successful.
2025-04-30 07:36:20.516 +07:00 [INF] CORS policy execution successful.
2025-04-30 07:36:20.516 +07:00 [INF] Executing endpoint 'Message_app.Controllers.AuthController.Login (Message_app)'
2025-04-30 07:36:20.517 +07:00 [INF] Route matched with {action = "Login", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Login(server.DTO.AuthDTO.LoginDTO) on controller Message_app.Controllers.AuthController (Message_app).
2025-04-30 07:36:20.562 +07:00 [INF] Executed DbCommand (14ms) [Parameters=[@__email_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[id], [u].[avatar_url], [u].[bio], [u].[birthday], [u].[created_at], [u].[email], [u].[gender], [u].[interests], [u].[location], [u].[password], [u].[passwordSalt], [u].[username]
FROM [Users] AS [u]
WHERE [u].[email] = @__email_0
2025-04-30 07:36:20.566 +07:00 [INF] Executing OkObjectResult, writing value of type 'server.DTO.AuthDTO.LoginRespose'.
2025-04-30 07:36:20.568 +07:00 [INF] Executed action Message_app.Controllers.AuthController.Login (Message_app) in 50.9575ms
2025-04-30 07:36:20.568 +07:00 [INF] Executed endpoint 'Message_app.Controllers.AuthController.Login (Message_app)'
2025-04-30 07:36:20.571 +07:00 [INF] Request finished HTTP/1.1 POST http://localhost:5053/api/Auth/login - 200 null application/json; charset=utf-8 52.9566ms
2025-04-30 07:36:20.963 +07:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5053/api/Conversation/get_conversations/5 - null null
2025-04-30 07:36:20.963 +07:00 [INF] CORS policy execution successful.
2025-04-30 07:36:20.964 +07:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5053/api/Conversation/get_conversations/5 - 204 null null 0.471ms
2025-04-30 07:36:20.965 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/api/Conversation/get_conversations/5 - null null
2025-04-30 07:36:20.965 +07:00 [INF] CORS policy execution successful.
2025-04-30 07:36:20.965 +07:00 [INF] CORS policy execution successful.
2025-04-30 07:36:20.966 +07:00 [INF] Executing endpoint 'server.Controllers.ConversationController.GetConversations (Message_app)'
2025-04-30 07:36:20.966 +07:00 [INF] Route matched with {action = "GetConversations", controller = "Conversation"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetConversations(Int32) on controller server.Controllers.ConversationController (Message_app).
2025-04-30 07:36:20.968 +07:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[server.DTO.ConversationDto, Message_app, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-04-30 07:36:20.968 +07:00 [INF] Executed action server.Controllers.ConversationController.GetConversations (Message_app) in 1.8402ms
2025-04-30 07:36:20.968 +07:00 [INF] Executed endpoint 'server.Controllers.ConversationController.GetConversations (Message_app)'
2025-04-30 07:36:20.968 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5053/api/Conversation/get_conversations/5 - 200 null application/json; charset=utf-8 3.3504ms
2025-04-30 07:37:03.375 +07:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5053/api/Auth/login - null null
2025-04-30 07:37:03.375 +07:00 [INF] CORS policy execution successful.
2025-04-30 07:37:03.376 +07:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5053/api/Auth/login - 204 null null 0.7392ms
2025-04-30 07:37:03.377 +07:00 [INF] Request starting HTTP/1.1 POST http://localhost:5053/api/Auth/login - application/json 53
2025-04-30 07:37:03.377 +07:00 [INF] CORS policy execution successful.
2025-04-30 07:37:03.378 +07:00 [INF] CORS policy execution successful.
2025-04-30 07:37:03.378 +07:00 [INF] Executing endpoint 'Message_app.Controllers.AuthController.Login (Message_app)'
2025-04-30 07:37:03.378 +07:00 [INF] Route matched with {action = "Login", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Login(server.DTO.AuthDTO.LoginDTO) on controller Message_app.Controllers.AuthController (Message_app).
2025-04-30 07:37:03.399 +07:00 [INF] Executed DbCommand (15ms) [Parameters=[@__email_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[id], [u].[avatar_url], [u].[bio], [u].[birthday], [u].[created_at], [u].[email], [u].[gender], [u].[interests], [u].[location], [u].[password], [u].[passwordSalt], [u].[username]
FROM [Users] AS [u]
WHERE [u].[email] = @__email_0
2025-04-30 07:37:03.402 +07:00 [INF] Executing OkObjectResult, writing value of type 'server.DTO.AuthDTO.LoginRespose'.
2025-04-30 07:37:03.402 +07:00 [INF] Executed action Message_app.Controllers.AuthController.Login (Message_app) in 24.1304ms
2025-04-30 07:37:03.403 +07:00 [INF] Executed endpoint 'Message_app.Controllers.AuthController.Login (Message_app)'
2025-04-30 07:37:03.403 +07:00 [INF] Request finished HTTP/1.1 POST http://localhost:5053/api/Auth/login - 200 null application/json; charset=utf-8 25.8774ms
2025-04-30 07:37:03.437 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/ws/chat?userId=5 - null null
2025-04-30 07:37:03.438 +07:00 [INF] CORS policy execution successful.
2025-04-30 07:37:03.438 +07:00 [INF] CORS policy execution successful.
2025-04-30 07:37:03.438 +07:00 [INF] Executing endpoint '/ws/chat'
2025-04-30 07:37:03.580 +07:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5053/api/Conversation/get_conversations/5 - null null
2025-04-30 07:37:03.581 +07:00 [INF] CORS policy execution successful.
2025-04-30 07:37:03.581 +07:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5053/api/Conversation/get_conversations/5 - 204 null null 0.4222ms
2025-04-30 07:37:03.582 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/api/Conversation/get_conversations/5 - null null
2025-04-30 07:37:03.582 +07:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5053/api/Conversation/get_conversations/5 - null null
2025-04-30 07:37:03.582 +07:00 [INF] CORS policy execution successful.
2025-04-30 07:37:03.583 +07:00 [INF] CORS policy execution successful.
2025-04-30 07:37:03.583 +07:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5053/api/Conversation/get_conversations/5 - 204 null null 0.2437ms
2025-04-30 07:37:03.583 +07:00 [INF] CORS policy execution successful.
2025-04-30 07:37:03.583 +07:00 [INF] Executing endpoint 'server.Controllers.ConversationController.GetConversations (Message_app)'
2025-04-30 07:37:03.583 +07:00 [INF] Route matched with {action = "GetConversations", controller = "Conversation"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetConversations(Int32) on controller server.Controllers.ConversationController (Message_app).
2025-04-30 07:37:03.585 +07:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[server.DTO.ConversationDto, Message_app, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-04-30 07:37:03.586 +07:00 [INF] Executed action server.Controllers.ConversationController.GetConversations (Message_app) in 2.8982ms
2025-04-30 07:37:03.586 +07:00 [INF] Executed endpoint 'server.Controllers.ConversationController.GetConversations (Message_app)'
2025-04-30 07:37:03.586 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5053/api/Conversation/get_conversations/5 - 200 null application/json; charset=utf-8 3.8314ms
2025-04-30 07:37:03.588 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/api/Conversation/get_conversations/5 - null null
2025-04-30 07:37:03.588 +07:00 [INF] CORS policy execution successful.
2025-04-30 07:37:03.588 +07:00 [INF] CORS policy execution successful.
2025-04-30 07:37:03.589 +07:00 [INF] Executing endpoint 'server.Controllers.ConversationController.GetConversations (Message_app)'
2025-04-30 07:37:03.589 +07:00 [INF] Route matched with {action = "GetConversations", controller = "Conversation"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetConversations(Int32) on controller server.Controllers.ConversationController (Message_app).
2025-04-30 07:37:03.592 +07:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[server.DTO.ConversationDto, Message_app, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-04-30 07:37:03.593 +07:00 [INF] Executed action server.Controllers.ConversationController.GetConversations (Message_app) in 3.7832ms
2025-04-30 07:37:03.593 +07:00 [INF] Executed endpoint 'server.Controllers.ConversationController.GetConversations (Message_app)'
2025-04-30 07:37:03.593 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5053/api/Conversation/get_conversations/5 - 200 null application/json; charset=utf-8 5.3571ms
2025-04-30 07:37:05.265 +07:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5053/api/Message/getMessages/1/5 - null null
2025-04-30 07:37:05.265 +07:00 [INF] CORS policy execution successful.
2025-04-30 07:37:05.265 +07:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5053/api/Message/getMessages/1/5 - 204 null null 0.313ms
2025-04-30 07:37:05.266 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/api/Message/getMessages/1/5 - null null
2025-04-30 07:37:05.266 +07:00 [INF] CORS policy execution successful.
2025-04-30 07:37:05.267 +07:00 [INF] CORS policy execution successful.
2025-04-30 07:37:05.267 +07:00 [INF] Executing endpoint 'server.Controllers.MessageController.GetMessages (Message_app)'
2025-04-30 07:37:05.302 +07:00 [INF] Route matched with {action = "GetMessages", controller = "Message"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetMessages(Int32, Int32) on controller server.Controllers.MessageController (Message_app).
2025-04-30 07:37:05.437 +07:00 [WRN] Message 81 not found in Redis
2025-04-30 07:37:05.438 +07:00 [WRN] Message 80 not found in Redis
2025-04-30 07:37:05.438 +07:00 [WRN] Message 79 not found in Redis
2025-04-30 07:37:05.439 +07:00 [WRN] Message 78 not found in Redis
2025-04-30 07:37:05.439 +07:00 [WRN] Message 77 not found in Redis
2025-04-30 07:37:05.440 +07:00 [WRN] Message 76 not found in Redis
2025-04-30 07:37:05.440 +07:00 [WRN] Message 75 not found in Redis
2025-04-30 07:37:05.440 +07:00 [WRN] Message 74 not found in Redis
2025-04-30 07:37:05.441 +07:00 [WRN] Message 73 not found in Redis
2025-04-30 07:37:05.441 +07:00 [WRN] Message 72 not found in Redis
2025-04-30 07:37:05.441 +07:00 [WRN] Message 71 not found in Redis
2025-04-30 07:37:05.442 +07:00 [WRN] Message 68 not found in Redis
2025-04-30 07:37:05.443 +07:00 [WRN] Message 64 not found in Redis
2025-04-30 07:37:05.443 +07:00 [WRN] Message 62 not found in Redis
2025-04-30 07:37:05.444 +07:00 [WRN] Message 61 not found in Redis
2025-04-30 07:37:05.445 +07:00 [WRN] Message 60 not found in Redis
2025-04-30 07:37:05.446 +07:00 [WRN] Message 59 not found in Redis
2025-04-30 07:37:05.447 +07:00 [WRN] Message 57 not found in Redis
2025-04-30 07:37:05.447 +07:00 [WRN] Message 55 not found in Redis
2025-04-30 07:37:05.448 +07:00 [WRN] Message 54 not found in Redis
2025-04-30 07:37:05.448 +07:00 [WRN] Message 51 not found in Redis
2025-04-30 07:37:05.451 +07:00 [WRN] Message 49 not found in Redis
2025-04-30 07:37:05.452 +07:00 [WRN] Message 11 not found in Redis
2025-04-30 07:37:05.453 +07:00 [WRN] Message 8 not found in Redis
2025-04-30 07:37:05.453 +07:00 [WRN] Message 3 not found in Redis
2025-04-30 07:37:05.454 +07:00 [WRN] Message 2 not found in Redis
2025-04-30 07:37:05.455 +07:00 [WRN] Message 1 not found in Redis
2025-04-30 07:37:05.455 +07:00 [INF] Retrieved 9 messages from Redis for conversation 1
2025-04-30 07:37:05.462 +07:00 [INF] Retrieved 9 messages from Redis for conversation 1 and user 5
2025-04-30 07:37:05.463 +07:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[server.DTO.MessageWithAttachment, Message_app, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-04-30 07:37:05.493 +07:00 [INF] Executed action server.Controllers.MessageController.GetMessages (Message_app) in 190.6541ms
2025-04-30 07:37:05.494 +07:00 [INF] Executed endpoint 'server.Controllers.MessageController.GetMessages (Message_app)'
2025-04-30 07:37:05.494 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5053/api/Message/getMessages/1/5 - 200 null application/json; charset=utf-8 227.5969ms
2025-04-30 07:37:05.513 +07:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5053/api/Conversation/get_first_conversation/1 - null null
2025-04-30 07:37:05.513 +07:00 [INF] CORS policy execution successful.
2025-04-30 07:37:05.515 +07:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5053/api/Conversation/get_first_conversation/1 - 204 null null 0.4692ms
2025-04-30 07:37:05.517 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/api/Conversation/get_first_conversation/1 - null null
2025-04-30 07:37:05.517 +07:00 [INF] CORS policy execution successful.
2025-04-30 07:37:05.517 +07:00 [INF] CORS policy execution successful.
2025-04-30 07:37:05.518 +07:00 [INF] Executing endpoint 'server.Controllers.ConversationController.GetFirstConversation (Message_app)'
2025-04-30 07:37:05.524 +07:00 [INF] Route matched with {action = "GetFirstConversation", controller = "Conversation"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetFirstConversation(Int32) on controller server.Controllers.ConversationController (Message_app).
2025-04-30 07:37:05.664 +07:00 [INF] Executed DbCommand (8ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[id], [c].[created_at], [c].[is_group], [c].[lastMessage], [c].[lastMessageSender], [c].[lastMessageTime], [c].[name]
FROM [Conversations] AS [c]
WHERE [c].[id] = @__p_0
2025-04-30 07:37:05.735 +07:00 [INF] Executing OkObjectResult, writing value of type 'server.Models.Conversation'.
2025-04-30 07:37:05.739 +07:00 [INF] Executed action server.Controllers.ConversationController.GetFirstConversation (Message_app) in 215.1108ms
2025-04-30 07:37:05.739 +07:00 [INF] Executed endpoint 'server.Controllers.ConversationController.GetFirstConversation (Message_app)'
2025-04-30 07:37:05.740 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5053/api/Conversation/get_first_conversation/1 - 200 null application/json; charset=utf-8 223.1053ms
2025-04-30 07:37:05.756 +07:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5053/api/Participant/get_participants/1 - null null
2025-04-30 07:37:05.757 +07:00 [INF] CORS policy execution successful.
2025-04-30 07:37:05.757 +07:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5053/api/Participant/get_participants/1 - 204 null null 0.6001ms
2025-04-30 07:37:05.759 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/api/Participant/get_participants/1 - null null
2025-04-30 07:37:05.759 +07:00 [INF] CORS policy execution successful.
2025-04-30 07:37:05.759 +07:00 [INF] CORS policy execution successful.
2025-04-30 07:37:05.759 +07:00 [INF] Executing endpoint 'server.Controllers.ParticipantController.GetParticipants (Message_app)'
2025-04-30 07:37:05.768 +07:00 [INF] Route matched with {action = "GetParticipants", controller = "Participant"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetParticipants(Int32) on controller server.Controllers.ParticipantController (Message_app).
2025-04-30 07:37:05.808 +07:00 [INF] Executed DbCommand (13ms) [Parameters=[@__conversation_id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[id], [p].[adder], [p].[conversation_id], [p].[is_deleted], [p].[joined_at], [p].[name], [p].[role], [p].[user_id]
FROM [Participants] AS [p]
WHERE [p].[conversation_id] = @__conversation_id_0
2025-04-30 07:37:05.844 +07:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType17`1[[System.Collections.Generic.List`1[[server.Models.Participants, Message_app, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-04-30 07:37:05.874 +07:00 [INF] Executed action server.Controllers.ParticipantController.GetParticipants (Message_app) in 105.5433ms
2025-04-30 07:37:05.874 +07:00 [INF] Executed endpoint 'server.Controllers.ParticipantController.GetParticipants (Message_app)'
2025-04-30 07:37:05.875 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5053/api/Participant/get_participants/1 - 200 null application/json; charset=utf-8 115.8895ms
2025-04-30 07:40:53.908 +07:00 [INF] Request starting HTTP/1.1 POST http://192.168.1.9:5053/api/Auth/login - application/json 57
2025-04-30 07:40:53.927 +07:00 [INF] Executing endpoint 'Message_app.Controllers.AuthController.Login (Message_app)'
2025-04-30 07:40:53.928 +07:00 [INF] Route matched with {action = "Login", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Login(server.DTO.AuthDTO.LoginDTO) on controller Message_app.Controllers.AuthController (Message_app).
2025-04-30 07:40:53.951 +07:00 [INF] Executed DbCommand (17ms) [Parameters=[@__email_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[id], [u].[avatar_url], [u].[bio], [u].[birthday], [u].[created_at], [u].[email], [u].[gender], [u].[interests], [u].[location], [u].[password], [u].[passwordSalt], [u].[username]
FROM [Users] AS [u]
WHERE [u].[email] = @__email_0
2025-04-30 07:40:53.953 +07:00 [INF] Executing OkObjectResult, writing value of type 'server.DTO.AuthDTO.LoginRespose'.
2025-04-30 07:40:53.953 +07:00 [INF] Executed action Message_app.Controllers.AuthController.Login (Message_app) in 25.763ms
2025-04-30 07:40:53.954 +07:00 [INF] Executed endpoint 'Message_app.Controllers.AuthController.Login (Message_app)'
2025-04-30 07:40:53.954 +07:00 [INF] Request finished HTTP/1.1 POST http://192.168.1.9:5053/api/Auth/login - 200 null application/json; charset=utf-8 45.7681ms
2025-04-30 07:40:55.027 +07:00 [INF] Request starting HTTP/1.1 GET http://192.168.1.9:5053/ws/chat?userId=2 - null null
2025-04-30 07:40:55.028 +07:00 [INF] Executing endpoint '/ws/chat'
2025-04-30 07:40:55.202 +07:00 [INF] Request starting HTTP/1.1 GET http://192.168.1.9:5053/api/Conversation/get_conversations/2 - null null
2025-04-30 07:40:55.202 +07:00 [INF] Executing endpoint 'server.Controllers.ConversationController.GetConversations (Message_app)'
2025-04-30 07:40:55.203 +07:00 [INF] Route matched with {action = "GetConversations", controller = "Conversation"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetConversations(Int32) on controller server.Controllers.ConversationController (Message_app).
2025-04-30 07:40:55.205 +07:00 [INF] Request starting HTTP/1.1 GET http://192.168.1.9:5053/api/Conversation/get_conversations/2 - null null
2025-04-30 07:40:55.205 +07:00 [INF] Executing endpoint 'server.Controllers.ConversationController.GetConversations (Message_app)'
2025-04-30 07:40:55.205 +07:00 [INF] Route matched with {action = "GetConversations", controller = "Conversation"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetConversations(Int32) on controller server.Controllers.ConversationController (Message_app).
2025-04-30 07:40:55.208 +07:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[server.DTO.ConversationDto, Message_app, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-04-30 07:40:55.208 +07:00 [INF] Executed action server.Controllers.ConversationController.GetConversations (Message_app) in 2.8375ms
2025-04-30 07:40:55.208 +07:00 [INF] Executed endpoint 'server.Controllers.ConversationController.GetConversations (Message_app)'
2025-04-30 07:40:55.209 +07:00 [INF] Request finished HTTP/1.1 GET http://192.168.1.9:5053/api/Conversation/get_conversations/2 - 200 null application/json; charset=utf-8 4.1655ms
2025-04-30 07:40:55.209 +07:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[server.DTO.ConversationDto, Message_app, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-04-30 07:40:55.209 +07:00 [INF] Executed action server.Controllers.ConversationController.GetConversations (Message_app) in 6.7219ms
2025-04-30 07:40:55.210 +07:00 [INF] Executed endpoint 'server.Controllers.ConversationController.GetConversations (Message_app)'
2025-04-30 07:40:55.210 +07:00 [INF] Request finished HTTP/1.1 GET http://192.168.1.9:5053/api/Conversation/get_conversations/2 - 200 null application/json; charset=utf-8 8.2049ms
2025-04-30 07:40:56.994 +07:00 [INF] Request starting HTTP/1.1 GET http://192.168.1.9:5053/api/Message/getMessages/1/2 - null null
2025-04-30 07:40:56.999 +07:00 [INF] Executing endpoint 'server.Controllers.MessageController.GetMessages (Message_app)'
2025-04-30 07:40:57.000 +07:00 [INF] Route matched with {action = "GetMessages", controller = "Message"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetMessages(Int32, Int32) on controller server.Controllers.MessageController (Message_app).
2025-04-30 07:40:57.022 +07:00 [WRN] Message 81 not found in Redis
2025-04-30 07:40:57.023 +07:00 [WRN] Message 80 not found in Redis
2025-04-30 07:40:57.026 +07:00 [WRN] Message 79 not found in Redis
2025-04-30 07:40:57.027 +07:00 [WRN] Message 78 not found in Redis
2025-04-30 07:40:57.028 +07:00 [WRN] Message 77 not found in Redis
2025-04-30 07:40:57.028 +07:00 [WRN] Message 76 not found in Redis
2025-04-30 07:40:57.042 +07:00 [WRN] Message 75 not found in Redis
2025-04-30 07:40:57.043 +07:00 [WRN] Message 74 not found in Redis
2025-04-30 07:40:57.043 +07:00 [WRN] Message 73 not found in Redis
2025-04-30 07:40:57.044 +07:00 [WRN] Message 72 not found in Redis
2025-04-30 07:40:57.044 +07:00 [WRN] Message 71 not found in Redis
2025-04-30 07:40:57.045 +07:00 [WRN] Message 68 not found in Redis
2025-04-30 07:40:57.045 +07:00 [WRN] Message 64 not found in Redis
2025-04-30 07:40:57.046 +07:00 [WRN] Message 62 not found in Redis
2025-04-30 07:40:57.046 +07:00 [WRN] Message 61 not found in Redis
2025-04-30 07:40:57.052 +07:00 [WRN] Message 60 not found in Redis
2025-04-30 07:40:57.055 +07:00 [WRN] Message 59 not found in Redis
2025-04-30 07:40:57.072 +07:00 [WRN] Message 57 not found in Redis
2025-04-30 07:40:57.073 +07:00 [WRN] Message 55 not found in Redis
2025-04-30 07:40:57.086 +07:00 [WRN] Message 54 not found in Redis
2025-04-30 07:40:57.087 +07:00 [WRN] Message 51 not found in Redis
2025-04-30 07:40:57.088 +07:00 [WRN] Message 49 not found in Redis
2025-04-30 07:40:57.088 +07:00 [WRN] Message 11 not found in Redis
2025-04-30 07:40:57.088 +07:00 [WRN] Message 8 not found in Redis
2025-04-30 07:40:57.089 +07:00 [WRN] Message 3 not found in Redis
2025-04-30 07:40:57.089 +07:00 [WRN] Message 2 not found in Redis
2025-04-30 07:40:57.090 +07:00 [WRN] Message 1 not found in Redis
2025-04-30 07:40:57.090 +07:00 [INF] Retrieved 9 messages from Redis for conversation 1
2025-04-30 07:40:57.090 +07:00 [INF] Retrieved 9 messages from Redis for conversation 1 and user 2
2025-04-30 07:40:57.090 +07:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[server.DTO.MessageWithAttachment, Message_app, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-04-30 07:40:57.090 +07:00 [INF] Executed action server.Controllers.MessageController.GetMessages (Message_app) in 90.6293ms
2025-04-30 07:40:57.091 +07:00 [INF] Executed endpoint 'server.Controllers.MessageController.GetMessages (Message_app)'
2025-04-30 07:40:57.094 +07:00 [INF] Request finished HTTP/1.1 GET http://192.168.1.9:5053/api/Message/getMessages/1/2 - 200 null application/json; charset=utf-8 100.5872ms
2025-04-30 07:40:57.141 +07:00 [INF] Request starting HTTP/1.1 GET http://192.168.1.9:5053/api/Conversation/get_first_conversation/1 - null null
2025-04-30 07:40:57.148 +07:00 [INF] Executing endpoint 'server.Controllers.ConversationController.GetFirstConversation (Message_app)'
2025-04-30 07:40:57.149 +07:00 [INF] Route matched with {action = "GetFirstConversation", controller = "Conversation"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetFirstConversation(Int32) on controller server.Controllers.ConversationController (Message_app).
2025-04-30 07:40:57.161 +07:00 [INF] Executed DbCommand (4ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[id], [c].[created_at], [c].[is_group], [c].[lastMessage], [c].[lastMessageSender], [c].[lastMessageTime], [c].[name]
FROM [Conversations] AS [c]
WHERE [c].[id] = @__p_0
2025-04-30 07:40:57.162 +07:00 [INF] Executing OkObjectResult, writing value of type 'server.Models.Conversation'.
2025-04-30 07:40:57.162 +07:00 [INF] Executed action server.Controllers.ConversationController.GetFirstConversation (Message_app) in 13.7399ms
2025-04-30 07:40:57.163 +07:00 [INF] Executed endpoint 'server.Controllers.ConversationController.GetFirstConversation (Message_app)'
2025-04-30 07:40:57.163 +07:00 [INF] Request finished HTTP/1.1 GET http://192.168.1.9:5053/api/Conversation/get_first_conversation/1 - 200 null application/json; charset=utf-8 22.1786ms
2025-04-30 07:40:57.181 +07:00 [INF] Request starting HTTP/1.1 GET http://192.168.1.9:5053/api/Participant/get_participants/1 - null null
2025-04-30 07:40:57.183 +07:00 [INF] Executing endpoint 'server.Controllers.ParticipantController.GetParticipants (Message_app)'
2025-04-30 07:40:57.183 +07:00 [INF] Route matched with {action = "GetParticipants", controller = "Participant"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetParticipants(Int32) on controller server.Controllers.ParticipantController (Message_app).
2025-04-30 07:40:57.195 +07:00 [INF] Executed DbCommand (8ms) [Parameters=[@__conversation_id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[id], [p].[adder], [p].[conversation_id], [p].[is_deleted], [p].[joined_at], [p].[name], [p].[role], [p].[user_id]
FROM [Participants] AS [p]
WHERE [p].[conversation_id] = @__conversation_id_0
2025-04-30 07:40:57.195 +07:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType17`1[[System.Collections.Generic.List`1[[server.Models.Participants, Message_app, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-04-30 07:40:57.196 +07:00 [INF] Executed action server.Controllers.ParticipantController.GetParticipants (Message_app) in 12.4548ms
2025-04-30 07:40:57.196 +07:00 [INF] Executed endpoint 'server.Controllers.ParticipantController.GetParticipants (Message_app)'
2025-04-30 07:40:57.196 +07:00 [INF] Request finished HTTP/1.1 GET http://192.168.1.9:5053/api/Participant/get_participants/1 - 200 null application/json; charset=utf-8 14.9132ms
2025-04-30 07:40:59.269 +07:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5053/api/Message/getMessages/1/5 - null null
2025-04-30 07:40:59.269 +07:00 [INF] CORS policy execution successful.
2025-04-30 07:40:59.269 +07:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5053/api/Message/getMessages/1/5 - 204 null null 0.5712ms
2025-04-30 07:40:59.271 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/api/Message/getMessages/1/5 - null null
2025-04-30 07:40:59.271 +07:00 [INF] CORS policy execution successful.
2025-04-30 07:40:59.271 +07:00 [INF] CORS policy execution successful.
2025-04-30 07:40:59.271 +07:00 [INF] Executing endpoint 'server.Controllers.MessageController.GetMessages (Message_app)'
2025-04-30 07:40:59.271 +07:00 [INF] Route matched with {action = "GetMessages", controller = "Message"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetMessages(Int32, Int32) on controller server.Controllers.MessageController (Message_app).
2025-04-30 07:40:59.279 +07:00 [WRN] Message 81 not found in Redis
2025-04-30 07:40:59.280 +07:00 [WRN] Message 80 not found in Redis
2025-04-30 07:40:59.281 +07:00 [WRN] Message 79 not found in Redis
2025-04-30 07:40:59.282 +07:00 [WRN] Message 78 not found in Redis
2025-04-30 07:40:59.283 +07:00 [WRN] Message 77 not found in Redis
2025-04-30 07:40:59.285 +07:00 [WRN] Message 76 not found in Redis
2025-04-30 07:40:59.287 +07:00 [WRN] Message 75 not found in Redis
2025-04-30 07:40:59.288 +07:00 [WRN] Message 74 not found in Redis
2025-04-30 07:40:59.288 +07:00 [WRN] Message 73 not found in Redis
2025-04-30 07:40:59.288 +07:00 [WRN] Message 72 not found in Redis
2025-04-30 07:40:59.289 +07:00 [WRN] Message 71 not found in Redis
2025-04-30 07:40:59.289 +07:00 [WRN] Message 68 not found in Redis
2025-04-30 07:40:59.290 +07:00 [WRN] Message 64 not found in Redis
2025-04-30 07:40:59.290 +07:00 [WRN] Message 62 not found in Redis
2025-04-30 07:40:59.290 +07:00 [WRN] Message 61 not found in Redis
2025-04-30 07:40:59.290 +07:00 [WRN] Message 60 not found in Redis
2025-04-30 07:40:59.291 +07:00 [WRN] Message 59 not found in Redis
2025-04-30 07:40:59.291 +07:00 [WRN] Message 57 not found in Redis
2025-04-30 07:40:59.292 +07:00 [WRN] Message 55 not found in Redis
2025-04-30 07:40:59.292 +07:00 [WRN] Message 54 not found in Redis
2025-04-30 07:40:59.293 +07:00 [WRN] Message 51 not found in Redis
2025-04-30 07:40:59.293 +07:00 [WRN] Message 49 not found in Redis
2025-04-30 07:40:59.294 +07:00 [WRN] Message 11 not found in Redis
2025-04-30 07:40:59.294 +07:00 [WRN] Message 8 not found in Redis
2025-04-30 07:40:59.295 +07:00 [WRN] Message 3 not found in Redis
2025-04-30 07:40:59.295 +07:00 [WRN] Message 2 not found in Redis
2025-04-30 07:40:59.295 +07:00 [WRN] Message 1 not found in Redis
2025-04-30 07:40:59.295 +07:00 [INF] Retrieved 9 messages from Redis for conversation 1
2025-04-30 07:40:59.295 +07:00 [INF] Retrieved 9 messages from Redis for conversation 1 and user 5
2025-04-30 07:40:59.296 +07:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[server.DTO.MessageWithAttachment, Message_app, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-04-30 07:40:59.297 +07:00 [INF] Executed action server.Controllers.MessageController.GetMessages (Message_app) in 24.7621ms
2025-04-30 07:40:59.297 +07:00 [INF] Executed endpoint 'server.Controllers.MessageController.GetMessages (Message_app)'
2025-04-30 07:40:59.297 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5053/api/Message/getMessages/1/5 - 200 null application/json; charset=utf-8 26.6613ms
2025-04-30 07:40:59.317 +07:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5053/api/Conversation/get_first_conversation/1 - null null
2025-04-30 07:40:59.317 +07:00 [INF] CORS policy execution successful.
2025-04-30 07:40:59.317 +07:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5053/api/Conversation/get_first_conversation/1 - 204 null null 0.2317ms
2025-04-30 07:40:59.319 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/api/Conversation/get_first_conversation/1 - null null
2025-04-30 07:40:59.319 +07:00 [INF] CORS policy execution successful.
2025-04-30 07:40:59.320 +07:00 [INF] CORS policy execution successful.
2025-04-30 07:40:59.320 +07:00 [INF] Executing endpoint 'server.Controllers.ConversationController.GetFirstConversation (Message_app)'
2025-04-30 07:40:59.320 +07:00 [INF] Route matched with {action = "GetFirstConversation", controller = "Conversation"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetFirstConversation(Int32) on controller server.Controllers.ConversationController (Message_app).
2025-04-30 07:40:59.325 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[id], [c].[created_at], [c].[is_group], [c].[lastMessage], [c].[lastMessageSender], [c].[lastMessageTime], [c].[name]
FROM [Conversations] AS [c]
WHERE [c].[id] = @__p_0
2025-04-30 07:40:59.325 +07:00 [INF] Executing OkObjectResult, writing value of type 'server.Models.Conversation'.
2025-04-30 07:40:59.326 +07:00 [INF] Executed action server.Controllers.ConversationController.GetFirstConversation (Message_app) in 5.8413ms
2025-04-30 07:40:59.326 +07:00 [INF] Executed endpoint 'server.Controllers.ConversationController.GetFirstConversation (Message_app)'
2025-04-30 07:40:59.326 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5053/api/Conversation/get_first_conversation/1 - 200 null application/json; charset=utf-8 6.8721ms
2025-04-30 07:40:59.342 +07:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5053/api/Participant/get_participants/1 - null null
2025-04-30 07:40:59.342 +07:00 [INF] CORS policy execution successful.
2025-04-30 07:40:59.343 +07:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5053/api/Participant/get_participants/1 - 204 null null 0.4399ms
2025-04-30 07:40:59.344 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/api/Participant/get_participants/1 - null null
2025-04-30 07:40:59.344 +07:00 [INF] CORS policy execution successful.
2025-04-30 07:40:59.345 +07:00 [INF] CORS policy execution successful.
2025-04-30 07:40:59.345 +07:00 [INF] Executing endpoint 'server.Controllers.ParticipantController.GetParticipants (Message_app)'
2025-04-30 07:40:59.345 +07:00 [INF] Route matched with {action = "GetParticipants", controller = "Participant"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetParticipants(Int32) on controller server.Controllers.ParticipantController (Message_app).
2025-04-30 07:40:59.348 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__conversation_id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[id], [p].[adder], [p].[conversation_id], [p].[is_deleted], [p].[joined_at], [p].[name], [p].[role], [p].[user_id]
FROM [Participants] AS [p]
WHERE [p].[conversation_id] = @__conversation_id_0
2025-04-30 07:40:59.348 +07:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType17`1[[System.Collections.Generic.List`1[[server.Models.Participants, Message_app, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-04-30 07:40:59.348 +07:00 [INF] Executed action server.Controllers.ParticipantController.GetParticipants (Message_app) in 3.2812ms
2025-04-30 07:40:59.348 +07:00 [INF] Executed endpoint 'server.Controllers.ParticipantController.GetParticipants (Message_app)'
2025-04-30 07:40:59.349 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5053/api/Participant/get_participants/1 - 200 null application/json; charset=utf-8 4.3877ms
2025-04-30 07:42:00.826 +07:00 [INF] Executed endpoint '/ws/chat'
2025-04-30 07:42:00.826 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5053/ws/chat?userId=5 - 101 null null 297388.57ms
2025-04-30 07:42:17.088 +07:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5053/api/Auth/login - null null
2025-04-30 07:42:17.089 +07:00 [INF] CORS policy execution successful.
2025-04-30 07:42:17.089 +07:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5053/api/Auth/login - 204 null null 0.3859ms
2025-04-30 07:42:17.090 +07:00 [INF] Request starting HTTP/1.1 POST http://localhost:5053/api/Auth/login - application/json 53
2025-04-30 07:42:17.090 +07:00 [INF] CORS policy execution successful.
2025-04-30 07:42:17.091 +07:00 [INF] CORS policy execution successful.
2025-04-30 07:42:17.091 +07:00 [INF] Executing endpoint 'Message_app.Controllers.AuthController.Login (Message_app)'
2025-04-30 07:42:17.091 +07:00 [INF] Route matched with {action = "Login", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Login(server.DTO.AuthDTO.LoginDTO) on controller Message_app.Controllers.AuthController (Message_app).
2025-04-30 07:42:17.109 +07:00 [INF] Executed DbCommand (15ms) [Parameters=[@__email_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[id], [u].[avatar_url], [u].[bio], [u].[birthday], [u].[created_at], [u].[email], [u].[gender], [u].[interests], [u].[location], [u].[password], [u].[passwordSalt], [u].[username]
FROM [Users] AS [u]
WHERE [u].[email] = @__email_0
2025-04-30 07:42:17.112 +07:00 [INF] Executing OkObjectResult, writing value of type 'server.DTO.AuthDTO.LoginRespose'.
2025-04-30 07:42:17.112 +07:00 [INF] Executed action Message_app.Controllers.AuthController.Login (Message_app) in 21.1888ms
2025-04-30 07:42:17.112 +07:00 [INF] Executed endpoint 'Message_app.Controllers.AuthController.Login (Message_app)'
2025-04-30 07:42:17.112 +07:00 [INF] Request finished HTTP/1.1 POST http://localhost:5053/api/Auth/login - 200 null application/json; charset=utf-8 22.133ms
2025-04-30 07:42:17.168 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/ws/chat?userId=5 - null null
2025-04-30 07:42:17.169 +07:00 [INF] CORS policy execution successful.
2025-04-30 07:42:17.169 +07:00 [INF] CORS policy execution successful.
2025-04-30 07:42:17.169 +07:00 [INF] Executing endpoint '/ws/chat'
2025-04-30 07:42:17.313 +07:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5053/api/Conversation/get_conversations/5 - null null
2025-04-30 07:42:17.314 +07:00 [INF] CORS policy execution successful.
2025-04-30 07:42:17.314 +07:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5053/api/Conversation/get_conversations/5 - 204 null null 0.9887ms
2025-04-30 07:42:17.315 +07:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5053/api/Conversation/get_conversations/5 - null null
2025-04-30 07:42:17.315 +07:00 [INF] CORS policy execution successful.
2025-04-30 07:42:17.316 +07:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5053/api/Conversation/get_conversations/5 - 204 null null 0.283ms
2025-04-30 07:42:17.318 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/api/Conversation/get_conversations/5 - null null
2025-04-30 07:42:17.319 +07:00 [INF] CORS policy execution successful.
2025-04-30 07:42:17.321 +07:00 [INF] CORS policy execution successful.
2025-04-30 07:42:17.324 +07:00 [INF] Executing endpoint 'server.Controllers.ConversationController.GetConversations (Message_app)'
2025-04-30 07:42:17.324 +07:00 [INF] Route matched with {action = "GetConversations", controller = "Conversation"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetConversations(Int32) on controller server.Controllers.ConversationController (Message_app).
2025-04-30 07:42:17.329 +07:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[server.DTO.ConversationDto, Message_app, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-04-30 07:42:17.329 +07:00 [INF] Executed action server.Controllers.ConversationController.GetConversations (Message_app) in 4.9362ms
2025-04-30 07:42:17.329 +07:00 [INF] Executed endpoint 'server.Controllers.ConversationController.GetConversations (Message_app)'
2025-04-30 07:42:17.329 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5053/api/Conversation/get_conversations/5 - 200 null application/json; charset=utf-8 10.9438ms
2025-04-30 07:42:17.331 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/api/Conversation/get_conversations/5 - null null
2025-04-30 07:42:17.332 +07:00 [INF] CORS policy execution successful.
2025-04-30 07:42:17.332 +07:00 [INF] CORS policy execution successful.
2025-04-30 07:42:17.334 +07:00 [INF] Executing endpoint 'server.Controllers.ConversationController.GetConversations (Message_app)'
2025-04-30 07:42:17.334 +07:00 [INF] Route matched with {action = "GetConversations", controller = "Conversation"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetConversations(Int32) on controller server.Controllers.ConversationController (Message_app).
2025-04-30 07:42:17.335 +07:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[server.DTO.ConversationDto, Message_app, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-04-30 07:42:17.336 +07:00 [INF] Executed action server.Controllers.ConversationController.GetConversations (Message_app) in 1.6594ms
2025-04-30 07:42:17.336 +07:00 [INF] Executed endpoint 'server.Controllers.ConversationController.GetConversations (Message_app)'
2025-04-30 07:42:17.336 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5053/api/Conversation/get_conversations/5 - 200 null application/json; charset=utf-8 4.4992ms
2025-04-30 07:42:18.755 +07:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5053/api/Message/getMessages/1/5 - null null
2025-04-30 07:42:18.755 +07:00 [INF] CORS policy execution successful.
2025-04-30 07:42:18.755 +07:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5053/api/Message/getMessages/1/5 - 204 null null 0.324ms
2025-04-30 07:42:18.757 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/api/Message/getMessages/1/5 - null null
2025-04-30 07:42:18.757 +07:00 [INF] CORS policy execution successful.
2025-04-30 07:42:18.757 +07:00 [INF] CORS policy execution successful.
2025-04-30 07:42:18.757 +07:00 [INF] Executing endpoint 'server.Controllers.MessageController.GetMessages (Message_app)'
2025-04-30 07:42:18.757 +07:00 [INF] Route matched with {action = "GetMessages", controller = "Message"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetMessages(Int32, Int32) on controller server.Controllers.MessageController (Message_app).
2025-04-30 07:42:18.762 +07:00 [WRN] Message 81 not found in Redis
2025-04-30 07:42:18.763 +07:00 [WRN] Message 80 not found in Redis
2025-04-30 07:42:18.764 +07:00 [WRN] Message 79 not found in Redis
2025-04-30 07:42:18.765 +07:00 [WRN] Message 78 not found in Redis
2025-04-30 07:42:18.767 +07:00 [WRN] Message 77 not found in Redis
2025-04-30 07:42:18.767 +07:00 [WRN] Message 76 not found in Redis
2025-04-30 07:42:18.769 +07:00 [WRN] Message 75 not found in Redis
2025-04-30 07:42:18.770 +07:00 [WRN] Message 74 not found in Redis
2025-04-30 07:42:18.776 +07:00 [WRN] Message 73 not found in Redis
2025-04-30 07:42:18.778 +07:00 [WRN] Message 72 not found in Redis
2025-04-30 07:42:18.779 +07:00 [WRN] Message 71 not found in Redis
2025-04-30 07:42:18.780 +07:00 [WRN] Message 68 not found in Redis
2025-04-30 07:42:18.780 +07:00 [WRN] Message 64 not found in Redis
2025-04-30 07:42:18.781 +07:00 [WRN] Message 62 not found in Redis
2025-04-30 07:42:18.783 +07:00 [WRN] Message 61 not found in Redis
2025-04-30 07:42:18.784 +07:00 [WRN] Message 60 not found in Redis
2025-04-30 07:42:18.785 +07:00 [WRN] Message 59 not found in Redis
2025-04-30 07:42:18.786 +07:00 [WRN] Message 57 not found in Redis
2025-04-30 07:42:18.787 +07:00 [WRN] Message 55 not found in Redis
2025-04-30 07:42:18.788 +07:00 [WRN] Message 54 not found in Redis
2025-04-30 07:42:18.789 +07:00 [WRN] Message 51 not found in Redis
2025-04-30 07:42:18.790 +07:00 [WRN] Message 49 not found in Redis
2025-04-30 07:42:18.792 +07:00 [WRN] Message 11 not found in Redis
2025-04-30 07:42:18.794 +07:00 [WRN] Message 8 not found in Redis
2025-04-30 07:42:18.795 +07:00 [WRN] Message 3 not found in Redis
2025-04-30 07:42:18.796 +07:00 [WRN] Message 2 not found in Redis
2025-04-30 07:42:18.796 +07:00 [WRN] Message 1 not found in Redis
2025-04-30 07:42:18.796 +07:00 [INF] Retrieved 9 messages from Redis for conversation 1
2025-04-30 07:42:18.796 +07:00 [INF] Retrieved 9 messages from Redis for conversation 1 and user 5
2025-04-30 07:42:18.796 +07:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[server.DTO.MessageWithAttachment, Message_app, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-04-30 07:42:18.797 +07:00 [INF] Executed action server.Controllers.MessageController.GetMessages (Message_app) in 39.3031ms
2025-04-30 07:42:18.797 +07:00 [INF] Executed endpoint 'server.Controllers.MessageController.GetMessages (Message_app)'
2025-04-30 07:42:18.797 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5053/api/Message/getMessages/1/5 - 200 null application/json; charset=utf-8 40.209ms
2025-04-30 07:42:18.816 +07:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5053/api/Conversation/get_first_conversation/1 - null null
2025-04-30 07:42:18.816 +07:00 [INF] CORS policy execution successful.
2025-04-30 07:42:18.816 +07:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5053/api/Conversation/get_first_conversation/1 - 204 null null 0.4832ms
2025-04-30 07:42:18.817 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/api/Conversation/get_first_conversation/1 - null null
2025-04-30 07:42:18.817 +07:00 [INF] CORS policy execution successful.
2025-04-30 07:42:18.818 +07:00 [INF] CORS policy execution successful.
2025-04-30 07:42:18.818 +07:00 [INF] Executing endpoint 'server.Controllers.ConversationController.GetFirstConversation (Message_app)'
2025-04-30 07:42:18.818 +07:00 [INF] Route matched with {action = "GetFirstConversation", controller = "Conversation"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetFirstConversation(Int32) on controller server.Controllers.ConversationController (Message_app).
2025-04-30 07:42:18.824 +07:00 [INF] Executed DbCommand (4ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[id], [c].[created_at], [c].[is_group], [c].[lastMessage], [c].[lastMessageSender], [c].[lastMessageTime], [c].[name]
FROM [Conversations] AS [c]
WHERE [c].[id] = @__p_0
2025-04-30 07:42:18.826 +07:00 [INF] Executing OkObjectResult, writing value of type 'server.Models.Conversation'.
2025-04-30 07:42:18.826 +07:00 [INF] Executed action server.Controllers.ConversationController.GetFirstConversation (Message_app) in 8.1144ms
2025-04-30 07:42:18.826 +07:00 [INF] Executed endpoint 'server.Controllers.ConversationController.GetFirstConversation (Message_app)'
2025-04-30 07:42:18.826 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5053/api/Conversation/get_first_conversation/1 - 200 null application/json; charset=utf-8 9.1907ms
2025-04-30 07:42:18.842 +07:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5053/api/Participant/get_participants/1 - null null
2025-04-30 07:42:18.843 +07:00 [INF] CORS policy execution successful.
2025-04-30 07:42:18.843 +07:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5053/api/Participant/get_participants/1 - 204 null null 1.0308ms
2025-04-30 07:42:18.845 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/api/Participant/get_participants/1 - null null
2025-04-30 07:42:18.845 +07:00 [INF] CORS policy execution successful.
2025-04-30 07:42:18.845 +07:00 [INF] CORS policy execution successful.
2025-04-30 07:42:18.845 +07:00 [INF] Executing endpoint 'server.Controllers.ParticipantController.GetParticipants (Message_app)'
2025-04-30 07:42:18.846 +07:00 [INF] Route matched with {action = "GetParticipants", controller = "Participant"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetParticipants(Int32) on controller server.Controllers.ParticipantController (Message_app).
2025-04-30 07:42:18.853 +07:00 [INF] Executed DbCommand (5ms) [Parameters=[@__conversation_id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[id], [p].[adder], [p].[conversation_id], [p].[is_deleted], [p].[joined_at], [p].[name], [p].[role], [p].[user_id]
FROM [Participants] AS [p]
WHERE [p].[conversation_id] = @__conversation_id_0
2025-04-30 07:42:18.854 +07:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType17`1[[System.Collections.Generic.List`1[[server.Models.Participants, Message_app, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-04-30 07:42:18.856 +07:00 [INF] Executed action server.Controllers.ParticipantController.GetParticipants (Message_app) in 9.8931ms
2025-04-30 07:42:18.856 +07:00 [INF] Executed endpoint 'server.Controllers.ParticipantController.GetParticipants (Message_app)'
2025-04-30 07:42:18.856 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5053/api/Participant/get_participants/1 - 200 null application/json; charset=utf-8 11.3703ms
2025-04-30 07:42:34.142 +07:00 [INF] Request starting HTTP/1.1 GET http://192.168.1.9:5053/api/Message/getMessages/1/2 - null null
2025-04-30 07:42:34.143 +07:00 [INF] Executing endpoint 'server.Controllers.MessageController.GetMessages (Message_app)'
2025-04-30 07:42:34.144 +07:00 [INF] Route matched with {action = "GetMessages", controller = "Message"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetMessages(Int32, Int32) on controller server.Controllers.MessageController (Message_app).
2025-04-30 07:42:34.148 +07:00 [WRN] Message 81 not found in Redis
2025-04-30 07:42:34.148 +07:00 [WRN] Message 80 not found in Redis
2025-04-30 07:42:34.148 +07:00 [WRN] Message 79 not found in Redis
2025-04-30 07:42:34.149 +07:00 [WRN] Message 78 not found in Redis
2025-04-30 07:42:34.149 +07:00 [WRN] Message 77 not found in Redis
2025-04-30 07:42:34.149 +07:00 [WRN] Message 76 not found in Redis
2025-04-30 07:42:34.150 +07:00 [WRN] Message 75 not found in Redis
2025-04-30 07:42:34.150 +07:00 [WRN] Message 74 not found in Redis
2025-04-30 07:42:34.150 +07:00 [WRN] Message 73 not found in Redis
2025-04-30 07:42:34.151 +07:00 [WRN] Message 72 not found in Redis
2025-04-30 07:42:34.151 +07:00 [WRN] Message 71 not found in Redis
2025-04-30 07:42:34.152 +07:00 [WRN] Message 68 not found in Redis
2025-04-30 07:42:34.153 +07:00 [WRN] Message 64 not found in Redis
2025-04-30 07:42:34.153 +07:00 [WRN] Message 62 not found in Redis
2025-04-30 07:42:34.153 +07:00 [WRN] Message 61 not found in Redis
2025-04-30 07:42:34.155 +07:00 [WRN] Message 60 not found in Redis
2025-04-30 07:42:34.156 +07:00 [WRN] Message 59 not found in Redis
2025-04-30 07:42:34.156 +07:00 [WRN] Message 57 not found in Redis
2025-04-30 07:42:34.157 +07:00 [WRN] Message 55 not found in Redis
2025-04-30 07:42:34.157 +07:00 [WRN] Message 54 not found in Redis
2025-04-30 07:42:34.157 +07:00 [WRN] Message 51 not found in Redis
2025-04-30 07:42:34.158 +07:00 [WRN] Message 49 not found in Redis
2025-04-30 07:42:34.158 +07:00 [WRN] Message 11 not found in Redis
2025-04-30 07:42:34.158 +07:00 [WRN] Message 8 not found in Redis
2025-04-30 07:42:34.159 +07:00 [WRN] Message 3 not found in Redis
2025-04-30 07:42:34.159 +07:00 [WRN] Message 2 not found in Redis
2025-04-30 07:42:34.159 +07:00 [WRN] Message 1 not found in Redis
2025-04-30 07:42:34.159 +07:00 [INF] Retrieved 9 messages from Redis for conversation 1
2025-04-30 07:42:34.159 +07:00 [INF] Retrieved 9 messages from Redis for conversation 1 and user 2
2025-04-30 07:42:34.160 +07:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[server.DTO.MessageWithAttachment, Message_app, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-04-30 07:42:34.160 +07:00 [INF] Executed action server.Controllers.MessageController.GetMessages (Message_app) in 16.1895ms
2025-04-30 07:42:34.160 +07:00 [INF] Executed endpoint 'server.Controllers.MessageController.GetMessages (Message_app)'
2025-04-30 07:42:34.160 +07:00 [INF] Request finished HTTP/1.1 GET http://192.168.1.9:5053/api/Message/getMessages/1/2 - 200 null application/json; charset=utf-8 18.3256ms
2025-04-30 07:42:34.335 +07:00 [INF] Request starting HTTP/1.1 GET http://192.168.1.9:5053/api/Conversation/get_first_conversation/1 - null null
2025-04-30 07:42:34.336 +07:00 [INF] Executing endpoint 'server.Controllers.ConversationController.GetFirstConversation (Message_app)'
2025-04-30 07:42:34.336 +07:00 [INF] Route matched with {action = "GetFirstConversation", controller = "Conversation"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetFirstConversation(Int32) on controller server.Controllers.ConversationController (Message_app).
2025-04-30 07:42:34.359 +07:00 [INF] Executed DbCommand (21ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[id], [c].[created_at], [c].[is_group], [c].[lastMessage], [c].[lastMessageSender], [c].[lastMessageTime], [c].[name]
FROM [Conversations] AS [c]
WHERE [c].[id] = @__p_0
2025-04-30 07:42:34.360 +07:00 [INF] Executing OkObjectResult, writing value of type 'server.Models.Conversation'.
2025-04-30 07:42:34.361 +07:00 [INF] Executed action server.Controllers.ConversationController.GetFirstConversation (Message_app) in 24.7614ms
2025-04-30 07:42:34.361 +07:00 [INF] Executed endpoint 'server.Controllers.ConversationController.GetFirstConversation (Message_app)'
2025-04-30 07:42:34.361 +07:00 [INF] Request finished HTTP/1.1 GET http://192.168.1.9:5053/api/Conversation/get_first_conversation/1 - 200 null application/json; charset=utf-8 25.4885ms
2025-04-30 07:42:34.462 +07:00 [INF] Request starting HTTP/1.1 GET http://192.168.1.9:5053/api/Participant/get_participants/1 - null null
2025-04-30 07:42:34.462 +07:00 [INF] Executing endpoint 'server.Controllers.ParticipantController.GetParticipants (Message_app)'
2025-04-30 07:42:34.462 +07:00 [INF] Route matched with {action = "GetParticipants", controller = "Participant"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetParticipants(Int32) on controller server.Controllers.ParticipantController (Message_app).
2025-04-30 07:42:34.470 +07:00 [INF] Executed DbCommand (5ms) [Parameters=[@__conversation_id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[id], [p].[adder], [p].[conversation_id], [p].[is_deleted], [p].[joined_at], [p].[name], [p].[role], [p].[user_id]
FROM [Participants] AS [p]
WHERE [p].[conversation_id] = @__conversation_id_0
2025-04-30 07:42:34.471 +07:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType17`1[[System.Collections.Generic.List`1[[server.Models.Participants, Message_app, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-04-30 07:42:34.472 +07:00 [INF] Executed action server.Controllers.ParticipantController.GetParticipants (Message_app) in 9.5661ms
2025-04-30 07:42:34.472 +07:00 [INF] Executed endpoint 'server.Controllers.ParticipantController.GetParticipants (Message_app)'
2025-04-30 07:42:34.472 +07:00 [INF] Request finished HTTP/1.1 GET http://192.168.1.9:5053/api/Participant/get_participants/1 - 200 null application/json; charset=utf-8 10.7626ms
2025-04-30 07:44:41.062 +07:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5053/api/Auth/login - null null
2025-04-30 07:44:41.062 +07:00 [INF] CORS policy execution successful.
2025-04-30 07:44:41.062 +07:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5053/api/Auth/login - 204 null null 0.433ms
2025-04-30 07:44:41.063 +07:00 [INF] Request starting HTTP/1.1 POST http://localhost:5053/api/Auth/login - application/json 53
2025-04-30 07:44:41.063 +07:00 [INF] CORS policy execution successful.
2025-04-30 07:44:41.063 +07:00 [INF] CORS policy execution successful.
2025-04-30 07:44:41.063 +07:00 [INF] Executing endpoint 'Message_app.Controllers.AuthController.Login (Message_app)'
2025-04-30 07:44:41.064 +07:00 [INF] Route matched with {action = "Login", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Login(server.DTO.AuthDTO.LoginDTO) on controller Message_app.Controllers.AuthController (Message_app).
2025-04-30 07:44:41.081 +07:00 [INF] Executed DbCommand (15ms) [Parameters=[@__email_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[id], [u].[avatar_url], [u].[bio], [u].[birthday], [u].[created_at], [u].[email], [u].[gender], [u].[interests], [u].[location], [u].[password], [u].[passwordSalt], [u].[username]
FROM [Users] AS [u]
WHERE [u].[email] = @__email_0
2025-04-30 07:44:41.082 +07:00 [INF] Executing OkObjectResult, writing value of type 'server.DTO.AuthDTO.LoginRespose'.
2025-04-30 07:44:41.083 +07:00 [INF] Executed action Message_app.Controllers.AuthController.Login (Message_app) in 18.9233ms
2025-04-30 07:44:41.083 +07:00 [INF] Executed endpoint 'Message_app.Controllers.AuthController.Login (Message_app)'
2025-04-30 07:44:41.083 +07:00 [INF] Request finished HTTP/1.1 POST http://localhost:5053/api/Auth/login - 200 null application/json; charset=utf-8 19.7181ms
2025-04-30 07:44:41.165 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/ws/chat?userId=5 - null null
2025-04-30 07:44:41.166 +07:00 [INF] CORS policy execution successful.
2025-04-30 07:44:41.166 +07:00 [INF] CORS policy execution successful.
2025-04-30 07:44:41.166 +07:00 [INF] Executing endpoint '/ws/chat'
2025-04-30 07:44:41.312 +07:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5053/api/Conversation/get_conversations/5 - null null
2025-04-30 07:44:41.312 +07:00 [INF] CORS policy execution successful.
2025-04-30 07:44:41.312 +07:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5053/api/Conversation/get_conversations/5 - 204 null null 0.2525ms
2025-04-30 07:44:41.313 +07:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5053/api/Conversation/get_conversations/5 - null null
2025-04-30 07:44:41.313 +07:00 [INF] CORS policy execution successful.
2025-04-30 07:44:41.313 +07:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5053/api/Conversation/get_conversations/5 - 204 null null 0.1832ms
2025-04-30 07:44:41.313 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/api/Conversation/get_conversations/5 - null null
2025-04-30 07:44:41.313 +07:00 [INF] CORS policy execution successful.
2025-04-30 07:44:41.314 +07:00 [INF] CORS policy execution successful.
2025-04-30 07:44:41.314 +07:00 [INF] Executing endpoint 'server.Controllers.ConversationController.GetConversations (Message_app)'
2025-04-30 07:44:41.315 +07:00 [INF] Route matched with {action = "GetConversations", controller = "Conversation"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetConversations(Int32) on controller server.Controllers.ConversationController (Message_app).
2025-04-30 07:44:41.316 +07:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[server.DTO.ConversationDto, Message_app, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-04-30 07:44:41.317 +07:00 [INF] Executed action server.Controllers.ConversationController.GetConversations (Message_app) in 1.6354ms
2025-04-30 07:44:41.317 +07:00 [INF] Executed endpoint 'server.Controllers.ConversationController.GetConversations (Message_app)'
2025-04-30 07:44:41.317 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5053/api/Conversation/get_conversations/5 - 200 null application/json; charset=utf-8 3.6098ms
2025-04-30 07:44:41.318 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/api/Conversation/get_conversations/5 - null null
2025-04-30 07:44:41.319 +07:00 [INF] CORS policy execution successful.
2025-04-30 07:44:41.319 +07:00 [INF] CORS policy execution successful.
2025-04-30 07:44:41.319 +07:00 [INF] Executing endpoint 'server.Controllers.ConversationController.GetConversations (Message_app)'
2025-04-30 07:44:41.319 +07:00 [INF] Route matched with {action = "GetConversations", controller = "Conversation"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetConversations(Int32) on controller server.Controllers.ConversationController (Message_app).
2025-04-30 07:44:41.320 +07:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[server.DTO.ConversationDto, Message_app, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-04-30 07:44:41.320 +07:00 [INF] Executed action server.Controllers.ConversationController.GetConversations (Message_app) in 1.098ms
2025-04-30 07:44:41.320 +07:00 [INF] Executed endpoint 'server.Controllers.ConversationController.GetConversations (Message_app)'
2025-04-30 07:44:41.320 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5053/api/Conversation/get_conversations/5 - 200 null application/json; charset=utf-8 1.6782ms
2025-04-30 07:44:42.602 +07:00 [INF] Request starting HTTP/1.1 GET http://192.168.1.9:5053/api/Message/getMessages/1/2 - null null
2025-04-30 07:44:42.603 +07:00 [INF] Executing endpoint 'server.Controllers.MessageController.GetMessages (Message_app)'
2025-04-30 07:44:42.603 +07:00 [INF] Route matched with {action = "GetMessages", controller = "Message"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetMessages(Int32, Int32) on controller server.Controllers.MessageController (Message_app).
2025-04-30 07:44:42.611 +07:00 [WRN] Message 81 not found in Redis
2025-04-30 07:44:42.612 +07:00 [WRN] Message 80 not found in Redis
2025-04-30 07:44:42.613 +07:00 [WRN] Message 79 not found in Redis
2025-04-30 07:44:42.614 +07:00 [WRN] Message 78 not found in Redis
2025-04-30 07:44:42.616 +07:00 [WRN] Message 77 not found in Redis
2025-04-30 07:44:42.618 +07:00 [WRN] Message 76 not found in Redis
2025-04-30 07:44:42.619 +07:00 [WRN] Message 75 not found in Redis
2025-04-30 07:44:42.619 +07:00 [WRN] Message 74 not found in Redis
2025-04-30 07:44:42.619 +07:00 [WRN] Message 73 not found in Redis
2025-04-30 07:44:42.620 +07:00 [WRN] Message 72 not found in Redis
2025-04-30 07:44:42.621 +07:00 [WRN] Message 71 not found in Redis
2025-04-30 07:44:42.621 +07:00 [WRN] Message 68 not found in Redis
2025-04-30 07:44:42.622 +07:00 [WRN] Message 64 not found in Redis
2025-04-30 07:44:42.624 +07:00 [WRN] Message 62 not found in Redis
2025-04-30 07:44:42.626 +07:00 [WRN] Message 61 not found in Redis
2025-04-30 07:44:42.627 +07:00 [WRN] Message 60 not found in Redis
2025-04-30 07:44:42.629 +07:00 [WRN] Message 59 not found in Redis
2025-04-30 07:44:42.630 +07:00 [WRN] Message 57 not found in Redis
2025-04-30 07:44:42.631 +07:00 [WRN] Message 55 not found in Redis
2025-04-30 07:44:42.631 +07:00 [WRN] Message 54 not found in Redis
2025-04-30 07:44:42.632 +07:00 [WRN] Message 51 not found in Redis
2025-04-30 07:44:42.633 +07:00 [WRN] Message 49 not found in Redis
2025-04-30 07:44:42.633 +07:00 [WRN] Message 11 not found in Redis
2025-04-30 07:44:42.633 +07:00 [WRN] Message 8 not found in Redis
2025-04-30 07:44:42.634 +07:00 [WRN] Message 3 not found in Redis
2025-04-30 07:44:42.635 +07:00 [WRN] Message 2 not found in Redis
2025-04-30 07:44:42.635 +07:00 [WRN] Message 1 not found in Redis
2025-04-30 07:44:42.635 +07:00 [INF] Retrieved 9 messages from Redis for conversation 1
2025-04-30 07:44:42.635 +07:00 [INF] Retrieved 9 messages from Redis for conversation 1 and user 2
2025-04-30 07:44:42.635 +07:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[server.DTO.MessageWithAttachment, Message_app, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-04-30 07:44:42.636 +07:00 [INF] Executed action server.Controllers.MessageController.GetMessages (Message_app) in 32.1886ms
2025-04-30 07:44:42.636 +07:00 [INF] Executed endpoint 'server.Controllers.MessageController.GetMessages (Message_app)'
2025-04-30 07:44:42.636 +07:00 [INF] Request finished HTTP/1.1 GET http://192.168.1.9:5053/api/Message/getMessages/1/2 - 200 null application/json; charset=utf-8 33.757ms
2025-04-30 07:44:42.746 +07:00 [INF] Request starting HTTP/1.1 GET http://192.168.1.9:5053/api/Conversation/get_first_conversation/1 - null null
2025-04-30 07:44:42.746 +07:00 [INF] Executing endpoint 'server.Controllers.ConversationController.GetFirstConversation (Message_app)'
2025-04-30 07:44:42.746 +07:00 [INF] Route matched with {action = "GetFirstConversation", controller = "Conversation"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetFirstConversation(Int32) on controller server.Controllers.ConversationController (Message_app).
2025-04-30 07:44:42.754 +07:00 [INF] Executed DbCommand (4ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[id], [c].[created_at], [c].[is_group], [c].[lastMessage], [c].[lastMessageSender], [c].[lastMessageTime], [c].[name]
FROM [Conversations] AS [c]
WHERE [c].[id] = @__p_0
2025-04-30 07:44:42.754 +07:00 [INF] Executing OkObjectResult, writing value of type 'server.Models.Conversation'.
2025-04-30 07:44:42.755 +07:00 [INF] Executed action server.Controllers.ConversationController.GetFirstConversation (Message_app) in 8.2455ms
2025-04-30 07:44:42.755 +07:00 [INF] Executed endpoint 'server.Controllers.ConversationController.GetFirstConversation (Message_app)'
2025-04-30 07:44:42.755 +07:00 [INF] Request finished HTTP/1.1 GET http://192.168.1.9:5053/api/Conversation/get_first_conversation/1 - 200 null application/json; charset=utf-8 8.9016ms
2025-04-30 07:44:42.833 +07:00 [INF] Request starting HTTP/1.1 GET http://192.168.1.9:5053/api/Participant/get_participants/1 - null null
2025-04-30 07:44:42.833 +07:00 [INF] Executing endpoint 'server.Controllers.ParticipantController.GetParticipants (Message_app)'
2025-04-30 07:44:42.834 +07:00 [INF] Route matched with {action = "GetParticipants", controller = "Participant"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetParticipants(Int32) on controller server.Controllers.ParticipantController (Message_app).
2025-04-30 07:44:42.844 +07:00 [INF] Executed DbCommand (6ms) [Parameters=[@__conversation_id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[id], [p].[adder], [p].[conversation_id], [p].[is_deleted], [p].[joined_at], [p].[name], [p].[role], [p].[user_id]
FROM [Participants] AS [p]
WHERE [p].[conversation_id] = @__conversation_id_0
2025-04-30 07:44:42.844 +07:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType17`1[[System.Collections.Generic.List`1[[server.Models.Participants, Message_app, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-04-30 07:44:42.845 +07:00 [INF] Executed action server.Controllers.ParticipantController.GetParticipants (Message_app) in 10.8532ms
2025-04-30 07:44:42.845 +07:00 [INF] Executed endpoint 'server.Controllers.ParticipantController.GetParticipants (Message_app)'
2025-04-30 07:44:42.845 +07:00 [INF] Request finished HTTP/1.1 GET http://192.168.1.9:5053/api/Participant/get_participants/1 - 200 null application/json; charset=utf-8 11.6691ms
2025-04-30 07:44:43.247 +07:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5053/api/Message/getMessages/1/5 - null null
2025-04-30 07:44:43.248 +07:00 [INF] CORS policy execution successful.
2025-04-30 07:44:43.248 +07:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5053/api/Message/getMessages/1/5 - 204 null null 2.6874ms
2025-04-30 07:44:43.251 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/api/Message/getMessages/1/5 - null null
2025-04-30 07:44:43.251 +07:00 [INF] CORS policy execution successful.
2025-04-30 07:44:43.251 +07:00 [INF] CORS policy execution successful.
2025-04-30 07:44:43.251 +07:00 [INF] Executing endpoint 'server.Controllers.MessageController.GetMessages (Message_app)'
2025-04-30 07:44:43.252 +07:00 [INF] Route matched with {action = "GetMessages", controller = "Message"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetMessages(Int32, Int32) on controller server.Controllers.MessageController (Message_app).
2025-04-30 07:44:43.259 +07:00 [WRN] Message 81 not found in Redis
2025-04-30 07:44:43.260 +07:00 [WRN] Message 80 not found in Redis
2025-04-30 07:44:43.261 +07:00 [WRN] Message 79 not found in Redis
2025-04-30 07:44:43.261 +07:00 [WRN] Message 78 not found in Redis
2025-04-30 07:44:43.262 +07:00 [WRN] Message 77 not found in Redis
2025-04-30 07:44:43.262 +07:00 [WRN] Message 76 not found in Redis
2025-04-30 07:44:43.262 +07:00 [WRN] Message 75 not found in Redis
2025-04-30 07:44:43.266 +07:00 [WRN] Message 74 not found in Redis
2025-04-30 07:44:43.266 +07:00 [WRN] Message 73 not found in Redis
2025-04-30 07:44:43.267 +07:00 [WRN] Message 72 not found in Redis
2025-04-30 07:44:43.267 +07:00 [WRN] Message 71 not found in Redis
2025-04-30 07:44:43.268 +07:00 [WRN] Message 68 not found in Redis
2025-04-30 07:44:43.268 +07:00 [WRN] Message 64 not found in Redis
2025-04-30 07:44:43.268 +07:00 [WRN] Message 62 not found in Redis
2025-04-30 07:44:43.269 +07:00 [WRN] Message 61 not found in Redis
2025-04-30 07:44:43.270 +07:00 [WRN] Message 60 not found in Redis
2025-04-30 07:44:43.270 +07:00 [WRN] Message 59 not found in Redis
2025-04-30 07:44:43.270 +07:00 [WRN] Message 57 not found in Redis
2025-04-30 07:44:43.271 +07:00 [WRN] Message 55 not found in Redis
2025-04-30 07:44:43.271 +07:00 [WRN] Message 54 not found in Redis
2025-04-30 07:44:43.271 +07:00 [WRN] Message 51 not found in Redis
2025-04-30 07:44:43.272 +07:00 [WRN] Message 49 not found in Redis
2025-04-30 07:44:43.272 +07:00 [WRN] Message 11 not found in Redis
2025-04-30 07:44:43.272 +07:00 [WRN] Message 8 not found in Redis
2025-04-30 07:44:43.273 +07:00 [WRN] Message 3 not found in Redis
2025-04-30 07:44:43.273 +07:00 [WRN] Message 2 not found in Redis
2025-04-30 07:44:43.273 +07:00 [WRN] Message 1 not found in Redis
2025-04-30 07:44:43.273 +07:00 [INF] Retrieved 9 messages from Redis for conversation 1
2025-04-30 07:44:43.274 +07:00 [INF] Retrieved 9 messages from Redis for conversation 1 and user 5
2025-04-30 07:44:43.274 +07:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[server.DTO.MessageWithAttachment, Message_app, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-04-30 07:44:43.274 +07:00 [INF] Executed action server.Controllers.MessageController.GetMessages (Message_app) in 22.1745ms
2025-04-30 07:44:43.274 +07:00 [INF] Executed endpoint 'server.Controllers.MessageController.GetMessages (Message_app)'
2025-04-30 07:44:43.274 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5053/api/Message/getMessages/1/5 - 200 null application/json; charset=utf-8 23.6963ms
2025-04-30 07:44:43.314 +07:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5053/api/Conversation/get_first_conversation/1 - null null
2025-04-30 07:44:43.314 +07:00 [INF] CORS policy execution successful.
2025-04-30 07:44:43.315 +07:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5053/api/Conversation/get_first_conversation/1 - 204 null null 0.3002ms
2025-04-30 07:44:43.316 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/api/Conversation/get_first_conversation/1 - null null
2025-04-30 07:44:43.316 +07:00 [INF] CORS policy execution successful.
2025-04-30 07:44:43.316 +07:00 [INF] CORS policy execution successful.
2025-04-30 07:44:43.316 +07:00 [INF] Executing endpoint 'server.Controllers.ConversationController.GetFirstConversation (Message_app)'
2025-04-30 07:44:43.316 +07:00 [INF] Route matched with {action = "GetFirstConversation", controller = "Conversation"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetFirstConversation(Int32) on controller server.Controllers.ConversationController (Message_app).
2025-04-30 07:44:43.319 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[id], [c].[created_at], [c].[is_group], [c].[lastMessage], [c].[lastMessageSender], [c].[lastMessageTime], [c].[name]
FROM [Conversations] AS [c]
WHERE [c].[id] = @__p_0
2025-04-30 07:44:43.320 +07:00 [INF] Executing OkObjectResult, writing value of type 'server.Models.Conversation'.
2025-04-30 07:44:43.320 +07:00 [INF] Executed action server.Controllers.ConversationController.GetFirstConversation (Message_app) in 3.0834ms
2025-04-30 07:44:43.320 +07:00 [INF] Executed endpoint 'server.Controllers.ConversationController.GetFirstConversation (Message_app)'
2025-04-30 07:44:43.320 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5053/api/Conversation/get_first_conversation/1 - 200 null application/json; charset=utf-8 3.9663ms
2025-04-30 07:44:43.336 +07:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5053/api/Participant/get_participants/1 - null null
2025-04-30 07:44:43.336 +07:00 [INF] CORS policy execution successful.
2025-04-30 07:44:43.336 +07:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5053/api/Participant/get_participants/1 - 204 null null 0.3021ms
2025-04-30 07:44:43.338 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/api/Participant/get_participants/1 - null null
2025-04-30 07:44:43.338 +07:00 [INF] CORS policy execution successful.
2025-04-30 07:44:43.338 +07:00 [INF] CORS policy execution successful.
2025-04-30 07:44:43.338 +07:00 [INF] Executing endpoint 'server.Controllers.ParticipantController.GetParticipants (Message_app)'
2025-04-30 07:44:43.339 +07:00 [INF] Route matched with {action = "GetParticipants", controller = "Participant"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetParticipants(Int32) on controller server.Controllers.ParticipantController (Message_app).
2025-04-30 07:44:43.344 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[@__conversation_id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[id], [p].[adder], [p].[conversation_id], [p].[is_deleted], [p].[joined_at], [p].[name], [p].[role], [p].[user_id]
FROM [Participants] AS [p]
WHERE [p].[conversation_id] = @__conversation_id_0
2025-04-30 07:44:43.346 +07:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType17`1[[System.Collections.Generic.List`1[[server.Models.Participants, Message_app, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-04-30 07:44:43.346 +07:00 [INF] Executed action server.Controllers.ParticipantController.GetParticipants (Message_app) in 7.164ms
2025-04-30 07:44:43.346 +07:00 [INF] Executed endpoint 'server.Controllers.ParticipantController.GetParticipants (Message_app)'
2025-04-30 07:44:43.346 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5053/api/Participant/get_participants/1 - 200 null application/json; charset=utf-8 8.2989ms
2025-04-30 07:50:42.088 +07:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5053/api/Auth/login - null null
2025-04-30 07:50:42.088 +07:00 [INF] CORS policy execution successful.
2025-04-30 07:50:42.088 +07:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5053/api/Auth/login - 204 null null 0.2783ms
2025-04-30 07:50:42.090 +07:00 [INF] Request starting HTTP/1.1 POST http://localhost:5053/api/Auth/login - application/json 53
2025-04-30 07:50:42.090 +07:00 [INF] CORS policy execution successful.
2025-04-30 07:50:42.091 +07:00 [INF] CORS policy execution successful.
2025-04-30 07:50:42.091 +07:00 [INF] Executing endpoint 'Message_app.Controllers.AuthController.Login (Message_app)'
2025-04-30 07:50:42.091 +07:00 [INF] Route matched with {action = "Login", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Login(server.DTO.AuthDTO.LoginDTO) on controller Message_app.Controllers.AuthController (Message_app).
2025-04-30 07:50:42.155 +07:00 [INF] Executed DbCommand (13ms) [Parameters=[@__email_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[id], [u].[avatar_url], [u].[bio], [u].[birthday], [u].[created_at], [u].[email], [u].[gender], [u].[interests], [u].[location], [u].[password], [u].[passwordSalt], [u].[username]
FROM [Users] AS [u]
WHERE [u].[email] = @__email_0
2025-04-30 07:50:42.156 +07:00 [INF] Executing OkObjectResult, writing value of type 'server.DTO.AuthDTO.LoginRespose'.
2025-04-30 07:50:42.156 +07:00 [INF] Executed action Message_app.Controllers.AuthController.Login (Message_app) in 64.8095ms
2025-04-30 07:50:42.156 +07:00 [INF] Executed endpoint 'Message_app.Controllers.AuthController.Login (Message_app)'
2025-04-30 07:50:42.156 +07:00 [INF] Request finished HTTP/1.1 POST http://localhost:5053/api/Auth/login - 200 null application/json; charset=utf-8 65.9425ms
2025-04-30 07:50:42.332 +07:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5053/api/Conversation/get_conversations/5 - null null
2025-04-30 07:50:42.332 +07:00 [INF] CORS policy execution successful.
2025-04-30 07:50:42.332 +07:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5053/api/Conversation/get_conversations/5 - 204 null null 0.2782ms
2025-04-30 07:50:42.333 +07:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5053/api/Conversation/get_conversations/5 - null null
2025-04-30 07:50:42.333 +07:00 [INF] CORS policy execution successful.
2025-04-30 07:50:42.334 +07:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5053/api/Conversation/get_conversations/5 - 204 null null 0.5229ms
2025-04-30 07:50:42.334 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/api/Conversation/get_conversations/5 - null null
2025-04-30 07:50:42.334 +07:00 [INF] CORS policy execution successful.
2025-04-30 07:50:42.334 +07:00 [INF] CORS policy execution successful.
2025-04-30 07:50:42.334 +07:00 [INF] Executing endpoint 'server.Controllers.ConversationController.GetConversations (Message_app)'
2025-04-30 07:50:42.335 +07:00 [INF] Route matched with {action = "GetConversations", controller = "Conversation"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetConversations(Int32) on controller server.Controllers.ConversationController (Message_app).
2025-04-30 07:50:42.336 +07:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[server.DTO.ConversationDto, Message_app, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-04-30 07:50:42.336 +07:00 [INF] Executed action server.Controllers.ConversationController.GetConversations (Message_app) in 1.3621ms
2025-04-30 07:50:42.336 +07:00 [INF] Executed endpoint 'server.Controllers.ConversationController.GetConversations (Message_app)'
2025-04-30 07:50:42.336 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5053/api/Conversation/get_conversations/5 - 200 null application/json; charset=utf-8 2.1702ms
2025-04-30 07:50:42.346 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/api/Conversation/get_conversations/5 - null null
2025-04-30 07:50:42.347 +07:00 [INF] CORS policy execution successful.
2025-04-30 07:50:42.347 +07:00 [INF] CORS policy execution successful.
2025-04-30 07:50:42.347 +07:00 [INF] Executing endpoint 'server.Controllers.ConversationController.GetConversations (Message_app)'
2025-04-30 07:50:42.348 +07:00 [INF] Route matched with {action = "GetConversations", controller = "Conversation"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetConversations(Int32) on controller server.Controllers.ConversationController (Message_app).
2025-04-30 07:50:42.355 +07:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[server.DTO.ConversationDto, Message_app, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-04-30 07:50:42.355 +07:00 [INF] Executed action server.Controllers.ConversationController.GetConversations (Message_app) in 7.6315ms
2025-04-30 07:50:42.355 +07:00 [INF] Executed endpoint 'server.Controllers.ConversationController.GetConversations (Message_app)'
2025-04-30 07:50:42.355 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5053/api/Conversation/get_conversations/5 - 200 null application/json; charset=utf-8 9.1417ms
2025-04-30 07:50:42.452 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/ws/chat?userId=5 - null null
2025-04-30 07:50:42.453 +07:00 [INF] CORS policy execution successful.
2025-04-30 07:50:42.453 +07:00 [INF] CORS policy execution successful.
2025-04-30 07:50:42.453 +07:00 [INF] Executing endpoint '/ws/chat'
2025-04-30 07:50:42.609 +07:00 [INF] Executed DbCommand (7ms) [Parameters=[@__client_UserId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[conversation_id]
FROM [Participants] AS [p]
WHERE [p].[user_id] = @__client_UserId_0 AND [p].[is_deleted] = CAST(0 AS bit)
2025-04-30 07:50:48.293 +07:00 [INF] Request starting HTTP/1.1 GET http://192.168.1.9:5053/api/Message/getMessages/1/2 - null null
2025-04-30 07:50:48.293 +07:00 [INF] Executing endpoint 'server.Controllers.MessageController.GetMessages (Message_app)'
2025-04-30 07:50:48.294 +07:00 [INF] Route matched with {action = "GetMessages", controller = "Message"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetMessages(Int32, Int32) on controller server.Controllers.MessageController (Message_app).
2025-04-30 07:50:48.306 +07:00 [WRN] Message 81 not found in Redis
2025-04-30 07:50:48.307 +07:00 [WRN] Message 80 not found in Redis
2025-04-30 07:50:48.307 +07:00 [WRN] Message 79 not found in Redis
2025-04-30 07:50:48.307 +07:00 [WRN] Message 78 not found in Redis
2025-04-30 07:50:48.307 +07:00 [WRN] Message 77 not found in Redis
2025-04-30 07:50:48.307 +07:00 [WRN] Message 76 not found in Redis
2025-04-30 07:50:48.310 +07:00 [WRN] Message 75 not found in Redis
2025-04-30 07:50:48.310 +07:00 [WRN] Message 74 not found in Redis
2025-04-30 07:50:48.311 +07:00 [WRN] Message 73 not found in Redis
2025-04-30 07:50:48.311 +07:00 [WRN] Message 72 not found in Redis
2025-04-30 07:50:48.312 +07:00 [WRN] Message 71 not found in Redis
2025-04-30 07:50:48.312 +07:00 [WRN] Message 68 not found in Redis
2025-04-30 07:50:48.312 +07:00 [WRN] Message 64 not found in Redis
2025-04-30 07:50:48.313 +07:00 [WRN] Message 62 not found in Redis
2025-04-30 07:50:48.313 +07:00 [WRN] Message 61 not found in Redis
2025-04-30 07:50:48.313 +07:00 [WRN] Message 60 not found in Redis
2025-04-30 07:50:48.314 +07:00 [WRN] Message 59 not found in Redis
2025-04-30 07:50:48.316 +07:00 [WRN] Message 57 not found in Redis
2025-04-30 07:50:48.317 +07:00 [WRN] Message 55 not found in Redis
2025-04-30 07:50:48.318 +07:00 [WRN] Message 54 not found in Redis
2025-04-30 07:50:48.320 +07:00 [WRN] Message 51 not found in Redis
2025-04-30 07:50:48.321 +07:00 [WRN] Message 49 not found in Redis
2025-04-30 07:50:48.322 +07:00 [WRN] Message 11 not found in Redis
2025-04-30 07:50:48.323 +07:00 [WRN] Message 8 not found in Redis
2025-04-30 07:50:48.326 +07:00 [WRN] Message 3 not found in Redis
2025-04-30 07:50:48.327 +07:00 [WRN] Message 2 not found in Redis
2025-04-30 07:50:48.328 +07:00 [WRN] Message 1 not found in Redis
2025-04-30 07:50:48.328 +07:00 [INF] Retrieved 9 messages from Redis for conversation 1
2025-04-30 07:50:48.328 +07:00 [INF] Retrieved 9 messages from Redis for conversation 1 and user 2
2025-04-30 07:50:48.328 +07:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[server.DTO.MessageWithAttachment, Message_app, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-04-30 07:50:48.328 +07:00 [INF] Executed action server.Controllers.MessageController.GetMessages (Message_app) in 34.562ms
2025-04-30 07:50:48.328 +07:00 [INF] Executed endpoint 'server.Controllers.MessageController.GetMessages (Message_app)'
2025-04-30 07:50:48.328 +07:00 [INF] Request finished HTTP/1.1 GET http://192.168.1.9:5053/api/Message/getMessages/1/2 - 200 null application/json; charset=utf-8 35.4961ms
2025-04-30 07:50:48.459 +07:00 [INF] Request starting HTTP/1.1 GET http://192.168.1.9:5053/api/Conversation/get_first_conversation/1 - null null
2025-04-30 07:50:48.460 +07:00 [INF] Executing endpoint 'server.Controllers.ConversationController.GetFirstConversation (Message_app)'
2025-04-30 07:50:48.460 +07:00 [INF] Route matched with {action = "GetFirstConversation", controller = "Conversation"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetFirstConversation(Int32) on controller server.Controllers.ConversationController (Message_app).
2025-04-30 07:50:48.468 +07:00 [INF] Executed DbCommand (5ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[id], [c].[created_at], [c].[is_group], [c].[lastMessage], [c].[lastMessageSender], [c].[lastMessageTime], [c].[name]
FROM [Conversations] AS [c]
WHERE [c].[id] = @__p_0
2025-04-30 07:50:48.469 +07:00 [INF] Executing OkObjectResult, writing value of type 'server.Models.Conversation'.
2025-04-30 07:50:48.469 +07:00 [INF] Executed action server.Controllers.ConversationController.GetFirstConversation (Message_app) in 9.2081ms
2025-04-30 07:50:48.469 +07:00 [INF] Executed endpoint 'server.Controllers.ConversationController.GetFirstConversation (Message_app)'
2025-04-30 07:50:48.469 +07:00 [INF] Request finished HTTP/1.1 GET http://192.168.1.9:5053/api/Conversation/get_first_conversation/1 - 200 null application/json; charset=utf-8 9.9674ms
2025-04-30 07:50:48.590 +07:00 [INF] Request starting HTTP/1.1 GET http://192.168.1.9:5053/api/Participant/get_participants/1 - null null
2025-04-30 07:50:48.590 +07:00 [INF] Executing endpoint 'server.Controllers.ParticipantController.GetParticipants (Message_app)'
2025-04-30 07:50:48.590 +07:00 [INF] Route matched with {action = "GetParticipants", controller = "Participant"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetParticipants(Int32) on controller server.Controllers.ParticipantController (Message_app).
2025-04-30 07:50:48.596 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[@__conversation_id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[id], [p].[adder], [p].[conversation_id], [p].[is_deleted], [p].[joined_at], [p].[name], [p].[role], [p].[user_id]
FROM [Participants] AS [p]
WHERE [p].[conversation_id] = @__conversation_id_0
2025-04-30 07:50:48.597 +07:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType17`1[[System.Collections.Generic.List`1[[server.Models.Participants, Message_app, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-04-30 07:50:48.597 +07:00 [INF] Executed action server.Controllers.ParticipantController.GetParticipants (Message_app) in 6.6872ms
2025-04-30 07:50:48.597 +07:00 [INF] Executed endpoint 'server.Controllers.ParticipantController.GetParticipants (Message_app)'
2025-04-30 07:50:48.597 +07:00 [INF] Request finished HTTP/1.1 GET http://192.168.1.9:5053/api/Participant/get_participants/1 - 200 null application/json; charset=utf-8 7.3723ms
2025-04-30 07:50:52.300 +07:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5053/api/Message/getMessages/1/5 - null null
2025-04-30 07:50:52.300 +07:00 [INF] CORS policy execution successful.
2025-04-30 07:50:52.300 +07:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5053/api/Message/getMessages/1/5 - 204 null null 0.2221ms
2025-04-30 07:50:52.302 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/api/Message/getMessages/1/5 - null null
2025-04-30 07:50:52.302 +07:00 [INF] CORS policy execution successful.
2025-04-30 07:50:52.302 +07:00 [INF] CORS policy execution successful.
2025-04-30 07:50:52.302 +07:00 [INF] Executing endpoint 'server.Controllers.MessageController.GetMessages (Message_app)'
2025-04-30 07:50:52.303 +07:00 [INF] Route matched with {action = "GetMessages", controller = "Message"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetMessages(Int32, Int32) on controller server.Controllers.MessageController (Message_app).
2025-04-30 07:50:52.306 +07:00 [WRN] Message 81 not found in Redis
2025-04-30 07:50:52.306 +07:00 [WRN] Message 80 not found in Redis
2025-04-30 07:50:52.306 +07:00 [WRN] Message 79 not found in Redis
2025-04-30 07:50:52.307 +07:00 [WRN] Message 78 not found in Redis
2025-04-30 07:50:52.307 +07:00 [WRN] Message 77 not found in Redis
2025-04-30 07:50:52.307 +07:00 [WRN] Message 76 not found in Redis
2025-04-30 07:50:52.307 +07:00 [WRN] Message 75 not found in Redis
2025-04-30 07:50:52.308 +07:00 [WRN] Message 74 not found in Redis
2025-04-30 07:50:52.308 +07:00 [WRN] Message 73 not found in Redis
2025-04-30 07:50:52.308 +07:00 [WRN] Message 72 not found in Redis
2025-04-30 07:50:52.308 +07:00 [WRN] Message 71 not found in Redis
2025-04-30 07:50:52.308 +07:00 [WRN] Message 68 not found in Redis
2025-04-30 07:50:52.308 +07:00 [WRN] Message 64 not found in Redis
2025-04-30 07:50:52.309 +07:00 [WRN] Message 62 not found in Redis
2025-04-30 07:50:52.309 +07:00 [WRN] Message 61 not found in Redis
2025-04-30 07:50:52.309 +07:00 [WRN] Message 60 not found in Redis
2025-04-30 07:50:52.310 +07:00 [WRN] Message 59 not found in Redis
2025-04-30 07:50:52.310 +07:00 [WRN] Message 57 not found in Redis
2025-04-30 07:50:52.310 +07:00 [WRN] Message 55 not found in Redis
2025-04-30 07:50:52.310 +07:00 [WRN] Message 54 not found in Redis
2025-04-30 07:50:52.311 +07:00 [WRN] Message 51 not found in Redis
2025-04-30 07:50:52.311 +07:00 [WRN] Message 49 not found in Redis
2025-04-30 07:50:52.311 +07:00 [WRN] Message 11 not found in Redis
2025-04-30 07:50:52.311 +07:00 [WRN] Message 8 not found in Redis
2025-04-30 07:50:52.311 +07:00 [WRN] Message 3 not found in Redis
2025-04-30 07:50:52.312 +07:00 [WRN] Message 2 not found in Redis
2025-04-30 07:50:52.312 +07:00 [WRN] Message 1 not found in Redis
2025-04-30 07:50:52.312 +07:00 [INF] Retrieved 9 messages from Redis for conversation 1
2025-04-30 07:50:52.312 +07:00 [INF] Retrieved 9 messages from Redis for conversation 1 and user 5
2025-04-30 07:50:52.312 +07:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[server.DTO.MessageWithAttachment, Message_app, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-04-30 07:50:52.313 +07:00 [INF] Executed action server.Controllers.MessageController.GetMessages (Message_app) in 9.8931ms
2025-04-30 07:50:52.313 +07:00 [INF] Executed endpoint 'server.Controllers.MessageController.GetMessages (Message_app)'
2025-04-30 07:50:52.313 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5053/api/Message/getMessages/1/5 - 200 null application/json; charset=utf-8 10.8564ms
2025-04-30 07:50:52.330 +07:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5053/api/Conversation/get_first_conversation/1 - null null
2025-04-30 07:50:52.330 +07:00 [INF] CORS policy execution successful.
2025-04-30 07:50:52.330 +07:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5053/api/Conversation/get_first_conversation/1 - 204 null null 0.1547ms
2025-04-30 07:50:52.332 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/api/Conversation/get_first_conversation/1 - null null
2025-04-30 07:50:52.332 +07:00 [INF] CORS policy execution successful.
2025-04-30 07:50:52.332 +07:00 [INF] CORS policy execution successful.
2025-04-30 07:50:52.332 +07:00 [INF] Executing endpoint 'server.Controllers.ConversationController.GetFirstConversation (Message_app)'
2025-04-30 07:50:52.332 +07:00 [INF] Route matched with {action = "GetFirstConversation", controller = "Conversation"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetFirstConversation(Int32) on controller server.Controllers.ConversationController (Message_app).
2025-04-30 07:50:52.335 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[id], [c].[created_at], [c].[is_group], [c].[lastMessage], [c].[lastMessageSender], [c].[lastMessageTime], [c].[name]
FROM [Conversations] AS [c]
WHERE [c].[id] = @__p_0
2025-04-30 07:50:52.335 +07:00 [INF] Executing OkObjectResult, writing value of type 'server.Models.Conversation'.
2025-04-30 07:50:52.336 +07:00 [INF] Executed action server.Controllers.ConversationController.GetFirstConversation (Message_app) in 3.2699ms
2025-04-30 07:50:52.336 +07:00 [INF] Executed endpoint 'server.Controllers.ConversationController.GetFirstConversation (Message_app)'
2025-04-30 07:50:52.336 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5053/api/Conversation/get_first_conversation/1 - 200 null application/json; charset=utf-8 3.7856ms
2025-04-30 07:50:52.352 +07:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5053/api/Participant/get_participants/1 - null null
2025-04-30 07:50:52.353 +07:00 [INF] CORS policy execution successful.
2025-04-30 07:50:52.353 +07:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5053/api/Participant/get_participants/1 - 204 null null 0.1632ms
2025-04-30 07:50:52.354 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/api/Participant/get_participants/1 - null null
2025-04-30 07:50:52.354 +07:00 [INF] CORS policy execution successful.
2025-04-30 07:50:52.354 +07:00 [INF] CORS policy execution successful.
2025-04-30 07:50:52.354 +07:00 [INF] Executing endpoint 'server.Controllers.ParticipantController.GetParticipants (Message_app)'
2025-04-30 07:50:52.354 +07:00 [INF] Route matched with {action = "GetParticipants", controller = "Participant"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetParticipants(Int32) on controller server.Controllers.ParticipantController (Message_app).
2025-04-30 07:50:52.356 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__conversation_id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[id], [p].[adder], [p].[conversation_id], [p].[is_deleted], [p].[joined_at], [p].[name], [p].[role], [p].[user_id]
FROM [Participants] AS [p]
WHERE [p].[conversation_id] = @__conversation_id_0
2025-04-30 07:50:52.356 +07:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType17`1[[System.Collections.Generic.List`1[[server.Models.Participants, Message_app, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-04-30 07:50:52.356 +07:00 [INF] Executed action server.Controllers.ParticipantController.GetParticipants (Message_app) in 2.2373ms
2025-04-30 07:50:52.356 +07:00 [INF] Executed endpoint 'server.Controllers.ParticipantController.GetParticipants (Message_app)'
2025-04-30 07:50:52.356 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5053/api/Participant/get_participants/1 - 200 null application/json; charset=utf-8 2.6235ms
2025-04-30 07:51:04.522 +07:00 [INF] Executed endpoint '/ws/chat'
2025-04-30 07:51:04.522 +07:00 [INF] Request finished HTTP/1.1 GET http://192.168.1.9:5053/ws/chat?userId=2 - 101 null null 609494.6683ms
2025-04-30 07:51:09.554 +07:00 [INF] Request starting HTTP/1.1 GET http://192.168.1.9:5053/ws/chat?userId=2 - null null
2025-04-30 07:51:09.554 +07:00 [INF] Executing endpoint '/ws/chat'
2025-04-30 07:51:19.445 +07:00 [INF] Request starting HTTP/1.1 POST http://192.168.1.9:5053/api/Auth/login - application/json 57
2025-04-30 07:51:19.445 +07:00 [INF] Executing endpoint 'Message_app.Controllers.AuthController.Login (Message_app)'
2025-04-30 07:51:19.445 +07:00 [INF] Route matched with {action = "Login", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Login(server.DTO.AuthDTO.LoginDTO) on controller Message_app.Controllers.AuthController (Message_app).
2025-04-30 07:51:19.515 +07:00 [INF] Executed DbCommand (16ms) [Parameters=[@__email_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[id], [u].[avatar_url], [u].[bio], [u].[birthday], [u].[created_at], [u].[email], [u].[gender], [u].[interests], [u].[location], [u].[password], [u].[passwordSalt], [u].[username]
FROM [Users] AS [u]
WHERE [u].[email] = @__email_0
2025-04-30 07:51:19.516 +07:00 [INF] Executing OkObjectResult, writing value of type 'server.DTO.AuthDTO.LoginRespose'.
2025-04-30 07:51:19.516 +07:00 [INF] Executed action Message_app.Controllers.AuthController.Login (Message_app) in 70.3091ms
2025-04-30 07:51:19.516 +07:00 [INF] Executed endpoint 'Message_app.Controllers.AuthController.Login (Message_app)'
2025-04-30 07:51:19.516 +07:00 [INF] Request finished HTTP/1.1 POST http://192.168.1.9:5053/api/Auth/login - 200 null application/json; charset=utf-8 70.8691ms
2025-04-30 07:51:19.791 +07:00 [INF] Request starting HTTP/1.1 GET http://192.168.1.9:5053/api/Conversation/get_conversations/2 - null null
2025-04-30 07:51:19.791 +07:00 [INF] Executing endpoint 'server.Controllers.ConversationController.GetConversations (Message_app)'
2025-04-30 07:51:19.791 +07:00 [INF] Route matched with {action = "GetConversations", controller = "Conversation"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetConversations(Int32) on controller server.Controllers.ConversationController (Message_app).
2025-04-30 07:51:19.794 +07:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[server.DTO.ConversationDto, Message_app, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-04-30 07:51:19.794 +07:00 [INF] Executed action server.Controllers.ConversationController.GetConversations (Message_app) in 2.5822ms
2025-04-30 07:51:19.794 +07:00 [INF] Executed endpoint 'server.Controllers.ConversationController.GetConversations (Message_app)'
2025-04-30 07:51:19.794 +07:00 [INF] Request finished HTTP/1.1 GET http://192.168.1.9:5053/api/Conversation/get_conversations/2 - 200 null application/json; charset=utf-8 3.4098ms
2025-04-30 07:51:19.803 +07:00 [INF] Request starting HTTP/1.1 GET http://192.168.1.9:5053/api/Conversation/get_conversations/2 - null null
2025-04-30 07:51:19.803 +07:00 [INF] Executing endpoint 'server.Controllers.ConversationController.GetConversations (Message_app)'
2025-04-30 07:51:19.804 +07:00 [INF] Route matched with {action = "GetConversations", controller = "Conversation"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetConversations(Int32) on controller server.Controllers.ConversationController (Message_app).
2025-04-30 07:51:19.806 +07:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[server.DTO.ConversationDto, Message_app, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-04-30 07:51:19.807 +07:00 [INF] Executed action server.Controllers.ConversationController.GetConversations (Message_app) in 2.275ms
2025-04-30 07:51:19.807 +07:00 [INF] Executed endpoint 'server.Controllers.ConversationController.GetConversations (Message_app)'
2025-04-30 07:51:19.807 +07:00 [INF] Request finished HTTP/1.1 GET http://192.168.1.9:5053/api/Conversation/get_conversations/2 - 200 null application/json; charset=utf-8 4.3884ms
2025-04-30 07:51:30.266 +07:00 [INF] Request starting HTTP/1.1 GET http://192.168.1.9:5053/api/Message/getMessages/1/2 - null null
2025-04-30 07:51:30.266 +07:00 [INF] Executing endpoint 'server.Controllers.MessageController.GetMessages (Message_app)'
2025-04-30 07:51:30.266 +07:00 [INF] Route matched with {action = "GetMessages", controller = "Message"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetMessages(Int32, Int32) on controller server.Controllers.MessageController (Message_app).
2025-04-30 07:51:30.276 +07:00 [WRN] Message 81 not found in Redis
2025-04-30 07:51:30.277 +07:00 [WRN] Message 80 not found in Redis
2025-04-30 07:51:30.281 +07:00 [WRN] Message 79 not found in Redis
2025-04-30 07:51:30.284 +07:00 [WRN] Message 78 not found in Redis
2025-04-30 07:51:30.295 +07:00 [WRN] Message 77 not found in Redis
2025-04-30 07:51:30.297 +07:00 [WRN] Message 76 not found in Redis
2025-04-30 07:51:30.297 +07:00 [WRN] Message 75 not found in Redis
2025-04-30 07:51:30.298 +07:00 [WRN] Message 74 not found in Redis
2025-04-30 07:51:30.299 +07:00 [WRN] Message 73 not found in Redis
2025-04-30 07:51:30.300 +07:00 [WRN] Message 72 not found in Redis
2025-04-30 07:51:30.300 +07:00 [WRN] Message 71 not found in Redis
2025-04-30 07:51:30.300 +07:00 [WRN] Message 68 not found in Redis
2025-04-30 07:51:30.301 +07:00 [WRN] Message 64 not found in Redis
2025-04-30 07:51:30.309 +07:00 [WRN] Message 62 not found in Redis
2025-04-30 07:51:30.309 +07:00 [WRN] Message 61 not found in Redis
2025-04-30 07:51:30.310 +07:00 [WRN] Message 60 not found in Redis
2025-04-30 07:51:30.310 +07:00 [WRN] Message 59 not found in Redis
2025-04-30 07:51:30.311 +07:00 [WRN] Message 57 not found in Redis
2025-04-30 07:51:30.311 +07:00 [WRN] Message 55 not found in Redis
2025-04-30 07:51:30.312 +07:00 [WRN] Message 54 not found in Redis
2025-04-30 07:51:30.312 +07:00 [WRN] Message 51 not found in Redis
2025-04-30 07:51:30.313 +07:00 [WRN] Message 49 not found in Redis
2025-04-30 07:51:30.313 +07:00 [WRN] Message 11 not found in Redis
2025-04-30 07:51:30.313 +07:00 [WRN] Message 8 not found in Redis
2025-04-30 07:51:30.314 +07:00 [WRN] Message 3 not found in Redis
2025-04-30 07:51:30.315 +07:00 [WRN] Message 2 not found in Redis
2025-04-30 07:51:30.316 +07:00 [WRN] Message 1 not found in Redis
2025-04-30 07:51:30.316 +07:00 [INF] Retrieved 9 messages from Redis for conversation 1
2025-04-30 07:51:30.316 +07:00 [INF] Retrieved 9 messages from Redis for conversation 1 and user 2
2025-04-30 07:51:30.316 +07:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[server.DTO.MessageWithAttachment, Message_app, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-04-30 07:51:30.316 +07:00 [INF] Executed action server.Controllers.MessageController.GetMessages (Message_app) in 50.3639ms
2025-04-30 07:51:30.316 +07:00 [INF] Executed endpoint 'server.Controllers.MessageController.GetMessages (Message_app)'
2025-04-30 07:51:30.316 +07:00 [INF] Request finished HTTP/1.1 GET http://192.168.1.9:5053/api/Message/getMessages/1/2 - 200 null application/json; charset=utf-8 50.9454ms
2025-04-30 07:51:30.356 +07:00 [INF] Request starting HTTP/1.1 GET http://192.168.1.9:5053/api/Conversation/get_first_conversation/1 - null null
2025-04-30 07:51:30.356 +07:00 [INF] Executing endpoint 'server.Controllers.ConversationController.GetFirstConversation (Message_app)'
2025-04-30 07:51:30.356 +07:00 [INF] Route matched with {action = "GetFirstConversation", controller = "Conversation"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetFirstConversation(Int32) on controller server.Controllers.ConversationController (Message_app).
2025-04-30 07:51:30.368 +07:00 [INF] Executed DbCommand (6ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[id], [c].[created_at], [c].[is_group], [c].[lastMessage], [c].[lastMessageSender], [c].[lastMessageTime], [c].[name]
FROM [Conversations] AS [c]
WHERE [c].[id] = @__p_0
2025-04-30 07:51:30.371 +07:00 [INF] Executing OkObjectResult, writing value of type 'server.Models.Conversation'.
2025-04-30 07:51:30.372 +07:00 [INF] Executed action server.Controllers.ConversationController.GetFirstConversation (Message_app) in 15.1916ms
2025-04-30 07:51:30.372 +07:00 [INF] Executed endpoint 'server.Controllers.ConversationController.GetFirstConversation (Message_app)'
2025-04-30 07:51:30.372 +07:00 [INF] Request finished HTTP/1.1 GET http://192.168.1.9:5053/api/Conversation/get_first_conversation/1 - 200 null application/json; charset=utf-8 15.9994ms
2025-04-30 07:51:30.398 +07:00 [INF] Request starting HTTP/1.1 GET http://192.168.1.9:5053/api/Participant/get_participants/1 - null null
2025-04-30 07:51:30.399 +07:00 [INF] Executing endpoint 'server.Controllers.ParticipantController.GetParticipants (Message_app)'
2025-04-30 07:51:30.399 +07:00 [INF] Route matched with {action = "GetParticipants", controller = "Participant"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetParticipants(Int32) on controller server.Controllers.ParticipantController (Message_app).
2025-04-30 07:51:30.411 +07:00 [INF] Executed DbCommand (10ms) [Parameters=[@__conversation_id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[id], [p].[adder], [p].[conversation_id], [p].[is_deleted], [p].[joined_at], [p].[name], [p].[role], [p].[user_id]
FROM [Participants] AS [p]
WHERE [p].[conversation_id] = @__conversation_id_0
2025-04-30 07:51:30.412 +07:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType17`1[[System.Collections.Generic.List`1[[server.Models.Participants, Message_app, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-04-30 07:51:30.412 +07:00 [INF] Executed action server.Controllers.ParticipantController.GetParticipants (Message_app) in 12.9317ms
2025-04-30 07:51:30.412 +07:00 [INF] Executed endpoint 'server.Controllers.ParticipantController.GetParticipants (Message_app)'
2025-04-30 07:51:30.412 +07:00 [INF] Request finished HTTP/1.1 GET http://192.168.1.9:5053/api/Participant/get_participants/1 - 200 null application/json; charset=utf-8 13.6921ms
2025-04-30 07:51:51.159 +07:00 [INF] Request starting HTTP/1.1 POST http://192.168.1.9:5053/api/Auth/login - application/json 57
2025-04-30 07:51:51.160 +07:00 [INF] Executing endpoint 'Message_app.Controllers.AuthController.Login (Message_app)'
2025-04-30 07:51:51.160 +07:00 [INF] Route matched with {action = "Login", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Login(server.DTO.AuthDTO.LoginDTO) on controller Message_app.Controllers.AuthController (Message_app).
2025-04-30 07:51:51.173 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[@__email_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[id], [u].[avatar_url], [u].[bio], [u].[birthday], [u].[created_at], [u].[email], [u].[gender], [u].[interests], [u].[location], [u].[password], [u].[passwordSalt], [u].[username]
FROM [Users] AS [u]
WHERE [u].[email] = @__email_0
2025-04-30 07:51:51.173 +07:00 [INF] Executing OkObjectResult, writing value of type 'server.DTO.AuthDTO.LoginRespose'.
2025-04-30 07:51:51.174 +07:00 [INF] Executed action Message_app.Controllers.AuthController.Login (Message_app) in 13.055ms
2025-04-30 07:51:51.174 +07:00 [INF] Executed endpoint 'Message_app.Controllers.AuthController.Login (Message_app)'
2025-04-30 07:51:51.174 +07:00 [INF] Request finished HTTP/1.1 POST http://192.168.1.9:5053/api/Auth/login - 200 null application/json; charset=utf-8 14.2279ms
2025-04-30 07:51:52.298 +07:00 [INF] Request starting HTTP/1.1 GET http://192.168.1.9:5053/ws/chat?userId=2 - null null
2025-04-30 07:51:52.298 +07:00 [INF] Executing endpoint '/ws/chat'
2025-04-30 07:51:52.470 +07:00 [INF] Request starting HTTP/1.1 GET http://192.168.1.9:5053/api/Conversation/get_conversations/2 - null null
2025-04-30 07:51:52.470 +07:00 [INF] Executing endpoint 'server.Controllers.ConversationController.GetConversations (Message_app)'
2025-04-30 07:51:52.470 +07:00 [INF] Route matched with {action = "GetConversations", controller = "Conversation"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetConversations(Int32) on controller server.Controllers.ConversationController (Message_app).
2025-04-30 07:51:52.472 +07:00 [INF] Request starting HTTP/1.1 GET http://192.168.1.9:5053/api/Conversation/get_conversations/2 - null null
2025-04-30 07:51:52.472 +07:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[server.DTO.ConversationDto, Message_app, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-04-30 07:51:52.472 +07:00 [INF] Executing endpoint 'server.Controllers.ConversationController.GetConversations (Message_app)'
2025-04-30 07:51:52.472 +07:00 [INF] Executed action server.Controllers.ConversationController.GetConversations (Message_app) in 1.3184ms
2025-04-30 07:51:52.472 +07:00 [INF] Executed endpoint 'server.Controllers.ConversationController.GetConversations (Message_app)'
2025-04-30 07:51:52.472 +07:00 [INF] Route matched with {action = "GetConversations", controller = "Conversation"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetConversations(Int32) on controller server.Controllers.ConversationController (Message_app).
2025-04-30 07:51:52.472 +07:00 [INF] Request finished HTTP/1.1 GET http://192.168.1.9:5053/api/Conversation/get_conversations/2 - 200 null application/json; charset=utf-8 2.2588ms
2025-04-30 07:51:52.474 +07:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[server.DTO.ConversationDto, Message_app, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-04-30 07:51:52.474 +07:00 [INF] Executed action server.Controllers.ConversationController.GetConversations (Message_app) in 1.7436ms
2025-04-30 07:51:52.474 +07:00 [INF] Executed endpoint 'server.Controllers.ConversationController.GetConversations (Message_app)'
2025-04-30 07:51:52.474 +07:00 [INF] Request finished HTTP/1.1 GET http://192.168.1.9:5053/api/Conversation/get_conversations/2 - 200 null application/json; charset=utf-8 2.4421ms
2025-04-30 07:51:57.671 +07:00 [INF] Executed endpoint '/ws/chat'
2025-04-30 07:51:57.672 +07:00 [INF] Executed endpoint '/ws/chat'
2025-04-30 07:51:57.672 +07:00 [ERR] An unhandled exception has occurred while executing the request.
System.Net.WebSockets.WebSocketException (0x80004005): The remote party closed the WebSocket connection without completing the close handshake.
 ---> Microsoft.AspNetCore.Connections.ConnectionResetException: An existing connection was forcibly closed by the remote host.
 ---> System.Net.Sockets.SocketException (10054): An existing connection was forcibly closed by the remote host.
   --- End of inner exception stack trace ---
   at System.IO.Pipelines.Pipe.GetReadAsyncResult()
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.Http.Http1UpgradeMessageBody.ReadAsyncInternalAwaited(ValueTask`1 readTask, CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.Http.HttpRequestStream.ReadAsyncInternal(Memory`1 destination, CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at System.IO.Stream.ReadAtLeastAsyncCore(Memory`1 buffer, Int32 minimumBytes, Boolean throwOnEndOfStream, CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at System.Net.WebSockets.ManagedWebSocket.EnsureBufferContainsAsync(Int32 minimumRequiredBytes, CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.WebSockets.ManagedWebSocket.ReceiveAsyncPrivate[TResult](Memory`1 payloadBuffer, CancellationToken cancellationToken)
   at System.Net.WebSockets.ManagedWebSocket.ReceiveAsyncPrivate[TResult](Memory`1 payloadBuffer, CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at System.Threading.Tasks.ValueTask`1.ValueTaskSourceAsTask.<>c.<.cctor>b__4_0(Object state)
--- End of stack trace from previous location ---
   at server.Services.WebSocketService.webSocket.Receiver(Client client) in C:\Users\Thao\source\Flutter\Message_app\server\Services\WebSocketService\websocket.cs:line 108
   at server.Services.WebSocketService.webSocket.HandleWebSocket(HttpContext context) in C:\Users\Thao\source\Flutter\Message_app\server\Services\WebSocketService\websocket.cs:line 91
   at Program.<>c.<<<Main>$>b__0_4>d.MoveNext() in C:\Users\Thao\source\Flutter\Message_app\server\Program.cs:line 89
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
2025-04-30 07:51:57.672 +07:00 [ERR] An unhandled exception has occurred while executing the request.
System.Net.WebSockets.WebSocketException (0x80004005): The remote party closed the WebSocket connection without completing the close handshake.
   at System.Net.WebSockets.ManagedWebSocket.ThrowEOFUnexpected()
   at System.Net.WebSockets.ManagedWebSocket.EnsureBufferContainsAsync(Int32 minimumRequiredBytes, CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.WebSockets.ManagedWebSocket.ReceiveAsyncPrivate[TResult](Memory`1 payloadBuffer, CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at System.Threading.Tasks.ValueTask`1.ValueTaskSourceAsTask.<>c.<.cctor>b__4_0(Object state)
--- End of stack trace from previous location ---
   at server.Services.WebSocketService.webSocket.Receiver(Client client) in C:\Users\Thao\source\Flutter\Message_app\server\Services\WebSocketService\websocket.cs:line 108
   at server.Services.WebSocketService.webSocket.HandleWebSocket(HttpContext context) in C:\Users\Thao\source\Flutter\Message_app\server\Services\WebSocketService\websocket.cs:line 91
   at Program.<>c.<<<Main>$>b__0_4>d.MoveNext() in C:\Users\Thao\source\Flutter\Message_app\server\Program.cs:line 89
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
2025-04-30 07:51:57.680 +07:00 [WRN] The response has already started, the error page middleware will not be executed.
2025-04-30 07:51:57.680 +07:00 [WRN] The response has already started, the error page middleware will not be executed.
2025-04-30 07:51:57.681 +07:00 [ERR] Connection id "0HNC76IAKB3AS", Request id "0HNC76IAKB3AS:00000001": An unhandled exception was thrown by the application.
System.Net.WebSockets.WebSocketException (0x80004005): The remote party closed the WebSocket connection without completing the close handshake.
 ---> Microsoft.AspNetCore.Connections.ConnectionResetException: An existing connection was forcibly closed by the remote host.
 ---> System.Net.Sockets.SocketException (10054): An existing connection was forcibly closed by the remote host.
   --- End of inner exception stack trace ---
   at System.IO.Pipelines.Pipe.GetReadAsyncResult()
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.Http.Http1UpgradeMessageBody.ReadAsyncInternalAwaited(ValueTask`1 readTask, CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.Http.HttpRequestStream.ReadAsyncInternal(Memory`1 destination, CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at System.IO.Stream.ReadAtLeastAsyncCore(Memory`1 buffer, Int32 minimumBytes, Boolean throwOnEndOfStream, CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at System.Net.WebSockets.ManagedWebSocket.EnsureBufferContainsAsync(Int32 minimumRequiredBytes, CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.WebSockets.ManagedWebSocket.ReceiveAsyncPrivate[TResult](Memory`1 payloadBuffer, CancellationToken cancellationToken)
   at System.Net.WebSockets.ManagedWebSocket.ReceiveAsyncPrivate[TResult](Memory`1 payloadBuffer, CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at System.Threading.Tasks.ValueTask`1.ValueTaskSourceAsTask.<>c.<.cctor>b__4_0(Object state)
--- End of stack trace from previous location ---
   at server.Services.WebSocketService.webSocket.Receiver(Client client) in C:\Users\Thao\source\Flutter\Message_app\server\Services\WebSocketService\websocket.cs:line 108
   at server.Services.WebSocketService.webSocket.HandleWebSocket(HttpContext context) in C:\Users\Thao\source\Flutter\Message_app\server\Services\WebSocketService\websocket.cs:line 91
   at Program.<>c.<<<Main>$>b__0_4>d.MoveNext() in C:\Users\Thao\source\Flutter\Message_app\server\Program.cs:line 89
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Watch.BrowserRefresh.BrowserRefreshMiddleware.InvokeAsync(HttpContext context)
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.Http.HttpProtocol.ProcessRequests[TContext](IHttpApplication`1 application)
2025-04-30 07:51:57.681 +07:00 [ERR] Connection id "0HNC76IAKB3B4", Request id "0HNC76IAKB3B4:00000001": An unhandled exception was thrown by the application.
System.Net.WebSockets.WebSocketException (0x80004005): The remote party closed the WebSocket connection without completing the close handshake.
   at System.Net.WebSockets.ManagedWebSocket.ThrowEOFUnexpected()
   at System.Net.WebSockets.ManagedWebSocket.EnsureBufferContainsAsync(Int32 minimumRequiredBytes, CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.WebSockets.ManagedWebSocket.ReceiveAsyncPrivate[TResult](Memory`1 payloadBuffer, CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at System.Threading.Tasks.ValueTask`1.ValueTaskSourceAsTask.<>c.<.cctor>b__4_0(Object state)
--- End of stack trace from previous location ---
   at server.Services.WebSocketService.webSocket.Receiver(Client client) in C:\Users\Thao\source\Flutter\Message_app\server\Services\WebSocketService\websocket.cs:line 108
   at server.Services.WebSocketService.webSocket.HandleWebSocket(HttpContext context) in C:\Users\Thao\source\Flutter\Message_app\server\Services\WebSocketService\websocket.cs:line 91
   at Program.<>c.<<<Main>$>b__0_4>d.MoveNext() in C:\Users\Thao\source\Flutter\Message_app\server\Program.cs:line 89
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Watch.BrowserRefresh.BrowserRefreshMiddleware.InvokeAsync(HttpContext context)
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.Http.HttpProtocol.ProcessRequests[TContext](IHttpApplication`1 application)
2025-04-30 07:51:57.684 +07:00 [INF] Request finished HTTP/1.1 GET http://192.168.1.9:5053/ws/chat?userId=2 - 101 null null 48130.5091ms
2025-04-30 07:51:57.686 +07:00 [INF] Request finished HTTP/1.1 GET http://192.168.1.9:5053/ws/chat?userId=2 - 101 null null 5387.8678ms
2025-04-30 08:35:04.066 +07:00 [INF] Executed endpoint '/ws/chat'
2025-04-30 08:35:04.067 +07:00 [ERR] An unhandled exception has occurred while executing the request.
System.Net.WebSockets.WebSocketException (0x80004005): The remote party closed the WebSocket connection without completing the close handshake.
   at System.Net.WebSockets.ManagedWebSocket.ThrowEOFUnexpected()
   at System.Net.WebSockets.ManagedWebSocket.EnsureBufferContainsAsync(Int32 minimumRequiredBytes, CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.WebSockets.ManagedWebSocket.ReceiveAsyncPrivate[TResult](Memory`1 payloadBuffer, CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at System.Threading.Tasks.ValueTask`1.ValueTaskSourceAsTask.<>c.<.cctor>b__4_0(Object state)
--- End of stack trace from previous location ---
   at server.Services.WebSocketService.webSocket.Receiver(Client client) in C:\Users\Thao\source\Flutter\Message_app\server\Services\WebSocketService\websocket.cs:line 108
   at server.Services.WebSocketService.webSocket.HandleWebSocket(HttpContext context) in C:\Users\Thao\source\Flutter\Message_app\server\Services\WebSocketService\websocket.cs:line 91
   at Program.<>c.<<<Main>$>b__0_4>d.MoveNext() in C:\Users\Thao\source\Flutter\Message_app\server\Program.cs:line 89
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
2025-04-30 08:35:04.084 +07:00 [WRN] The response has already started, the error page middleware will not be executed.
2025-04-30 08:35:04.084 +07:00 [ERR] Connection id "0HNC76IAKB3AH", Request id "0HNC76IAKB3AH:00000001": An unhandled exception was thrown by the application.
System.Net.WebSockets.WebSocketException (0x80004005): The remote party closed the WebSocket connection without completing the close handshake.
   at System.Net.WebSockets.ManagedWebSocket.ThrowEOFUnexpected()
   at System.Net.WebSockets.ManagedWebSocket.EnsureBufferContainsAsync(Int32 minimumRequiredBytes, CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.WebSockets.ManagedWebSocket.ReceiveAsyncPrivate[TResult](Memory`1 payloadBuffer, CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at System.Threading.Tasks.ValueTask`1.ValueTaskSourceAsTask.<>c.<.cctor>b__4_0(Object state)
--- End of stack trace from previous location ---
   at server.Services.WebSocketService.webSocket.Receiver(Client client) in C:\Users\Thao\source\Flutter\Message_app\server\Services\WebSocketService\websocket.cs:line 108
   at server.Services.WebSocketService.webSocket.HandleWebSocket(HttpContext context) in C:\Users\Thao\source\Flutter\Message_app\server\Services\WebSocketService\websocket.cs:line 91
   at Program.<>c.<<<Main>$>b__0_4>d.MoveNext() in C:\Users\Thao\source\Flutter\Message_app\server\Program.cs:line 89
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Watch.BrowserRefresh.BrowserRefreshMiddleware.InvokeAsync(HttpContext context)
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.Http.HttpProtocol.ProcessRequests[TContext](IHttpApplication`1 application)
2025-04-30 08:35:04.099 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5053/ws/chat?userId=5 - 101 null null 3022934.1093ms
2025-04-30 08:35:04.100 +07:00 [INF] Executed endpoint '/ws/chat'
2025-04-30 08:35:04.135 +07:00 [INF] Executed endpoint '/ws/chat'
2025-04-30 08:35:04.148 +07:00 [ERR] An unhandled exception has occurred while executing the request.
System.Net.WebSockets.WebSocketException (0x80004005): The remote party closed the WebSocket connection without completing the close handshake.
   at System.Net.WebSockets.ManagedWebSocket.ThrowEOFUnexpected()
   at System.Net.WebSockets.ManagedWebSocket.EnsureBufferContainsAsync(Int32 minimumRequiredBytes, CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.WebSockets.ManagedWebSocket.ReceiveAsyncPrivate[TResult](Memory`1 payloadBuffer, CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at System.Threading.Tasks.ValueTask`1.ValueTaskSourceAsTask.<>c.<.cctor>b__4_0(Object state)
--- End of stack trace from previous location ---
   at server.Services.WebSocketService.webSocket.Receiver(Client client) in C:\Users\Thao\source\Flutter\Message_app\server\Services\WebSocketService\websocket.cs:line 108
   at server.Services.WebSocketService.webSocket.HandleWebSocket(HttpContext context) in C:\Users\Thao\source\Flutter\Message_app\server\Services\WebSocketService\websocket.cs:line 91
   at Program.<>c.<<<Main>$>b__0_4>d.MoveNext() in C:\Users\Thao\source\Flutter\Message_app\server\Program.cs:line 89
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
2025-04-30 08:35:04.148 +07:00 [ERR] An unhandled exception has occurred while executing the request.
System.Net.WebSockets.WebSocketException (0x80004005): The remote party closed the WebSocket connection without completing the close handshake.
   at System.Net.WebSockets.ManagedWebSocket.ThrowEOFUnexpected()
   at System.Net.WebSockets.ManagedWebSocket.EnsureBufferContainsAsync(Int32 minimumRequiredBytes, CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.WebSockets.ManagedWebSocket.ReceiveAsyncPrivate[TResult](Memory`1 payloadBuffer, CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at System.Threading.Tasks.ValueTask`1.ValueTaskSourceAsTask.<>c.<.cctor>b__4_0(Object state)
--- End of stack trace from previous location ---
   at server.Services.WebSocketService.webSocket.Receiver(Client client) in C:\Users\Thao\source\Flutter\Message_app\server\Services\WebSocketService\websocket.cs:line 108
   at server.Services.WebSocketService.webSocket.HandleWebSocket(HttpContext context) in C:\Users\Thao\source\Flutter\Message_app\server\Services\WebSocketService\websocket.cs:line 91
   at Program.<>c.<<<Main>$>b__0_4>d.MoveNext() in C:\Users\Thao\source\Flutter\Message_app\server\Program.cs:line 89
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
2025-04-30 08:35:04.247 +07:00 [WRN] The response has already started, the error page middleware will not be executed.
2025-04-30 08:35:04.258 +07:00 [WRN] The response has already started, the error page middleware will not be executed.
2025-04-30 08:35:04.258 +07:00 [ERR] Connection id "0HNC76IAKB3AO", Request id "0HNC76IAKB3AO:00000001": An unhandled exception was thrown by the application.
System.Net.WebSockets.WebSocketException (0x80004005): The remote party closed the WebSocket connection without completing the close handshake.
   at System.Net.WebSockets.ManagedWebSocket.ThrowEOFUnexpected()
   at System.Net.WebSockets.ManagedWebSocket.EnsureBufferContainsAsync(Int32 minimumRequiredBytes, CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.WebSockets.ManagedWebSocket.ReceiveAsyncPrivate[TResult](Memory`1 payloadBuffer, CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at System.Threading.Tasks.ValueTask`1.ValueTaskSourceAsTask.<>c.<.cctor>b__4_0(Object state)
--- End of stack trace from previous location ---
   at server.Services.WebSocketService.webSocket.Receiver(Client client) in C:\Users\Thao\source\Flutter\Message_app\server\Services\WebSocketService\websocket.cs:line 108
   at server.Services.WebSocketService.webSocket.HandleWebSocket(HttpContext context) in C:\Users\Thao\source\Flutter\Message_app\server\Services\WebSocketService\websocket.cs:line 91
   at Program.<>c.<<<Main>$>b__0_4>d.MoveNext() in C:\Users\Thao\source\Flutter\Message_app\server\Program.cs:line 89
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Watch.BrowserRefresh.BrowserRefreshMiddleware.InvokeAsync(HttpContext context)
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.Http.HttpProtocol.ProcessRequests[TContext](IHttpApplication`1 application)
2025-04-30 08:35:04.258 +07:00 [ERR] Connection id "0HNC76IAKB3AB", Request id "0HNC76IAKB3AB:00000001": An unhandled exception was thrown by the application.
System.Net.WebSockets.WebSocketException (0x80004005): The remote party closed the WebSocket connection without completing the close handshake.
   at System.Net.WebSockets.ManagedWebSocket.ThrowEOFUnexpected()
   at System.Net.WebSockets.ManagedWebSocket.EnsureBufferContainsAsync(Int32 minimumRequiredBytes, CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.WebSockets.ManagedWebSocket.ReceiveAsyncPrivate[TResult](Memory`1 payloadBuffer, CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at System.Threading.Tasks.ValueTask`1.ValueTaskSourceAsTask.<>c.<.cctor>b__4_0(Object state)
--- End of stack trace from previous location ---
   at server.Services.WebSocketService.webSocket.Receiver(Client client) in C:\Users\Thao\source\Flutter\Message_app\server\Services\WebSocketService\websocket.cs:line 108
   at server.Services.WebSocketService.webSocket.HandleWebSocket(HttpContext context) in C:\Users\Thao\source\Flutter\Message_app\server\Services\WebSocketService\websocket.cs:line 91
   at Program.<>c.<<<Main>$>b__0_4>d.MoveNext() in C:\Users\Thao\source\Flutter\Message_app\server\Program.cs:line 89
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Watch.BrowserRefresh.BrowserRefreshMiddleware.InvokeAsync(HttpContext context)
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.Http.HttpProtocol.ProcessRequests[TContext](IHttpApplication`1 application)
2025-04-30 08:35:04.320 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5053/ws/chat?userId=5 - 101 null null 3167151.0512ms
2025-04-30 08:35:04.267 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5053/ws/chat?userId=5 - 101 null null 2661814.3964ms
2025-04-30 08:35:04.341 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/ws/chat?userId=5 - null null
2025-04-30 08:35:04.457 +07:00 [INF] CORS policy execution successful.
2025-04-30 08:35:04.457 +07:00 [INF] CORS policy execution successful.
2025-04-30 08:35:04.457 +07:00 [INF] Executing endpoint '/ws/chat'
2025-04-30 08:35:04.715 +07:00 [INF] Executed endpoint '/ws/chat'
2025-04-30 08:35:04.715 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5053/ws/chat?userId=5 - 101 null null 374.1213ms
2025-04-30 08:38:32.029 +07:00 [INF] Application is shutting down...
2025-04-30 08:38:39.911 +07:00 [INF] Executed DbCommand (40ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [u].[id], [u].[username], [u].[avatar_url]
FROM [Users] AS [u]
2025-04-30 08:38:40.037 +07:00 [INF] User profile is available. Using 'C:\Users\Thao\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-04-30 08:38:40.093 +07:00 [WRN] Overriding address(es) 'http://localhost:5053'. Binding to endpoints defined via IConfiguration and/or UseKestrel() instead.
2025-04-30 08:38:40.101 +07:00 [INF] Now listening on: http://[::]:5053
2025-04-30 08:38:40.101 +07:00 [INF] Now listening on: http://0.0.0.0:5053
2025-04-30 08:38:40.102 +07:00 [INF] Application started. Press Ctrl+C to shut down.
2025-04-30 08:38:40.102 +07:00 [INF] Hosting environment: Development
2025-04-30 08:38:40.102 +07:00 [INF] Content root path: C:\Users\Thao\source\Flutter\Message_app\server
2025-04-30 08:38:43.008 +07:00 [INF] Request starting HTTP/1.1 POST http://192.168.1.9:5053/api/Auth/login - application/json 57
2025-04-30 08:38:43.044 +07:00 [WRN] Failed to determine the https port for redirect.
2025-04-30 08:38:43.064 +07:00 [INF] Executing endpoint 'Message_app.Controllers.AuthController.Login (Message_app)'
2025-04-30 08:38:43.077 +07:00 [INF] Route matched with {action = "Login", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Login(server.DTO.AuthDTO.LoginDTO) on controller Message_app.Controllers.AuthController (Message_app).
2025-04-30 08:38:43.209 +07:00 [INF] Executed DbCommand (16ms) [Parameters=[@__email_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[id], [u].[avatar_url], [u].[bio], [u].[birthday], [u].[created_at], [u].[email], [u].[gender], [u].[interests], [u].[location], [u].[password], [u].[passwordSalt], [u].[username]
FROM [Users] AS [u]
WHERE [u].[email] = @__email_0
2025-04-30 08:38:43.270 +07:00 [INF] Executing BadRequestObjectResult, writing value of type 'System.String'.
2025-04-30 08:38:43.281 +07:00 [INF] Executed action Message_app.Controllers.AuthController.Login (Message_app) in 201.6495ms
2025-04-30 08:38:43.282 +07:00 [INF] Executed endpoint 'Message_app.Controllers.AuthController.Login (Message_app)'
2025-04-30 08:38:43.286 +07:00 [INF] Request finished HTTP/1.1 POST http://192.168.1.9:5053/api/Auth/login - 400 null application/json; charset=utf-8 279.1306ms
2025-04-30 08:38:47.722 +07:00 [INF] Request starting HTTP/1.1 POST http://192.168.1.9:5053/api/Auth/login - application/json 57
2025-04-30 08:38:47.726 +07:00 [INF] Executing endpoint 'Message_app.Controllers.AuthController.Login (Message_app)'
2025-04-30 08:38:47.726 +07:00 [INF] Route matched with {action = "Login", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Login(server.DTO.AuthDTO.LoginDTO) on controller Message_app.Controllers.AuthController (Message_app).
2025-04-30 08:38:47.775 +07:00 [INF] Executed DbCommand (6ms) [Parameters=[@__email_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[id], [u].[avatar_url], [u].[bio], [u].[birthday], [u].[created_at], [u].[email], [u].[gender], [u].[interests], [u].[location], [u].[password], [u].[passwordSalt], [u].[username]
FROM [Users] AS [u]
WHERE [u].[email] = @__email_0
2025-04-30 08:38:47.790 +07:00 [INF] Executing OkObjectResult, writing value of type 'server.DTO.AuthDTO.LoginRespose'.
2025-04-30 08:38:47.826 +07:00 [INF] Executed action Message_app.Controllers.AuthController.Login (Message_app) in 99.1687ms
2025-04-30 08:38:47.826 +07:00 [INF] Executed endpoint 'Message_app.Controllers.AuthController.Login (Message_app)'
2025-04-30 08:38:47.827 +07:00 [INF] Request finished HTTP/1.1 POST http://192.168.1.9:5053/api/Auth/login - 200 null application/json; charset=utf-8 104.5293ms
2025-04-30 08:38:48.927 +07:00 [INF] Request starting HTTP/1.1 GET http://192.168.1.9:5053/api/Conversation/get_conversations/2 - null null
2025-04-30 08:38:48.929 +07:00 [INF] Request starting HTTP/1.1 GET http://192.168.1.9:5053/api/Conversation/get_conversations/2 - null null
2025-04-30 08:38:48.934 +07:00 [INF] Executing endpoint 'server.Controllers.ConversationController.GetConversations (Message_app)'
2025-04-30 08:38:48.934 +07:00 [INF] Executing endpoint 'server.Controllers.ConversationController.GetConversations (Message_app)'
2025-04-30 08:38:48.937 +07:00 [INF] Route matched with {action = "GetConversations", controller = "Conversation"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetConversations(Int32) on controller server.Controllers.ConversationController (Message_app).
2025-04-30 08:38:48.939 +07:00 [INF] Route matched with {action = "GetConversations", controller = "Conversation"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetConversations(Int32) on controller server.Controllers.ConversationController (Message_app).
2025-04-30 08:38:48.958 +07:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[server.DTO.ConversationDto, Message_app, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-04-30 08:38:48.958 +07:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[server.DTO.ConversationDto, Message_app, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-04-30 08:38:48.962 +07:00 [INF] Executed action server.Controllers.ConversationController.GetConversations (Message_app) in 24.7902ms
2025-04-30 08:38:48.962 +07:00 [INF] Executed action server.Controllers.ConversationController.GetConversations (Message_app) in 23.4412ms
2025-04-30 08:38:48.962 +07:00 [INF] Executed endpoint 'server.Controllers.ConversationController.GetConversations (Message_app)'
2025-04-30 08:38:48.962 +07:00 [INF] Executed endpoint 'server.Controllers.ConversationController.GetConversations (Message_app)'
2025-04-30 08:38:48.963 +07:00 [INF] Request finished HTTP/1.1 GET http://192.168.1.9:5053/api/Conversation/get_conversations/2 - 200 null application/json; charset=utf-8 35.2866ms
2025-04-30 08:38:48.963 +07:00 [INF] Request finished HTTP/1.1 GET http://192.168.1.9:5053/api/Conversation/get_conversations/2 - 200 null application/json; charset=utf-8 33.6571ms
2025-04-30 08:38:49.052 +07:00 [INF] Request starting HTTP/1.1 GET http://192.168.1.9:5053/ws/chat?userId=2 - null null
2025-04-30 08:38:49.053 +07:00 [INF] Executing endpoint '/ws/chat'
2025-04-30 08:38:49.250 +07:00 [INF] Executed DbCommand (8ms) [Parameters=[@__client_UserId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[conversation_id]
FROM [Participants] AS [p]
WHERE [p].[user_id] = @__client_UserId_0 AND [p].[is_deleted] = CAST(0 AS bit)
2025-04-30 08:39:03.306 +07:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5053/api/Auth/login - null null
2025-04-30 08:39:03.307 +07:00 [INF] CORS policy execution successful.
2025-04-30 08:39:03.309 +07:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5053/api/Auth/login - 204 null null 2.5816ms
2025-04-30 08:39:03.310 +07:00 [INF] Request starting HTTP/1.1 POST http://localhost:5053/api/Auth/login - application/json 53
2025-04-30 08:39:03.310 +07:00 [INF] CORS policy execution successful.
2025-04-30 08:39:03.313 +07:00 [INF] CORS policy execution successful.
2025-04-30 08:39:03.313 +07:00 [INF] Executing endpoint 'Message_app.Controllers.AuthController.Login (Message_app)'
2025-04-30 08:39:03.313 +07:00 [INF] Route matched with {action = "Login", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Login(server.DTO.AuthDTO.LoginDTO) on controller Message_app.Controllers.AuthController (Message_app).
2025-04-30 08:39:03.322 +07:00 [INF] Executed DbCommand (4ms) [Parameters=[@__email_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[id], [u].[avatar_url], [u].[bio], [u].[birthday], [u].[created_at], [u].[email], [u].[gender], [u].[interests], [u].[location], [u].[password], [u].[passwordSalt], [u].[username]
FROM [Users] AS [u]
WHERE [u].[email] = @__email_0
2025-04-30 08:39:03.323 +07:00 [INF] Executing OkObjectResult, writing value of type 'server.DTO.AuthDTO.LoginRespose'.
2025-04-30 08:39:03.325 +07:00 [INF] Executed action Message_app.Controllers.AuthController.Login (Message_app) in 11.1931ms
2025-04-30 08:39:03.325 +07:00 [INF] Executed endpoint 'Message_app.Controllers.AuthController.Login (Message_app)'
2025-04-30 08:39:03.325 +07:00 [INF] Request finished HTTP/1.1 POST http://localhost:5053/api/Auth/login - 200 null application/json; charset=utf-8 15.1266ms
2025-04-30 08:39:03.525 +07:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5053/api/Conversation/get_conversations/5 - null null
2025-04-30 08:39:03.525 +07:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5053/api/Conversation/get_conversations/5 - null null
2025-04-30 08:39:03.526 +07:00 [INF] CORS policy execution successful.
2025-04-30 08:39:03.526 +07:00 [INF] CORS policy execution successful.
2025-04-30 08:39:03.526 +07:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5053/api/Conversation/get_conversations/5 - 204 null null 0.3548ms
2025-04-30 08:39:03.526 +07:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5053/api/Conversation/get_conversations/5 - 204 null null 0.2007ms
2025-04-30 08:39:03.527 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/api/Conversation/get_conversations/5 - null null
2025-04-30 08:39:03.527 +07:00 [INF] CORS policy execution successful.
2025-04-30 08:39:03.528 +07:00 [INF] CORS policy execution successful.
2025-04-30 08:39:03.528 +07:00 [INF] Executing endpoint 'server.Controllers.ConversationController.GetConversations (Message_app)'
2025-04-30 08:39:03.528 +07:00 [INF] Route matched with {action = "GetConversations", controller = "Conversation"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetConversations(Int32) on controller server.Controllers.ConversationController (Message_app).
2025-04-30 08:39:03.530 +07:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[server.DTO.ConversationDto, Message_app, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-04-30 08:39:03.531 +07:00 [INF] Executed action server.Controllers.ConversationController.GetConversations (Message_app) in 2.3899ms
2025-04-30 08:39:03.531 +07:00 [INF] Executed endpoint 'server.Controllers.ConversationController.GetConversations (Message_app)'
2025-04-30 08:39:03.531 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5053/api/Conversation/get_conversations/5 - 200 null application/json; charset=utf-8 4.0184ms
2025-04-30 08:39:03.532 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/api/Conversation/get_conversations/5 - null null
2025-04-30 08:39:03.532 +07:00 [INF] CORS policy execution successful.
2025-04-30 08:39:03.532 +07:00 [INF] CORS policy execution successful.
2025-04-30 08:39:03.532 +07:00 [INF] Executing endpoint 'server.Controllers.ConversationController.GetConversations (Message_app)'
2025-04-30 08:39:03.533 +07:00 [INF] Route matched with {action = "GetConversations", controller = "Conversation"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetConversations(Int32) on controller server.Controllers.ConversationController (Message_app).
2025-04-30 08:39:03.535 +07:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[server.DTO.ConversationDto, Message_app, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-04-30 08:39:03.536 +07:00 [INF] Executed action server.Controllers.ConversationController.GetConversations (Message_app) in 2.9394ms
2025-04-30 08:39:03.536 +07:00 [INF] Executed endpoint 'server.Controllers.ConversationController.GetConversations (Message_app)'
2025-04-30 08:39:03.536 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5053/api/Conversation/get_conversations/5 - 200 null application/json; charset=utf-8 4.2854ms
2025-04-30 08:39:03.638 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/ws/chat?userId=5 - null null
2025-04-30 08:39:03.638 +07:00 [INF] CORS policy execution successful.
2025-04-30 08:39:03.639 +07:00 [INF] CORS policy execution successful.
2025-04-30 08:39:03.639 +07:00 [INF] Executing endpoint '/ws/chat'
2025-04-30 08:39:03.649 +07:00 [INF] Executed DbCommand (4ms) [Parameters=[@__client_UserId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[conversation_id]
FROM [Participants] AS [p]
WHERE [p].[user_id] = @__client_UserId_0 AND [p].[is_deleted] = CAST(0 AS bit)
2025-04-30 08:39:05.844 +07:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5053/api/Message/getMessages/1/5 - null null
2025-04-30 08:39:05.844 +07:00 [INF] CORS policy execution successful.
2025-04-30 08:39:05.845 +07:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5053/api/Message/getMessages/1/5 - 204 null null 0.416ms
2025-04-30 08:39:05.846 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/api/Message/getMessages/1/5 - null null
2025-04-30 08:39:05.846 +07:00 [INF] CORS policy execution successful.
2025-04-30 08:39:05.846 +07:00 [INF] CORS policy execution successful.
2025-04-30 08:39:05.846 +07:00 [INF] Executing endpoint 'server.Controllers.MessageController.GetMessages (Message_app)'
2025-04-30 08:39:05.849 +07:00 [INF] Route matched with {action = "GetMessages", controller = "Message"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetMessages(Int32, Int32) on controller server.Controllers.MessageController (Message_app).
2025-04-30 08:39:05.879 +07:00 [WRN] Message 81 not found in Redis
2025-04-30 08:39:05.880 +07:00 [WRN] Message 80 not found in Redis
2025-04-30 08:39:05.880 +07:00 [WRN] Message 79 not found in Redis
2025-04-30 08:39:05.881 +07:00 [WRN] Message 78 not found in Redis
2025-04-30 08:39:05.881 +07:00 [WRN] Message 77 not found in Redis
2025-04-30 08:39:05.881 +07:00 [WRN] Message 76 not found in Redis
2025-04-30 08:39:05.881 +07:00 [WRN] Message 75 not found in Redis
2025-04-30 08:39:05.882 +07:00 [WRN] Message 74 not found in Redis
2025-04-30 08:39:05.882 +07:00 [WRN] Message 73 not found in Redis
2025-04-30 08:39:05.882 +07:00 [WRN] Message 72 not found in Redis
2025-04-30 08:39:05.882 +07:00 [WRN] Message 71 not found in Redis
2025-04-30 08:39:05.883 +07:00 [WRN] Message 68 not found in Redis
2025-04-30 08:39:05.883 +07:00 [WRN] Message 64 not found in Redis
2025-04-30 08:39:05.883 +07:00 [WRN] Message 62 not found in Redis
2025-04-30 08:39:05.884 +07:00 [WRN] Message 61 not found in Redis
2025-04-30 08:39:05.884 +07:00 [WRN] Message 60 not found in Redis
2025-04-30 08:39:05.884 +07:00 [WRN] Message 59 not found in Redis
2025-04-30 08:39:05.884 +07:00 [WRN] Message 57 not found in Redis
2025-04-30 08:39:05.885 +07:00 [WRN] Message 55 not found in Redis
2025-04-30 08:39:05.885 +07:00 [WRN] Message 54 not found in Redis
2025-04-30 08:39:05.885 +07:00 [WRN] Message 51 not found in Redis
2025-04-30 08:39:05.885 +07:00 [WRN] Message 49 not found in Redis
2025-04-30 08:39:05.886 +07:00 [WRN] Message 11 not found in Redis
2025-04-30 08:39:05.886 +07:00 [WRN] Message 8 not found in Redis
2025-04-30 08:39:05.886 +07:00 [WRN] Message 3 not found in Redis
2025-04-30 08:39:05.886 +07:00 [WRN] Message 2 not found in Redis
2025-04-30 08:39:05.887 +07:00 [WRN] Message 1 not found in Redis
2025-04-30 08:39:05.887 +07:00 [INF] Retrieved 9 messages from Redis for conversation 1
2025-04-30 08:39:05.888 +07:00 [INF] Retrieved 9 messages from Redis for conversation 1 and user 5
2025-04-30 08:39:05.889 +07:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[server.DTO.MessageWithAttachment, Message_app, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-04-30 08:39:05.890 +07:00 [INF] Executed action server.Controllers.MessageController.GetMessages (Message_app) in 40.9891ms
2025-04-30 08:39:05.891 +07:00 [INF] Executed endpoint 'server.Controllers.MessageController.GetMessages (Message_app)'
2025-04-30 08:39:05.891 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5053/api/Message/getMessages/1/5 - 200 null application/json; charset=utf-8 44.965ms
2025-04-30 08:39:05.911 +07:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5053/api/Conversation/get_first_conversation/1 - null null
2025-04-30 08:39:05.912 +07:00 [INF] CORS policy execution successful.
2025-04-30 08:39:05.912 +07:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5053/api/Conversation/get_first_conversation/1 - 204 null null 0.285ms
2025-04-30 08:39:05.913 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/api/Conversation/get_first_conversation/1 - null null
2025-04-30 08:39:05.913 +07:00 [INF] CORS policy execution successful.
2025-04-30 08:39:05.913 +07:00 [INF] CORS policy execution successful.
2025-04-30 08:39:05.913 +07:00 [INF] Executing endpoint 'server.Controllers.ConversationController.GetFirstConversation (Message_app)'
2025-04-30 08:39:05.916 +07:00 [INF] Route matched with {action = "GetFirstConversation", controller = "Conversation"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetFirstConversation(Int32) on controller server.Controllers.ConversationController (Message_app).
2025-04-30 08:39:05.948 +07:00 [INF] Executed DbCommand (5ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[id], [c].[created_at], [c].[is_group], [c].[lastMessage], [c].[lastMessageSender], [c].[lastMessageTime], [c].[name]
FROM [Conversations] AS [c]
WHERE [c].[id] = @__p_0
2025-04-30 08:39:05.965 +07:00 [INF] Executing OkObjectResult, writing value of type 'server.Models.Conversation'.
2025-04-30 08:39:05.966 +07:00 [INF] Executed action server.Controllers.ConversationController.GetFirstConversation (Message_app) in 49.9419ms
2025-04-30 08:39:05.967 +07:00 [INF] Executed endpoint 'server.Controllers.ConversationController.GetFirstConversation (Message_app)'
2025-04-30 08:39:05.967 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5053/api/Conversation/get_first_conversation/1 - 200 null application/json; charset=utf-8 53.9093ms
2025-04-30 08:39:05.984 +07:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5053/api/Participant/get_participants/1 - null null
2025-04-30 08:39:05.984 +07:00 [INF] CORS policy execution successful.
2025-04-30 08:39:05.984 +07:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5053/api/Participant/get_participants/1 - 204 null null 0.4308ms
2025-04-30 08:39:05.987 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/api/Participant/get_participants/1 - null null
2025-04-30 08:39:05.987 +07:00 [INF] CORS policy execution successful.
2025-04-30 08:39:05.987 +07:00 [INF] CORS policy execution successful.
2025-04-30 08:39:05.987 +07:00 [INF] Executing endpoint 'server.Controllers.ParticipantController.GetParticipants (Message_app)'
2025-04-30 08:39:05.990 +07:00 [INF] Route matched with {action = "GetParticipants", controller = "Participant"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetParticipants(Int32) on controller server.Controllers.ParticipantController (Message_app).
2025-04-30 08:39:06.005 +07:00 [INF] Executed DbCommand (5ms) [Parameters=[@__conversation_id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[id], [p].[adder], [p].[conversation_id], [p].[is_deleted], [p].[joined_at], [p].[name], [p].[role], [p].[user_id]
FROM [Participants] AS [p]
WHERE [p].[conversation_id] = @__conversation_id_0
2025-04-30 08:39:06.018 +07:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType17`1[[System.Collections.Generic.List`1[[server.Models.Participants, Message_app, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-04-30 08:39:06.024 +07:00 [INF] Executed action server.Controllers.ParticipantController.GetParticipants (Message_app) in 34.0442ms
2025-04-30 08:39:06.024 +07:00 [INF] Executed endpoint 'server.Controllers.ParticipantController.GetParticipants (Message_app)'
2025-04-30 08:39:06.024 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5053/api/Participant/get_participants/1 - 200 null application/json; charset=utf-8 37.2424ms
2025-04-30 08:39:06.854 +07:00 [INF] Request starting HTTP/1.1 GET http://192.168.1.9:5053/api/Message/getMessages/1/2 - null null
2025-04-30 08:39:06.856 +07:00 [INF] Executing endpoint 'server.Controllers.MessageController.GetMessages (Message_app)'
2025-04-30 08:39:06.856 +07:00 [INF] Route matched with {action = "GetMessages", controller = "Message"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetMessages(Int32, Int32) on controller server.Controllers.MessageController (Message_app).
2025-04-30 08:39:06.863 +07:00 [WRN] Message 81 not found in Redis
2025-04-30 08:39:06.864 +07:00 [WRN] Message 80 not found in Redis
2025-04-30 08:39:06.864 +07:00 [WRN] Message 79 not found in Redis
2025-04-30 08:39:06.865 +07:00 [WRN] Message 78 not found in Redis
2025-04-30 08:39:06.865 +07:00 [WRN] Message 77 not found in Redis
2025-04-30 08:39:06.866 +07:00 [WRN] Message 76 not found in Redis
2025-04-30 08:39:06.866 +07:00 [WRN] Message 75 not found in Redis
2025-04-30 08:39:06.866 +07:00 [WRN] Message 74 not found in Redis
2025-04-30 08:39:06.867 +07:00 [WRN] Message 73 not found in Redis
2025-04-30 08:39:06.867 +07:00 [WRN] Message 72 not found in Redis
2025-04-30 08:39:06.868 +07:00 [WRN] Message 71 not found in Redis
2025-04-30 08:39:06.868 +07:00 [WRN] Message 68 not found in Redis
2025-04-30 08:39:06.868 +07:00 [WRN] Message 64 not found in Redis
2025-04-30 08:39:06.869 +07:00 [WRN] Message 62 not found in Redis
2025-04-30 08:39:06.869 +07:00 [WRN] Message 61 not found in Redis
2025-04-30 08:39:06.869 +07:00 [WRN] Message 60 not found in Redis
2025-04-30 08:39:06.870 +07:00 [WRN] Message 59 not found in Redis
2025-04-30 08:39:06.870 +07:00 [WRN] Message 57 not found in Redis
2025-04-30 08:39:06.870 +07:00 [WRN] Message 55 not found in Redis
2025-04-30 08:39:06.871 +07:00 [WRN] Message 54 not found in Redis
2025-04-30 08:39:06.871 +07:00 [WRN] Message 51 not found in Redis
2025-04-30 08:39:06.871 +07:00 [WRN] Message 49 not found in Redis
2025-04-30 08:39:06.871 +07:00 [WRN] Message 11 not found in Redis
2025-04-30 08:39:06.872 +07:00 [WRN] Message 8 not found in Redis
2025-04-30 08:39:06.872 +07:00 [WRN] Message 3 not found in Redis
2025-04-30 08:39:06.872 +07:00 [WRN] Message 2 not found in Redis
2025-04-30 08:39:06.872 +07:00 [WRN] Message 1 not found in Redis
2025-04-30 08:39:06.872 +07:00 [INF] Retrieved 9 messages from Redis for conversation 1
2025-04-30 08:39:06.872 +07:00 [INF] Retrieved 9 messages from Redis for conversation 1 and user 2
2025-04-30 08:39:06.872 +07:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[server.DTO.MessageWithAttachment, Message_app, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-04-30 08:39:06.873 +07:00 [INF] Executed action server.Controllers.MessageController.GetMessages (Message_app) in 17.0322ms
2025-04-30 08:39:06.873 +07:00 [INF] Executed endpoint 'server.Controllers.MessageController.GetMessages (Message_app)'
2025-04-30 08:39:06.873 +07:00 [INF] Request finished HTTP/1.1 GET http://192.168.1.9:5053/api/Message/getMessages/1/2 - 200 null application/json; charset=utf-8 18.4004ms
2025-04-30 08:39:06.905 +07:00 [INF] Request starting HTTP/1.1 GET http://192.168.1.9:5053/api/Conversation/get_first_conversation/1 - null null
2025-04-30 08:39:06.905 +07:00 [INF] Executing endpoint 'server.Controllers.ConversationController.GetFirstConversation (Message_app)'
2025-04-30 08:39:06.905 +07:00 [INF] Route matched with {action = "GetFirstConversation", controller = "Conversation"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetFirstConversation(Int32) on controller server.Controllers.ConversationController (Message_app).
2025-04-30 08:39:06.911 +07:00 [INF] Executed DbCommand (4ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[id], [c].[created_at], [c].[is_group], [c].[lastMessage], [c].[lastMessageSender], [c].[lastMessageTime], [c].[name]
FROM [Conversations] AS [c]
WHERE [c].[id] = @__p_0
2025-04-30 08:39:06.911 +07:00 [INF] Executing OkObjectResult, writing value of type 'server.Models.Conversation'.
2025-04-30 08:39:06.912 +07:00 [INF] Executed action server.Controllers.ConversationController.GetFirstConversation (Message_app) in 6.3425ms
2025-04-30 08:39:06.912 +07:00 [INF] Executed endpoint 'server.Controllers.ConversationController.GetFirstConversation (Message_app)'
2025-04-30 08:39:06.912 +07:00 [INF] Request finished HTTP/1.1 GET http://192.168.1.9:5053/api/Conversation/get_first_conversation/1 - 200 null application/json; charset=utf-8 6.9368ms
2025-04-30 08:39:06.939 +07:00 [INF] Request starting HTTP/1.1 GET http://192.168.1.9:5053/api/Participant/get_participants/1 - null null
2025-04-30 08:39:06.941 +07:00 [INF] Executing endpoint 'server.Controllers.ParticipantController.GetParticipants (Message_app)'
2025-04-30 08:39:06.941 +07:00 [INF] Route matched with {action = "GetParticipants", controller = "Participant"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetParticipants(Int32) on controller server.Controllers.ParticipantController (Message_app).
2025-04-30 08:39:06.949 +07:00 [INF] Executed DbCommand (6ms) [Parameters=[@__conversation_id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[id], [p].[adder], [p].[conversation_id], [p].[is_deleted], [p].[joined_at], [p].[name], [p].[role], [p].[user_id]
FROM [Participants] AS [p]
WHERE [p].[conversation_id] = @__conversation_id_0
2025-04-30 08:39:06.949 +07:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType17`1[[System.Collections.Generic.List`1[[server.Models.Participants, Message_app, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-04-30 08:39:06.949 +07:00 [INF] Executed action server.Controllers.ParticipantController.GetParticipants (Message_app) in 8.3204ms
2025-04-30 08:39:06.950 +07:00 [INF] Executed endpoint 'server.Controllers.ParticipantController.GetParticipants (Message_app)'
2025-04-30 08:39:06.950 +07:00 [INF] Request finished HTTP/1.1 GET http://192.168.1.9:5053/api/Participant/get_participants/1 - 200 null application/json; charset=utf-8 10.5079ms
2025-04-30 08:43:07.154 +07:00 [INF] Handling message from user 5: kj
2025-04-30 08:43:07.167 +07:00 [INF] Executed DbCommand (10ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[id], [c].[created_at], [c].[is_group], [c].[lastMessage], [c].[lastMessageSender], [c].[lastMessageTime], [c].[name]
FROM [Conversations] AS [c]
WHERE [c].[id] = @__p_0
2025-04-30 08:43:07.485 +07:00 [WRN] Savepoints are disabled because Multiple Active Result Sets (MARS) is enabled. If 'SaveChanges' fails, then the transaction cannot be automatically rolled back to a known clean state. Instead, the transaction should be rolled back by the application before retrying 'SaveChanges'. See https://go.microsoft.com/fwlink/?linkid=2149338 for more information and examples. To identify the code which triggers this warning, call 'ConfigureWarnings(w => w.Throw(SqlServerEventId.SavepointsDisabledBecauseOfMARS))'.
2025-04-30 08:43:07.516 +07:00 [INF] Executed DbCommand (24ms) [Parameters=[@p0='?' (Size = 500), @p1='?' (DbType = Int32), @p2='?' (DbType = DateTime2), @p3='?' (DbType = Boolean), @p4='?' (DbType = Boolean), @p5='?' (DbType = Boolean), @p6='?' (DbType = Int32), @p7='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Messages] ([content], [conversation_id], [created_at], [isFile], [isRecalled], [is_read], [sender_id], [type])
OUTPUT INSERTED.[id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7);
2025-04-30 08:43:07.565 +07:00 [INF] Message saved to DB with ID: 93
2025-04-30 08:43:07.575 +07:00 [WRN] Savepoints are disabled because Multiple Active Result Sets (MARS) is enabled. If 'SaveChanges' fails, then the transaction cannot be automatically rolled back to a known clean state. Instead, the transaction should be rolled back by the application before retrying 'SaveChanges'. See https://go.microsoft.com/fwlink/?linkid=2149338 for more information and examples. To identify the code which triggers this warning, call 'ConfigureWarnings(w => w.Throw(SqlServerEventId.SavepointsDisabledBecauseOfMARS))'.
2025-04-30 08:43:07.590 +07:00 [INF] Executed DbCommand (14ms) [Parameters=[@p6='?' (DbType = Int32), @p0='?' (DbType = DateTime2), @p1='?' (DbType = Boolean), @p2='?' (Size = 4000), @p3='?' (Size = 4000), @p4='?' (DbType = DateTime2), @p5='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
UPDATE [Conversations] SET [created_at] = @p0, [is_group] = @p1, [lastMessage] = @p2, [lastMessageSender] = @p3, [lastMessageTime] = @p4, [name] = @p5
OUTPUT 1
WHERE [id] = @p6;
2025-04-30 08:43:07.620 +07:00 [INF] Transaction committed for message: 93
2025-04-30 08:43:07.629 +07:00 [INF] Saved message 93 to Redis
2025-04-30 08:43:07.632 +07:00 [INF] Added message 93 to conversation 1
2025-04-30 08:43:07.644 +07:00 [INF] Published message to channel conversation:1
2025-04-30 08:43:16.590 +07:00 [INF] Request starting HTTP/1.1 GET http://192.168.1.9:5053/api/Message/getMessages/1/2 - null null
2025-04-30 08:43:16.591 +07:00 [INF] Executing endpoint 'server.Controllers.MessageController.GetMessages (Message_app)'
2025-04-30 08:43:16.591 +07:00 [INF] Route matched with {action = "GetMessages", controller = "Message"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetMessages(Int32, Int32) on controller server.Controllers.MessageController (Message_app).
2025-04-30 08:43:16.600 +07:00 [WRN] Message 81 not found in Redis
2025-04-30 08:43:16.600 +07:00 [WRN] Message 80 not found in Redis
2025-04-30 08:43:16.601 +07:00 [WRN] Message 79 not found in Redis
2025-04-30 08:43:16.601 +07:00 [WRN] Message 78 not found in Redis
2025-04-30 08:43:16.601 +07:00 [WRN] Message 77 not found in Redis
2025-04-30 08:43:16.601 +07:00 [WRN] Message 76 not found in Redis
2025-04-30 08:43:16.601 +07:00 [WRN] Message 75 not found in Redis
2025-04-30 08:43:16.601 +07:00 [WRN] Message 74 not found in Redis
2025-04-30 08:43:16.602 +07:00 [WRN] Message 73 not found in Redis
2025-04-30 08:43:16.602 +07:00 [WRN] Message 72 not found in Redis
2025-04-30 08:43:16.602 +07:00 [WRN] Message 71 not found in Redis
2025-04-30 08:43:16.602 +07:00 [WRN] Message 68 not found in Redis
2025-04-30 08:43:16.602 +07:00 [WRN] Message 64 not found in Redis
2025-04-30 08:43:16.603 +07:00 [WRN] Message 62 not found in Redis
2025-04-30 08:43:16.603 +07:00 [WRN] Message 61 not found in Redis
2025-04-30 08:43:16.603 +07:00 [WRN] Message 60 not found in Redis
2025-04-30 08:43:16.603 +07:00 [WRN] Message 59 not found in Redis
2025-04-30 08:43:16.603 +07:00 [WRN] Message 57 not found in Redis
2025-04-30 08:43:16.603 +07:00 [WRN] Message 55 not found in Redis
2025-04-30 08:43:16.604 +07:00 [WRN] Message 54 not found in Redis
2025-04-30 08:43:16.604 +07:00 [WRN] Message 51 not found in Redis
2025-04-30 08:43:16.604 +07:00 [WRN] Message 49 not found in Redis
2025-04-30 08:43:16.604 +07:00 [WRN] Message 11 not found in Redis
2025-04-30 08:43:16.604 +07:00 [WRN] Message 8 not found in Redis
2025-04-30 08:43:16.604 +07:00 [WRN] Message 3 not found in Redis
2025-04-30 08:43:16.605 +07:00 [WRN] Message 2 not found in Redis
2025-04-30 08:43:16.605 +07:00 [WRN] Message 1 not found in Redis
2025-04-30 08:43:16.605 +07:00 [INF] Retrieved 10 messages from Redis for conversation 1
2025-04-30 08:43:16.605 +07:00 [INF] Retrieved 10 messages from Redis for conversation 1 and user 2
2025-04-30 08:43:16.605 +07:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[server.DTO.MessageWithAttachment, Message_app, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-04-30 08:43:16.606 +07:00 [INF] Executed action server.Controllers.MessageController.GetMessages (Message_app) in 14.602ms
2025-04-30 08:43:16.606 +07:00 [INF] Executed endpoint 'server.Controllers.MessageController.GetMessages (Message_app)'
2025-04-30 08:43:16.606 +07:00 [INF] Request finished HTTP/1.1 GET http://192.168.1.9:5053/api/Message/getMessages/1/2 - 200 null application/json; charset=utf-8 16.112ms
2025-04-30 08:43:16.649 +07:00 [INF] Request starting HTTP/1.1 GET http://192.168.1.9:5053/api/Conversation/get_first_conversation/1 - null null
2025-04-30 08:43:16.649 +07:00 [INF] Executing endpoint 'server.Controllers.ConversationController.GetFirstConversation (Message_app)'
2025-04-30 08:43:16.649 +07:00 [INF] Route matched with {action = "GetFirstConversation", controller = "Conversation"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetFirstConversation(Int32) on controller server.Controllers.ConversationController (Message_app).
2025-04-30 08:43:16.651 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[id], [c].[created_at], [c].[is_group], [c].[lastMessage], [c].[lastMessageSender], [c].[lastMessageTime], [c].[name]
FROM [Conversations] AS [c]
WHERE [c].[id] = @__p_0
2025-04-30 08:43:16.652 +07:00 [INF] Executing OkObjectResult, writing value of type 'server.Models.Conversation'.
2025-04-30 08:43:16.652 +07:00 [INF] Executed action server.Controllers.ConversationController.GetFirstConversation (Message_app) in 2.9503ms
2025-04-30 08:43:16.652 +07:00 [INF] Executed endpoint 'server.Controllers.ConversationController.GetFirstConversation (Message_app)'
2025-04-30 08:43:16.652 +07:00 [INF] Request finished HTTP/1.1 GET http://192.168.1.9:5053/api/Conversation/get_first_conversation/1 - 200 null application/json; charset=utf-8 3.6423ms
2025-04-30 08:43:16.681 +07:00 [INF] Request starting HTTP/1.1 GET http://192.168.1.9:5053/api/Participant/get_participants/1 - null null
2025-04-30 08:43:16.682 +07:00 [INF] Executing endpoint 'server.Controllers.ParticipantController.GetParticipants (Message_app)'
2025-04-30 08:43:16.682 +07:00 [INF] Route matched with {action = "GetParticipants", controller = "Participant"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetParticipants(Int32) on controller server.Controllers.ParticipantController (Message_app).
2025-04-30 08:43:16.689 +07:00 [INF] Executed DbCommand (5ms) [Parameters=[@__conversation_id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[id], [p].[adder], [p].[conversation_id], [p].[is_deleted], [p].[joined_at], [p].[name], [p].[role], [p].[user_id]
FROM [Participants] AS [p]
WHERE [p].[conversation_id] = @__conversation_id_0
2025-04-30 08:43:16.689 +07:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType17`1[[System.Collections.Generic.List`1[[server.Models.Participants, Message_app, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-04-30 08:43:16.690 +07:00 [INF] Executed action server.Controllers.ParticipantController.GetParticipants (Message_app) in 7.7671ms
2025-04-30 08:43:16.690 +07:00 [INF] Executed endpoint 'server.Controllers.ParticipantController.GetParticipants (Message_app)'
2025-04-30 08:43:16.690 +07:00 [INF] Request finished HTTP/1.1 GET http://192.168.1.9:5053/api/Participant/get_participants/1 - 200 null application/json; charset=utf-8 9.1795ms
2025-04-30 08:43:23.228 +07:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5053/api/Message/getMessages/1/5 - null null
2025-04-30 08:43:23.228 +07:00 [INF] CORS policy execution successful.
2025-04-30 08:43:23.228 +07:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5053/api/Message/getMessages/1/5 - 204 null null 0.4441ms
2025-04-30 08:43:23.229 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/api/Message/getMessages/1/5 - null null
2025-04-30 08:43:23.230 +07:00 [INF] CORS policy execution successful.
2025-04-30 08:43:23.230 +07:00 [INF] CORS policy execution successful.
2025-04-30 08:43:23.230 +07:00 [INF] Executing endpoint 'server.Controllers.MessageController.GetMessages (Message_app)'
2025-04-30 08:43:23.230 +07:00 [INF] Route matched with {action = "GetMessages", controller = "Message"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetMessages(Int32, Int32) on controller server.Controllers.MessageController (Message_app).
2025-04-30 08:43:23.233 +07:00 [WRN] Message 81 not found in Redis
2025-04-30 08:43:23.233 +07:00 [WRN] Message 80 not found in Redis
2025-04-30 08:43:23.233 +07:00 [WRN] Message 79 not found in Redis
2025-04-30 08:43:23.233 +07:00 [WRN] Message 78 not found in Redis
2025-04-30 08:43:23.233 +07:00 [WRN] Message 77 not found in Redis
2025-04-30 08:43:23.234 +07:00 [WRN] Message 76 not found in Redis
2025-04-30 08:43:23.234 +07:00 [WRN] Message 75 not found in Redis
2025-04-30 08:43:23.234 +07:00 [WRN] Message 74 not found in Redis
2025-04-30 08:43:23.234 +07:00 [WRN] Message 73 not found in Redis
2025-04-30 08:43:23.235 +07:00 [WRN] Message 72 not found in Redis
2025-04-30 08:43:23.235 +07:00 [WRN] Message 71 not found in Redis
2025-04-30 08:43:23.235 +07:00 [WRN] Message 68 not found in Redis
2025-04-30 08:43:23.235 +07:00 [WRN] Message 64 not found in Redis
2025-04-30 08:43:23.236 +07:00 [WRN] Message 62 not found in Redis
2025-04-30 08:43:23.236 +07:00 [WRN] Message 61 not found in Redis
2025-04-30 08:43:23.236 +07:00 [WRN] Message 60 not found in Redis
2025-04-30 08:43:23.236 +07:00 [WRN] Message 59 not found in Redis
2025-04-30 08:43:23.237 +07:00 [WRN] Message 57 not found in Redis
2025-04-30 08:43:23.237 +07:00 [WRN] Message 55 not found in Redis
2025-04-30 08:43:23.237 +07:00 [WRN] Message 54 not found in Redis
2025-04-30 08:43:23.238 +07:00 [WRN] Message 51 not found in Redis
2025-04-30 08:43:23.238 +07:00 [WRN] Message 49 not found in Redis
2025-04-30 08:43:23.238 +07:00 [WRN] Message 11 not found in Redis
2025-04-30 08:43:23.238 +07:00 [WRN] Message 8 not found in Redis
2025-04-30 08:43:23.239 +07:00 [WRN] Message 3 not found in Redis
2025-04-30 08:43:23.239 +07:00 [WRN] Message 2 not found in Redis
2025-04-30 08:43:23.239 +07:00 [WRN] Message 1 not found in Redis
2025-04-30 08:43:23.239 +07:00 [INF] Retrieved 10 messages from Redis for conversation 1
2025-04-30 08:43:23.239 +07:00 [INF] Retrieved 10 messages from Redis for conversation 1 and user 5
2025-04-30 08:43:23.239 +07:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[server.DTO.MessageWithAttachment, Message_app, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-04-30 08:43:23.239 +07:00 [INF] Executed action server.Controllers.MessageController.GetMessages (Message_app) in 9.6117ms
2025-04-30 08:43:23.240 +07:00 [INF] Executed endpoint 'server.Controllers.MessageController.GetMessages (Message_app)'
2025-04-30 08:43:23.240 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5053/api/Message/getMessages/1/5 - 200 null application/json; charset=utf-8 10.1873ms
2025-04-30 08:43:23.260 +07:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5053/api/Conversation/get_first_conversation/1 - null null
2025-04-30 08:43:23.260 +07:00 [INF] CORS policy execution successful.
2025-04-30 08:43:23.260 +07:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5053/api/Conversation/get_first_conversation/1 - 204 null null 0.2439ms
2025-04-30 08:43:23.261 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/api/Conversation/get_first_conversation/1 - null null
2025-04-30 08:43:23.261 +07:00 [INF] CORS policy execution successful.
2025-04-30 08:43:23.261 +07:00 [INF] CORS policy execution successful.
2025-04-30 08:43:23.261 +07:00 [INF] Executing endpoint 'server.Controllers.ConversationController.GetFirstConversation (Message_app)'
2025-04-30 08:43:23.261 +07:00 [INF] Route matched with {action = "GetFirstConversation", controller = "Conversation"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetFirstConversation(Int32) on controller server.Controllers.ConversationController (Message_app).
2025-04-30 08:43:23.263 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[id], [c].[created_at], [c].[is_group], [c].[lastMessage], [c].[lastMessageSender], [c].[lastMessageTime], [c].[name]
FROM [Conversations] AS [c]
WHERE [c].[id] = @__p_0
2025-04-30 08:43:23.264 +07:00 [INF] Executing OkObjectResult, writing value of type 'server.Models.Conversation'.
2025-04-30 08:43:23.264 +07:00 [INF] Executed action server.Controllers.ConversationController.GetFirstConversation (Message_app) in 3.0009ms
2025-04-30 08:43:23.264 +07:00 [INF] Executed endpoint 'server.Controllers.ConversationController.GetFirstConversation (Message_app)'
2025-04-30 08:43:23.264 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5053/api/Conversation/get_first_conversation/1 - 200 null application/json; charset=utf-8 3.6714ms
2025-04-30 08:43:23.279 +07:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5053/api/Participant/get_participants/1 - null null
2025-04-30 08:43:23.279 +07:00 [INF] CORS policy execution successful.
2025-04-30 08:43:23.279 +07:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5053/api/Participant/get_participants/1 - 204 null null 0.24ms
2025-04-30 08:43:23.280 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/api/Participant/get_participants/1 - null null
2025-04-30 08:43:23.280 +07:00 [INF] CORS policy execution successful.
2025-04-30 08:43:23.280 +07:00 [INF] CORS policy execution successful.
2025-04-30 08:43:23.281 +07:00 [INF] Executing endpoint 'server.Controllers.ParticipantController.GetParticipants (Message_app)'
2025-04-30 08:43:23.281 +07:00 [INF] Route matched with {action = "GetParticipants", controller = "Participant"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetParticipants(Int32) on controller server.Controllers.ParticipantController (Message_app).
2025-04-30 08:43:23.283 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__conversation_id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[id], [p].[adder], [p].[conversation_id], [p].[is_deleted], [p].[joined_at], [p].[name], [p].[role], [p].[user_id]
FROM [Participants] AS [p]
WHERE [p].[conversation_id] = @__conversation_id_0
2025-04-30 08:43:23.284 +07:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType17`1[[System.Collections.Generic.List`1[[server.Models.Participants, Message_app, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-04-30 08:43:23.284 +07:00 [INF] Executed action server.Controllers.ParticipantController.GetParticipants (Message_app) in 3.5771ms
2025-04-30 08:43:23.284 +07:00 [INF] Executed endpoint 'server.Controllers.ParticipantController.GetParticipants (Message_app)'
2025-04-30 08:43:23.285 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5053/api/Participant/get_participants/1 - 200 null application/json; charset=utf-8 4.5103ms
2025-04-30 08:43:33.685 +07:00 [INF] Handling message from user 2: hello
2025-04-30 08:43:33.689 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[id], [c].[created_at], [c].[is_group], [c].[lastMessage], [c].[lastMessageSender], [c].[lastMessageTime], [c].[name]
FROM [Conversations] AS [c]
WHERE [c].[id] = @__p_0
2025-04-30 08:43:33.699 +07:00 [WRN] Savepoints are disabled because Multiple Active Result Sets (MARS) is enabled. If 'SaveChanges' fails, then the transaction cannot be automatically rolled back to a known clean state. Instead, the transaction should be rolled back by the application before retrying 'SaveChanges'. See https://go.microsoft.com/fwlink/?linkid=2149338 for more information and examples. To identify the code which triggers this warning, call 'ConfigureWarnings(w => w.Throw(SqlServerEventId.SavepointsDisabledBecauseOfMARS))'.
2025-04-30 08:43:33.702 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[@p0='?' (Size = 500), @p1='?' (DbType = Int32), @p2='?' (DbType = DateTime2), @p3='?' (DbType = Boolean), @p4='?' (DbType = Boolean), @p5='?' (DbType = Boolean), @p6='?' (DbType = Int32), @p7='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Messages] ([content], [conversation_id], [created_at], [isFile], [isRecalled], [is_read], [sender_id], [type])
OUTPUT INSERTED.[id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7);
2025-04-30 08:43:33.704 +07:00 [INF] Message saved to DB with ID: 94
2025-04-30 08:43:33.706 +07:00 [WRN] Savepoints are disabled because Multiple Active Result Sets (MARS) is enabled. If 'SaveChanges' fails, then the transaction cannot be automatically rolled back to a known clean state. Instead, the transaction should be rolled back by the application before retrying 'SaveChanges'. See https://go.microsoft.com/fwlink/?linkid=2149338 for more information and examples. To identify the code which triggers this warning, call 'ConfigureWarnings(w => w.Throw(SqlServerEventId.SavepointsDisabledBecauseOfMARS))'.
2025-04-30 08:43:33.710 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[@p6='?' (DbType = Int32), @p0='?' (DbType = DateTime2), @p1='?' (DbType = Boolean), @p2='?' (Size = 4000), @p3='?' (Size = 4000), @p4='?' (DbType = DateTime2), @p5='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
UPDATE [Conversations] SET [created_at] = @p0, [is_group] = @p1, [lastMessage] = @p2, [lastMessageSender] = @p3, [lastMessageTime] = @p4, [name] = @p5
OUTPUT 1
WHERE [id] = @p6;
2025-04-30 08:43:33.712 +07:00 [INF] Transaction committed for message: 94
2025-04-30 08:43:33.716 +07:00 [INF] Saved message 94 to Redis
2025-04-30 08:43:33.717 +07:00 [INF] Added message 94 to conversation 1
2025-04-30 08:43:33.719 +07:00 [INF] Published message to channel conversation:1
2025-04-30 08:46:52.024 +07:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5053/api/Auth/login - null null
2025-04-30 08:46:52.025 +07:00 [INF] CORS policy execution successful.
2025-04-30 08:46:52.025 +07:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5053/api/Auth/login - 204 null null 0.7769ms
2025-04-30 08:46:52.026 +07:00 [INF] Request starting HTTP/1.1 POST http://localhost:5053/api/Auth/login - application/json 53
2025-04-30 08:46:52.027 +07:00 [INF] CORS policy execution successful.
2025-04-30 08:46:52.027 +07:00 [INF] CORS policy execution successful.
2025-04-30 08:46:52.027 +07:00 [INF] Executing endpoint 'Message_app.Controllers.AuthController.Login (Message_app)'
2025-04-30 08:46:52.027 +07:00 [INF] Route matched with {action = "Login", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Login(server.DTO.AuthDTO.LoginDTO) on controller Message_app.Controllers.AuthController (Message_app).
2025-04-30 08:46:52.041 +07:00 [INF] Executed DbCommand (10ms) [Parameters=[@__email_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[id], [u].[avatar_url], [u].[bio], [u].[birthday], [u].[created_at], [u].[email], [u].[gender], [u].[interests], [u].[location], [u].[password], [u].[passwordSalt], [u].[username]
FROM [Users] AS [u]
WHERE [u].[email] = @__email_0
2025-04-30 08:46:52.042 +07:00 [INF] Executing OkObjectResult, writing value of type 'server.DTO.AuthDTO.LoginRespose'.
2025-04-30 08:46:52.043 +07:00 [INF] Executed action Message_app.Controllers.AuthController.Login (Message_app) in 15.4164ms
2025-04-30 08:46:52.043 +07:00 [INF] Executed endpoint 'Message_app.Controllers.AuthController.Login (Message_app)'
2025-04-30 08:46:52.043 +07:00 [INF] Request finished HTTP/1.1 POST http://localhost:5053/api/Auth/login - 200 null application/json; charset=utf-8 17.0604ms
2025-04-30 08:46:52.246 +07:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5053/api/Conversation/get_conversations/5 - null null
2025-04-30 08:46:52.247 +07:00 [INF] CORS policy execution successful.
2025-04-30 08:46:52.247 +07:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5053/api/Conversation/get_conversations/5 - 204 null null 0.4218ms
2025-04-30 08:46:52.248 +07:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5053/api/Conversation/get_conversations/5 - null null
2025-04-30 08:46:52.248 +07:00 [INF] CORS policy execution successful.
2025-04-30 08:46:52.248 +07:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5053/api/Conversation/get_conversations/5 - 204 null null 0.5769ms
2025-04-30 08:46:52.249 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/api/Conversation/get_conversations/5 - null null
2025-04-30 08:46:52.250 +07:00 [INF] CORS policy execution successful.
2025-04-30 08:46:52.250 +07:00 [INF] CORS policy execution successful.
2025-04-30 08:46:52.250 +07:00 [INF] Executing endpoint 'server.Controllers.ConversationController.GetConversations (Message_app)'
2025-04-30 08:46:52.250 +07:00 [INF] Route matched with {action = "GetConversations", controller = "Conversation"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetConversations(Int32) on controller server.Controllers.ConversationController (Message_app).
2025-04-30 08:46:52.254 +07:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[server.DTO.ConversationDto, Message_app, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-04-30 08:46:52.254 +07:00 [INF] Executed action server.Controllers.ConversationController.GetConversations (Message_app) in 3.9068ms
2025-04-30 08:46:52.255 +07:00 [INF] Executed endpoint 'server.Controllers.ConversationController.GetConversations (Message_app)'
2025-04-30 08:46:52.255 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5053/api/Conversation/get_conversations/5 - 200 null application/json; charset=utf-8 5.3393ms
2025-04-30 08:46:52.264 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/api/Conversation/get_conversations/5 - null null
2025-04-30 08:46:52.264 +07:00 [INF] CORS policy execution successful.
2025-04-30 08:46:52.264 +07:00 [INF] CORS policy execution successful.
2025-04-30 08:46:52.265 +07:00 [INF] Executing endpoint 'server.Controllers.ConversationController.GetConversations (Message_app)'
2025-04-30 08:46:52.265 +07:00 [INF] Route matched with {action = "GetConversations", controller = "Conversation"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetConversations(Int32) on controller server.Controllers.ConversationController (Message_app).
2025-04-30 08:46:52.268 +07:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[server.DTO.ConversationDto, Message_app, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-04-30 08:46:52.269 +07:00 [INF] Executed action server.Controllers.ConversationController.GetConversations (Message_app) in 3.4747ms
2025-04-30 08:46:52.269 +07:00 [INF] Executed endpoint 'server.Controllers.ConversationController.GetConversations (Message_app)'
2025-04-30 08:46:52.269 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5053/api/Conversation/get_conversations/5 - 200 null application/json; charset=utf-8 5.3373ms
2025-04-30 08:46:52.316 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/ws/chat?userId=5 - null null
2025-04-30 08:46:52.316 +07:00 [INF] CORS policy execution successful.
2025-04-30 08:46:52.316 +07:00 [INF] CORS policy execution successful.
2025-04-30 08:46:52.317 +07:00 [INF] Executing endpoint '/ws/chat'
2025-04-30 08:46:52.444 +07:00 [INF] Executed DbCommand (6ms) [Parameters=[@__client_UserId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[conversation_id]
FROM [Participants] AS [p]
WHERE [p].[user_id] = @__client_UserId_0 AND [p].[is_deleted] = CAST(0 AS bit)
2025-04-30 08:46:54.087 +07:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5053/api/Message/getMessages/1/5 - null null
2025-04-30 08:46:54.087 +07:00 [INF] CORS policy execution successful.
2025-04-30 08:46:54.088 +07:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5053/api/Message/getMessages/1/5 - 204 null null 1.0453ms
2025-04-30 08:46:54.090 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/api/Message/getMessages/1/5 - null null
2025-04-30 08:46:54.090 +07:00 [INF] CORS policy execution successful.
2025-04-30 08:46:54.091 +07:00 [INF] CORS policy execution successful.
2025-04-30 08:46:54.091 +07:00 [INF] Executing endpoint 'server.Controllers.MessageController.GetMessages (Message_app)'
2025-04-30 08:46:54.091 +07:00 [INF] Route matched with {action = "GetMessages", controller = "Message"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetMessages(Int32, Int32) on controller server.Controllers.MessageController (Message_app).
2025-04-30 08:46:54.129 +07:00 [WRN] Message 81 not found in Redis
2025-04-30 08:46:54.131 +07:00 [WRN] Message 80 not found in Redis
2025-04-30 08:46:54.132 +07:00 [WRN] Message 79 not found in Redis
2025-04-30 08:46:54.141 +07:00 [WRN] Message 78 not found in Redis
2025-04-30 08:46:54.143 +07:00 [WRN] Message 77 not found in Redis
2025-04-30 08:46:54.144 +07:00 [WRN] Message 76 not found in Redis
2025-04-30 08:46:54.145 +07:00 [WRN] Message 75 not found in Redis
2025-04-30 08:46:54.146 +07:00 [WRN] Message 74 not found in Redis
2025-04-30 08:46:54.146 +07:00 [WRN] Message 73 not found in Redis
2025-04-30 08:46:54.147 +07:00 [WRN] Message 72 not found in Redis
2025-04-30 08:46:54.149 +07:00 [WRN] Message 71 not found in Redis
2025-04-30 08:46:54.150 +07:00 [WRN] Message 68 not found in Redis
2025-04-30 08:46:54.150 +07:00 [WRN] Message 64 not found in Redis
2025-04-30 08:46:54.151 +07:00 [WRN] Message 62 not found in Redis
2025-04-30 08:46:54.151 +07:00 [WRN] Message 61 not found in Redis
2025-04-30 08:46:54.152 +07:00 [WRN] Message 60 not found in Redis
2025-04-30 08:46:54.153 +07:00 [WRN] Message 59 not found in Redis
2025-04-30 08:46:54.155 +07:00 [WRN] Message 57 not found in Redis
2025-04-30 08:46:54.156 +07:00 [WRN] Message 55 not found in Redis
2025-04-30 08:46:54.157 +07:00 [WRN] Message 54 not found in Redis
2025-04-30 08:46:54.158 +07:00 [WRN] Message 51 not found in Redis
2025-04-30 08:46:54.159 +07:00 [WRN] Message 49 not found in Redis
2025-04-30 08:46:54.160 +07:00 [WRN] Message 11 not found in Redis
2025-04-30 08:46:54.161 +07:00 [WRN] Message 8 not found in Redis
2025-04-30 08:46:54.161 +07:00 [WRN] Message 3 not found in Redis
2025-04-30 08:46:54.162 +07:00 [WRN] Message 2 not found in Redis
2025-04-30 08:46:54.162 +07:00 [WRN] Message 1 not found in Redis
2025-04-30 08:46:54.162 +07:00 [INF] Retrieved 11 messages from Redis for conversation 1
2025-04-30 08:46:54.162 +07:00 [INF] Retrieved 11 messages from Redis for conversation 1 and user 5
2025-04-30 08:46:54.163 +07:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[server.DTO.MessageWithAttachment, Message_app, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-04-30 08:46:54.163 +07:00 [INF] Executed action server.Controllers.MessageController.GetMessages (Message_app) in 71.2871ms
2025-04-30 08:46:54.163 +07:00 [INF] Executed endpoint 'server.Controllers.MessageController.GetMessages (Message_app)'
2025-04-30 08:46:54.163 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5053/api/Message/getMessages/1/5 - 200 null application/json; charset=utf-8 73.5015ms
2025-04-30 08:46:54.184 +07:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5053/api/Conversation/get_first_conversation/1 - null null
2025-04-30 08:46:54.184 +07:00 [INF] CORS policy execution successful.
2025-04-30 08:46:54.185 +07:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5053/api/Conversation/get_first_conversation/1 - 204 null null 0.2744ms
2025-04-30 08:46:54.188 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/api/Conversation/get_first_conversation/1 - null null
2025-04-30 08:46:54.188 +07:00 [INF] CORS policy execution successful.
2025-04-30 08:46:54.188 +07:00 [INF] CORS policy execution successful.
2025-04-30 08:46:54.188 +07:00 [INF] Executing endpoint 'server.Controllers.ConversationController.GetFirstConversation (Message_app)'
2025-04-30 08:46:54.189 +07:00 [INF] Route matched with {action = "GetFirstConversation", controller = "Conversation"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetFirstConversation(Int32) on controller server.Controllers.ConversationController (Message_app).
2025-04-30 08:46:54.198 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[id], [c].[created_at], [c].[is_group], [c].[lastMessage], [c].[lastMessageSender], [c].[lastMessageTime], [c].[name]
FROM [Conversations] AS [c]
WHERE [c].[id] = @__p_0
2025-04-30 08:46:54.199 +07:00 [INF] Executing OkObjectResult, writing value of type 'server.Models.Conversation'.
2025-04-30 08:46:54.199 +07:00 [INF] Executed action server.Controllers.ConversationController.GetFirstConversation (Message_app) in 10.0489ms
2025-04-30 08:46:54.200 +07:00 [INF] Executed endpoint 'server.Controllers.ConversationController.GetFirstConversation (Message_app)'
2025-04-30 08:46:54.200 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5053/api/Conversation/get_first_conversation/1 - 200 null application/json; charset=utf-8 12.0295ms
2025-04-30 08:46:54.216 +07:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5053/api/Participant/get_participants/1 - null null
2025-04-30 08:46:54.216 +07:00 [INF] CORS policy execution successful.
2025-04-30 08:46:54.216 +07:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5053/api/Participant/get_participants/1 - 204 null null 0.2605ms
2025-04-30 08:46:54.217 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/api/Participant/get_participants/1 - null null
2025-04-30 08:46:54.218 +07:00 [INF] CORS policy execution successful.
2025-04-30 08:46:54.218 +07:00 [INF] CORS policy execution successful.
2025-04-30 08:46:54.218 +07:00 [INF] Executing endpoint 'server.Controllers.ParticipantController.GetParticipants (Message_app)'
2025-04-30 08:46:54.218 +07:00 [INF] Route matched with {action = "GetParticipants", controller = "Participant"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetParticipants(Int32) on controller server.Controllers.ParticipantController (Message_app).
2025-04-30 08:46:54.230 +07:00 [INF] Executed DbCommand (4ms) [Parameters=[@__conversation_id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[id], [p].[adder], [p].[conversation_id], [p].[is_deleted], [p].[joined_at], [p].[name], [p].[role], [p].[user_id]
FROM [Participants] AS [p]
WHERE [p].[conversation_id] = @__conversation_id_0
2025-04-30 08:46:54.231 +07:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType17`1[[System.Collections.Generic.List`1[[server.Models.Participants, Message_app, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-04-30 08:46:54.232 +07:00 [INF] Executed action server.Controllers.ParticipantController.GetParticipants (Message_app) in 13.0727ms
2025-04-30 08:46:54.232 +07:00 [INF] Executed endpoint 'server.Controllers.ParticipantController.GetParticipants (Message_app)'
2025-04-30 08:46:54.233 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5053/api/Participant/get_participants/1 - 200 null application/json; charset=utf-8 14.6964ms
2025-04-30 08:46:58.160 +07:00 [INF] Request starting HTTP/1.1 GET http://192.168.1.9:5053/api/Message/getMessages/1/2 - null null
2025-04-30 08:46:58.160 +07:00 [INF] Executing endpoint 'server.Controllers.MessageController.GetMessages (Message_app)'
2025-04-30 08:46:58.160 +07:00 [INF] Route matched with {action = "GetMessages", controller = "Message"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetMessages(Int32, Int32) on controller server.Controllers.MessageController (Message_app).
2025-04-30 08:46:58.185 +07:00 [WRN] Message 81 not found in Redis
2025-04-30 08:46:58.187 +07:00 [WRN] Message 80 not found in Redis
2025-04-30 08:46:58.191 +07:00 [WRN] Message 79 not found in Redis
2025-04-30 08:46:58.197 +07:00 [WRN] Message 78 not found in Redis
2025-04-30 08:46:58.199 +07:00 [WRN] Message 77 not found in Redis
2025-04-30 08:46:58.202 +07:00 [WRN] Message 76 not found in Redis
2025-04-30 08:46:58.212 +07:00 [WRN] Message 75 not found in Redis
2025-04-30 08:46:58.214 +07:00 [WRN] Message 74 not found in Redis
2025-04-30 08:46:58.216 +07:00 [WRN] Message 73 not found in Redis
2025-04-30 08:46:58.217 +07:00 [WRN] Message 72 not found in Redis
2025-04-30 08:46:58.219 +07:00 [WRN] Message 71 not found in Redis
2025-04-30 08:46:58.221 +07:00 [WRN] Message 68 not found in Redis
2025-04-30 08:46:58.222 +07:00 [WRN] Message 64 not found in Redis
2025-04-30 08:46:58.224 +07:00 [WRN] Message 62 not found in Redis
2025-04-30 08:46:58.226 +07:00 [WRN] Message 61 not found in Redis
2025-04-30 08:46:58.227 +07:00 [WRN] Message 60 not found in Redis
2025-04-30 08:46:58.232 +07:00 [WRN] Message 59 not found in Redis
2025-04-30 08:46:58.235 +07:00 [WRN] Message 57 not found in Redis
2025-04-30 08:46:58.237 +07:00 [WRN] Message 55 not found in Redis
2025-04-30 08:46:58.238 +07:00 [WRN] Message 54 not found in Redis
2025-04-30 08:46:58.239 +07:00 [WRN] Message 51 not found in Redis
2025-04-30 08:46:58.239 +07:00 [WRN] Message 49 not found in Redis
2025-04-30 08:46:58.241 +07:00 [WRN] Message 11 not found in Redis
2025-04-30 08:46:58.242 +07:00 [WRN] Message 8 not found in Redis
2025-04-30 08:46:58.243 +07:00 [WRN] Message 3 not found in Redis
2025-04-30 08:46:58.246 +07:00 [WRN] Message 2 not found in Redis
2025-04-30 08:46:58.248 +07:00 [WRN] Message 1 not found in Redis
2025-04-30 08:46:58.249 +07:00 [INF] Retrieved 11 messages from Redis for conversation 1
2025-04-30 08:46:58.249 +07:00 [INF] Retrieved 11 messages from Redis for conversation 1 and user 2
2025-04-30 08:46:58.249 +07:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[server.DTO.MessageWithAttachment, Message_app, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-04-30 08:46:58.249 +07:00 [INF] Executed action server.Controllers.MessageController.GetMessages (Message_app) in 89.014ms
2025-04-30 08:46:58.250 +07:00 [INF] Executed endpoint 'server.Controllers.MessageController.GetMessages (Message_app)'
2025-04-30 08:46:58.250 +07:00 [INF] Request finished HTTP/1.1 GET http://192.168.1.9:5053/api/Message/getMessages/1/2 - 200 null application/json; charset=utf-8 90.1558ms
2025-04-30 08:46:58.394 +07:00 [INF] Request starting HTTP/1.1 GET http://192.168.1.9:5053/api/Conversation/get_first_conversation/1 - null null
2025-04-30 08:46:58.394 +07:00 [INF] Executing endpoint 'server.Controllers.ConversationController.GetFirstConversation (Message_app)'
2025-04-30 08:46:58.394 +07:00 [INF] Route matched with {action = "GetFirstConversation", controller = "Conversation"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetFirstConversation(Int32) on controller server.Controllers.ConversationController (Message_app).
2025-04-30 08:46:58.398 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[id], [c].[created_at], [c].[is_group], [c].[lastMessage], [c].[lastMessageSender], [c].[lastMessageTime], [c].[name]
FROM [Conversations] AS [c]
WHERE [c].[id] = @__p_0
2025-04-30 08:46:58.398 +07:00 [INF] Executing OkObjectResult, writing value of type 'server.Models.Conversation'.
2025-04-30 08:46:58.398 +07:00 [INF] Executed action server.Controllers.ConversationController.GetFirstConversation (Message_app) in 3.8646ms
2025-04-30 08:46:58.398 +07:00 [INF] Executed endpoint 'server.Controllers.ConversationController.GetFirstConversation (Message_app)'
2025-04-30 08:46:58.399 +07:00 [INF] Request finished HTTP/1.1 GET http://192.168.1.9:5053/api/Conversation/get_first_conversation/1 - 200 null application/json; charset=utf-8 4.7066ms
2025-04-30 08:46:58.514 +07:00 [INF] Request starting HTTP/1.1 GET http://192.168.1.9:5053/api/Participant/get_participants/1 - null null
2025-04-30 08:46:58.515 +07:00 [INF] Executing endpoint 'server.Controllers.ParticipantController.GetParticipants (Message_app)'
2025-04-30 08:46:58.515 +07:00 [INF] Route matched with {action = "GetParticipants", controller = "Participant"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetParticipants(Int32) on controller server.Controllers.ParticipantController (Message_app).
2025-04-30 08:46:58.518 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__conversation_id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[id], [p].[adder], [p].[conversation_id], [p].[is_deleted], [p].[joined_at], [p].[name], [p].[role], [p].[user_id]
FROM [Participants] AS [p]
WHERE [p].[conversation_id] = @__conversation_id_0
2025-04-30 08:46:58.518 +07:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType17`1[[System.Collections.Generic.List`1[[server.Models.Participants, Message_app, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-04-30 08:46:58.519 +07:00 [INF] Executed action server.Controllers.ParticipantController.GetParticipants (Message_app) in 3.9952ms
2025-04-30 08:46:58.519 +07:00 [INF] Executed endpoint 'server.Controllers.ParticipantController.GetParticipants (Message_app)'
2025-04-30 08:46:58.519 +07:00 [INF] Request finished HTTP/1.1 GET http://192.168.1.9:5053/api/Participant/get_participants/1 - 200 null application/json; charset=utf-8 4.828ms
2025-04-30 08:47:01.408 +07:00 [INF] Handling message from user 5: ok
2025-04-30 08:47:01.411 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[id], [c].[created_at], [c].[is_group], [c].[lastMessage], [c].[lastMessageSender], [c].[lastMessageTime], [c].[name]
FROM [Conversations] AS [c]
WHERE [c].[id] = @__p_0
2025-04-30 08:47:01.445 +07:00 [WRN] Savepoints are disabled because Multiple Active Result Sets (MARS) is enabled. If 'SaveChanges' fails, then the transaction cannot be automatically rolled back to a known clean state. Instead, the transaction should be rolled back by the application before retrying 'SaveChanges'. See https://go.microsoft.com/fwlink/?linkid=2149338 for more information and examples. To identify the code which triggers this warning, call 'ConfigureWarnings(w => w.Throw(SqlServerEventId.SavepointsDisabledBecauseOfMARS))'.
2025-04-30 08:47:01.449 +07:00 [INF] Executed DbCommand (4ms) [Parameters=[@p0='?' (Size = 500), @p1='?' (DbType = Int32), @p2='?' (DbType = DateTime2), @p3='?' (DbType = Boolean), @p4='?' (DbType = Boolean), @p5='?' (DbType = Boolean), @p6='?' (DbType = Int32), @p7='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Messages] ([content], [conversation_id], [created_at], [isFile], [isRecalled], [is_read], [sender_id], [type])
OUTPUT INSERTED.[id]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7);
2025-04-30 08:47:01.450 +07:00 [INF] Message saved to DB with ID: 95
2025-04-30 08:47:01.450 +07:00 [WRN] Savepoints are disabled because Multiple Active Result Sets (MARS) is enabled. If 'SaveChanges' fails, then the transaction cannot be automatically rolled back to a known clean state. Instead, the transaction should be rolled back by the application before retrying 'SaveChanges'. See https://go.microsoft.com/fwlink/?linkid=2149338 for more information and examples. To identify the code which triggers this warning, call 'ConfigureWarnings(w => w.Throw(SqlServerEventId.SavepointsDisabledBecauseOfMARS))'.
2025-04-30 08:47:01.456 +07:00 [INF] Executed DbCommand (5ms) [Parameters=[@p6='?' (DbType = Int32), @p0='?' (DbType = DateTime2), @p1='?' (DbType = Boolean), @p2='?' (Size = 4000), @p3='?' (Size = 4000), @p4='?' (DbType = DateTime2), @p5='?' (Size = 100)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
UPDATE [Conversations] SET [created_at] = @p0, [is_group] = @p1, [lastMessage] = @p2, [lastMessageSender] = @p3, [lastMessageTime] = @p4, [name] = @p5
OUTPUT 1
WHERE [id] = @p6;
2025-04-30 08:47:01.460 +07:00 [INF] Transaction committed for message: 95
2025-04-30 08:47:01.462 +07:00 [INF] Saved message 95 to Redis
2025-04-30 08:47:01.463 +07:00 [INF] Added message 95 to conversation 1
2025-04-30 08:47:01.464 +07:00 [INF] Published message to channel conversation:1
2025-04-30 08:56:22.785 +07:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5053/api/Auth/login - null null
2025-04-30 08:56:22.785 +07:00 [INF] CORS policy execution successful.
2025-04-30 08:56:22.785 +07:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5053/api/Auth/login - 204 null null 0.2578ms
2025-04-30 08:56:22.787 +07:00 [INF] Request starting HTTP/1.1 POST http://localhost:5053/api/Auth/login - application/json 53
2025-04-30 08:56:22.787 +07:00 [INF] CORS policy execution successful.
2025-04-30 08:56:22.787 +07:00 [INF] CORS policy execution successful.
2025-04-30 08:56:22.788 +07:00 [INF] Executing endpoint 'Message_app.Controllers.AuthController.Login (Message_app)'
2025-04-30 08:56:22.788 +07:00 [INF] Route matched with {action = "Login", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Login(server.DTO.AuthDTO.LoginDTO) on controller Message_app.Controllers.AuthController (Message_app).
2025-04-30 08:56:22.825 +07:00 [INF] Executed DbCommand (15ms) [Parameters=[@__email_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[id], [u].[avatar_url], [u].[bio], [u].[birthday], [u].[created_at], [u].[email], [u].[gender], [u].[interests], [u].[location], [u].[password], [u].[passwordSalt], [u].[username]
FROM [Users] AS [u]
WHERE [u].[email] = @__email_0
2025-04-30 08:56:22.826 +07:00 [INF] Executing OkObjectResult, writing value of type 'server.DTO.AuthDTO.LoginRespose'.
2025-04-30 08:56:22.826 +07:00 [INF] Executed action Message_app.Controllers.AuthController.Login (Message_app) in 38.0247ms
2025-04-30 08:56:22.826 +07:00 [INF] Executed endpoint 'Message_app.Controllers.AuthController.Login (Message_app)'
2025-04-30 08:56:22.826 +07:00 [INF] Request finished HTTP/1.1 POST http://localhost:5053/api/Auth/login - 200 null application/json; charset=utf-8 39.7908ms
2025-04-30 08:56:23.029 +07:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5053/api/Conversation/get_conversations/5 - null null
2025-04-30 08:56:23.029 +07:00 [INF] CORS policy execution successful.
2025-04-30 08:56:23.030 +07:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5053/api/Conversation/get_conversations/5 - 204 null null 0.7724ms
2025-04-30 08:56:23.031 +07:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5053/api/Conversation/get_conversations/5 - null null
2025-04-30 08:56:23.031 +07:00 [INF] CORS policy execution successful.
2025-04-30 08:56:23.031 +07:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5053/api/Conversation/get_conversations/5 - 204 null null 0.2231ms
2025-04-30 08:56:23.031 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/api/Conversation/get_conversations/5 - null null
2025-04-30 08:56:23.031 +07:00 [INF] CORS policy execution successful.
2025-04-30 08:56:23.031 +07:00 [INF] CORS policy execution successful.
2025-04-30 08:56:23.031 +07:00 [INF] Executing endpoint 'server.Controllers.ConversationController.GetConversations (Message_app)'
2025-04-30 08:56:23.032 +07:00 [INF] Route matched with {action = "GetConversations", controller = "Conversation"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetConversations(Int32) on controller server.Controllers.ConversationController (Message_app).
2025-04-30 08:56:23.033 +07:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[server.DTO.ConversationDto, Message_app, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-04-30 08:56:23.033 +07:00 [INF] Executed action server.Controllers.ConversationController.GetConversations (Message_app) in 1.7585ms
2025-04-30 08:56:23.034 +07:00 [INF] Executed endpoint 'server.Controllers.ConversationController.GetConversations (Message_app)'
2025-04-30 08:56:23.034 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5053/api/Conversation/get_conversations/5 - 200 null application/json; charset=utf-8 2.6581ms
2025-04-30 08:56:23.035 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/api/Conversation/get_conversations/5 - null null
2025-04-30 08:56:23.035 +07:00 [INF] CORS policy execution successful.
2025-04-30 08:56:23.035 +07:00 [INF] CORS policy execution successful.
2025-04-30 08:56:23.036 +07:00 [INF] Executing endpoint 'server.Controllers.ConversationController.GetConversations (Message_app)'
2025-04-30 08:56:23.036 +07:00 [INF] Route matched with {action = "GetConversations", controller = "Conversation"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetConversations(Int32) on controller server.Controllers.ConversationController (Message_app).
2025-04-30 08:56:23.037 +07:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[server.DTO.ConversationDto, Message_app, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-04-30 08:56:23.037 +07:00 [INF] Executed action server.Controllers.ConversationController.GetConversations (Message_app) in 1.5296ms
2025-04-30 08:56:23.037 +07:00 [INF] Executed endpoint 'server.Controllers.ConversationController.GetConversations (Message_app)'
2025-04-30 08:56:23.038 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5053/api/Conversation/get_conversations/5 - 200 null application/json; charset=utf-8 2.4963ms
2025-04-30 08:56:23.084 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/ws/chat?userId=5 - null null
2025-04-30 08:56:23.085 +07:00 [INF] CORS policy execution successful.
2025-04-30 08:56:23.085 +07:00 [INF] CORS policy execution successful.
2025-04-30 08:56:23.085 +07:00 [INF] Executing endpoint '/ws/chat'
2025-04-30 08:56:23.182 +07:00 [INF] Executed DbCommand (6ms) [Parameters=[@__client_UserId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[conversation_id]
FROM [Participants] AS [p]
WHERE [p].[user_id] = @__client_UserId_0 AND [p].[is_deleted] = CAST(0 AS bit)
2025-04-30 08:56:25.515 +07:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5053/api/Message/getMessages/1/5 - null null
2025-04-30 08:56:25.515 +07:00 [INF] CORS policy execution successful.
2025-04-30 08:56:25.515 +07:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5053/api/Message/getMessages/1/5 - 204 null null 0.1911ms
2025-04-30 08:56:25.516 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/api/Message/getMessages/1/5 - null null
2025-04-30 08:56:25.516 +07:00 [INF] CORS policy execution successful.
2025-04-30 08:56:25.516 +07:00 [INF] CORS policy execution successful.
2025-04-30 08:56:25.516 +07:00 [INF] Executing endpoint 'server.Controllers.MessageController.GetMessages (Message_app)'
2025-04-30 08:56:25.516 +07:00 [INF] Route matched with {action = "GetMessages", controller = "Message"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetMessages(Int32, Int32) on controller server.Controllers.MessageController (Message_app).
2025-04-30 08:56:25.521 +07:00 [WRN] Message 81 not found in Redis
2025-04-30 08:56:25.522 +07:00 [WRN] Message 80 not found in Redis
2025-04-30 08:56:25.522 +07:00 [WRN] Message 79 not found in Redis
2025-04-30 08:56:25.522 +07:00 [WRN] Message 78 not found in Redis
2025-04-30 08:56:25.522 +07:00 [WRN] Message 77 not found in Redis
2025-04-30 08:56:25.522 +07:00 [WRN] Message 76 not found in Redis
2025-04-30 08:56:25.523 +07:00 [WRN] Message 75 not found in Redis
2025-04-30 08:56:25.523 +07:00 [WRN] Message 74 not found in Redis
2025-04-30 08:56:25.523 +07:00 [WRN] Message 73 not found in Redis
2025-04-30 08:56:25.523 +07:00 [WRN] Message 72 not found in Redis
2025-04-30 08:56:25.524 +07:00 [WRN] Message 71 not found in Redis
2025-04-30 08:56:25.524 +07:00 [WRN] Message 68 not found in Redis
2025-04-30 08:56:25.525 +07:00 [WRN] Message 64 not found in Redis
2025-04-30 08:56:25.525 +07:00 [WRN] Message 62 not found in Redis
2025-04-30 08:56:25.525 +07:00 [WRN] Message 61 not found in Redis
2025-04-30 08:56:25.526 +07:00 [WRN] Message 60 not found in Redis
2025-04-30 08:56:25.526 +07:00 [WRN] Message 59 not found in Redis
2025-04-30 08:56:25.527 +07:00 [WRN] Message 57 not found in Redis
2025-04-30 08:56:25.527 +07:00 [WRN] Message 55 not found in Redis
2025-04-30 08:56:25.528 +07:00 [WRN] Message 54 not found in Redis
2025-04-30 08:56:25.528 +07:00 [WRN] Message 51 not found in Redis
2025-04-30 08:56:25.528 +07:00 [WRN] Message 49 not found in Redis
2025-04-30 08:56:25.529 +07:00 [WRN] Message 11 not found in Redis
2025-04-30 08:56:25.529 +07:00 [WRN] Message 8 not found in Redis
2025-04-30 08:56:25.529 +07:00 [WRN] Message 3 not found in Redis
2025-04-30 08:56:25.529 +07:00 [WRN] Message 2 not found in Redis
2025-04-30 08:56:25.529 +07:00 [WRN] Message 1 not found in Redis
2025-04-30 08:56:25.529 +07:00 [INF] Retrieved 12 messages from Redis for conversation 1
2025-04-30 08:56:25.529 +07:00 [INF] Retrieved 12 messages from Redis for conversation 1 and user 5
2025-04-30 08:56:25.529 +07:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[server.DTO.MessageWithAttachment, Message_app, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-04-30 08:56:25.530 +07:00 [INF] Executed action server.Controllers.MessageController.GetMessages (Message_app) in 13.1194ms
2025-04-30 08:56:25.530 +07:00 [INF] Executed endpoint 'server.Controllers.MessageController.GetMessages (Message_app)'
2025-04-30 08:56:25.530 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5053/api/Message/getMessages/1/5 - 200 null application/json; charset=utf-8 13.7955ms
2025-04-30 08:56:25.546 +07:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5053/api/Conversation/get_first_conversation/1 - null null
2025-04-30 08:56:25.546 +07:00 [INF] CORS policy execution successful.
2025-04-30 08:56:25.546 +07:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5053/api/Conversation/get_first_conversation/1 - 204 null null 0.3486ms
2025-04-30 08:56:25.547 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/api/Conversation/get_first_conversation/1 - null null
2025-04-30 08:56:25.547 +07:00 [INF] CORS policy execution successful.
2025-04-30 08:56:25.547 +07:00 [INF] CORS policy execution successful.
2025-04-30 08:56:25.547 +07:00 [INF] Executing endpoint 'server.Controllers.ConversationController.GetFirstConversation (Message_app)'
2025-04-30 08:56:25.547 +07:00 [INF] Route matched with {action = "GetFirstConversation", controller = "Conversation"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetFirstConversation(Int32) on controller server.Controllers.ConversationController (Message_app).
2025-04-30 08:56:25.557 +07:00 [INF] Executed DbCommand (7ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[id], [c].[created_at], [c].[is_group], [c].[lastMessage], [c].[lastMessageSender], [c].[lastMessageTime], [c].[name]
FROM [Conversations] AS [c]
WHERE [c].[id] = @__p_0
2025-04-30 08:56:25.557 +07:00 [INF] Executing OkObjectResult, writing value of type 'server.Models.Conversation'.
2025-04-30 08:56:25.558 +07:00 [INF] Executed action server.Controllers.ConversationController.GetFirstConversation (Message_app) in 9.9783ms
2025-04-30 08:56:25.558 +07:00 [INF] Executed endpoint 'server.Controllers.ConversationController.GetFirstConversation (Message_app)'
2025-04-30 08:56:25.558 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5053/api/Conversation/get_first_conversation/1 - 200 null application/json; charset=utf-8 11.1416ms
2025-04-30 08:56:25.574 +07:00 [INF] Request starting HTTP/1.1 OPTIONS http://localhost:5053/api/Participant/get_participants/1 - null null
2025-04-30 08:56:25.575 +07:00 [INF] CORS policy execution successful.
2025-04-30 08:56:25.575 +07:00 [INF] Request finished HTTP/1.1 OPTIONS http://localhost:5053/api/Participant/get_participants/1 - 204 null null 0.2846ms
2025-04-30 08:56:25.576 +07:00 [INF] Request starting HTTP/1.1 GET http://localhost:5053/api/Participant/get_participants/1 - null null
2025-04-30 08:56:25.576 +07:00 [INF] CORS policy execution successful.
2025-04-30 08:56:25.576 +07:00 [INF] CORS policy execution successful.
2025-04-30 08:56:25.576 +07:00 [INF] Executing endpoint 'server.Controllers.ParticipantController.GetParticipants (Message_app)'
2025-04-30 08:56:25.577 +07:00 [INF] Route matched with {action = "GetParticipants", controller = "Participant"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetParticipants(Int32) on controller server.Controllers.ParticipantController (Message_app).
2025-04-30 08:56:25.580 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[@__conversation_id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[id], [p].[adder], [p].[conversation_id], [p].[is_deleted], [p].[joined_at], [p].[name], [p].[role], [p].[user_id]
FROM [Participants] AS [p]
WHERE [p].[conversation_id] = @__conversation_id_0
2025-04-30 08:56:25.581 +07:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType17`1[[System.Collections.Generic.List`1[[server.Models.Participants, Message_app, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-04-30 08:56:25.581 +07:00 [INF] Executed action server.Controllers.ParticipantController.GetParticipants (Message_app) in 4.5852ms
2025-04-30 08:56:25.581 +07:00 [INF] Executed endpoint 'server.Controllers.ParticipantController.GetParticipants (Message_app)'
2025-04-30 08:56:25.581 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5053/api/Participant/get_participants/1 - 200 null application/json; charset=utf-8 5.1659ms
2025-04-30 08:56:39.779 +07:00 [INF] Application is shutting down...
2025-04-30 08:57:04.281 +07:00 [INF] Executed endpoint '/ws/chat'
2025-04-30 08:57:04.281 +07:00 [ERR] An unhandled exception has occurred while executing the request.
System.Net.WebSockets.WebSocketException (0x80004005): The remote party closed the WebSocket connection without completing the close handshake.
   at System.Net.WebSockets.ManagedWebSocket.ThrowEOFUnexpected()
   at System.Net.WebSockets.ManagedWebSocket.EnsureBufferContainsAsync(Int32 minimumRequiredBytes, CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.WebSockets.ManagedWebSocket.ReceiveAsyncPrivate[TResult](Memory`1 payloadBuffer, CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at System.Threading.Tasks.ValueTask`1.ValueTaskSourceAsTask.<>c.<.cctor>b__4_0(Object state)
--- End of stack trace from previous location ---
   at server.Services.WebSocketService.webSocket.Receiver(Client client) in C:\Users\Thao\source\Flutter\Message_app\server\Services\WebSocketService\websocket.cs:line 108
   at server.Services.WebSocketService.webSocket.HandleWebSocket(HttpContext context) in C:\Users\Thao\source\Flutter\Message_app\server\Services\WebSocketService\websocket.cs:line 91
   at Program.<>c.<<<Main>$>b__0_4>d.MoveNext() in C:\Users\Thao\source\Flutter\Message_app\server\Program.cs:line 89
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
2025-04-30 08:57:04.293 +07:00 [WRN] The response has already started, the error page middleware will not be executed.
2025-04-30 08:57:04.294 +07:00 [ERR] Connection id "0HNC7GUUPR8MC", Request id "0HNC7GUUPR8MC:00000001": An unhandled exception was thrown by the application.
System.Net.WebSockets.WebSocketException (0x80004005): The remote party closed the WebSocket connection without completing the close handshake.
   at System.Net.WebSockets.ManagedWebSocket.ThrowEOFUnexpected()
   at System.Net.WebSockets.ManagedWebSocket.EnsureBufferContainsAsync(Int32 minimumRequiredBytes, CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource.GetResult(Int16 token)
   at System.Net.WebSockets.ManagedWebSocket.ReceiveAsyncPrivate[TResult](Memory`1 payloadBuffer, CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.PoolingAsyncValueTaskMethodBuilder`1.StateMachineBox`1.System.Threading.Tasks.Sources.IValueTaskSource<TResult>.GetResult(Int16 token)
   at System.Threading.Tasks.ValueTask`1.ValueTaskSourceAsTask.<>c.<.cctor>b__4_0(Object state)
--- End of stack trace from previous location ---
   at server.Services.WebSocketService.webSocket.Receiver(Client client) in C:\Users\Thao\source\Flutter\Message_app\server\Services\WebSocketService\websocket.cs:line 108
   at server.Services.WebSocketService.webSocket.HandleWebSocket(HttpContext context) in C:\Users\Thao\source\Flutter\Message_app\server\Services\WebSocketService\websocket.cs:line 91
   at Program.<>c.<<<Main>$>b__0_4>d.MoveNext() in C:\Users\Thao\source\Flutter\Message_app\server\Program.cs:line 89
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Watch.BrowserRefresh.BrowserRefreshMiddleware.InvokeAsync(HttpContext context)
   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.Http.HttpProtocol.ProcessRequests[TContext](IHttpApplication`1 application)
2025-04-30 08:57:04.297 +07:00 [INF] Request finished HTTP/1.1 GET http://192.168.1.9:5053/ws/chat?userId=2 - 101 null null 1095244.8276ms
2025-04-30 08:57:09.800 +07:00 [INF] Executed endpoint '/ws/chat'
2025-04-30 08:57:09.800 +07:00 [INF] Executed endpoint '/ws/chat'
2025-04-30 08:57:09.800 +07:00 [INF] Executed endpoint '/ws/chat'
2025-04-30 08:57:09.800 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5053/ws/chat?userId=5 - 101 null null 46715.9331ms
2025-04-30 08:57:09.800 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5053/ws/chat?userId=5 - 101 null null 617484.7175ms
2025-04-30 08:57:09.800 +07:00 [INF] Request finished HTTP/1.1 GET http://localhost:5053/ws/chat?userId=5 - 101 null null 1086162.3822ms
